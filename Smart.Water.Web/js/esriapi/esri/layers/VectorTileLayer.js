// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define("require exports tslib ../../geometry ../../core/accessorSupport/decorators ../support/serviceTileInfoProperty ../support/TilemapCache".split(" "),function(n,e,c,h,b,a,g){Object.defineProperty(e,"__esModule",{value:!0});e.ArcGISCachedService=function(m){return function(l){function f(){var d=null!==l&&l.apply(this,arguments)||this;d.copyright=null;d.minScale=0;d.maxScale=0;d.spatialReference=null;d.tileInfo=null;d.tilemapCache=
null;return d}c.__extends(f,l);f.prototype.readMinScale=function(d,a){return null!=a.minLOD&&null!=a.maxLOD?d:0};f.prototype.readMaxScale=function(d,a){return null!=a.minLOD&&null!=a.maxLOD?d:0};Object.defineProperty(f.prototype,"supportsBlankTile",{get:function(){return 10.2<=this.version},enumerable:!0,configurable:!0});f.prototype.readTilemapCache=function(d,a){return a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?new g.TilemapCache({layer:this}):null};c.__decorate([b.property({json:{read:{source:"copyrightText"}}})],
f.prototype,"copyright",void 0);c.__decorate([b.property()],f.prototype,"minScale",void 0);c.__decorate([b.reader("service","minScale")],f.prototype,"readMinScale",null);c.__decorate([b.property()],f.prototype,"maxScale",void 0);c.__decorate([b.reader("service","maxScale")],f.prototype,"readMaxScale",null);c.__decorate([b.property({type:h.SpatialReference})],f.prototype,"spatialReference",void 0);c.__decorate([b.property({readOnly:!0,dependsOn:["version"]})],f.prototype,"supportsBlankTile",null);
c.__decorate([b.property(a.serviceTileInfoProperty)],f.prototype,"tileInfo",void 0);c.__decorate([b.property()],f.prototype,"tilemapCache",void 0);c.__decorate([b.reader("service","tilemapCache",["capabilities"])],f.prototype,"readTilemapCache",null);c.__decorate([b.property()],f.prototype,"version",void 0);return f=c.__decorate([b.subclass("esri.layers.mixins.ArcGISCachedService")],f)}(m)}})},"esri/layers/support/serviceTileInfoProperty":function(){define(["require","exports","tslib","./TileInfo"],
function(n,e,c,h){function b(a,g,b,l){if(!a)return null;b=g.minScale;var f=g.maxScale,d=g.minLOD,k=g.maxLOD;if(null!=d&&null!=k)return l&&l.ignoreMinMaxLOD?h.fromJSON(a):h.fromJSON(c.__assign(c.__assign({},a),{lods:a.lods.filter(function(a){a=a.level;return null!=a&&a>=d&&a<=k})}));if(0!==b&&0!==f){var m=b?Math.round(1E4*b)/1E4:Infinity,e=f?Math.round(1E4*f)/1E4:-Infinity;return h.fromJSON(c.__assign(c.__assign({},a),{lods:a.lods.filter(function(d){d=Math.round(1E4*d.scale)/1E4;return d<=m&&d>=e})}))}return h.fromJSON(a)}
Object.defineProperty(e,"__esModule",{value:!0});e.serviceTileInfoProperty={type:h,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:b}}}}};e.readServiceTileInfo=b})},"esri/layers/support/TileInfo":function(){define("require exports tslib ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(n,e,c,h,b,a,g,m,l,f,d,k,q){var t=new b.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(a){function b(d){d=a.call(this,d)||this;d.dpi=96;d.format=null;d.origin=null;d.minScale=0;d.maxScale=0;d.size=null;d.spatialReference=null;return d}c.__extends(b,a);e=b;b.create=function(a){void 0===
a&&(a={size:256,spatialReference:h.SpatialReference.WebMercator});var b=a.resolutionFactor||1,f=a.scales,k=a.size||256,c=a.spatialReference||h.SpatialReference.WebMercator;if(!d.isValid(c)){b=[];if(f)for(a=0;a<f.length;a++){var l=f[a];b.push({level:a,scale:l,resolution:l})}else{var m=5E-4;for(a=23;0<=a;a--)b.unshift({level:a,scale:m,resolution:m}),m*=2}return new e({dpi:96,lods:b,origin:new h.Point(0,0,c),size:[k,k],spatialReference:c})}var l=d.getInfo(c),v=a.origin?new h.Point({x:a.origin.x,y:a.origin.y,
spatialReference:c}):l?new h.Point({x:l.origin[0],y:l.origin[1],spatialReference:c}):new h.Point({x:0,y:0,spatialReference:c}),q=1/(39.37*g.getMetersPerUnitForSR(c)*96),p=[];if(f)for(a=0;a<f.length;a++)l=f[a],m=l*q,p.push({level:a,scale:l,resolution:m});else for(l=d.isGeographic(c)?512/k*5.916575275917094E8:256/k*5.91657527591555E8,f=Math.ceil(24/b),p.push({level:0,scale:l,resolution:l*q}),a=1;a<f;a++)l/=Math.pow(2,b),m=l*q,p.push({level:a,scale:l,resolution:m});return new e({dpi:96,lods:p,origin:v,
size:[k,k],spatialReference:c})};Object.defineProperty(b.prototype,"isWrappable",{get:function(){var a=this.spatialReference,b=this.origin;if(a&&b){var f=d.getInfo(a);return a.isWrappable&&Math.abs(f.origin[0]-b.x)<=f.dx}return!1},enumerable:!0,configurable:!0});b.prototype.readOrigin=function(a,d){return h.Point.fromJSON(c.__assign({spatialReference:d.spatialReference},a))};Object.defineProperty(b.prototype,"lods",{set:function(a){var d=this,b=0,f=0,g=[];this._levelToLOD={};a&&(b=-Infinity,f=Infinity,
a.forEach(function(a){g.push(a.scale);b=a.scale>b?a.scale:b;f=a.scale<f?a.scale:f;d._levelToLOD[a.level]=a}));this._set("scales",g);this._set("minScale",b);this._set("maxScale",f);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});b.prototype.readSize=function(a,d){return[d.cols,d.rows]};b.prototype.writeSize=function(a,d){d.cols=a[0];d.rows=a[0]};b.prototype.zoomToScale=function(a){var d=this.scales;if(0>=a)return d[0];if(a>=d.length)return d[d.length-1];var b=
Math.round(a);return d[b]+(b-a)*(d[Math.round(a-.5)]-d[b])};b.prototype.scaleToZoom=function(a){for(var d=this.scales,b=d.length-1,f=0;f<b;f++){var g=d[f],k=d[f+1];if(g<=a)break;if(k===a)return f+1;if(g>a&&k<a)return f+1-(a-k)/(g-k)}return f};b.prototype.snapScale=function(a,d){void 0===d&&(d=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=d?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))};b.prototype.tileAt=function(a,b,g,l){var c=this.lodAt(a);if(!c)return null;var h;if("number"===
typeof b)h=b,b=g;else{if(d.equals(b.spatialReference,this.spatialReference))h=b.x,b=b.y;else{l=k.project(b,this.spatialReference);if(!l)return null;h=l.x;b=l.y}l=g}g=c.resolution*this.size[0];c=c.resolution*this.size[1];l||(l={id:null,level:0,row:0,col:0,extent:f.create()});l.level=a;l.row=Math.floor((this.origin.y-b)/c+.001);l.col=Math.floor((h-this.origin.x)/g+.001);this.updateTileInfo(l);return l};b.prototype.updateTileInfo=function(a){var d=this.lodAt(a.level);if(d){var b=d.resolution*this.size[0],
d=d.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=f.create());a.extent[0]=this.origin.x+a.col*b;a.extent[1]=this.origin.y-(a.row+1)*d;a.extent[2]=a.extent[0]+b;a.extent[3]=a.extent[1]+d}};b.prototype.upsampleTile=function(a){var d=this._upsampleLevels[a.level];if(!d||-1===d.parentLevel)return!1;a.level=d.parentLevel;a.row=Math.floor(a.row/d.factor+.001);a.col=Math.floor(a.col/d.factor+.001);this.updateTileInfo(a);return!0};b.prototype.getTileBounds=function(a,d){var b=
this.lodAt(d.level).resolution,f=b*this.size[0],b=b*this.size[1];a[0]=this.origin.x+d.col*f;a[1]=this.origin.y-(d.row+1)*b;a[2]=a[0]+f;a[3]=a[1]+b;return a};b.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null};b.prototype.clone=function(){return e.fromJSON(this.write({}))};b.prototype._initializeUpsampleLevels=function(){var a=this.lods;this._upsampleLevels=[];for(var d=null,b=0;b<a.length;b++){var f=a[b];this._upsampleLevels[f.level]={parentLevel:d?d.level:-1,factor:d?
d.resolution/f.resolution:0};d=f}};var e;c.__decorate([m.property({type:Number,json:{write:!0}})],b.prototype,"compressionQuality",void 0);c.__decorate([m.property({type:Number,json:{write:!0}})],b.prototype,"dpi",void 0);c.__decorate([m.property({type:String,json:{read:t.read,write:t.write,origins:{"web-scene":{read:!1,write:!1}}}})],b.prototype,"format",void 0);c.__decorate([m.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],b.prototype,"isWrappable",null);c.__decorate([m.property({type:h.Point,
json:{write:!0}})],b.prototype,"origin",void 0);c.__decorate([m.reader("origin")],b.prototype,"readOrigin",null);c.__decorate([m.property({type:[q],value:null,json:{write:!0}})],b.prototype,"lods",null);c.__decorate([m.property({readOnly:!0})],b.prototype,"minScale",void 0);c.__decorate([m.property({readOnly:!0})],b.prototype,"maxScale",void 0);c.__decorate([m.property({readOnly:!0})],b.prototype,"scales",void 0);c.__decorate([m.property({cast:function(a){return Array.isArray(a)?a:"number"===typeof a?
[a,a]:[256,256]}})],b.prototype,"size",void 0);c.__decorate([m.reader("size",["rows","cols"])],b.prototype,"readSize",null);c.__decorate([m.writer("size",{cols:{type:l.Integer},rows:{type:l.Integer}})],b.prototype,"writeSize",null);c.__decorate([m.property({type:h.SpatialReference,json:{write:!0}})],b.prototype,"spatialReference",void 0);return b=e=c.__decorate([m.subclass("esri.layers.support.TileInfo")],b)}(a.JSONSupport)})},"esri/layers/support/LOD":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(n,e,c,h,b,a){return function(g){function h(a){a=g.call(this,a)||this;a.level=0;a.levelValue=null;a.resolution=0;a.scale=0;return a}c.__extends(h,g);l=h;h.prototype.clone=function(){return new l({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var l;c.__decorate([b.property({type:a.Integer,json:{write:!0}})],h.prototype,"level",void 0);c.__decorate([b.property({type:String,json:{write:!0}})],h.prototype,"levelValue",void 0);c.__decorate([b.property({type:Number,
json:{write:!0}})],h.prototype,"resolution",void 0);c.__decorate([b.property({type:Number,json:{write:!0}})],h.prototype,"scale",void 0);return h=l=c.__decorate([b.subclass("esri.layers.support.LOD")],h)}(h.JSONSupport)})},"esri/layers/support/TilemapCache":function(){define("require exports tslib ../../request ../../core/Accessor ../../core/Error ../../core/Handles ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/scheduling ../../core/urlUtils ../../core/watchUtils ../../core/accessorSupport/decorators ./Tilemap".split(" "),
function(n,e,c,h,b,a,g,m,l,f,d,k,q,t,p,r){Object.defineProperty(e,"__esModule",{value:!0});var u=m.getLogger("esri.layers.support.TilemapCache");n=function(b){function m(a){a=b.call(this,a)||this;a._handles=new g;a._pendingTilemapRequests={};a._availableLevels={};a.levels=5;a.cacheByteSize=2097152;a.request=h;a._prefetchingEnabled=!0;return a}c.__extends(m,b);e=m;m.prototype.initialize=function(){var a=this;this._tilemapCache=new l(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl",
"layer.tileServers?"],function(){return a._initializeTilemapDefinition()}),t.init(this,"layer.tileInfo.lods",function(d){return a._initializeAvailableLevels(d)},!0)]);this._initializeTilemapDefinition()};m.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};m.prototype.castLevels=function(a){return 2>=a?(u.error("Minimum levels for Tilemap is 3, but got ",a),3):a};Object.defineProperty(m.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0});
m.prototype.fetchTilemap=function(b,f,g,l){var k=this;if(!this._availableLevels[b])return d.reject(new a("tilemap-cache:level-unavailable","Level "+b+" is unavailable in the service"));var m=this._tmpTilemapDefinition;if(b=this._tilemapFromCache(b,f,g,m))return d.resolve(b);var h=l&&l.signal;l=c.__assign(c.__assign({},l),{signal:null});return d.create(function(a,b){d.onAbort(h,function(){return b(d.createAbortError())});var f=r.tilemapDefinitionId(m),g=k._pendingTilemapRequests[f];if(!g){var g=r.Tilemap.fromDefinition(m,
l).then(function(a){k._tilemapCache.put(f,a,a.byteSize);return a}),c=function(){return delete k._pendingTilemapRequests[f]};k._pendingTilemapRequests[f]=g;g.then(c,c)}g.then(a,b)})};m.prototype.getAvailability=function(a,d,b){return this._availableLevels[a]?(a=this._tilemapFromCache(a,d,b,this._tmpTilemapDefinition))?a.getAvailability(d,b):"unknown":"unavailable"};m.prototype.getAvailabilityUpsample=function(a,d,b,f){f.level=a;f.row=d;f.col=b;a=this.layer.tileInfo;for(a.updateTileInfo(f);;)if(d=this.getAvailability(f.level,
f.row,f.col),"unavailable"===d){if(!a.upsampleTile(f))return"unavailable"}else return d};m.prototype.fetchAvailability=function(b,f,g,l){return this._availableLevels[b]?this.fetchTilemap(b,f,g,l).catch(function(a){return a}).then(function(l){if(l instanceof r.Tilemap)return l=l.getAvailability(f,g),"unavailable"===l?d.reject(new a("tile-map:tile-unavailable","Tile is not available",{level:b,row:f,col:g})):l;if(d.isAbortError(l))throw l;return"unknown"}):d.reject(new a("tilemap-cache:level-unavailable",
"Level "+b+" is unavailable in the service"))};m.prototype.fetchAvailabilityUpsample=function(a,b,f,g,l){var k=this;g.level=a;g.row=b;g.col=f;var c=this.layer.tileInfo;c.updateTileInfo(g);var m=this.fetchAvailability(a,b,f,l).catch(function(a){if(d.isAbortError(a))throw a;if(c.upsampleTile(g))return k.fetchAvailabilityUpsample(g.level,g.row,g.col,g);throw a;});this._fetchAvailabilityUpsamplePrefetch(g.id,a,b,f,l,m);return m};m.prototype._fetchAvailabilityUpsamplePrefetch=function(a,b,f,g,l,m){return c.__awaiter(this,
void 0,void 0,function(){var h,q,p,z,r,u,v,t,n,w;return c.__generator(this,function(x){switch(x.label){case 0:if(!this._prefetchingEnabled)return[2];h="prefetch-"+a;if(this._handles.has(h))return[2];q=d.createAbortController();m.then(function(){return q.abort()},function(){return q.abort()});p=!1;z={remove:function(){p||(p=!0,q.abort())}};this._handles.add(z,h);x.label=1;case 1:return x.trys.push([1,3,,4]),[4,k.waitTicks(10,q.signal)];case 2:return x.sent(),[3,4];case 3:return x.sent(),[3,4];case 4:p||
(p=!0,this._handles.remove(h));if(d.isAborted(q))return[2];r={id:a,level:b,row:f,col:g};u=c.__assign(c.__assign({},l),{signal:q.signal});v=this.layer.tileInfo;t=function(a){var d=n.fetchAvailability(r.level,r.row,r.col,u);e._prefetches.push(d);a=function(){e._prefetches.removeUnordered(d)};d.then(a,a)};n=this;for(w=0;e._prefetches.length<e._maxPrefetch&&v.upsampleTile(r);++w)t(w);return[2]}})})};m.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var a=this.layer.parsedUrl,
d=a.query;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:a.path,query:d?q.objectToQuery(d):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};m.prototype._tilemapFromCache=function(a,d,b,f){f.level=a;f.row=d-d%this.size;f.col=b-b%this.size;a=r.tilemapDefinitionId(f);return this._tilemapCache.get(a)};m.prototype._initializeAvailableLevels=function(a){var d=this;this._availableLevels={};a&&a.forEach(function(a){return d._availableLevels[a.level]=
!0})};Object.defineProperty(m.prototype,"test",{get:function(){var a=this;return{get prefetchingEnabled(){return a._prefetchingEnabled},set prefetchingEnabled(d){a._prefetchingEnabled=d},hasTilemap:function(d,b,f){return!!a._tilemapFromCache(d,b,f,a._tmpTilemapDefinition)}}},enumerable:!0,configurable:!0});var e;m._maxPrefetch=4;m._prefetches=new f({initialSize:e._maxPrefetch});c.__decorate([p.property({constructOnly:!0,type:Number})],m.prototype,"levels",void 0);c.__decorate([p.cast("levels")],m.prototype,
"castLevels",null);c.__decorate([p.property({readOnly:!0,dependsOn:["levels"],type:Number})],m.prototype,"size",null);c.__decorate([p.property({constructOnly:!0,type:Number})],m.prototype,"cacheByteSize",void 0);c.__decorate([p.property({constructOnly:!0})],m.prototype,"layer",void 0);c.__decorate([p.property({constructOnly:!0})],m.prototype,"request",void 0);return m=e=c.__decorate([p.subclass("esri.layers.support.TilemapCache")],m)}(b);e.TilemapCache=n})},"esri/layers/support/Tilemap":function(){define("require exports tslib ../../request ../../core/arrayUtils ../../core/Error ../../core/lang".split(" "),
function(n,e,c,h,b,a,g){function m(a){var b;"vector-tile"===a.service.type?b=a.service.url+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height:(b=a.service.tileServers,b=(b&&b.length?b[a.row%b.length]:a.service.url)+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height);(a=a.service.query)&&(b=b+"?"+a);return b}Object.defineProperty(e,"__esModule",{value:!0});n=function(){function l(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=
40}l.prototype.getAvailability=function(a,d){if("unknown"!==this._allAvailability)return this._allAvailability;a=(a-this.location.top)*this.location.width+(d-this.location.left);d=a>>3;var b=this._tileAvailabilityBitSet;return 0>d||d>b.length?"unknown":b[d]&1<<a%8?"available":"unavailable"};l.prototype._updateFromData=function(a){for(var d=!0,b=!0,f=new Uint8Array(Math.ceil(this.location.width*this.location.height/8)),g=0,l=0;l<a.length;l++){var c=l%8;a[l]?(b=!1,f[g]|=1<<c):d=!1;7===c&&++g}b?this._allAvailability=
"unavailable":d?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=f,this.byteSize+=f.length)};l.fromDefinition=function(f,d){var g=f.service.request||h,e=f.row,n=f.col,p=f.width,r=f.height,u={query:{f:"json"}};d=d?c.__assign(c.__assign({},u),d):u;return g(m(f),d).then(function(a){return a.data}).catch(function(a){if(a&&a.details&&422===a.details.httpStatus)return{location:{top:e,left:n,width:p,height:r},valid:!0,data:b.constant(p*r,0)};throw a;}).then(function(d){if(d.location&&
(d.location.top!==e||d.location.left!==n||d.location.width!==p||d.location.height!==r))throw new a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:d,definition:{top:e,left:n,width:p,height:r}});return l.fromJSON(d)})};l.fromJSON=function(a){l.validateJSON(a);var d=new l;d.location=Object.freeze(g.clone(a.location));d._updateFromData(a.data);return Object.freeze(d)};l.validateJSON=function(b){if(!b||!b.location)throw new a("tilemap:missing-location","Location missing from tilemap response");
if(!1===b.valid)throw new a("tilemap:invalid","Tilemap response was marked as invalid");if(!b.data)throw new a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(b.data))throw new a("tilemap:data-mismatch","Data must be an array of numbers");if(b.data.length!==b.location.width*b.location.height)throw new a("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return l}();e.Tilemap=n;e.tilemapDefinitionId=function(a){return a.level+"/"+
a.row+"/"+a.col+"/"+a.width+"/"+a.height};e.tilemapDefinitionUrl=m;e.default=n})},"esri/layers/support/SpriteSource":function(){define("require exports tslib ../../request ../../core/Error ../../core/has ../../core/Logger ../../core/promiseUtils".split(" "),function(n,e,c,h,b,a,g,m){Object.defineProperty(e,"__esModule",{value:!0});var l=g.getLogger("esri.layers.support.SpriteSource");n=function(){function g(a,b){this.baseURL=a;this.devicePixelRatio=b;this._isRetina=!1;this._spritesData={};this.height=
this.width=this.image=null;this.loadStatus="not-loaded"}Object.defineProperty(g.prototype,"spriteNames",{get:function(){var a=[],b;for(b in this._spritesData)a.push(b);a.sort();return a},enumerable:!0,configurable:!0});g.prototype.getSpriteInfo=function(a){return this._spritesData[a]};g.prototype.load=function(a){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(d){switch(d.label){case 0:m.throwIfAborted(a);this.loadStatus="loading";if(!this.baseURL)return[2,m.resolve(this)];
d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._loadSprites(a)];case 2:return d.sent(),this.loadStatus="loaded",[3,4];case 3:return d.sent(),this.loadStatus="failed",[3,4];case 4:return[2,this]}})})};g.prototype._loadSprites=function(d){var g=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var f=this.baseURL,e=this._isRetina?"@2x":"",p=""+f+e+".png";return m.all([h(f+e+".json",d),h(p,c.__assign({responseType:"image"},d))]).then(function(d){var c=d[0];d=d[1];var k=Object.keys(c.data);if(!k||
0===k.length||1===k.length&&"_ssl"===k[0]||!d||!d.data)return g._spritesData=g.image=null,g.width=g.height=0,m.resolve(null);g._spritesData=c.data;c=d.data;d=Math.max(a("esri-webgl-max-texture-size"),4096);if(c.width>d||c.height>d)throw c="Sprite resource for style "+f+" is bigger than the maximum allowed of "+d+" pixels}",l.error(c),new b("SpriteSource",c);g.width=c.width;g.height=c.height;d=document.createElement("canvas");k=d.getContext("2d");d.width=c.width;d.height=c.height;k.drawImage(c,0,0,
c.width,c.height);c=k.getImageData(0,0,c.width,c.height);c=new Uint8Array(c.data);for(k=0;k<c.length;k+=4)d=c[k+3]/255,c[k]*=d,c[k+1]*=d,c[k+2]*=d;g.image=c})};return g}();e.default=n})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports tslib ../../config ../../request ../../core/promiseUtils ../../core/urlUtils ../../views/2d/engine/vectorTiles/style/VectorTileSource".split(" "),function(n,e,c,h,b,a,g,m){function l(a){a&&(a=g.getOrigin(a),t&&-1===t.indexOf(a)&&t.push(a))}
function f(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];for(var d=void 0,b=0;b<a.length;++b)g.isProtocolRelative(a[b])?d&&(d=d.split("://")[0]+":"+a[b].trim()):d=g.isAbsolute(a[b])?a[b]:g.join(d,a[b]);return g.removeTrailingSlash(d)}function d(d,f,m,h,e){return c.__awaiter(this,void 0,void 0,function(){var p,n,r,t,u,v;return c.__generator(this,function(w){switch(w.label){case 0:a.throwIfAborted(e);if("string"!==typeof m)return[3,2];t=g.normalize(m);l(t);u=g.urlToObject(t);return[4,
b(u.path,c.__assign({query:{f:"json"},responseType:"json"},e))];case 1:return r=w.sent(),n=p=t,[3,3];case 2:r={data:m},p=m.jsonUrl||null,n=h,w.label=3;case 3:return v=r.data,r.ssl&&(p&&(p=p.replace(/^http:/i,"https:")),n&&(n=n.replace(/^http:/i,"https:"))),v.sources?(d.styleUrl=p||null,[2,k(d,v,n,e)]):v.sources?[2,a.reject("You must specify the URL or the JSON for a service or for a style.")]:d.sourceUrl?[2,q(d,v,n,!1,f,e)]:(d.sourceUrl=p||null,[2,q(d,v,n,!0,f,e)])}})})}function k(b,k,m,h){return c.__awaiter(this,
void 0,void 0,function(){var e,q,p,n,r,t;return c.__generator(this,function(c){switch(c.label){case 0:e=m?g.removeFile(m):g.appBaseUrl;b.styleBase=e;b.style=k;b.styleUrl&&l(b.styleUrl);q=[];if(!k.sources||!k.sources.esri)return[3,3];p=k.sources.esri;return p.url?[4,d(b,"esri",f(e,p.url),void 0,h)]:[3,2];case 1:return c.sent(),[3,3];case 2:q.push(d(b,"esri",p,e,h)),c.label=3;case 3:n=0;for(r=Object.keys(k.sources);n<r.length;n++)t=r[n],"esri"!==t&&"vector"===k.sources[t].type&&(k.sources[t].url?q.push(d(b,
t,f(e,k.sources[t].url),void 0,h)):q.push(d(b,t,k.sources[t],e,h)));return[4,a.all(q)];case 4:return c.sent(),[2]}})})}function q(b,k,h,e,q,n){return c.__awaiter(this,void 0,void 0,function(){var p,t,r,u;return c.__generator(this,function(c){p=h?g.removeTrailingSlash(h)+"/":g.appBaseUrl;c=p;if(k.hasOwnProperty("tileInfo"))t=k;else{for(var v={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},w=78271.51696400007,
y=2.958287637957775E8,x=[],z=k.hasOwnProperty("minzoom")?parseFloat(k.minzoom):0,J=k.hasOwnProperty("maxzoom")?parseFloat(k.maxzoom):22,A=0;A<=J;A++)A>=z&&x.push({level:A,scale:y,resolution:w}),w/=2,y/=2;w=0;for(y=k.tiles;w<y.length;w++)l(f(c,y[w]));t={capabilities:"TilesOnly",initialExtent:v,fullExtent:v,minScale:0,maxScale:0,tiles:k.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:x,spatialReference:{wkid:102100}}}}r=new m(q,p,t);if(!e&&
b.primarySourceName in b.sourceNameToSource){u=b.sourceNameToSource[b.primarySourceName];if(!u.isCompatibleWith(r))return[2,a.resolve()];null!=r.fullExtent&&(null!=u.fullExtent?u.fullExtent.union(r.fullExtent):u.fullExtent=r.fullExtent.clone());u.tileInfo.lods.length<r.tileInfo.lods.length&&(u.tileInfo=r.tileInfo)}e?(b.sourceBase=p,b.source=k,b.validatedSource=t,b.primarySourceName=q,b.sourceUrl&&l(b.sourceUrl)):l(p);b.sourceNameToSource[q]=r;return b.style?[2]:null==k.defaultStyles?[2,a.reject()]:
"string"===typeof k.defaultStyles?[2,d(b,"",f(p,k.defaultStyles,"root.json"),void 0,n)]:[2,d(b,"",k.defaultStyles,f(p,"root.json"),n)]})})}Object.defineProperty(e,"__esModule",{value:!0});var t=h.defaults&&h.defaults.io.corsEnabledServers;e.loadMetadata=function(a,b){return c.__awaiter(this,void 0,void 0,function(){var k,m,h,e,q,n;return c.__generator(this,function(c){switch(c.label){case 0:return k={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,
sourceNameToSource:{},primarySourceName:""},m="string"===typeof a?[a,null]:[null,a.jsonUrl],h=m[0],e=m[1],q=h?g.urlToObject(h):null,[4,d(k,"esri",a,e,b)];case 1:return c.sent(),n={layerDefinition:k.validatedSource,url:h,parsedUrl:q,serviceUrl:k.sourceUrl,style:k.style,styleUrl:k.styleUrl,spriteUrl:k.style.sprite&&f(k.styleBase,k.style.sprite),glyphsUrl:k.style.glyphs&&f(k.styleBase,k.style.glyphs),sourceNameToSource:k.sourceNameToSource,primarySourceName:k.primarySourceName},l(n.spriteUrl),l(n.glyphsUrl),
[2,n]}})})}})},"esri/views/2d/engine/vectorTiles/style/VectorTileSource":function(){define("require exports tslib ../../../../../core/lang ../../../../../core/urlUtils ../../../../../geometry/Extent ../../../../../layers/support/serviceTileInfoProperty ../../../../../layers/support/TilemapCache ../TileIndex".split(" "),function(n,e,c,h,b,a,g,m,l){return function(){function f(d,f,c){this.tileMapURL="";this.fullExtent=this.tileIndex=this.capabilities=this.tileInfo=this.parsedUrl=this.tilemapCache=null;
this.name=d;if(this.sourceUrl=f)this.parsedUrl=b.urlToObject(this.sourceUrl);d=h.clone(c);var k=d.tiles;f&&k.forEach(function(a,d){b.isAbsolute(a)||(k[d]=b.join(f,a))});this.tileServers=k;c.tileMap&&(this.tileMapURL=b.join(f,c.tileMap));var e=c.capabilities&&c.capabilities.split(",").map(function(a){return a.toLowerCase().trim()}),q=!!c.exportTilesAllowed,e=!!e&&-1!==e.indexOf("tilemap"),n=q&&c.hasOwnProperty("maxExportTilesCount")?c.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:q,
supportsTileMap:e},exportTiles:q?{maxExportTilesCount:+n}:null};this.tileInfo=g.readServiceTileInfo(d.tileInfo,d,null,{ignoreMinMaxLOD:!0});e&&(this.type="vector-tile",this.tilemapCache=new m.TilemapCache({layer:this}),this.tileIndex=new l(this.tilemapCache));this.fullExtent=a.fromJSON(c.fullExtent)}f.prototype.getRefKey=function(a,b){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(d){return this.tileIndex?[2,this.tileIndex.dataKey(a,b)]:[2,a]})})};f.prototype.getSourceTileUrl=
function(a,b,g){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,b.toString()).replace(/\{x\}/gi,g.toString())};f.prototype.isCompatibleWith=function(a){var d=this.tileInfo;a=a.tileInfo;if(!d.spatialReference.equals(a.spatialReference)||!d.origin.equals(a.origin)||Math.round(d.dpi)!==Math.round(a.dpi))return!1;d=d.lods;a=a.lods;for(var b=Math.min(d.length,a.length),g=0;g<b;g++){var f=d[g],c=a[g];if(f.level!==c.level||Math.round(f.scale)!==
Math.round(c.scale))return!1}return!0};return f}()})},"esri/views/2d/engine/vectorTiles/TileIndex":function(){define(["require","exports","../../../../core/promiseUtils","../../../../layers/support/TilemapCache","../../tiling/TileKey"],function(n,e,c,h,b){return function(){function a(a){if(a instanceof h.TilemapCache)this._tilemapCache=a;else if(a&&"index"in a)this._tilemap=a.index;else throw Error("Invalid tilemap!");}a.prototype.dataKey=function(a,h){if(this._tilemapCache){var g=a.level,f=a.row,
d=a.col,k=new b(a);return this._tilemapCache.fetchAvailabilityUpsample(g,f,d,k,h).then(function(){return k}).catch(function(a){if(c.isAbortError(a))throw a;return null})}return this._getIndexedDataKey(a)};a.prototype.forEach=function(a,b,c,f,d){this._callback=d;this._maxLevel=b+a;this._forEach(this._tilemap,b,c,f)};a.prototype._forEach=function(a,b,c,f){0!==a&&(this._callback(b,c,f),b!==this._maxLevel&&"object"===typeof a&&(this._forEach(a[0],b+1,2*c,2*f),this._forEach(a[1],b+1,2*c,2*f+1),this._forEach(a[2],
b+1,2*c+1,2*f),this._forEach(a[3],b+1,2*c+1,2*f+1)))};a.prototype._getIndexedDataKey=function(a){var g=[a];if(0>a.level||0>a.row||0>a.col||0<a.row>>a.level||0<a.col>>a.level)return c.resolve(null);for(;0!==a.level;)a=new b(a.level-1,a.row>>1,a.col>>1,a.world),g.push(a);a=this._tilemap;var l=g.pop(),f,d;if(1===a)return c.resolve(l);for(;g.length;)if(f=g.pop(),d=(f.col&1)+((f.row&1)<<1),a){if(0===a[d]){l=null;break}if(1===a[d]){l=f;break}l=f;a=a[d]}return c.resolve(l)};return a}()})},"esri/views/2d/tiling/TileKey":function(){define(["require",
"exports","../../../core/ObjectPool"],function(n,e,c){return function(){function h(b,a,c,h){this.set(b,a,c,h)}h.getId=function(b,a,c,h){return"object"===typeof b?b.level+"/"+b.row+"/"+b.col+"/"+b.world:b+"/"+a+"/"+c+"/"+h};Object.defineProperty(h.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});h.prototype.acquire=function(b,a,c,h){this.set(b,a,c,h)};h.prototype.equals=
function(b){return this.level===b.level&&this.row===b.row&&this.col===b.col&&this.world===b.world};h.prototype.release=function(){this.world=this.col=this.row=this.level=0};h.prototype.set=function(b,a,c,h){null==b?this.world=this.col=this.row=this.level=0:"object"===typeof b?(this.level=b.level||0,this.row=b.row||0,this.col=b.col||0,this.world=b.world||0):"string"===typeof b?(b=b.split("/"),a=b[1],c=b[2],h=b[3],this.level=parseFloat(b[0]),this.row=parseFloat(a),this.col=parseFloat(c),this.world=
parseFloat(h)):(this.level=+b,this.row=+a,this.col=+c,this.world=+h||0);return this};h.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};h.prototype.getChildKeys=function(){var b=this.level+1,a=this.row<<1,c=this.col<<1,e=this.world;return[new h(b,a,c,e),new h(b,a,c+1,e),new h(b,a+1,c,e),new h(b,a+1,c+1,e)]};h.prototype.compareRowMajor=function(b){return this.row<b.row?-1:this.row>b.row?1:this.col<b.col?-1:this.col>b.col?1:0};h.pool=new c(h,null,null,25,50);
return h}()})},"esri/portal/support/jsonContext":function(){define(["require","exports","../../core/urlUtils","../Portal"],function(n,e,c,h){Object.defineProperty(e,"__esModule",{value:!0});e.createForItem=function(b){return{origin:"portal-item",url:c.urlToObject(b.itemUrl),portal:b.portal||h.getDefault(),portalItem:b,readResourcePaths:[]}}})},"esri/views/2d/engine/vectorTiles/SchemaHelper":function(){define(["require","exports","../../../../layers/support/LOD","../../../../layers/support/TileInfo"],
function(n,e,c,h){return function(){function b(a,b){this.lockedSchemaPixelSize=a;this.isGCS=b}b.prototype.getLevelRowColumn=function(a){return this.isGCS?[a[0],a[1]>>1,a[2]>>1]:256===this.lockedSchemaPixelSize&&0<a[0]?[a[0]-1,a[1]>>1,a[2]>>1]:a};b.prototype.adjustLevel=function(a){return this.isGCS?a:256===this.lockedSchemaPixelSize?0<a?a-1:0:a};b.prototype.getShift=function(a,b){var c=0,g=0;if(256===this.lockedSchemaPixelSize||this.isGCS)a[2]%2&&(c=b),a[1]%2&&(g=b);return[c,g]};b.prototype.getScale=
function(a){if(this.isGCS){if(512===this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===a)return 1;return 2};b.create256x256CompatibleTileInfo=function(a){if(!a)return null;if(256===a.size[0]&&256===a.size[1])return a;for(var b=a.spatialReference.isGeographic,e=[],l=a.lods.length,f=0;f<l;f++){var d=a.lods[f];e.push(new c({level:d.level,scale:d.scale,resolution:b?d.resolution:2*d.resolution}))}return new h({size:[256,256],dpi:a.dpi,format:a.format,compressionQuality:a.compressionQuality,
origin:a.origin,spatialReference:a.spatialReference,lods:e})};b.create512x512CompatibleTileInfo=function(a){if(!a||256===a.size[0]||256===a.size[1])return null;for(var b=[],e=a.lods.length,l=0;l<e;l++){var f=a.lods[l];b.push(new c({level:f.level,scale:f.scale,resolution:.5*f.resolution}))}return new h({size:[512,512],dpi:a.dpi,format:a.format,compressionQuality:a.compressionQuality,origin:a.origin,spatialReference:a.spatialReference,lods:b})};return b}()})},"esri/views/2d/engine/vectorTiles/tileInfoUtils":function(){define(["require",
"exports","../../../../layers/support/TileInfo"],function(n,e,c){Object.defineProperty(e,"__esModule",{value:!0});e.areSchemasOverlapping=function(c,b){if(c===b)return!0;if(!c&&null!=b||null!=c&&!b||!c.spatialReference.equals(b.spatialReference)||c.dpi!==b.dpi)return!1;var a=c.origin,g=b.origin;if(1E-6<=Math.abs(a.x-g.x)||1E-6<=Math.abs(a.y-g.y))return!1;c.lods[0].scale>b.lods[0].scale?(a=c,c=b):a=b;for(b=a.lods[0].scale;b>=c.lods[c.lods.length-1].scale-1E-6;b/=2)if(1E-6>Math.abs(b-c.lods[0].scale))return!0;
return!1};e.unionTileInfos=function(h,b){if(h===b)return h;if(!h&&null!=b)return b;if(null!=h&&!b)return h;var a=h.size[0],g=h.format,e=h.dpi,l={x:h.origin.x,y:h.origin.y},f=h.spatialReference.toJSON(),d=h.lods[0].scale>b.lods[0].scale?h.lods[0]:b.lods[0];h=(h.lods[h.lods.length-1].scale<=b.lods[b.lods.length-1].scale?h.lods[h.lods.length-1]:b.lods[b.lods.length-1]).scale;b=[];for(var k=d.scale,d=d.resolution,q=0;k>h;)b.push({level:q,resolution:d,scale:k}),q++,k/=2,d/=2;return new c({size:[a,a],dpi:e,
format:g||"pbf",origin:l,lods:b,spatialReference:f})}})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["require","exports","../../../../../core/has","./StyleLayer"],function(n,e,c,h){return function(){function b(a,c){this.backgroundBucketIds=[];this._layerByName={};this.styleJSON=a;this.version=parseFloat(a.version);this.sprite=c?c.spriteUrl:a.sprite;this.glyphs=c?c.glyphsUrl:a.glyphs;if(this.layers=(a.layers||[]).map(b._create))for(a=void 0,c=0;c<this.layers.length;c++)a=
this.layers[c],this._layerByName[a.id.toLowerCase()]=a,0===a.type&&this.backgroundBucketIds.push(c);this._identifyRefLayers()}b.prototype.isPainterDataDriven=function(a){return(a=this._layerByName[a.toLowerCase()])?a.isPainterDataDriven():!1};b.prototype.getStyleLayerId=function(a){return a>=this.layers.length?null:this.layers[a].id};b.prototype.getLayoutProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.layout:null};b.prototype.getPaintProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?
a.paint:null};b.prototype.setPaintProperties=function(a,c){a=this._layerByName[a.toLowerCase()];if(!a)return"";var g=this.layers.indexOf(a);this.styleJSON.layers[g].paint=c;c=b._recreateLayer({id:a.id,type:a.typeName,source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:c},a);this.layers[g]=c;this._layerByName[a.id.toLowerCase()]=c;return a.id};b.prototype.setLayoutProperties=function(a,c){a=this._layerByName[a.toLowerCase()];if(!a)return"";
var g=this.layers.indexOf(a);this.styleJSON.layers[g].layout=c;c=b._recreateLayer({id:a.id,type:a.typeName,source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:c,paint:a.paint},a);this.layers[g]=c;this._layerByName[a.id.toLowerCase()]=c;return a.id};b.prototype._identifyRefLayers=function(){for(var a=[],b=[],c=0,l=0,f=this.layers;l<f.length;l++){var d=f[l];if(1===d.type){var k=d,e=d.source+"|"+d.sourceLayer,e=e+("|"+JSON.stringify(d.layout&&d.layout.visibility)),
e=e+("|"+JSON.stringify(d.minzoom)),e=e+("|"+JSON.stringify(d.maxzoom)),e=e+("|"+JSON.stringify(d.filter));if(k.hasDataDrivenFill||k.hasDataDrivenOutline)e+="|"+JSON.stringify(c);a.push({key:e,layer:d})}2===d.type&&(k=d,e=d.source+"|"+d.sourceLayer,e+="|"+JSON.stringify(d.layout&&d.layout.visibility),e+="|"+JSON.stringify(d.minzoom),e+="|"+JSON.stringify(d.maxzoom),e+="|"+JSON.stringify(d.filter),e+="|"+JSON.stringify(d.layout&&d.layout["line-cap"]),e+="|"+JSON.stringify(d.layout&&d.layout["line-join"]),
k.hasDataDrivenLine&&(e+="|"+JSON.stringify(c)),b.push({key:e,layer:d}));++c}this._assignRefLayers(a);this._assignRefLayers(b)};b.prototype._assignRefLayers=function(a){a.sort(function(a,d){return a.key<d.key?-1:a.key>d.key?1:0});for(var b,c,e=a.length,f=0;f<e;f++){var d=a[f];if(d.key===b)d.layer.refLayerId=c;else if(b=d.key,c=d.layer.id,1===d.layer.type&&!d.layer.getPaintProperty("fill-outline-color"))for(var k=f+1;k<e;k++){var h=a[k];if(h.key===b){if(h.layer.getPaintProperty("fill-outline-color")){a[f]=
h;a[k]=d;c=h.layer.id;break}}else break}}};b._create=function(a,b,c){b=1-1/(c.length+1)*(1+b);switch(a.type){case "background":return new h.BackgroundStyleLayer(0,a,b);case "fill":return new h.FillStyleLayer(1,a,b);case "line":return new h.LineStyleLayer(2,a,b);case "symbol":return new h.SymbolStyleLayer(3,a,b);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new h.CircleStyleLayer(4,a,b)}throw Error("Unknown vector tile layer");};b._recreateLayer=function(a,
b){switch(a.type){case "background":return new h.BackgroundStyleLayer(0,a,b.z);case "fill":return new h.FillStyleLayer(1,a,b.z);case "line":return new h.LineStyleLayer(2,a,b.z);case "symbol":return new h.SymbolStyleLayer(3,a,b.z);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new h.CircleStyleLayer(4,a,b.z)}};return b}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("require exports tslib ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),
function(n,e,c,h,b,a,g){Object.defineProperty(e,"__esModule",{value:!0});n=function(){function c(a,d,c){this.type=a;this.typeName=d.type;this.id=d.id;this.source=d.source;this.sourceLayer=d["source-layer"];this.minzoom=d.minzoom;this.maxzoom=d.maxzoom;this.filter=d.filter;this.layout=d.layout;this.paint=d.paint;this.z=c;switch(a){case 0:this._layoutDefinition=b.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=b.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=
b.StyleDefinition.fillLayoutDefinition;this._paintDefinition=b.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=b.StyleDefinition.lineLayoutDefinition;this._paintDefinition=b.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=b.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=b.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=b.StyleDefinition.circleLayoutDefinition,this._paintDefinition=b.StyleDefinition.circlePaintDefinition}this._layoutProperties=
this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}c.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=h.createFilter(this.filter)};c.prototype.getLayoutProperty=function(a){var d=this._layoutProperties;if(d)return d[a]};c.prototype.getPaintProperty=function(a){var d=this._paintProperties;if(d)return d[a]};c.prototype.getLayoutValue=function(a,d,b){var c,f=this._layoutProperties;f&&(f=f[a])&&(c=f.getValue(d,
b));var k=this._layoutDefinition[a];void 0===c&&(c=k["default"]);"enum"===k.type?c=k.values.indexOf(c):"array"===k.type&&"enum"===k.value&&(c=c.map(function(a){return k.values.indexOf(a)}));return c};c.prototype.getPaintValue=function(a,d,b){var c,f=this._paintProperties;f&&(f=f[a])&&(c=f.getValue(d,b));a=this._paintDefinition[a];void 0===c&&(c=a["default"]);"enum"===a.type&&(c=a.values.indexOf(c));return c};c.prototype.isPainterDataDriven=function(){var a=this._paintProperties;if(a)for(var d in a)if(a[d].isDataDriven)return!0;
return!1};c.prototype._parseLayout=function(b){var d={},c;for(c in b){var f=this._layoutDefinition[c];f&&(d[c]=new a(f,b[c]))}return d};c.prototype._parsePaint=function(b){var d={},c;for(c in b){var f=this._paintDefinition[c];f&&(d[c]=new a(f,b[c]))}return d};return c}();e.StyleLayer=n;var m=function(a){function b(b,c,f){return a.call(this,b,c,f)||this}c.__extends(b,a);return b}(n);e.BackgroundStyleLayer=m;m=function(a){function b(b,c,f){b=a.call(this,b,c,f)||this;c=b.getPaintProperty("fill-color");
b.hasDataDrivenColor=c?c.isDataDriven:!1;c=b.getPaintProperty("fill-opacity");b.hasDataDrivenOpacity=c?c.isDataDriven:!1;b.hasDataDrivenFill=b.hasDataDrivenColor||b.hasDataDrivenOpacity;c=b.getPaintProperty("fill-outline-color");b.outlineUsesFillColor=!c;b.hasDataDrivenOutlineColor=c?c.isDataDriven:!1;b.hasDataDrivenOutline=(c?b.hasDataDrivenOutlineColor:b.hasDataDrivenColor)||b.hasDataDrivenOpacity;return b}c.__extends(b,a);return b}(n);e.FillStyleLayer=m;m=function(a){function f(d,c,f){d=a.call(this,
d,c,f)||this;f=d.getPaintProperty("line-color");d.hasDataDrivenColor=f?f.isDataDriven:!1;f=d.getPaintProperty("line-opacity");d.hasDataDrivenOpacity=f?f.isDataDriven:!1;f=d.getPaintProperty("line-width");d.hasDataDrivenWidth=f?f.isDataDriven:!1;d.hasDataDrivenLine=d.hasDataDrivenColor||d.hasDataDrivenOpacity||d.hasDataDrivenWidth;c=c.paint["line-width"];c||(c=b.StyleDefinition.linePaintDefinition["line-width"].default);d.isThinLine=!d.hasDataDrivenWidth&&"number"===typeof c&&c<g.THIN_LINE_THRESHOLD;
return d}c.__extends(f,a);return f}(n);e.LineStyleLayer=m;m=function(a){function b(b,c,f){b=a.call(this,b,c,f)||this;c=b.getPaintProperty("icon-color");b.hasDataDrivenIconColor=c?c.isDataDriven:!1;c=b.getPaintProperty("icon-opacity");b.hasDataDrivenIconOpacity=c?c.isDataDriven:!1;c=b.getLayoutProperty("icon-size");b.hasDataDrivenIconSize=c?c.isDataDriven:!1;b.hasDataDrivenIcon=b.hasDataDrivenIconColor||b.hasDataDrivenIconOpacity||b.hasDataDrivenIconSize;c=b.getPaintProperty("text-color");b.hasDataDrivenTextColor=
c?c.isDataDriven:!1;c=b.getPaintProperty("text-opacity");b.hasDataDrivenTextOpacity=c?c.isDataDriven:!1;c=b.getLayoutProperty("text-size");b.hasDataDrivenTextSize=c?c.isDataDriven:!1;b.hasDataDrivenText=b.hasDataDrivenTextColor||b.hasDataDrivenTextOpacity||b.hasDataDrivenTextSize;return b}c.__extends(b,a);return b}(n);e.SymbolStyleLayer=m;n=function(a){function b(b,c,f){b=a.call(this,b,c,f)||this;c=b.getPaintProperty("circle-radius");b.hasDataDrivenRadius=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-color");
b.hasDataDrivenColor=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-opacity");b.hasDataDrivenOpacity=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-width");b.hasDataDrivenStrokeWidth=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-color");b.hasDataDrivenStrokeColor=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-opacity");b.hasDataDrivenStrokeOpacity=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-blur");b.hasDataDrivenBlur=c?c.isDataDriven:!1;return b}c.__extends(b,a);
return b}(n);e.CircleStyleLayer=n;n=function(){return function(a,b,c){this.cap=a.getLayoutValue("line-cap",b,c);this.join=a.getLayoutValue("line-join",b,c);this.miterLimit=a.getLayoutValue("line-miter-limit",b,c);this.roundLimit=a.getLayoutValue("line-round-limit",b,c)}}();e.LineLayout=n;n=function(){return function(a,b,c,e){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b,e);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",b,e);this.optional=a.getLayoutValue("icon-optional",
b,e);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b,e);this.size=a.getLayoutValue("icon-size",b,e);this.rotate=a.getLayoutValue("icon-rotate",b,e);this.padding=a.getLayoutValue("icon-padding",b,e);this.keepUpright=a.getLayoutValue("icon-keep-upright",b,e);this.offset=a.getLayoutValue("icon-offset",b,e);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();e.IconLayout=n;n=function(){return function(a,b,c,e){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b,e);
this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b,e);this.optional=a.getLayoutValue("text-optional",b,e);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",b,e);this.fontArray=a.getLayoutValue("text-font",b,e);this.maxWidth=a.getLayoutValue("text-max-width",b,e);this.lineHeight=a.getLayoutValue("text-line-height",b,e);this.letterSpacing=a.getLayoutValue("text-letter-spacing",b,e);this.justify=a.getLayoutValue("text-justify",b,e);this.anchor=a.getLayoutValue("text-anchor",
b,e);this.maxAngle=a.getLayoutValue("text-max-angle",b,e);this.size=a.getLayoutValue("text-size",b,e);this.rotate=a.getLayoutValue("text-rotate",b,e);this.padding=a.getLayoutValue("text-padding",b,e);this.keepUpright=a.getLayoutValue("text-keep-upright",b,e);this.transform=a.getLayoutValue("text-transform",b,e);this.offset=a.getLayoutValue("text-offset",b,e);this.writingMode=a.getLayoutValue("text-writing-mode",b,e);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();e.TextLayout=n})},
"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["require","exports"],function(n,e){return function(){function c(e,b,a){this._op=e;"$type"===b?(this._val=a instanceof Array?a.map(function(a){return c._types.indexOf(a)}):c._types.indexOf(a),this._op+=11):(this._key=b,this._val=a)}c.prototype.filter=function(c){switch(this._op){case 0:return this._val;case 1:return c.values[this._key]===this._val;case 2:return c.values[this._key]!==this._val;case 3:return c.values[this._key]<this._val;
case 4:return c.values[this._key]>this._val;case 5:return c.values[this._key]<=this._val;case 6:return c.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(c.values[this._key]);case 8:return-1===this._val.indexOf(c.values[this._key]);case 9:for(var b=0,a=this._val;b<a.length;b++){var e=a[b];if(e.filter(c))return!0}return!1;case 10:b=0;for(a=this._val;b<a.length;b++)if(e=a[b],!e.filter(c))return!1;return!0;case 11:b=0;for(a=this._val;b<a.length;b++)if(e=a[b],e.filter(c))return!1;return!0;
case 12:return c.type===this._val;case 13:return c.type!==this._val;case 14:return c.type<this._val;case 15:return c.type>this._val;case 16:return c.type>=this._val;case 17:return c.type<=this._val;case 18:return-1!==this._val.indexOf(c.type);case 19:return-1===this._val.indexOf(c.type);case 20:return void 0!==c.values[this._key];case 21:return void 0===c.values[this._key]}};c.createFilter=function(e){if(!e)return new c(0,void 0,!0);var b=e[0];if(1>=e.length)return new c(0,void 0,"any"!==b);switch(b){case "\x3d\x3d":return new c(1,
e[1],e[2]);case "!\x3d":return new c(2,e[1],e[2]);case "\x3e":return new c(4,e[1],e[2]);case "\x3c":return new c(3,e[1],e[2]);case "\x3e\x3d":return new c(6,e[1],e[2]);case "\x3c\x3d":return new c(5,e[1],e[2]);case "in":return new c(7,e[1],e.slice(2));case "!in":return new c(8,e[1],e.slice(2));case "any":return new c(9,void 0,e.slice(1).map(c.createFilter.bind(this)));case "all":return new c(10,void 0,e.slice(1).map(c.createFilter.bind(this)));case "none":return new c(11,void 0,e.slice(1).map(c.createFilter.bind(this)));
case "has":return new c(20,e[1],void 0);case "!has":return new c(21,e[1],void 0);default:throw Error("invalid operator: "+b);}};c._types=["Unknown","Point","LineString","Polygon"];return c}()})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(n,e){Object.defineProperty(e,"__esModule",{value:!0});n=function(){function c(){}c.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};c.fillLayoutDefinition=
{visibility:{type:"enum",values:["visible","none"],default:"visible"}};c.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};c.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},
"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,
default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:"center"},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},
"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["left","center","right"],default:"center"},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",
minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:["horizontal"]}};c.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};c.backgroundPaintDefinition=
{"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};c.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",
values:["map","viewport"],default:"map"}};c.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",
values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1}};c.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map",
"viewport"],default:"map"},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};c.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,
maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};c.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",
default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};return c}();e.StyleDefinition=n})},
"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../../../Color","../GeometryUtils"],function(n,e,c,h){return function(){function b(a,c){this.isDataDriven=!1;var e;switch(a.type){case "number":e=!0;break;case "color":e=!0;c=b._parseColor(c);break;case "array":e="number"===a.value;break;default:e=!1}null==c&&(c=a.default);e&&"interval"===c.type&&(e=!1);var g=c&&c.stops&&0<c.stops.length;if(g)for(var f=0,d=c.stops;f<d.length;f++){var h=d[f];h[1]=this._validate(h[1],
a)}if(this.isDataDriven=c?!!c.property:!1)if(void 0!==c.default&&(c.default=this._validate(c.default,a)),g)switch(c.type){case "identity":this.getValue=this._buildIdentity(c,a);break;case "categorical":this.getValue=this._buildCategorical(c,a);break;default:this.getValue=e?this._buildInterpolate(c,a):this._buildInterval(c,a)}else this.getValue=this._buildIdentity(c,a);else g?this.getValue=e?this._buildZoomInterpolate(c):this._buildZoomInterval(c):(c=this._validate(c,a),this.getValue=this._buildSimple(c))}
b.prototype._validate=function(a,b){if("number"===b.type){if(a<b.minimum)return b.minimum;if(a>b.maximum)return b.maximum}return a};b.prototype._buildSimple=function(a){return function(){return a}};b.prototype._buildIdentity=function(a,c){var e=this;return function(g,f){var d;f&&(d=f.values[a.property],"color"===c.type&&(d=b._parseColor(d)));void 0===d&&(d=a.default);return void 0!==d?e._validate(d,c):c.default}};b.prototype._buildCategorical=function(a,b){var c=this;return function(e,f){var d;f&&
(d=f.values[a.property]);d=c._categorical(d,a.stops);return void 0!==d?d:void 0!==a.default?a.default:b.default}};b.prototype._buildInterval=function(a,b){var c=this;return function(e,f){var d;f&&(d=f.values[a.property]);return"number"===typeof d?c._interval(d,a.stops):void 0!==a.default?a.default:b.default}};b.prototype._buildInterpolate=function(a,b){var c=this;return function(e,f){var d;f&&(d=f.values[a.property]);return"number"===typeof d?c._interpolate(d,a.stops,a.base||1):void 0!==a.default?
a.default:b.default}};b.prototype._buildZoomInterpolate=function(a){var b=this;return function(c){return b._interpolate(c,a.stops,a.base||1)}};b.prototype._buildZoomInterval=function(a){var b=this;return function(c){return b._interval(c,a.stops)}};b.prototype._categorical=function(a,b){for(var c=b.length,e=0;e<c;e++)if(b[e][0]===a)return b[e][1]};b.prototype._interval=function(a,b){for(var c=b.length,e=0,f=0;f<c;f++)if(b[f][0]<=a)e=f;else break;return b[e][1]};b.prototype._interpolate=function(a,
b,c){for(var e,f,d=b.length,g=0;g<d;g++){var m=b[g];if(m[0]<=a)e=m;else{f=m;break}}if(e&&f){g=f[0]-e[0];a-=e[0];c=1===c?a/g:(Math.pow(c,a)-1)/(Math.pow(c,g)-1);if(Array.isArray(e[1])){e=e[1];f=f[1];a=[];for(g=0;g<e.length;g++)a.push(h.interpolate(e[g],f[g],c));return a}return h.interpolate(e[1],f[1],c)}if(e)return e[1];if(f)return f[1]};b._isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};b._parseColor=function(a){if(Array.isArray(a))return a;if("string"===typeof a){if(a=
new c(a),!this._isEmpty(a))return c.toUnitRGBA(a)}else return a&&a.default&&(a.default=b._parseColor(a.default)),a&&a.stops&&(a.stops=a.stops.map(function(a){return[a[0],b._parseColor(a[1])]})),a};return b}()})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(n,e){function c(b,a){b%=a;return 0<=b?b:b+a}Object.defineProperty(e,"__esModule",{value:!0});e.C_INFINITY=Number.POSITIVE_INFINITY;e.C_PI=Math.PI;e.C_2PI=2*e.C_PI;e.C_PI_BY_2=e.C_PI/2;e.C_RAD_TO_256=
128/e.C_PI;e.C_256_TO_RAD=e.C_PI/128;e.C_DEG_TO_256=256/360;e.C_DEG_TO_RAD=e.C_PI/180;e.C_SQRT2=1.414213562;e.C_SQRT2_INV=1/e.C_SQRT2;var h=1/Math.LN2;e.positiveMod=c;e.radToByte=function(b){return c(b*e.C_RAD_TO_256,256)};e.degToByte=function(b){return c(b*e.C_DEG_TO_256,256)};e.log2=function(b){return Math.log(b)*h};e.sqr=function(b){return b*b};e.interpolate=function(b,a,c){return b*(1-c)+a*c};e.between=function(b,a,c){return b>=a&&b<=c||b>=c&&b<=a}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require",
"exports"],function(n,e){Object.defineProperty(e,"__esModule",{value:!0});e.WEBGL_MAX_STOPS=8;e.WEBGL_MAX_INNER_STOPS=e.WEBGL_MAX_STOPS-2;e.NAN_MAGIC_NUMBER=1E-30;e.EXTRUDE_SCALE=64;e.PICTURE_FILL_COLOR=4294967295;e.TILE_SIZE=512;e.RASTER_TILE_SIZE=256;e.ANGLE_FACTOR_256=256/360;e.DEBUG_LABELS=!1;e.COLLISION_BUCKET_SIZE=128;e.DOT_DENSITY_MAX_FIELDS=8;e.MAGIC_LABEL_LINE_HEIGHT=29;e.COLLISION_MAX_ZOOM_DELTA=1;e.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;e.COLLISION_BOX_PADDING=16;e.COLLISION_TILE_BOX_SIZE=
e.TILE_SIZE/e.COLLISION_BUCKET_SIZE;e.COLLISION_PLACEMENT_PADDING=8;e.HEURISTIC_GLYPHS_PER_LINE=50;e.HEURISTIC_GLYPHS_PER_FEATURE=10;e.GLYPH_SIZE=24;e.TEXT_PLACEMENT_PADDING=8;e.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};e.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;e.TEXTURE_BINDING_SPRITE_ATLAS=0;e.TEXTURE_BINDING_GLYPH_ATLAS=0;e.TEXTURE_BINDING_BITMAP=0;e.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;e.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;e.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;e.TEXTURE_BINDING_ATTRIBUTE_DATA_3=
4;e.TEXTURE_BINDING_HIGHLIGHT_0=5;e.TEXTURE_BINDING_HIGHLIGHT_1=6;e.TEXTURE_BINDING_RENDERER_0=5;e.TEXTURE_BINDING_RENDERER_1=6;e.ATTRIBUTE_DATA_FILTER_FLAGS=0;e.ATTRIBUTE_DATA_ANIMATION=1;e.ATTRIBUTE_DATA_VV=2;e.ATTRIBUTE_DATA_DD0=3;e.ATTRIBUTE_DATA_DD1=3;e.MAX_FILTERS=2;e.HIGHLIGHT_FLAG=1;e.FILTER_FLAG_0=2;e.EFFECT_FLAG_0=4;e.THIN_LINE_THRESHOLD=2.5;e.HITTEST_SEARCH_SIZE=24;e.MAX_ANIMATION_TIME_MS=2E3;e.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;e.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;e.VTL_HIGH_RES_CUTOFF=
1.15;e.MAX_GPU_UPLOADS_PER_FRAME=2})},"*noref":1}});
define("require exports tslib ../request ../core/Error ../core/global ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/urlUtils ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ./Layer ./mixins/ArcGISCachedService ./mixins/ArcGISService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./support/SpriteSource ./support/TileInfo ./support/TilemapCache ./support/vectorTileLayerLoader ../portal/support/jsonContext ../views/2d/engine/vectorTiles/SchemaHelper ../views/2d/engine/vectorTiles/tileInfoUtils ../views/2d/engine/vectorTiles/style/StyleRepository".split(" "),function(n,
e,c,h,b,a,g,m,l,f,d,k,q,t,p,r,u,v,D,E,w,F,G,H,B,C,I){return function(e){function g(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=e.apply(this,a)||this;a._spriteSourceMap=new Map;a.currentStyleInfo=null;a.style=null;a.isReference=null;a.operationalLayerType="VectorTileLayer";a.type="vector-tile";a.url=null;return a}c.__extends(g,e);g.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?c.__assign({url:a},b):a};g.prototype.destroy=function(){this._spriteSourceMap.clear()};
g.prototype.prefetchResources=function(b){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(c){switch(c.label){case 0:return[4,this.loadSpriteSource(a.devicePixelRatio||1,b)];case 1:return c.sent(),[2]}})})};g.prototype.load=function(a){var b=this,d=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},a).then(function(){return c.__awaiter(b,void 0,void 0,function(){var b,d;return c.__generator(this,function(e){switch(e.label){case 0:if(!this.portalItem||
!this.portalItem.id)return[2];b=this.portalItem.itemUrl+"/resources/styles/root.json";return[4,h(b,c.__assign(c.__assign({},a),{query:{f:"json"}}))];case 1:return d=e.sent(),d.data&&this.read({url:b},H.createForItem(this.portalItem)),[2]}})})}).then(function(){return b._loadStyle(a)},function(){return b._loadStyle(a)});this.addResolvingPromise(d);return m.resolve(this)};Object.defineProperty(g.prototype,"attributionDataUrl",{get:function(){var a=this.currentStyleInfo;return(a=a&&a.serviceUrl&&f.urlToObject(a.serviceUrl))?
this._getDefaultAttribution(a.path):null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"capabilities",{get:function(){var a=this._getPrimarySource();return a?a.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"fullExtent",{get:function(){var a=this._getPrimarySource();return a?a.fullExtent:null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"parsedUrl",
{get:function(){return this.serviceUrl?l.urlToObject(this.serviceUrl):null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&
this.currentStyleInfo.styleUrl||null},enumerable:!0,configurable:!0});g.prototype.writeStyleUrl=function(a,b){a&&f.isProtocolRelative(a)&&(a="https:"+a);b.styleUrl=a};Object.defineProperty(g.prototype,"tileIndexType",{get:function(){var a=this._getPrimarySource();return a?a.type:""},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"tileIndexUrl",{get:function(){var a=this._getPrimarySource();return a?a.tileMapURL:""},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"tileInfo",{get:function(){var a=[],b;for(b in this.sourceNameToSource)a.push(this.sourceNameToSource[b]);b=this._getPrimarySource().tileInfo;if(1<a.length)for(var c=0;c<a.length;c++)C.areSchemasOverlapping(b,a[c].tileInfo)&&(b=C.unionTileInfos(b,a[c].tileInfo));return b},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"tilemapCache",{get:function(){var a=this._getPrimarySource();return a?a.capabilities.operations.supportsTileMap?a.tilemapCache:null:null},enumerable:!0,configurable:!0});
Object.defineProperty(g.prototype,"tileServers",{get:function(){var a=this._getPrimarySource();return a?a.tileServers:[]},enumerable:!0,configurable:!0});g.prototype.readVersion=function(a,b){return b.version?parseFloat(b.version):parseFloat(b.currentVersion)};Object.defineProperty(g.prototype,"compatibleTileInfo256",{get:function(){return B.create256x256CompatibleTileInfo(this.tileInfo)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"compatibleTileInfo512",{get:function(){return B.create512x512CompatibleTileInfo(this.tileInfo)},
enumerable:!0,configurable:!0});g.prototype.loadSpriteSource=function(a,b){void 0===a&&(a=1);return c.__awaiter(this,void 0,void 0,function(){var d,e;return c.__generator(this,function(c){this._spriteSourceMap.has(a)||(d=new E.default(this.styleRepository.sprite,a),this._spriteSourceMap.set(a,d.load()));e=this._spriteSourceMap.get(a);return[2,m.create(function(a,c){e.then(a,c);m.onAbortOrThrow(b,c)})]})})};g.prototype.loadStyle=function(a,b){return c.__awaiter(this,void 0,void 0,function(){var d,
e,f,g=this;return c.__generator(this,function(c){d=a||this.style||this.url;if(this._loadingPromise&&"string"===typeof d&&this.url===d&&!m.isAborted(this._abortController))return[2,this._loadingPromise];(e=this._abortController)&&e.abort();f=m.createAbortController();this._loadingPromise=m.create(function(a,c){var e={signal:f.signal};g._spriteSourceMap.clear();g._getSourceAndStyle(d,e).then(a,c);m.onAbort(b,function(){f.abort()})});this._abortController=f;return[2,this._loadingPromise]})})};g.prototype.getStyleLayerId=
function(a){return this.styleRepository.getStyleLayerId(a)};g.prototype.getPaintProperties=function(a){return this.styleRepository.getPaintProperties(a)};g.prototype.setPaintProperties=function(a,b){var c=this.styleRepository.isPainterDataDriven(a),d=this.styleRepository.setPaintProperties(a,b),e=this.styleRepository.isPainterDataDriven(a);this.emit("paint-change",{layer:d,paint:b});(c||e)&&this.emit("layout-change",{layer:d,layout:this.styleRepository.getLayoutProperties(a)})};g.prototype.getLayoutProperties=
function(a){return this.styleRepository.getLayoutProperties(a)};g.prototype.setLayoutProperties=function(a,b){a=this.styleRepository.setLayoutProperties(a,b);this.emit("layout-change",{layer:a,layout:b})};g.prototype.getTileUrl=function(a,b,c){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,b.toString()).replace(/\{x\}/gi,c.toString())};g.prototype.write=function(a,c){return c&&c.origin&&!this.styleUrl?(c.messages&&c.messages.push(new b("vectortilelayer:unsupported",
"VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):e.prototype.write.call(this,a,c)};g.prototype._getSourceAndStyle=function(a,b){return c.__awaiter(this,void 0,void 0,function(){var d;return c.__generator(this,function(c){switch(c.label){case 0:if(!a)throw Error("invalid style!");return[4,G.loadMetadata(a,b)];case 1:return d=c.sent(),this._set("currentStyleInfo",{serviceUrl:d.serviceUrl,styleUrl:d.styleUrl,spriteUrl:d.spriteUrl,
glyphsUrl:d.glyphsUrl,style:d.style,layerDefinition:d.layerDefinition}),"string"===typeof a?(this.url=a,this.style=null):(this.url=null,this.style=a),this._set("sourceNameToSource",d.sourceNameToSource),this._set("primarySourceName",d.primarySourceName),this._set("styleRepository",new I(d.style,d)),this.read(d.layerDefinition,{origin:"service"}),[2]}})})};g.prototype._getDefaultAttribution=function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta|basemapsdev)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);
if(b&&(a=b[3]&&b[3].toLowerCase()))for(var b=b[2]||"",c=0,d="OpenStreetMap_v2 OpenStreetMap_Export_v2 OpenStreetMap_FTS_v2 OpenStreetMap_GCS_v2 World_Basemap World_Basemap_v2 World_Basemap_Export_v2 World_Basemap_GCS_v2 World_Basemap_WGS84".split(" ");c<d.length;c++){var e=d[c];if(-1<e.toLowerCase().indexOf(a))return f.normalize("//static.arcgis.com/attribution/Vector"+b+"/"+e)}};g.prototype._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?
this.sourceNameToSource[this.primarySourceName]:null};g.prototype._loadStyle=function(a){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(b){return this._loadingPromise?[2,this._loadingPromise]:[2,this.loadStyle(null,a)]})})};c.__decorate([d.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],g.prototype,"attributionDataUrl",null);c.__decorate([d.property({type:["show","hide"]})],g.prototype,"listMode",void 0);c.__decorate([d.property({json:{read:!1},readOnly:!0,
dependsOn:["sourceNameToSource","primarySourceName"]})],g.prototype,"capabilities",null);c.__decorate([d.property({readOnly:!0})],g.prototype,"currentStyleInfo",void 0);c.__decorate([d.property({json:{read:!1},readOnly:!0,type:k,dependsOn:["sourceNameToSource","primarySourceName"]})],g.prototype,"fullExtent",null);c.__decorate([d.property()],g.prototype,"style",void 0);c.__decorate([d.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],g.prototype,
"isReference",void 0);c.__decorate([d.property({type:["VectorTileLayer"]})],g.prototype,"operationalLayerType",void 0);c.__decorate([d.property({readOnly:!0,dependsOn:["serviceUrl"]})],g.prototype,"parsedUrl",null);c.__decorate([d.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],g.prototype,"serviceUrl",null);c.__decorate([d.property({type:q,dependsOn:["tileInfo"],readOnly:!0})],g.prototype,"spatialReference",null);c.__decorate([d.property({readOnly:!0})],g.prototype,"styleRepository",void 0);
c.__decorate([d.property({readOnly:!0})],g.prototype,"sourceNameToSource",void 0);c.__decorate([d.property({readOnly:!0})],g.prototype,"primarySourceName",void 0);c.__decorate([d.property({type:String,readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],g.prototype,"styleUrl",null);c.__decorate([d.writer(["portal-item","web-document"],"styleUrl")],g.prototype,"writeStyleUrl",null);c.__decorate([d.property({json:{read:!1},
readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],g.prototype,"tileIndexType",null);c.__decorate([d.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],g.prototype,"tileIndexUrl",null);c.__decorate([d.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:w,dependsOn:["sourceNameToSource","primarySourceName"]})],g.prototype,"tileInfo",null);c.__decorate([d.property({json:{read:!1},readOnly:!0,type:F.TilemapCache,dependsOn:["sourceNameToSource",
"primarySourceName"]})],g.prototype,"tilemapCache",null);c.__decorate([d.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],g.prototype,"tileServers",null);c.__decorate([d.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],g.prototype,"type",void 0);c.__decorate([d.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],g.prototype,"url",void 0);c.__decorate([d.property({readOnly:!0})],
g.prototype,"version",void 0);c.__decorate([d.reader("version",["version","currentVersion"])],g.prototype,"readVersion",null);c.__decorate([d.property({readOnly:!0,dependsOn:["tileInfo"]})],g.prototype,"compatibleTileInfo256",null);c.__decorate([d.property({readOnly:!0,dependsOn:["tileInfo"]})],g.prototype,"compatibleTileInfo512",null);return g=c.__decorate([d.subclass("esri.layers.VectorTileLayer")],g)}(D.ScaleRangeLayer(p.ArcGISCachedService(r.ArcGISService(u.OperationalLayer(v.PortalLayer(g.MultiOriginJSONMixin(t)))))))});