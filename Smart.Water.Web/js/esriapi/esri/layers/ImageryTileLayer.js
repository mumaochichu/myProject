// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/rasterRenderers":function(){define("require exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer".split(" "),function(C,g,f,t,c,h,m,a){function e(a,d){if(!a)return null;var p;p=a?b[a.type]||null:null;if(p)return p=new p,p.read(a,d),p;d&&d.messages&&a&&d.messages.push(new f("renderer:unsupported","Renderers of type '"+(a.type||"unknown")+
"' are not supported",{definition:a,context:d}));return null}Object.defineProperty(g,"__esModule",{value:!0});g.ClassBreaksRenderer=t;g.RasterColormapRenderer=c;g.RasterShadedReliefRenderer=h;g.RasterStretchRenderer=m;g.UniqueValueRenderer=a;g.rasterRendererTypes={key:"type",base:null,typeMap:{"unique-value":a,"class-breaks":t,"raster-colormap":c,"raster-stretch":m,"raster-shaded-relief":h}};var b={uniqueValue:a,classBreaks:t,rasterStretch:m,rasterColormap:c,rasterShadedRelief:h};g.read=e;g.fromJSON=
function(a,d){return e(a,d)}})},"esri/renderers/RasterColormapRenderer":function(){define("require exports tslib ../core/JSONSupport ../core/accessorSupport/decorators ./support/ColormapInfo ./support/colorRampUtils".split(" "),function(C,g,f,t,c,h,m){return function(a){function e(p){p=a.call(this,p)||this;p.colormapInfos=null;p.type="raster-colormap";return p}f.__extends(e,a);b=e;e.createFromColormap=function(a,d){function e(a){return d?d[a]||"":String(a[0])}if(!a)return null;var p=5===a[0].length;
a=a.sort(function(d){return d[0][0]-d[1][0]});p=p?a.map(function(d){return h.fromJSON({value:d[0],color:d.slice(1,5),label:e(d[0])})}):a.map(function(d){return h.fromJSON({value:d[0],color:d.slice(1,4).concat([255]),label:e(d[0])})});return new b({colormapInfos:p})};e.createFromColorramp=function(a){a=m.convertColorRampToColormap(a,256);return b.createFromColormap(a)};e.prototype.clone=function(){return new b({colormapInfos:this.colormapInfos.map(function(a){return a.toJSON()})})};e.prototype.extractColormap=
function(){return this.colormapInfos.map(function(a){return[a.value,a.color.r,a.color.g,a.color.b,1<a.color.a?a.color.a:255*a.color.a&255]}).sort(function(a,d){return a[0]-d[0]})};var b;f.__decorate([c.property({type:[h],json:{write:!0}})],e.prototype,"colormapInfos",void 0);f.__decorate([c.enumeration({rasterColormap:"raster-colormap"})],e.prototype,"type",void 0);return e=b=f.__decorate([c.subclass("esri.renderers.RasterColormapRenderer")],e)}(t.JSONSupport)})},"esri/renderers/support/ColormapInfo":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(C,g,f,t,c,h){return function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.value=null;a.label=null;a.color=null;return a}f.__extends(a,c);f.__decorate([h.property({type:Number,json:{write:!0}})],a.prototype,"value",void 0);f.__decorate([h.property({type:String,json:{write:!0}})],a.prototype,"label",void 0);f.__decorate([h.property({type:t,json:{write:!0}})],a.prototype,"color",void 0);return a=f.__decorate([h.subclass("esri.renderers.support.ColormapInfo")],a)}(c.JSONSupport)})},
"esri/renderers/support/colorRampUtils":function(){define(["require","exports","../../Color","../../core/colorUtils"],function(C,g,f,t){function c(a,e){if(!a||!e||a.length!==e.length)return!1;for(var b=0;b<a.length;b++)if(a[b]>e[b]+2||a[b]<e[b]-2)return!1;return!0}function h(a,e,b){a=t.toLAB(a);e=t.toLAB(e);return t.toRGB({l:a.l*(1-b)+b*e.l,a:a.a*(1-b)+b*e.a,b:a.b*(1-b)+b*e.b})}function m(a,e){if(a){e=e?e:g.PREDEFINED_JSON_COLOR_RAMPS;var b=null,p;"algorithmic"===a.type?e.some(function(d){if(c(a.fromColor.toRgb(),
d.fromColor)&&c(a.toColor.toRgb(),d.toColor))return b=d.id,!0}):"multipart"===a.type&&e.some(function(d){if(a.colorRamps&&d.colorRamps&&a.colorRamps.length===d.colorRamps.length&&(p=a.colorRamps,!d.colorRamps.some(function(a,d){if(!c(p[d].fromColor.toRgb(),(new f(a.fromColor)).toRgb())||!c(p[d].toColor.toRgb(),(new f(a.toColor)).toRgb()))return!0}))){if(b)return!0;b=d.id}});return b}}Object.defineProperty(g,"__esModule",{value:!0});g.PREDEFINED_JSON_COLOR_RAMPS=[{id:"aspect_predefined",type:"multipart",
colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",
fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,
255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,
97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,
240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},
{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",
type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,
173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,
13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},
{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],
toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,
17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",
type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,
168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",
colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,
0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",
type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}];g.PREDEFINED_COLOR_RAMP_NAME_MAP={aspect_predefined:"Aspect",blackToWhite_predefined:"Black to White",
blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",
conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",
partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",
purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",
redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",
yellowToRed_predefined:"Yellow to Red",yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"};g.getColorRampId=m;g.getColorRampName=function(a){return(a=m(a))?g.PREDEFINED_COLOR_RAMP_NAME_MAP[a]:null};g.convertColorRampToColormap=function(a,e){if(a&&e){for(var b="multipart"===a.type?a.colorRamps.length:1,p=[],d=[],c,m,l,k,x,n=0,q=0;q<b;q++)p[q]={start:null,end:null},p[q].start=n,p[q].end=n+1/b,n=p[q].end;b=function(n){k=n/e;p.forEach(function(b,
p){k>=b.start&&k<b.end&&(x=(k-b.start)/(b.end-b.start),"multipart"===a.type?(c=new f(a.colorRamps[p].fromColor),m=new f(a.colorRamps[p].toColor)):(c=new f(a.fromColor),m=new f(a.toColor)),l=h(c,m,x),0===n?d.push([n,c.r,c.g,c.b]):n===e-1?d.push([n,m.r,m.g,m.b]):(l=h(c,m,x),d.push([n,l.r,l.g,l.b])))})};for(q=0;q<e;q++)b(q);return d}}})},"esri/core/colorUtils":function(){define(["require","exports"],function(C,g){function f(a,d){var b=[],e,p;if(a[0].length!==d.length)throw"dimensions do not match";var c=
a.length,x=a[0].length,n=0;for(e=0;e<c;e++){for(p=n=0;p<x;p++)n+=a[e][p]*d[p];b.push(n)}return b}function t(a){a=[a.r/255,a.g/255,a.b/255].map(function(a){return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});a=f(e,a);return{x:100*a[0],y:100*a[1],z:100*a[2]}}function c(a){a=f(b,[a.x/100,a.y/100,a.z/100]).map(function(a){return Math.min(1,Math.max(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055,0))});return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function h(a){a=[a.x/
95.047,a.y/100,a.z/108.883].map(function(a){return a>Math.pow(6/29,3)?Math.pow(a,1/3):1/3*Math.pow(29/6,2)*a+4/29});return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function m(a){var d=a.l;a=[(d+16)/116+a.a/500,(d+16)/116,(d+16)/116-a.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function a(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var d=a.c,b=a.h;return c(m({l:a.l,a:d*Math.cos(b),
b:d*Math.sin(b)}))}if("l"in a&&"a"in a&&"b"in a)return c(m(a));if("x"in a&&"y"in a&&"z"in a)return c(a);if("h"in a&&"s"in a&&"v"in a){b=(a.h+360)%360/60;d=a.v/100*255;a=a.s/100*d;var e=a*(1-Math.abs(b%2-1));switch(Math.floor(b)){case 0:b={r:a,g:e,b:0};break;case 1:b={r:e,g:a,b:0};break;case 2:b={r:0,g:a,b:e};break;case 3:b={r:0,g:e,b:a};break;case 4:b={r:e,g:0,b:a};break;case 5:case 6:b={r:a,g:0,b:e};break;default:b={r:0,g:0,b:0}}b.r=Math.round(b.r+d-a);b.g=Math.round(b.g+d-a);b.b=Math.round(b.b+
d-a);return b}}Object.defineProperty(g,"__esModule",{value:!0});var e=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],b=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];g.toRGB=a;g.toHSV=function(b){if("h"in b&&"s"in b&&"v"in b)return b;var d=a(b);b=d.r;var e=d.g,d=d.b,c=Math.max(b,e,d),p=c-Math.min(b,e,d),k;0===p?k=0:c===b?k=(e-d)/p%6:c===e?k=(d-b)/p+2:c===d&&(k=(b-e)/p+4);0>k&&(k+=6);return{h:60*k,s:100*(0===p?0:p/c),v:100/255*c}};g.toLAB=function(b){return"l"in
b&&"a"in b&&"b"in b?b:h(t(a(b)))};g.toLCH=function(b){if(!("l"in b&&"c"in b&&"h"in b)){var d=h(t(a(b)));b=d.l;var e=d.a,c=d.b,d=Math.sqrt(e*e+c*c),e=Math.atan2(c,e),e=0<e?e:e+2*Math.PI;b={l:b,c:d,h:e}}return b};g.toXYZ=function(b){return"x"in b&&"y"in b&&"z"in b?b:t(a(b))};g.darken=function(a,b){a=h(t(a));a.l*=1-b;return c(m(a))}})},"esri/renderers/RasterShadedReliefRenderer":function(){define("require exports tslib ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ../tasks/support/colorRamps".split(" "),
function(C,g,f,t,c,h,m){return function(a){function e(b){b=a.call(this,b)||this;b.altitude=45;b.azimuth=315;b.colorRamp=null;b.hillshadeType="multi-directional";b.pixelSizePower=.664;b.pixelSizeFactor=.024;b.scalingType="none";b.type="raster-shaded-relief";b.zFactor=1;return b}f.__extends(e,a);b=e;e.prototype.readColorRamp=function(a){return m.fromJSON(a)};e.prototype.clone=function(){return new b({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,
pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:c.clone(this.colorRamp)})};var b;f.__decorate([h.property({type:Number,json:{write:!0}})],e.prototype,"altitude",void 0);f.__decorate([h.property({type:Number,json:{write:!0}})],e.prototype,"azimuth",void 0);f.__decorate([h.property({types:m.types,json:{write:!0}})],e.prototype,"colorRamp",void 0);f.__decorate([h.reader("colorRamp")],e.prototype,"readColorRamp",null);f.__decorate([h.property({type:["traditional","multi-directional"],
json:{write:!0}})],e.prototype,"hillshadeType",void 0);f.__decorate([h.property({type:Number,json:{write:!0}})],e.prototype,"pixelSizePower",void 0);f.__decorate([h.property({type:Number,json:{write:!0}})],e.prototype,"pixelSizeFactor",void 0);f.__decorate([h.property({type:["none","adjusted"],json:{write:!0}})],e.prototype,"scalingType",void 0);f.__decorate([h.enumeration({rasterShadedRelief:"raster-shaded-relief"})],e.prototype,"type",void 0);f.__decorate([h.property({type:Number,json:{write:!0}})],
e.prototype,"zFactor",void 0);return e=b=f.__decorate([h.subclass("esri.renderers.RasterShadedReliefRenderer")],e)}(t.JSONSupport)})},"esri/renderers/RasterStretchRenderer":function(){define("require exports tslib ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/stretchRendererUtils ../tasks/support/colorRamps".split(" "),function(C,g,f,t,c,h,m,a){return function(e){function b(a){a=e.call(this,a)||this;a.colorRamp=null;a.computeGamma=!1;a.dynamicRangeAdjustment=!1;a.gamma=
[];a.maxPercent=null;a.minPercent=null;a.numberOfStandardDeviations=null;a.outputMax=null;a.outputMin=null;a.sigmoidStrengthLevel=null;a.statistics=[];a.histograms=null;a.useGamma=!1;a.stretchType="none";a.type="raster-stretch";return a}f.__extends(b,e);p=b;b.prototype.readColorRamp=function(b){if(b)return a.fromJSON(b)};b.prototype.writeStatistics=function(a,b,e){null==a||0===a.length?a=null:a[0]instanceof Array||(a=a.map(function(a){return[a.min,a.max,a.avg,a.stddev]}));b[e]=a};b.prototype.readStretchType=
function(a,b){a=b.stretchType;"number"===typeof a&&(a=m.stretchTypeFunctionEnum[a]);return m.stretchTypeJSONDict.read(a)};b.prototype.clone=function(){return new p({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:c.clone(this.statistics),gamma:c.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,
colorRamp:c.clone(this.colorRamp),histograms:c.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})};var p;f.__decorate([h.property({types:a.types,json:{write:!0}})],b.prototype,"colorRamp",void 0);f.__decorate([h.reader("colorRamp")],b.prototype,"readColorRamp",null);f.__decorate([h.property({type:Boolean,json:{write:!0}})],b.prototype,"computeGamma",void 0);f.__decorate([h.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],b.prototype,"dynamicRangeAdjustment",
void 0);f.__decorate([h.property({type:[Number],json:{write:{allowNull:!0}}})],b.prototype,"gamma",void 0);f.__decorate([h.property({type:Number,json:{write:{allowNull:!0}}})],b.prototype,"maxPercent",void 0);f.__decorate([h.property({type:Number,json:{write:{allowNull:!0}}})],b.prototype,"minPercent",void 0);f.__decorate([h.property({type:Number,json:{write:{allowNull:!0}}})],b.prototype,"numberOfStandardDeviations",void 0);f.__decorate([h.property({type:Number,json:{read:{source:"max"},write:{target:"max",
allowNull:!0}}})],b.prototype,"outputMax",void 0);f.__decorate([h.property({type:Number,json:{read:{source:"min"},write:{target:"min",allowNull:!0}}})],b.prototype,"outputMin",void 0);f.__decorate([h.property({type:Number,json:{write:{allowNull:!0}}})],b.prototype,"sigmoidStrengthLevel",void 0);f.__decorate([h.property({json:{write:{allowNull:!0}}})],b.prototype,"statistics",void 0);f.__decorate([h.property()],b.prototype,"histograms",void 0);f.__decorate([h.writer("statistics")],b.prototype,"writeStatistics",
null);f.__decorate([h.property({type:Boolean,json:{write:!0}})],b.prototype,"useGamma",void 0);f.__decorate([h.property({type:m.stretchTypeJSONDict.apiValues,json:{type:m.stretchTypeJSONDict.jsonValues,write:m.stretchTypeJSONDict.write}})],b.prototype,"stretchType",void 0);f.__decorate([h.reader("stretchType",["stretchType"])],b.prototype,"readStretchType",null);f.__decorate([h.enumeration({rasterStretch:"raster-stretch"})],b.prototype,"type",void 0);return b=p=f.__decorate([h.subclass("esri.renderers.RasterStretchRenderer")],
b)}(t.JSONSupport)})},"esri/renderers/support/stretchRendererUtils":function(){define(["require","exports","../../core/jsonMap"],function(C,g,f){Object.defineProperty(g,"__esModule",{value:!0});g.stretchTypeJSONDict=new f.default({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});g.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",
9:"sigmoid"}})},"esri/layers/support/DimensionalDefinition":function(){define("require exports tslib ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),function(C,g,f,t,c,h,m){return function(a){function e(b){b=a.call(this,b)||this;b.variableName=null;b.dimensionName=null;b.values=[];b.isSlice=!1;return b}f.__extends(e,a);b=e;e.prototype.clone=function(){return new b({variableName:this.variableName,dimensionName:this.dimensionName,
values:c.clone(this.values),isSlice:this.isSlice})};var b;f.__decorate([h.property({type:String,json:{write:!0}})],e.prototype,"variableName",void 0);f.__decorate([h.property({type:String,json:{write:!0}})],e.prototype,"dimensionName",void 0);f.__decorate([h.property({type:m.types.array(m.types.oneOf([m.types.native(Number),m.types.array(m.types.native(Number))])),json:{write:!0}})],e.prototype,"values",void 0);f.__decorate([h.property({type:Boolean,json:{write:!0}})],e.prototype,"isSlice",void 0);
return e=b=f.__decorate([h.subclass("esri.layers.support.DimensionalDefinition")],e)}(t.JSONSupport)})},"esri/layers/support/imageryRendererUtils":function(){define("require exports ../../rasterRenderers ../../core/arrayUtils ../../core/lang ./RasterFunction ../../renderers/support/colorRampUtils ../../renderers/support/stretchRendererUtils ../../tasks/support/MultipartColorRamp".split(" "),function(C,g,f,t,c,h,m,a,e){function b(a){var e=a.Raster;return e&&"esri.layers.support.RasterFunction"===e.declaredClass?
b(e.functionArguments):a}function p(a,b){var e=[],n=[],r=[],c=[],k=b.pixelType,q=(b=b.rasterAttributeTable)&&b.features,v=A(b);if(q&&Array.isArray(q)&&a.classBreakInfos)return a.classBreakInfos.forEach(function(b,e){var n=b.symbol.color,d;n.a&&q.forEach(function(r){d=r.attributes[a.field];(d>=b.minValue&&d<b.maxValue||e===a.classBreakInfos.length-1&&d>=b.minValue)&&c.push([r.attributes[v],n.r,n.g,n.b])})}),k=k?d(c,k):c,b=new h,b.functionName="Colormap",b.functionArguments={},b.functionArguments.Colormap=
k,b.variableName="Raster",b;a.classBreakInfos.forEach(function(a,b){var d=a.symbol&&a.symbol.color;d.a?(0===b?e.push(a.minValue,a.maxValue+1E-6):e.push(a.minValue+1E-6,a.maxValue+1E-6),n.push(b),c.push([b,d.r,d.g,d.b])):r.push(a.minValue,a.maxValue)});k=k?d(c,k):c;b=new h;b.functionName="Remap";b.functionArguments={InputRanges:e,OutputValues:n,NoDataRanges:r};b.variableName="Raster";var p=new h;p.functionName="Colormap";p.functionArguments={Colormap:k,Raster:b};return p}function d(a,b){(b=k[String(b).toLowerCase()])&&
a.push([Math.floor(b[0]-1),0,0,0],[Math.ceil(b[1]+1),0,0,0]);return a}function A(a){if(a)return(a=(a=a.fields)&&t.find(a,function(a){return a&&a.name&&"value"===a.name.toLowerCase()}))&&a.name}function y(a,b){var e=[],n=b.pixelType,c=(b=b.rasterAttributeTable)&&b.features,r=A(b),k=!1;a.uniqueValueInfos&&a.uniqueValueInfos.forEach(function(b){var n=b.symbol.color;n.a&&(a.field!==r&&c?c&&c.forEach(function(d){String(d.attributes[a.field])===String(b.value)&&e.push([d.attributes[r],n.r,n.g,n.b])}):isNaN(b.value)?
k=!0:e.push([b.value,n.r,n.g,n.b]))});if(k)return null;n=n&&0<e.length?d(e,n):e;b=new h;b.functionName="Colormap";b.functionArguments={};b.functionArguments.Colormap=n;b.variableName="Raster";return b}function l(a){var b=[];a.forEach(function(a){Array.isArray(a)?b.push(a):null!=a.min&&null!=a.max&&b.push([a.min,a.max,a.avg||0,a.stddev||0])});return b}Object.defineProperty(g,"__esModule",{value:!0});var k={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767]},x={type:"multipart",
colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},n=e.fromJSON(m.PREDEFINED_JSON_COLOR_RAMPS[0]);g.isSupportedRendererType=function(a){return-1<["raster-stretch","unique-value","class-breaks","raster-shaded-relief"].indexOf(a.type)};g.combineRenderingRules=function(a,e){if(!a||!e)return c.clone(a||e);a=c.clone(a);"none"!==e.functionName.toLowerCase()&&(b(a.functionArguments).Raster=e);return a};g.convertRendererToRenderingRule=
function(b,e){e=e||{};switch(b.type){case "raster-stretch":var n=new h;n.functionName="Stretch";var c=q[a.stretchTypeJSONDict.toJSON(b.stretchType)],u=l(b.statistics),u={StretchType:c,Statistics:u,DRA:b.dynamicRangeAdjustment,UseGamma:b.useGamma,Gamma:b.gamma,ComputeGamma:b.computeGamma};null!=b.outputMin&&(u.Min=b.outputMin);null!=b.outputMax&&(u.Max=b.outputMax);c===q.standardDeviation?(u.NumberOfStandardDeviations=b.numberOfStandardDeviations,n.outputPixelType="u8"):c===q.percentClip?(u.MinPercent=
b.minPercent,u.MaxPercent=b.maxPercent,n.outputPixelType="u8"):c===q.minMax?n.outputPixelType="u8":c===q.sigmoid&&(u.SigmoidStrengthLevel=b.sigmoidStrengthLevel);n.functionArguments=u;n.variableName="Raster";if(b.colorRamp){var c=b.colorRamp,u=new h,r=m.getColorRampName(c);u.functionArguments=r?{colorRamp:r}:!e.convertColorRampToColormap||"algorithmic"!==c.type&&"multipart"!==c.type?{colorRamp:b.colorRamp.toJSON()}:{Colormap:m.convertColorRampToColormap(c,256)};u.variableName="Raster";u.functionName=
"Colormap";u.functionArguments.Raster=n;b=u}else b=n;return b;case "class-breaks":return p(b,e);case "unique-value":return y(b,e);case "raster-colormap":return(b=b.extractColormap())&&0!==b.length?(b=(e=e.pixelType)?d(b,e):b,e=new h,e.functionName="Colormap",e.functionArguments={},e.functionArguments.Colormap=b,b=e):b=void 0,b;case "raster-shaded-relief":return"elevation"!==e.dataType?b=new h:(e=new h,e.functionName="Hillshade",n="traditional"===b.hillshadeType?0:1,c="none"===b.scalingType?1:3,u=
{HillshadeType:n,SlopeType:c,ZFactor:b.zFactor},0===n&&(u.Azimuth=b.azimuth,u.Altitude=b.altitude),3===c&&(u.PSPower=b.pixelSizePower,u.PSZFactor=b.pixelSizeFactor),e.functionArguments=u,e.variableName="Raster",b.colorRamp&&(e.functionName="ShadedRelief",u.Colormap=m.convertColorRampToColormap(b.colorRamp,256)),b=e),b}};g.createDefaultRenderer=function(a,b){if(a){var e=a.attributeTable,d=a.dataType,c=a.bandCount,r=a.pixelType,k=a.colormap,q=a.statistics,p=a.histograms;b&&0<b.length&&(q=q?b.map(function(a){return q[a]}):
null,p=p?b.map(function(a){return p[a]}):null);var l,v,A,y,h,t;e&&(v=e.fields.filter(function(a){return"red"===a.name.toLowerCase()})[0],A=e.fields.filter(function(a){return"green"===a.name.toLowerCase()})[0],y=e.fields.filter(function(a){return"blue"===a.name.toLowerCase()})[0],t=e.fields.filter(function(a){return"value"===a.name.toLowerCase()})[0],h=e.fields.filter(function(a){return"classname"===a.name.toLowerCase()||"class_name"===a.name.toLowerCase()})[0],h||(h=e.fields.filter(function(a){return"string"===
a.type})[0])||(h=t));if(1===c&&0<(null===k||void 0===k?void 0:k.length)){var g;e&&v&&A&&y&&(g={},e.features.forEach(function(a){a=a.attributes;g[a[t.name]]=h?a[h.name]:a[t.name]}));l=f.RasterColormapRenderer.createFromColormap(k,g)}else if(1===c&&e){a=void 0;e=e.features;if(v&&A&&y&&h)a=e.map(function(a){return{value:a.attributes[h.name],label:a.attributes[h.name],symbol:{type:"esriSFS",style:"esriSFSSolid",color:[a.attributes[v.name],a.attributes[A.name],a.attributes[y.name],255]}}});else{var S=
m.convertColorRampToColormap(n,e.length);a=e.map(function(a,b){return{value:a.attributes[t.name],label:a.attributes[t.name],symbol:{color:S[b].slice(1,4),type:"esriSFS",style:"esriSFSSolid"}}})}a.sort(function(a,b){return a.value>b.value?1:-1});l=f.UniqueValueRenderer.fromJSON({field1:h.name,uniqueValueInfos:a})}l||(e=void 0,a=!1,l=k=b=void 0,"u8"===r&&"processed"===d?(e="none",q=1===c?[{min:0,max:255}]:[{min:0,max:255},{min:0,max:255},{min:0,max:255}]):"u8"===r||"elevation"===d?(e="min-max",a=q?
!1:!0):"scientific"===d?(e="min-max",a=q?!1:!0,b=x):p&&0<p.length?(e="percent-clip",l=k=.25):q?e="min-max":(e="percent-clip",a=!0),l=f.RasterStretchRenderer.fromJSON({stretchType:e,dra:a,colorRamp:b,min:0,max:255,statistics:a?null:q,histograms:a?null:p,maxPercent:k,minPercent:l}));return l}};g.getDefaultBandCombination=function(a){var b=a.bandCount;if(1===b)return null;if(2===b)return[0];a=a.keyProperties&&a.keyProperties.BandProperties;var e,n,d,c,k;if(a&&a.length===b){for(var q=0;q<a.length;q++)a[q].BandName&&
"red"===a[q].BandName.toLowerCase()&&(n=q),a[q].BandName&&"green"===a[q].BandName.toLowerCase()&&(d=q),a[q].BandName&&"blue"===a[q].BandName.toLowerCase()&&(c=q),a[q].BandName&&"nearinfrared"===a[q].BandName.toLowerCase()&&(k=q);void 0!==n&&void 0!==d&&void 0!==c?e=[n,d,c]:void 0!==n&&void 0!==d&&void 0!==k&&(e=[k,n,d])}!e&&3<b&&(e=[0,1,2]);return e};var q={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9}})},"esri/layers/support/RasterFunction":function(){define("require exports tslib ../../core/JSONSupport ../../core/lang ../../core/SetUtils ../../core/accessorSupport/decorators".split(" "),
function(C,g,f,t,c,h,m){var a=h.SetFromValues(["Raster","Raster2","DEM","FillRaster"]),e=h.SetFromValues(["Rasters"]),b=function(a){return a&&a.rasterFunction?A.fromJSON(a):a},p=function(a){return a&&a instanceof A?a.toJSON():a},d;(function(a){a[a.MOSAIC=0]="MOSAIC";a[a.GROUP=1]="GROUP";a[a.ITEM=2]="ITEM"})(d||(d={}));var A=function(A){function l(a){a=A.call(this,a)||this;a.functionArguments=null;a.functionName=null;a.outputPixelType="unknown";a.variableName=null;a.description=null;a.functionDefinition=
null;a.thumbnail=null;return a}f.__extends(l,A);k=l;l.prototype.readFunctionArguments=function(d,n){d=n.arguments||n.rasterFunctionArguments;if(null==d)d=null;else{n={};for(var c=0,k=Object.keys(d);c<k.length;c++){var r=k[c];a.has(r)?n[r]=b(d[r]):e.has(r)&&Array.isArray(d[r])?n[r]=d[r].map(b):n[r]=d[r]}d=n}return d};l.prototype.writeFunctionArguments=function(b,n,d){for(var c={},k=0,q=Object.keys(b);k<q.length;k++){var w=q[k];a.has(w)?c[w]=p(b[w]):e.has(w)&&Array.isArray(b[w])?c[w]=b[w].map(p):c[w]=
p(b[w])}this.functionDefinition?n.arguments=c:n[d]=c};l.prototype.readFunctionName=function(a,b){a=b.rasterFunctionInfos;var e=b.name;return e?e:a&&a.length&&"None"!==a[0].name?a[0].name:b.rasterFunction};l.prototype.writeFunctionName=function(a,b,e){this.functionDefinition?b.name=a:b[e]=a};l.prototype.readFunctionType=function(a){return d[a]};l.prototype.writeFunctionType=function(a,b,e){b[e]=d[a]};l.prototype.clone=function(){return new k({functionName:this.functionName,functionArguments:c.clone(this.functionArguments),
outputPixelType:this.outputPixelType,variableName:this.variableName,name:this.functionName,description:this.description,functionType:this.functionType,functionDefinition:this.functionDefinition,thumbnail:this.thumbnail})};var k;f.__decorate([m.property({json:{type:Object,write:{target:"rasterFunctionArguments"}}})],l.prototype,"functionArguments",void 0);f.__decorate([m.reader("functionArguments",["rasterFunctionArguments","arguments"])],l.prototype,"readFunctionArguments",null);f.__decorate([m.writer("functionArguments")],
l.prototype,"writeFunctionArguments",null);f.__decorate([m.property({json:{type:String,write:{target:"rasterFunction"}}})],l.prototype,"functionName",void 0);f.__decorate([m.reader("functionName",["rasterFunction","rasterFunctionInfos","name"])],l.prototype,"readFunctionName",null);f.__decorate([m.writer("functionName")],l.prototype,"writeFunctionName",null);f.__decorate([m.enumeration({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",
U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),m.property({json:{default:"unknown"}})],l.prototype,"outputPixelType",void 0);f.__decorate([m.property({type:String,json:{read:!0,write:!0}})],l.prototype,"variableName",void 0);f.__decorate([m.property({type:String,json:{read:!0,write:!0,origins:{"web-document":{read:!1,write:!1}}}})],l.prototype,"description",void 0);f.__decorate([m.property({json:{origins:{"web-document":{read:!1,write:!1}}}})],l.prototype,"functionType",void 0);f.__decorate([m.reader("functionType")],
l.prototype,"readFunctionType",null);f.__decorate([m.writer("functionType")],l.prototype,"writeFunctionType",null);f.__decorate([m.property({type:Object,json:{read:{source:"function"},write:{target:"function"},origins:{"web-document":{read:!1,write:!1}}}})],l.prototype,"functionDefinition",void 0);f.__decorate([m.property({type:String,json:{read:!0,write:!0,origins:{"web-document":{read:!1,write:!1}}}})],l.prototype,"thumbnail",void 0);return l=k=f.__decorate([m.subclass("esri.layers.support.RasterFunction")],
l)}(t.JSONSupport);return A})},"esri/layers/support/RasterJobHandler":function(){define("require exports tslib ../../core/Error ../../core/promiseUtils ../../core/workers ./PixelBlock".split(" "),function(C,g,f,t,c,h,m){return function(){function a(){this._workerThread=null;this._destroyed=!1}a.prototype.initialize=function(){return f.__awaiter(this,void 0,void 0,function(){var a;return f.__generator(this,function(b){switch(b.label){case 0:return[4,h.open("RasterWorker")];case 1:return a=b.sent(),
this._destroyed?a.close():this._workerThread=a,[2]}})})};a.prototype.destroy=function(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)};a.prototype.decode=function(a,b){return f.__awaiter(this,void 0,void 0,function(){var e;return f.__generator(this,function(d){switch(d.label){case 0:if(!this._workerThread)throw new t("raster-jobhandler:no-connection","no available worker connection");return[4,this._workerThread.invoke("decode",a,b)];case 1:return e=d.sent(),
[2,e?new m(e):null]}})})};a.prototype.symbolize=function(a,b){return f.__awaiter(this,void 0,void 0,function(){var e,d;return f.__generator(this,function(c){switch(c.label){case 0:if(!this._workerThread)throw new t("raster-jobhandler:no-connection","no available worker connection");e={extent:a.extent&&a.extent.toJSON(),pixelBlock:a.pixelBlock.toJSON(),simpleStretchParams:a.simpleStretchParams,bandIds:a.bandIds};return[4,this._workerThread.invoke("symbolize",e,b)];case 1:return d=c.sent(),[2,d?new m(d):
null]}})})};a.prototype.updateSymbolizer=function(a,b){return f.__awaiter(this,void 0,void 0,function(){var e;return f.__generator(this,function(d){switch(d.label){case 0:if(!this._workerThread)throw new t("raster-jobhandler:no-connection","no available worker connection");e=a&&a.renderer&&"raster-stretch"===a.renderer.type&&a.renderer.histograms;return[4,c.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:a.toJSON(),histograms:e},b))];case 1:return d.sent(),[2]}})})};a.prototype.stretch=
function(a,b){return f.__awaiter(this,void 0,void 0,function(){var e,d;return f.__generator(this,function(c){switch(c.label){case 0:if(!this._workerThread)throw new t("raster-jobhandler:no-connection","no available worker connection");if(!a||!a.pixelBlock)return[2,null];e={srcPixelBlock:a.pixelBlock.toJSON(),stretchParams:a.stretchParams};return[4,this._workerThread.invoke("stretch",e,b)];case 1:return d=c.sent(),[2,d?new m(d):null]}})})};a.prototype.mosaicAndTransform=function(a,b){return f.__awaiter(this,
void 0,void 0,function(){var e,d;return f.__generator(this,function(c){switch(c.label){case 0:if(!this._workerThread)throw new t("raster-jobhandler:no-connection","no available worker connection");if(!(a&&a.srcPixelBlocks&&0<a.srcPixelBlocks.length))return[2,null];e=f.__assign(f.__assign({},a),{srcPixelBlocks:a.srcPixelBlocks.map(function(a){return a?a.toJSON():null})});return[4,this._workerThread.invoke("mosaicAndTransform",e,b)];case 1:return d=c.sent(),[2,d?new m(d):null]}})})};return a}()})},
"esri/layers/support/PixelBlock":function(){define("require exports tslib ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators".split(" "),function(C,g,f,t,c,h,m,a,e,b){var p=a.getLogger("esri.layers.support.PixelBlock");return function(a){function d(b){b=a.call(this,b)||this;b.width=null;b.height=null;b.pixelType="f32";b.validPixelCount=null;b.mask=null;b.maskIsAlpha=!1;b.pixels=null;b.statistics=
null;return b}f.__extends(d,a);h=d;d.createEmptyBand=function(a,b){return new (h.getPixelArrayConstructor(a))(b)};d.getPixelArrayConstructor=function(a){var b;switch(a){case "u1":case "u2":case "u4":case "u8":b=Uint8Array;break;case "u16":b=Uint16Array;break;case "u32":b=Uint32Array;break;case "s8":b=Int8Array;break;case "s16":b=Int16Array;break;case "s32":b=Int32Array;break;case "u32":b=Uint32Array;break;case "f32":b=Float32Array;break;case "f64":b=Float64Array;break;case "c64":case "c128":case "unknown":b=
Float32Array;break;default:t.neverReached(a)}return b};d.prototype.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");return a};d.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};d.prototype.addData=function(a){if(!a.pixels||a.pixels.length!==this.width*this.height)throw new c("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");
this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(a.pixels);this.statistics.push(a.statistics||{minValue:null,maxValue:null})};d.prototype.getAsRGBA=function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};d.prototype.getAsRGBAFloat=function(){var a=new Float32Array(this.width*
this.height*4);this._fillFrom32Bit(a);return a};d.prototype.updateStatistics=function(){var a=this;this.statistics=this.pixels.map(function(b){return a._calculateBandStatistics(b,a.mask)});var b=this.mask,e=0;if(b)for(var d=0;d<b.length;d++)b[d]&&e++;else e=this.width*this.height;this.validPixelCount=e};d.prototype.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){var b;switch(a){case "u8":b=[0,255];break;case "u16":b=[0,65535];break;case "u32":b=[0,4294967295];break;case "s8":b=[-128,127];break;case "s16":b=
[-32768,32767];break;case "s32":b=[-2147483648,2147483647];break;default:b=[-3.4*1E39,3.4*1E39]}var e=b[0];b=b[1];for(var d=this.pixels,c=this.width*this.height,p=d.length,r,l,w,u=[],B=0;B<p;B++){w=h.createEmptyBand(a,c);r=d[B];for(var m=0;m<c;m++)l=r[m],w[m]=l>b?b:l<e?e:l;u.push(w)}this.pixels=u;this.pixelType=a}};d.prototype.extractBands=function(a){var b=this;if(e.isNone(a)||0===a.length||null==this.pixels||0===this.pixels.length)return this;var d=this.pixels.length,n=a.some(function(a){return a>=
b.pixels.length}),d=d===a.length&&!a.some(function(a,b){return a!==b});return n||d?this:new h({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:a.map(function(a){return b.pixels[a]}),statistics:this.statistics&&a.map(function(a){return b.statistics[a]})})};d.prototype.clone=function(){var a=new h({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});
this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var b,e=h.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=[];var d=this.pixels[0].slice;for(b=0;b<this.pixels.length;b++)a.pixels[b]=d?this.pixels[b].slice(0,this.pixels[b].length):new e(this.pixels[b])}if(this.statistics)for(a.statistics=[],b=0;b<this.statistics.length;b++)a.statistics[b]=m.clone(this.statistics[b]);return a};d.prototype._fillFrom8Bit=function(a){var b=
this.mask,e=this.maskIsAlpha,d=this.pixels;if(a&&d&&d.length){var c,l,r;c=l=r=d[0];3<=d.length?(l=d[1],r=d[2]):2===d.length&&(l=d[1]);a=new Uint32Array(a);d=this.width*this.height;if(c.length!==d)p.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(b&&b.length===d)if(e)for(e=0;e<d;e++)b[e]&&(a[e]=b[e]<<24|r[e]<<16|l[e]<<8|c[e]);else for(e=0;e<d;e++)b[e]&&(a[e]=-16777216|r[e]<<16|l[e]<<8|c[e]);else for(e=0;e<d;e++)a[e]=-16777216|r[e]<<16|l[e]<<8|c[e]}else p.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};d.prototype._fillFromNon8Bit=function(a){var b=this.pixels,e=this.mask,d=this.statistics;if(a&&b&&b.length){var c=this.pixelType,l=1,r=0,l=1;d&&0<d.length?(r=d.map(function(a){return a.minValue}).reduce(function(a,b){return Math.min(a,b)}),l=d.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,b){return Math.max(a,b)}),l=255/l):(l=255,"s8"===c?(r=-128,l=127):"u16"===c?l=65535:"s16"===c?(r=-32768,l=32767):"u32"===c?l=4294967295:
"s32"===c?(r=-2147483648,l=2147483647):"f32"===c?(r=-3.4*1E39,l=3.4*1E39):"f64"===c&&(r=-Number.MAX_VALUE,l=Number.MAX_VALUE),l=255/(l-r));a=new Uint32Array(a);var c=this.width*this.height,m,w,d=m=w=b[0];if(d.length!==c)return p.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=b.length)if(m=b[1],3<=b.length&&(w=b[2]),e&&e.length===c)for(b=0;b<c;b++)e[b]&&(a[b]=-16777216|(w[b]-r)*l<<16|(m[b]-r)*l<<8|(d[b]-r)*l);else for(b=0;b<c;b++)a[b]=-16777216|(w[b]-r)*l<<16|(m[b]-
r)*l<<8|(d[b]-r)*l;else if(e&&e.length===c)for(b=0;b<c;b++)m=(d[b]-r)*l,e[b]&&(a[b]=-16777216|m<<16|m<<8|m);else for(b=0;b<c;b++)m=(d[b]-r)*l,a[b]=-16777216|m<<16|m<<8|m}else p.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};d.prototype._fillFrom32Bit=function(a){var b=this.pixels,e=this.mask;if(!a||!b||!b.length)return p.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var d,c,l;d=c=l=b[0];3<=b.length?(c=b[1],l=b[2]):2===b.length&&
(c=b[1]);var r=this.width*this.height;if(d.length!==r)return p.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var m=0;if(e&&e.length===r)for(b=0;b<r;b++)a[m++]=d[b],a[m++]=c[b],a[m++]=l[b],a[m++]=e[b]&1;else for(b=0;b<r;b++)a[m++]=d[b],a[m++]=c[b],a[m++]=l[b],a[m++]=1};d.prototype._calculateBandStatistics=function(a,b){var e=Infinity,d=-Infinity,c=a.length,p,r=0;if(b)for(p=0;p<c;p++)b[p]&&(r=a[p],e=r<e?r:e,d=r>d?r:d);else for(p=0;p<c;p++)r=a[p],e=r<e?r:e,d=r>d?r:
d;return{minValue:e,maxValue:d}};var h;f.__decorate([b.property({json:{write:!0}})],d.prototype,"width",void 0);f.__decorate([b.property({json:{write:!0}})],d.prototype,"height",void 0);f.__decorate([b.property({json:{write:!0}})],d.prototype,"pixelType",void 0);f.__decorate([b.cast("pixelType")],d.prototype,"castPixelType",null);f.__decorate([b.property({json:{write:!0}})],d.prototype,"validPixelCount",void 0);f.__decorate([b.property({json:{write:!0}})],d.prototype,"mask",void 0);f.__decorate([b.property({json:{write:!0}})],
d.prototype,"maskIsAlpha",void 0);f.__decorate([b.property({json:{write:!0}})],d.prototype,"pixels",void 0);f.__decorate([b.property({json:{write:!0}})],d.prototype,"statistics",void 0);return d=h=f.__decorate([b.subclass("esri.layers.support.PixelBlock")],d)}(h.JSONSupport)})},"esri/layers/support/TileInfo":function(){define("require exports tslib ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(C,g,f,t,c,h,m,a,e,b,p,d,A){var y=new c.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(c){function k(a){a=c.call(this,a)||this;a.dpi=96;a.format=null;a.origin=null;a.minScale=0;a.maxScale=0;a.size=null;a.spatialReference=null;return a}f.__extends(k,c);l=k;k.create=function(a){void 0===
a&&(a={size:256,spatialReference:t.SpatialReference.WebMercator});var b=a.resolutionFactor||1,e=a.scales,d=a.size||256,c=a.spatialReference||t.SpatialReference.WebMercator;if(!p.isValid(c)){b=[];if(e)for(a=0;a<e.length;a++){var n=e[a];b.push({level:a,scale:n,resolution:n})}else{var u=5E-4;for(a=23;0<=a;a--)b.unshift({level:a,scale:u,resolution:u}),u*=2}return new l({dpi:96,lods:b,origin:new t.Point(0,0,c),size:[d,d],spatialReference:c})}var n=p.getInfo(c),k=a.origin?new t.Point({x:a.origin.x,y:a.origin.y,
spatialReference:c}):n?new t.Point({x:n.origin[0],y:n.origin[1],spatialReference:c}):new t.Point({x:0,y:0,spatialReference:c}),x=1/(39.37*m.getMetersPerUnitForSR(c)*96),h=[];if(e)for(a=0;a<e.length;a++)n=e[a],u=n*x,h.push({level:a,scale:n,resolution:u});else for(n=p.isGeographic(c)?512/d*5.916575275917094E8:256/d*5.91657527591555E8,e=Math.ceil(24/b),h.push({level:0,scale:n,resolution:n*x}),a=1;a<e;a++)n/=Math.pow(2,b),u=n*x,h.push({level:a,scale:n,resolution:u});return new l({dpi:96,lods:h,origin:k,
size:[d,d],spatialReference:c})};Object.defineProperty(k.prototype,"isWrappable",{get:function(){var a=this.spatialReference,b=this.origin;if(a&&b){var e=p.getInfo(a);return a.isWrappable&&Math.abs(e.origin[0]-b.x)<=e.dx}return!1},enumerable:!0,configurable:!0});k.prototype.readOrigin=function(a,b){return t.Point.fromJSON(f.__assign({spatialReference:b.spatialReference},a))};Object.defineProperty(k.prototype,"lods",{set:function(a){var b=this,e=0,d=0,c=[];this._levelToLOD={};a&&(e=-Infinity,d=Infinity,
a.forEach(function(a){c.push(a.scale);e=a.scale>e?a.scale:e;d=a.scale<d?a.scale:d;b._levelToLOD[a.level]=a}));this._set("scales",c);this._set("minScale",e);this._set("maxScale",d);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});k.prototype.readSize=function(a,b){return[b.cols,b.rows]};k.prototype.writeSize=function(a,b){b.cols=a[0];b.rows=a[0]};k.prototype.zoomToScale=function(a){var b=this.scales;if(0>=a)return b[0];if(a>=b.length)return b[b.length-1];var e=
Math.round(a);return b[e]+(e-a)*(b[Math.round(a-.5)]-b[e])};k.prototype.scaleToZoom=function(a){for(var b=this.scales,e=b.length-1,d=0;d<e;d++){var c=b[d],n=b[d+1];if(c<=a)break;if(n===a)return d+1;if(c>a&&n<a)return d+1-(a-n)/(c-n)}return d};k.prototype.snapScale=function(a,b){void 0===b&&(b=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=b?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))};k.prototype.tileAt=function(a,e,c,r){var n=this.lodAt(a);if(!n)return null;var w;if("number"===
typeof e)w=e,e=c;else{if(p.equals(e.spatialReference,this.spatialReference))w=e.x,e=e.y;else{r=d.project(e,this.spatialReference);if(!r)return null;w=r.x;e=r.y}r=c}c=n.resolution*this.size[0];n=n.resolution*this.size[1];r||(r={id:null,level:0,row:0,col:0,extent:b.create()});r.level=a;r.row=Math.floor((this.origin.y-e)/n+.001);r.col=Math.floor((w-this.origin.x)/c+.001);this.updateTileInfo(r);return r};k.prototype.updateTileInfo=function(a){var e=this.lodAt(a.level);if(e){var d=e.resolution*this.size[0],
e=e.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=b.create());a.extent[0]=this.origin.x+a.col*d;a.extent[1]=this.origin.y-(a.row+1)*e;a.extent[2]=a.extent[0]+d;a.extent[3]=a.extent[1]+e}};k.prototype.upsampleTile=function(a){var b=this._upsampleLevels[a.level];if(!b||-1===b.parentLevel)return!1;a.level=b.parentLevel;a.row=Math.floor(a.row/b.factor+.001);a.col=Math.floor(a.col/b.factor+.001);this.updateTileInfo(a);return!0};k.prototype.getTileBounds=function(a,b){var e=
this.lodAt(b.level).resolution,d=e*this.size[0],e=e*this.size[1];a[0]=this.origin.x+b.col*d;a[1]=this.origin.y-(b.row+1)*e;a[2]=a[0]+d;a[3]=a[1]+e;return a};k.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null};k.prototype.clone=function(){return l.fromJSON(this.write({}))};k.prototype._initializeUpsampleLevels=function(){var a=this.lods;this._upsampleLevels=[];for(var b=null,e=0;e<a.length;e++){var d=a[e];this._upsampleLevels[d.level]={parentLevel:b?b.level:-1,factor:b?
b.resolution/d.resolution:0};b=d}};var l;f.__decorate([a.property({type:Number,json:{write:!0}})],k.prototype,"compressionQuality",void 0);f.__decorate([a.property({type:Number,json:{write:!0}})],k.prototype,"dpi",void 0);f.__decorate([a.property({type:String,json:{read:y.read,write:y.write,origins:{"web-scene":{read:!1,write:!1}}}})],k.prototype,"format",void 0);f.__decorate([a.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],k.prototype,"isWrappable",null);f.__decorate([a.property({type:t.Point,
json:{write:!0}})],k.prototype,"origin",void 0);f.__decorate([a.reader("origin")],k.prototype,"readOrigin",null);f.__decorate([a.property({type:[A],value:null,json:{write:!0}})],k.prototype,"lods",null);f.__decorate([a.property({readOnly:!0})],k.prototype,"minScale",void 0);f.__decorate([a.property({readOnly:!0})],k.prototype,"maxScale",void 0);f.__decorate([a.property({readOnly:!0})],k.prototype,"scales",void 0);f.__decorate([a.property({cast:function(a){return Array.isArray(a)?a:"number"===typeof a?
[a,a]:[256,256]}})],k.prototype,"size",void 0);f.__decorate([a.reader("size",["rows","cols"])],k.prototype,"readSize",null);f.__decorate([a.writer("size",{cols:{type:e.Integer},rows:{type:e.Integer}})],k.prototype,"writeSize",null);f.__decorate([a.property({type:t.SpatialReference,json:{write:!0}})],k.prototype,"spatialReference",void 0);return k=l=f.__decorate([a.subclass("esri.layers.support.TileInfo")],k)}(h.JSONSupport)})},"esri/layers/support/LOD":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(C,g,f,t,c,h){return function(m){function a(a){a=m.call(this,a)||this;a.level=0;a.levelValue=null;a.resolution=0;a.scale=0;return a}f.__extends(a,m);e=a;a.prototype.clone=function(){return new e({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var e;f.__decorate([c.property({type:h.Integer,json:{write:!0}})],a.prototype,"level",void 0);f.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"levelValue",void 0);f.__decorate([c.property({type:Number,
json:{write:!0}})],a.prototype,"resolution",void 0);f.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"scale",void 0);return a=e=f.__decorate([c.subclass("esri.layers.support.LOD")],a)}(t.JSONSupport)})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("require exports tslib ../../../core/Error ../../../core/MapUtils ./CloudRaster ./ImageServerRaster ./MRFRaster ./TIFFRaster".split(" "),function(C,g,f,t,c,h,m,a,e){var b=new Map;b.set("CRF",{desc:"Cloud Raster Format",
constructor:h});b.set("MRF",{desc:"Meta Raster Format",constructor:a});b.set("TIFF",{desc:"GeoTIFF",constructor:e});b.set("RasterTileServer",{desc:"Raster Tile Server",constructor:m});return function(){function a(){}Object.defineProperty(a,"supportedFormats",{get:function(){var a=new Set;b.forEach(function(b,e){return a.add(e)});return a},enumerable:!0,configurable:!0});a.open=function(a){return f.__awaiter(this,void 0,void 0,function(){var e,d,p,k,m,n,q,v,r,h,w;return f.__generator(this,function(u){switch(u.label){case 0:e=
a.url;d=a.ioConfig;p=a.sourceJSON;k=a.datasetFormat;null==k&&e.lastIndexOf(".")&&(k=e.slice(e.lastIndexOf(".")+1).toUpperCase());"OVR"===k||"TIF"===k?k="TIFF":-1<e.toLowerCase().indexOf("/imageserver")&&(k="RasterTileServer");m={bandIds:null,sampling:null};n={url:e,sourceJSON:p,datasetFormat:k,ioConfig:d||m};if(!this.supportedFormats.has(k))return[3,2];q=b.get(k).constructor;v=new q(n);return[4,v.open({signal:a.signal})];case 1:return u.sent(),[2,v];case 2:if(k)throw new t("rasterfactory:open","not a supported format "+
k);r=c.keysOfMap(b);h=0;w=function(){k=r[h++];if(!k)return null;q=b.get(k).constructor;v=new q(n);return v.open({signal:a.signal}).then(function(){return v}).catch(function(){return w()})};return[2,w()]}})})};a.register=function(a,e,c){b.has(a.toUpperCase())||b.set(a.toUpperCase(),{desc:e,constructor:c})};return a}()})},"esri/layers/support/rasterDatasets/CloudRaster":function(){define("require exports tslib ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../RasterInfo ../RasterStorageInfo ../TileInfo ./BaseRaster ./DBFParser ../../../tasks/support/FeatureSet".split(" "),
function(C,g,f,t,c,h,m,a,e,b,p,d,A,y){var l=new Map;l.set("int16","esriFieldTypeSmallInteger");l.set("int32","esriFieldTypeInteger");l.set("int64","esriFieldTypeInteger");l.set("float32","esriFieldTypeSingle");l.set("float64","esriFieldTypeDouble");l.set("text","esriFieldTypeString");return function(d){function k(){var a=null!==d&&d.apply(this,arguments)||this;a.storageInfo=null;return a}f.__extends(k,d);k.prototype.open=function(a){return f.__awaiter(this,void 0,void 0,function(){var b,e,d,n,w,u;
return f.__generator(this,function(r){switch(r.label){case 0:return[4,this.init()];case 1:return r.sent(),b=a?h.unwrap(a.signal):null,[4,this.request({url:this.url+"/conf.json",responseType:"json"},b)];case 2:e=r.sent();if(!this._validateHeader(e))throw new c("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);d=this._parseHeader(e);n=d.storageInfo;w=d.rasterInfo;return"thematic"!==w.dataType?[3,4]:[4,this._fetchAuxiliaryInformation()];
case 3:u=r.sent(),w.attributeTable=u,r.label=4;case 4:return this._set("storageInfo",n),this._set("rasterInfo",w),this.ioConfig.retryCount=this.ioConfig.retryCount||0,[2]}})})};k.prototype.fetchRawTile=function(a,b,e,d){void 0===d&&(d={});return f.__awaiter(this,void 0,void 0,function(){var c,n,u,r,p,k,q;return f.__generator(this,function(w){switch(w.label){case 0:c=this.rasterInfo.storageInfo.maximumPyramidLevel-a;if(0>c)return[2,null];n=this._buildCacheFilePath(c,b,e,d.multidimensionalDefinition);
u=this._getIndexRecordFromBundle(b,e);return[4,this.request({url:n,range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer"},d.signal)];case 1:r=w.sent();if(!r)return[2,null];p=new Uint8Array(r);k=this._getTileEndAndContentType(p,u);return 0===k.recordSize?[2,null]:[4,this.request({url:n,range:{from:k.position,to:k.position+k.recordSize},responseType:"array-buffer"},d.signal)];case 2:return(q=w.sent())?[2,this.decodePixelBlock(q,{width:this.rasterInfo.storageInfo.tileInfo.size[0],
height:this.rasterInfo.storageInfo.tileInfo.size[1],planes:null,pixelType:null})]:[2,null]}})})};k.prototype._validateHeader=function(a){var b="origin extent geodataXform LODInfos blockWidth blockHeight bandCount pixelType pixelSizeX pixelSizeY format packetSize".split(" ");return a&&"RasterInfo"===a.type&&!b.some(function(b){return!a[b]})};k.prototype._parseHeader=function(a){var d="u1 u2 u4 u8 s8 u16 s16 u32 s32 f32 f64".split(" ")[a.pixelType],c=a.bandCount,r=a.histograms,n=a.colormap,w=a.blockWidth,
u=a.blockHeight,k=a.firstPyramidLevel,l=a.maximumPyramidLevel,m=a.statistics&&a.statistics.map(function(a){return{min:a.min,max:a.max,avg:a.mean,stddev:a.standardDeviation,median:a.median,mode:a.mode}}),h=new t.SpatialReference(a.extent.spatialReference||a.geodataXform.spatialReference),x=new t.Extent({xmin:a.extent.xmin,ymin:a.extent.ymin,xmax:a.extent.xmax,ymax:a.extent.ymax,spatialReference:h}),f=new t.Point({x:a.pixelSizeX,y:a.pixelSizeY,spatialReference:h}),A=a.properties,y=a.format.toLowerCase().replace("cache/",
""),g=new t.Point(a.origin.x,a.origin.y,h),N,L,S,R;if(n&&n.colors)for(N=[],L=0;L<n.colors.length;L++)S=n.colors[L],R=n.values?n.values[L]:L,N.push([R,S&255,S<<16>>>24,S<<8>>>24,S>>>24]);n=a.LODInfos;S=[];for(L=0;L<n.levels.length;L++)S.push({level:n.levels[L],resolution:n.resolutions[L],scale:96/.0254*n.resolutions[L]});n=new p({dpi:96,lods:S,format:y,origin:g,size:[w,u],spatialReference:h});y={recordSize:8,packetSize:a.packetSize,headerSize:a.packetSize*a.packetSize*8+64};S=Math.round((x.xmax-x.xmin)/
f.x);R=Math.round((x.ymax-x.ymin)/f.y);var T=[{maxCol:Math.ceil(S/w)-1,maxRow:Math.ceil(R/u)-1,minCol:0,minRow:0}],Q=2;if(0<l)for(L=0;L<l;L++)T.push({maxCol:Math.ceil(S/Q/w)-1,maxRow:Math.ceil(R/Q/u)-1,minCol:0,minRow:0}),Q*=2;a=new e({width:S,height:R,pixelType:d,bandCount:c,extent:x,spatialReference:h,pixelSize:f,keyProperties:A,statistics:m,histograms:r,multidimensionalInfo:a.mdInfo,colormap:N,storageInfo:new b({blockWidth:w,blockHeight:u,pyramidBlockWidth:w,pyramidBlockHeight:u,origin:g,tileInfo:n,
firstPyramidLevel:k,maximumPyramidLevel:l,blockBoundary:T})});return{storageInfo:y,rasterInfo:a}};k.prototype._fetchAuxiliaryInformation=function(a){return f.__awaiter(this,void 0,void 0,function(){var b,e,d,c,w,u,n,p;return f.__generator(this,function(r){switch(r.label){case 0:return b=this.request({url:this.url+"/conf.vat.json",responseType:"json"},a).then(function(a){return a}).catch(function(){return null}),e=this.request({url:this.url+"/conf.vat.dbf",responseType:"array-buffer"},a).then(function(a){return a}).catch(function(){return null}),
[4,m.all([b,e])];case 1:return d=r.sent(),d[0]&&(w=d[0].fields,u=d[0].values,w&&u&&(w=w.map(function(a){return{type:"OID"===a.name?"esriFieldTypeOID":l.get(a.type),name:a.name,alias:a.alias||a.name}}),n=u.map(function(a){return{attributes:a}}),w&&u&&(c={fields:w,features:n}))),!c&&d[1]&&(p=A.parse(d[1]),c=p.recordSet),[2,y.fromJSON(c)]}})})};k.prototype._buildCacheFilePath=function(a,b,e,d){var c=this.storageInfo.packetSize;e=Math.floor(e/c)*c;b="R"+this._toHexString4(Math.floor(b/c)*c)+"C"+this._toHexString4(e);
var c="L",c=10<=a?c+a.toString():c+("0"+a.toString()),w=d&&d[0];if(!w)return this.url+"/_alllayers/"+c+"/"+b+".bundle";a=this.rasterInfo.multidimensionalInfo.variables.filter(function(a){return a.name===w.variableName})[0].dimensions[0].values.indexOf(w.values[0]).toString(16);d=4-a.length;for(e=0;e<d;e++)a="0"+a;return this.url+"/_alllayers/"+w.variableName+"/"+("S"+a)+"/"+c+"/"+b+".bundle"};k.prototype._getIndexRecordFromBundle=function(a,b){var e=this.storageInfo.packetSize;a=a%e*e+b%e;if(0>a)throw"Invalid level / row / col";
return a*this.storageInfo.recordSize+64};k.prototype._getTileEndAndContentType=function(a,b){a=a.subarray(b,b+8);b=0;var e;for(e=0;5>e;e++)b|=(a[e]&255)<<8*e;var d=b&0xffffffffff;b=0;for(e=5;8>e;e++)b|=(a[e]&255)<<8*(e-5);return{position:d,recordSize:b&0xffffffffff}};k.prototype._toHexString4=function(a){a=a.toString(16);if(4!==a.length)for(var b=4-a.length;0<b--;)a="0"+a;return a};f.__decorate([a.property({readOnly:!0})],k.prototype,"storageInfo",void 0);f.__decorate([a.property({type:String,json:{write:!0}})],
k.prototype,"datasetFormat",void 0);return k=f.__decorate([a.subclass("esri.layers.support.rasterDatasets.CloudRaster")],k)}(d)})},"esri/layers/support/RasterInfo":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ../../geometry/Extent ../../tasks/support/FeatureSet".split(" "),function(C,g,f,t,c,h,m){return function(a){function e(b){b=a.call(this,b)||this;b.attributeTable=null;b.bandCount=null;b.colormap=null;b.extent=null;b.format=void 0;b.height=
null;b.width=null;b.histograms=null;b.keyProperties=null;b.multidimensionalInfo=null;b.noDataValue=null;b.pixelSize=null;b.pixelType=null;b.spatialReference=null;b.statistics=null;b.storageInfo=null;return b}f.__extends(e,a);Object.defineProperty(e.prototype,"dataType",{get:function(){var a=this.keyProperties&&this.keyProperties.DataType;return a?a.toLowerCase():"generic"},enumerable:!0,configurable:!0});f.__decorate([c.property({type:m,json:{write:!0}})],e.prototype,"attributeTable",void 0);f.__decorate([c.property({json:{write:!0}})],
e.prototype,"bandCount",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"colormap",void 0);f.__decorate([c.property({type:String,readOnly:!0})],e.prototype,"dataType",null);f.__decorate([c.property({type:h,json:{write:!0}})],e.prototype,"extent",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"format",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"height",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"width",void 0);f.__decorate([c.property({json:{write:!0}})],
e.prototype,"histograms",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"keyProperties",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"multidimensionalInfo",void 0);f.__decorate([c.property()],e.prototype,"noDataValue",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"pixelSize",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"pixelType",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"spatialReference",void 0);
f.__decorate([c.property({json:{write:!0}})],e.prototype,"statistics",void 0);f.__decorate([c.property({json:{write:!0}})],e.prototype,"storageInfo",void 0);return e=f.__decorate([c.subclass("esri.layers.support.RasterInfo")],e)}(t.JSONSupport)})},"esri/layers/support/RasterStorageInfo":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ../../geometry/Point".split(" "),function(C,g,f,t,c,h){return function(m){function a(){var a=null!==m&&m.apply(this,
arguments)||this;a.blockWidth=void 0;a.blockHeight=void 0;a.compression=null;a.origin=null;a.firstPyramidLevel=null;a.maximumPyramidLevel=null;a.pyramidScalingFactor=2;a.pyramidBlockWidth=null;a.pyramidBlockHeight=null;a.tileInfo=null;a.blockBoundary=null;return a}f.__extends(a,m);f.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"blockWidth",void 0);f.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"blockHeight",void 0);f.__decorate([c.property({type:String,
json:{write:!0}})],a.prototype,"compression",void 0);f.__decorate([c.property({type:h,json:{write:!0}})],a.prototype,"origin",void 0);f.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"firstPyramidLevel",void 0);f.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"maximumPyramidLevel",void 0);f.__decorate([c.property()],a.prototype,"pyramidScalingFactor",void 0);f.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"pyramidBlockWidth",void 0);f.__decorate([c.property({type:Number,
json:{write:!0}})],a.prototype,"pyramidBlockHeight",void 0);f.__decorate([c.property({json:{write:!0}})],a.prototype,"tileInfo",void 0);f.__decorate([c.property()],a.prototype,"blockBoundary",void 0);return a=f.__decorate([c.subclass("esri.layers.support.RasterStorageInfo")],a)}(t.JSONSupport)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("require exports tslib ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/maybe ../../../core/Promise ../../../core/promiseUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators ../commonProperties ../TileInfo ./RawBlockCache ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper".split(" "),
function(C,g,f,t,c,h,m,a,e,b,p,d,A,y,l,k,x,n){return function(e){function q(){var a=null!==e&&e.apply(this,arguments)||this;a.rasterJobHandler=null;a.datasetName=null;a.datasetFormat=null;a.rasterInfo=null;a.ioConfig={sampling:"closest"};return a}f.__extends(q,e);q.prototype.init=function(){return f.__awaiter(this,void 0,void 0,function(){var a;return f.__generator(this,function(b){switch(b.label){case 0:return a=n.load(),this.addResolvingPromise(a),[4,this.when()];case 1:return b.sent(),[2]}})})};
q.prototype.normalizeCtorArgs=function(a){a&&a.ioConfig&&(a=f.__assign(f.__assign({},a),{ioConfig:f.__assign({resolution:null,bandIds:null,sampling:"closest",tileInfo:y.create()},a.ioConfig)}));return a};Object.defineProperty(q.prototype,"url",{set:function(a){a=p.urlToObject(a);this._set("url",a.path)},enumerable:!0,configurable:!0});q.prototype.open=function(a){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(a){throw new h("BaseRaster:open-not-implemented","open() is not implemented");
})})};q.prototype.fetchTile=function(a,b,e,d){void 0===d&&(d={});return f.__awaiter(this,void 0,void 0,function(){var c,u,w,p;return f.__generator(this,function(n){c=d.tileInfo;u=c.lodAt(a);w=new t.Point({x:u.resolution,y:u.resolution,spatialReference:c.spatialReference});p=this._getTileExtent(w,b,e,c);return[2,this.fetchPixels(p,c.size[0],c.size[1],d)]})})};q.prototype.identify=function(b,e){void 0===e&&(e={});return f.__awaiter(this,void 0,void 0,function(){var d,c,p,r,k,q,m,h,x,A,y,t,v,F,g,T,Q,
K;return f.__generator(this,function(u){switch(u.label){case 0:d=this.rasterInfo;c=d.spatialReference;p=d.extent;r=e.datumTransformation;k=n.projectPoint(b,c,r);if(!p.intersects(k))return[2,{location:k,value:null}];q=0;if(!e.srcResolution)return[3,1];m=n.snapPyramid(e.srcResolution,this.rasterInfo,this.ioConfig.sampling);q=m.pyramidLevel;return[3,3];case 1:return[4,this.computeBestPyramidLevelForLocation(b,e)];case 2:q=u.sent();if(null==q)return[2,{location:k,value:null}];u.label=3;case 3:h=this.identifyPixelLocation(k,
q,null);if(null===h)return[2,{location:k,value:null}];x=h.row;A=h.col;y=h.rowOffset;t=h.colOffset;v=this.url;F=q+"/"+x+"/"+A;g=l.getBlock(v,null,F);a.isSome(g)||(g=this.fetchRawTile(q,x,A,e),l.putBlock(v,null,F,g));return[4,g];case 4:T=u.sent();if(!(T&&T.pixels&&0<T.pixels.length))return[2,{location:k,value:null}];Q=y*this.rasterInfo.storageInfo.blockHeight+t;K=!T.mask||T.mask[Q]?T.pixels.map(function(a){return a[Q]}):null;return[2,{location:k,value:K,pyramidLevel:q}]}})})};q.prototype.fetchPixels=
function(a,b,e,d){void 0===d&&(d={});return f.__awaiter(this,void 0,void 0,function(){var c,u,w,p,k,r,q,l,m,h,A,y,v,F,g,K,U,O,V,P,W,C,Y,Z,aa,ba,ca;return f.__generator(this,function(B){switch(B.label){case 0:c=a.clone().normalize();a=c[0];u=this.rasterInfo.spatialReference;w=!a.spatialReference.equals(u);p=d.datumTransformation;k=new t.Point({x:(a.xmax-a.xmin)/b,y:(a.ymax-a.ymin)/e,spatialReference:a.spatialReference});r=d.srcResolution||(w?n.projectResolution(k,u,a,p):k);if(!r)return[2,null];q=n.snapPyramid(r,
this.rasterInfo,this.ioConfig.sampling);l=q.pyramidLevel;m=q.pyramidResolution;if(h=q.excessiveReading)return[2,null];A=this.rasterInfo.storageInfo;y=w?n.projectExtent(a,u,p):a;if(null==y)return[2,null];v={x:Math.floor((y.xmin-A.origin.x)/m.x+.1),y:Math.floor((A.origin.y-y.ymax)/m.y+.1)};F=Math.ceil((y.xmax-y.xmin)/m.x-.1);g=Math.ceil((y.ymax-y.ymin)/m.y-.1);return 8<F/b||8<g/e?[2,null]:[4,this.fetchRawPixels(l,v,{width:F,height:g},d)];case 1:K=B.sent();if(!K)return[2,null];U=0<l?A.pyramidBlockWidth:
A.blockWidth;O=0<l?A.pyramidBlockHeight:A.blockHeight;if(V=!w&&1===K.pixelBlocks.length&&U===b&&O===e&&r.x===k.x&&r.y===k.y)return[2,{extent:a,srcExtent:y,pixelBlock:K.pixelBlocks[0],transformGrid:null}];P=n.getProjectionOffsetGrid(a,K.extent,k,p);C=!d.requestRawData;Y={rows:P.spacing[0],cols:P.spacing[1]};Z=K.pixelBlocks;aa=K.mosaicSize;ba=K.isPartiallyFilled;return this.rasterJobHandler?[4,this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:Z,srcMosaicSize:aa,destDimension:C?{width:b,height:e}:
null,coefs:C?P.coefficients:null,sampleSpacing:C?Y:null},d)]:[3,3];case 2:return W=B.sent(),[3,4];case 3:ca=x.mosaic(Z,aa),W=C?x.approximateTransform(ca,{width:b,height:e},P.coefficients,Y):ca,B.label=4;case 4:return[2,{srcExtent:y,pixelBlock:W,transformGrid:P,extent:a,isPartiallyFilled:ba}]}})})};q.prototype.fetchRawPixels=function(a,e,d,c){return f.__awaiter(this,void 0,void 0,function(){var u,w,p,n,k,r,q,l,m,h,x,A,y,v,F,g,U,O,V,P,C,X,Y,Z,aa,ba,ca;return f.__generator(this,function(B){switch(B.label){case 0:u=
this.rasterInfo.storageInfo;w=u.origin;p=u.blockBoundary;n=0<a?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth;k=0<a?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight;r=Math.floor(e.x/n);q=Math.floor(e.y/k);l=Math.floor((e.x+d.width-1)/n);m=Math.floor((e.y+d.height-1)/k);h=this.rasterInfo;x=h.pixelSize;A=h.spatialReference;y=p[a];if(!y)return[2,null];v=y.minRow;F=y.minCol;g=y.maxCol;U=y.maxRow;if(m<v||l<F||q>U||r>g)return[2,
null];O=[];P=!1;for(C=q;C<=m;C++)for(X=r;X<=l;X++)C>=v&&X>=F&&U>=C&&g>=X?(V=this._fetchRawTile(a,C,X,c),this.ioConfig.allowPartialFill&&(V=b.create(function(a){V.then(function(b){return a(b)}).catch(function(){P=!0;a(null)})})),O.push(V)):O.push(null);return 0===O.length?[2,null]:[4,b.all(O)];case 1:return Y=B.sent(),Z={height:(m-q+1)*n,width:(l-r+1)*k},aa=x.x*Math.pow(2,a),ba=x.y*Math.pow(2,a),ca=new t.Extent({xmin:w.x+r*n*aa,xmax:w.x+(l+1)*n*aa,ymin:w.y-(m+1)*k*ba,ymax:w.y-q*k*ba,spatialReference:A}),
[2,{extent:ca,pixelBlocks:Y,mosaicSize:Z,isPartiallyFilled:P}]}})})};q.prototype.fetchRawTile=function(a,b,e,d){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(a){throw new h("BaseRaster:read-not-implemented","fetchRawTile() is not implemented");})})};q.prototype.computeExtent=function(a){return n.projectExtent(this.rasterInfo.extent,a)};q.prototype.decodePixelBlock=function(a,b){return this.rasterJobHandler?this.rasterJobHandler.decode({data:a,options:b}):k.decode(a,
b)};q.prototype.request=function(a,b){return f.__awaiter(this,void 0,void 0,function(){var e,d,p,n,k,r,q,l;return f.__generator(this,function(u){switch(u.label){case 0:e=this.ioConfig.customFetchParameters,d=a.url,p=a.range,n=a.query,k=a.responseType,null==a.retryCount&&this.ioConfig.retryCount&&(a.retryCount=this.ioConfig.retryCount),r=p?{Range:"bytes\x3d"+p.from+"-"+p.to}:null,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,c(d,{query:f.__assign(f.__assign({},n),e),headers:r,responseType:k,signal:b})];
case 2:return q=u.sent().data,[2,q];case 3:l=u.sent();if(0<a.retryCount)return a.retryCount--,[2,this.request(a,b)];throw l;case 4:return[2]}})})};q.prototype.getSliceIndex=function(a){var b=this.rasterInfo.multidimensionalInfo;if(!b||0===a.length)return null;for(var e=0,d=a[0].variableName,c=function(c){c=b.variables[c];var u=c.dimensions;if(c.name!==d)return e+=u.map(function(a){return a.values.length}).reduce(function(a,b){return a+b}),"break";var p=u.map(function(a){return a.values.length}),w=
u.length;c=function(b){var d=a.filter(function(a){return a.dimensionName===u[b].name})[0];if(null==d)return{value:null};d=Array.isArray(d.values[0])?d.values[0][0]:d.values[0];d=u[b].values.indexOf(d);if(-1===d)return{value:null};p.shift();e=b===w-1?e+d:e+d*p.reduce(function(a,b){return a+b})};for(var n=0;n<w;n++){var k=c(n);if("object"===typeof k)return k}},p=0;p<b.variables.length;p++){var n=c(p);if("object"===typeof n)return n.value;if("break"===n)break}return e};q.prototype.computeBestPyramidLevelForLocation=
function(a,b){void 0===b&&(b={});return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(a){return[2,0]})})};q.prototype.identifyPixelLocation=function(a,b,e){var d=this.rasterInfo,c=d.pixelSize,p=d.extent,w=this.rasterInfo.storageInfo,k=w.blockWidth,r=w.blockHeight,q=w.maximumPyramidLevel,l=w.pyramidScalingFactor,w=w.origin;a=n.projectPoint(a,d.spatialReference,e);if(!p.intersects(a)||0>b||b>q)return null;q=Math.pow(l,b);p=(w.y-a.y)/(q*c.y)/r;c=(a.x-w.x)/(q*c.x)/k;return{pyramidLevel:b,
row:Math.floor(p),col:Math.floor(c),rowOffset:Math.min(r-1,Math.floor((p-Math.floor(p))*r)),colOffset:Math.min(k-1,Math.floor((c-Math.floor(c))*k)),srcLocation:a}};q.prototype._getTileExtent=function(a,b,e,d){var c=d.origin,u=d.size[0],p=d.size[1];e=c.x+e*u*a.x;b=c.y-b*p*a.y;return new t.Extent({xmin:e,xmax:e+u*a.x,ymin:b-p*a.y,ymax:b,spatialReference:d.spatialReference})};q.prototype._fetchRawTile=function(e,d,c,u){var p=this.url,w=e+"/"+d+"/"+c,n=l.getBlock(p,u.registryId,w);if(!a.isSome(n)){var k=
b.createAbortController(),n=this.fetchRawTile(e,d,c,f.__assign(f.__assign({},u),{signal:k.signal}));l.putBlock(p,u.registryId,w,n,k);n.catch(function(){l.deleteBlock(p,u.registryId,w)})}if(u.signal)b.onAbort(u,function(){l.decreaseRefCount(p,u.registryId,w)});return n};f.__decorate([d.property(A.url)],q.prototype,"url",null);f.__decorate([d.property({type:String,json:{write:!0}})],q.prototype,"datasetName",void 0);f.__decorate([d.property({type:String,json:{write:!0}})],q.prototype,"datasetFormat",
void 0);f.__decorate([d.property()],q.prototype,"rasterInfo",void 0);f.__decorate([d.property()],q.prototype,"ioConfig",void 0);f.__decorate([d.property()],q.prototype,"sourceJSON",void 0);return q=f.__decorate([d.subclass("esri.layers.support.rasterDatasets.BaseRaster")],q)}(e.EsriPromiseMixin(m.JSONSupport))})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define(["require","exports","../../../geometry","./EphemeralBlockCache","../rasterFunctions/rasterProjectionHelper"],function(C,
g,f,t,c){function h(a,b){if(!m.has(a))return null;a=m.get(a);return null==a[b]?null:a[b]}Object.defineProperty(g,"__esModule",{value:!0});var m=new Map,a=new t;g.register=function(a,b){b={extent:null,rasterInfo:b,cache:new Map};if(m.has(a))return a=m.get(a),a.push(b),a.length-1;m.set(a,[b]);return 0};g.unregister=function(a,b){m.has(a)&&(m.get(a)[b]=null)};g.deleteRaster=function(a){m.delete(a)};g.decreaseRefCount=function(e,b,c){if(!m.has(e))return null==b?a.decreaseRefCount(e,c):0;var d=m.get(e);
if(null==d[b])return a.decreaseRefCount(e,c);b=d[b].cache;if(b.has(c)){e=b.get(c);e.refCount--;if(0===e.refCount){b.delete(c);for(b=0;b<d.length;b++)d[b]&&d[b].cache.has(c)&&d[b].cache.delete(c);e.controller&&e.controller.abort()}return e.refCount}return 0};g.getBlock=function(e,b,c){if(!m.has(e))return null==b?a.getBlock(e,c):null;var d=m.get(e);if(null==d[b]){for(var p=0;p<d.length;p++)if(d[p]&&d[p].cache.has(c))return c=d[p].cache.get(c),c.refCount++,c.block;return a.getBlock(e,c)}e=d[b].cache;
if(e.has(c))return c=e.get(c),c.refCount++,c.block;for(p=0;p<d.length;p++)if(p!==b&&d[p]&&d[p]&&d[p].cache.has(c))return b=d[p].cache.get(c),b.refCount++,e.set(c,b),b.block;return null};g.putBlock=function(e,b,c,d,h){void 0===h&&(h=null);if(m.has(e)){var p=m.get(e);null==p[b]?a.putBlock(e,c,d,h):p[b].cache.set(c,{refCount:1,block:d,controller:h})}else null==b&&a.putBlock(e,c,d,h)};g.deleteBlock=function(e,b,c){if(m.has(e)){var d=m.get(e);null==d[b]?a.deleteBlock(e,c):d[b].cache.delete(c)}else null==
b&&a.deleteBlock(e,c)};g.update=function(a,b,p,d,m,y,l){void 0===l&&(l=null);a=h(a,b);b=a.extent;var e=a.cache,x=a.rasterInfo;p=p.clone().normalize()[0];if(!b||b.xmin!==p.xmin||b.xmax!==p.xmax||b.ymin!==p.ymin||b.ymax!==p.ymax){var n=x.spatialReference;b=c.projectExtent(p,n,l);d=new f.Point({x:d,y:d,spatialReference:p.spatialReference});if(null===m&&(m=c.projectResolution(d,n,p,l),!m))return;l=c.snapPyramid(m,x,y||"closest");m=l.pyramidLevel;y=l.pyramidResolution;if(!l.excessiveReading){n=Math.floor((b.xmin-
x.storageInfo.origin.x)/y.x);l=Math.floor((x.storageInfo.origin.y-b.ymax)/y.y);var q=0<m?x.storageInfo.pyramidBlockWidth:x.storageInfo.blockWidth,t=0<m?x.storageInfo.pyramidBlockHeight:x.storageInfo.blockHeight,x=Math.floor(n/q);d=Math.floor(l/t);n=Math.floor((n+Math.ceil((b.xmax-b.xmin)/y.x-.1)-1)/q);b=Math.floor((l+Math.ceil((b.ymax-b.ymin)/y.y-.1)-1)/t);var r=new Set;for(y=d-1;y<=b+1;y++)for(l=x-1;l<=n+1;l++)r.add(m+"/"+y+"/"+l);e.forEach(function(a,b){r.has(b)||e.delete(b)});a.extent={xmin:p.xmin,
ymin:p.ymin,xmax:p.xmax,ymax:p.ymax}}}}})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(["require","exports","../../../core/MapUtils"],function(C,g,f){return function(){function t(c,h){void 0===c&&(c=15E3);void 0===h&&(h=5E3);this._timer=null;this._cachedBlocks=new Map;this._size=-1;this._duration=c;this._interval=Math.min(c,h)}t.prototype.decreaseRefCount=function(c,h){c=c+"/"+h;h=this._cachedBlocks;if(h.has(c)){var m=h.get(c);m.refCount--;0>=m.refCount&&(h.delete(c),
m.controller&&m.controller.abort());return m.refCount}return 0};t.prototype.getBlock=function(c,h){c=c+"/"+h;h=this._cachedBlocks;if(h.has(c)){var m=h.get(c);m.ts=Date.now();m.refCount++;h.delete(c);h.set(c,m);return m.block}return null};t.prototype.putBlock=function(c,h,m,a){void 0===a&&(a=null);var e=this._cachedBlocks;c=c+"/"+h;e.has(c)?(m=e.get(c),m.ts=Date.now(),m.refCount++):e.set(c,{block:m,ts:Date.now(),refCount:1,controller:a});this.trim();this.updateTimer()};t.prototype.deleteBlock=function(c,
h){var m=this._cachedBlocks;c=c+"/"+h;m.has(c)&&m.delete(c)};t.prototype.updateMaxSize=function(c){this._size=c;this.trim()};t.prototype.empty=function(){this._cachedBlocks.clear();this.clearTimer()};t.prototype.getCurrentSize=function(){return this._cachedBlocks.size};t.prototype.updateTimer=function(){var c=this;if(null==this._timer){var h=this._cachedBlocks;this._timer=setInterval(function(){for(var m=f.pairsOfMap(h),a=Date.now(),e=0;e<m.length;e++)if(m[e][1].ts<=a-c._duration)h.delete(m[e][0]);
else break;0===h.size&&c.clearTimer()},this._interval)}};t.prototype.trim=function(){var c=this._cachedBlocks;if(!(-1===this._size||this._size>=c.size))for(var h=f.pairsOfMap(c),m=0;m<h.length-this._size;m++)c.delete(h[m][0])};t.prototype.clearTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};return t}()})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("require exports tslib ../../../geometry ../../../core/Error ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(C,g,f,t,c,h,m,a){Object.defineProperty(g,"__esModule",{value:!0});var e=function(a,e){var b=(a.isWGS84||a.isWebMercator)&&(e.isWGS84||e.isWebMercator);return!(a.equals(e)||b)};g.defaultGridSpacing=32;g.load=function(){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(a){switch(a.label){case 0:return h.isLoaded()||!h.isSupported()?[2,null]:[4,h.load()];case 1:return a.sent(),[2]}})})};g.projectResolution=function(b,p,d,m){void 0===m&&(m=null);if(b.spatialReference.equals(p))return b;
var y=e(b.spatialReference,p);if(y&&!h.isLoaded())throw new c("rasterprojectionhelper-projectResolution","projection engine is not loaded");d=d.center;b=new t.Extent({xmin:d.x-b.x/2,xmax:d.x+b.x/2,ymin:d.y-b.y/2,ymax:d.y+b.y/2,spatialReference:b.spatialReference});m=y?h.project(b,p,m):a.project(b,p);return null==m?null:new t.Point(m.xmax-m.xmin,m.ymax-m.ymin,p)};g.projectPoint=function(b,p,d){void 0===d&&(d=null);if(b.spatialReference.equals(p))return b;var m=e(b.spatialReference,p);if(m&&!h.isLoaded())throw new c("rasterprojectionhelper-projectResolution",
"projection engine is not loaded");return m?h.project(b,p,d):a.project(b,p)};g.projectExtent=function(b,p,d){void 0===d&&(d=null);if(b.spatialReference.equals(p))return b;var m=e(b.spatialReference,p);if(m&&!h.isLoaded())throw new c("rasterprojectionhelper-projectExtent","projection engine is not loaded");return m?h.project(b,p,d):a.project(b,p)};g.getProjectionOffsetGrid=function(b,p,d,f,y,l){void 0===f&&(f=null);void 0===y&&(y=!1);void 0===l&&(l=[g.defaultGridSpacing,g.defaultGridSpacing]);var k=
p.spatialReference.equals(b.spatialReference),x=e(b.spatialReference,p.spatialReference);if(x&&!h.isLoaded())throw new c("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(b&&p&&d))return null;var n=b.xmin,q=b.ymin,v=b.xmax,r=b.ymax,A=b.spatialReference,w=p.spatialReference,u=m.getInfo(A),B=u&&u.valid[0],z=u&&u.valid[1],D=l[0]*d.x,E=l[1]*d.y,v=Math.ceil((v-n)/D-.1)+1,q=Math.ceil((r-q)/E-.1)+1,J;d=[];var H;b=!1;for(var M=0;M<v;M++){for(var I=[],G=0;G<q;G++)J=new t.Point({x:n+
D*M,y:r-E*G,spatialReference:A}),J=k?J:x?h.project(J,w,f):a.project(J,w),I.push(J),0<M&&y&&J&&H[G]&&u&&J.x<H[G].x&&(J.x+=z-B),J?(d.push((J.x-p.xmin)/(p.xmax-p.xmin)),d.push((p.ymax-J.y)/(p.ymax-p.ymin))):(d.push(NaN),d.push(NaN),b=!0);H=I}p=[Math.abs((d[0]+d[4]+d[4*v]+d[4*v+4])/4-d[2*q+2]),Math.abs((d[1]+d[5]+d[4*q+1]+d[4*q+5])/4-d[2*q+3])];f=new Float32Array((v-1)*(q-1)*12);y=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]);k=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(M=0;M<v-1;M++){for(G=0;G<q-1;G++){B=
M*q*2+2*G;x=d[B];n=d[B+1];r=d[B+2];H=d[B+3];B+=2*q;A=d[B];w=d[B+1];u=d[B+2];B=d[B+3];z=0;D=12*(G*(v-1)+M);for(E=0;3>E;E++)f[D++]=y[z++]*x+y[z++]*r+y[z++]*u;for(E=z=0;3>E;E++)f[D++]=y[z++]*n+y[z++]*H+y[z++]*B;for(E=z=0;3>E;E++)f[D++]=k[z++]*x+k[z++]*A+k[z++]*u;for(E=z=0;3>E;E++)f[D++]=k[z++]*n+k[z++]*w+k[z++]*B}if(b)for(G=0;G<f.length;G++)isNaN(f[G])&&(f[G]=-1)}return{offsets:d,error:p,coefficients:f,spacing:l,size:[v-1,q-1]}};g.snapPyramid=function(a,e,d){var b=Math.log(a.x/e.pixelSize.x)/Math.LN2,
c=Math.log(a.y/e.pixelSize.y)/Math.LN2;a=e.storageInfo.maximumPyramidLevel||0;d="down"===d?Math.floor(Math.min(b,c)):"up"===d?Math.ceil(Math.max(b,c)):Math.round((b+c)/2);b=!1;0>d?d=0:d>a&&(b=d>a+3,d=a);a=Math.pow(2,d);e=new t.Point({x:a*e.pixelSize.x,y:a*e.pixelSize.y,spatialReference:e.spatialReference});return{pyramidLevel:d,pyramidResolution:e,excessiveReading:b}}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),
function(C,g,f,t,c){function h(b,e,h,l,k){void 0===k&&(k=null);if(null===k){var d=c.cacheKey(h,l);void 0!==p[d]?k=p[d]:(k=m(h,l,null),null===k&&(k=new c),p[d]=k)}return a._project(b,e,h,l,k)}function m(b,p,m){void 0===m&&(m=null);b=a._getTransformation(e,b,p,m,null===m||void 0===m?void 0:m.spatialReference);return null!==b?c.fromGE(b):null}Object.defineProperty(g,"__esModule",{value:!0});var a=null,e=null;g.isLoaded=function(){return!!a&&t.isLoaded()};g.isSupported=function(){return t.isSupported()};
var b=null;g.load=function(){return b?b:b=f.all([t.load(),new Promise(function(a,b){C(["./geometryEngineBase"],a,b)}),new Promise(function(a,b){C(["./geometryAdapters/hydrated"],a,b)})]).then(function(b){var d=b[1];e=b[2].hydratedAdapter;a=d;a._enableProjection(t)})};g.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:h(e,a,a[0].spatialReference,b,c):h(e,[a],a.spatialReference,b,c)[0]};var p={};g.projectMany=h;g.getTransformation=m;g.getTransformations=function(b,
p,m){void 0===m&&(m=null);b=a._getTransformationBySuitability(e,b,p,m,null===m||void 0===m?void 0:m.spatialReference);if(null!==b){p=[];for(m=0;m<b.length;m++)p.push(c.fromGE(b[m]));return p}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(C,g,f,t,c,h){function m(a){function b(a,b,e){a[b]=e(a[b])}g._pe=a;A.init();y.init();l.init();k.init();x.init();g.PeGCSExtent=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}f.__extends(b,a);b.prototype.destroy=function(){g._pe.destroy(this)};return b}(g._pe.PeGCSExtent);for(var e=0,d=[g._pe.PeDatum,g._pe.PeGeogcs,g._pe.PeGeogtran,g._pe.PeObject,g._pe.PeParameter,g._pe.PePrimem,g._pe.PeProjcs,g._pe.PeSpheroid,g._pe.PeUnit];e<d.length;e++)a=d[e],b(a.prototype,"getName",function(a){return function(){return a.call(this,Array(A.PE_NAME_MAX))}});e=0;for(d=[g._pe.PeGeogtran,g._pe.PeProjcs];e<d.length;e++)a=d[e],b(a.prototype,"getParameters",
function(a){return function(){for(var b=Array(A.PE_PARM_MAX),e=a.call(this),d=0;d<b.length;d++){var c=g._pe.getValue(e,"*");b[d]=c?g._pe.wrapPointer(c,g._pe.PeParameter):null;e+=Int32Array.BYTES_PER_ELEMENT}return b}});b(g._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var e=[],d=a.call(this);p(e,b,d);return e}});b(g._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(a){var b=g._pe._pe_getPeGTlistExtendedGTsSize();return function(){var e=
null,d=a.call(this);if(!g._pe.compare(d,g._pe.NULL)){var e=[d],c=this.getSteps();if(1<c)for(var d=g._pe.getPointer(d),u=1;u<c;u++)e.push(g._pe.wrapPointer(d+b*u,g._pe.PeGTlistExtendedGTs))}return e}});var c=g._pe._pe_getPeHorizonSize();a=function(a){return function(){var b=this._cache;b||(this._cache=b=new Map);if(b.has(a))return b.get(a);var e=null,d=a.call(this);if(!g._pe.compare(d,g._pe.NULL)){var e=[d],p=d.getNump();if(1<p)for(var d=g._pe.getPointer(d),n=1;n<p;n++)e.push(g._pe.wrapPointer(d+c*
n,g._pe.PeHorizon))}b.set(a,e);return e}};b(g._pe.PeProjcs.prototype,"horizonGcsGenerate",a);b(g._pe.PeProjcs.prototype,"horizonPcsGenerate",a);g._pe.PeObject.prototype.toString=function(a){void 0===a&&(a=A.PE_STR_OPTS_NONE);g._pe.ensureCache.prepare();var b=g._pe.getPointer(this),e=g._pe.ensureInt8(Array(A.PE_BUFFER_MAX));return g._pe.UTF8ToString(g._pe._pe_object_to_string_ext(b,a,e))}}function a(a){if(a){var b=g._pe.getClass(a);b&&(b=g._pe.getCache(b))&&(a=g._pe.getPointer(a))&&delete b[a]}}function e(a,
b){var e=[];b=Array(b);for(var d=0;d<a;d++)e.push(g._pe.ensureInt8(b));return e}function b(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function p(a,b,e,d){void 0===d&&(d=!1);if(d)for(d=0;d<2*b;d++)a[d]=g._pe.getValue(e+d*Float64Array.BYTES_PER_ELEMENT,"double");else{var c=0===a.length;for(d=0;d<b;d++)c&&(a[d]=Array(2)),a[d][0]=g._pe.getValue(e,"double"),a[d][1]=g._pe.getValue(e+Float64Array.BYTES_PER_ELEMENT,"double"),e+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(g,"__esModule",{value:!0});var d;g._pe=null;g.isLoaded=function(){return!!g._pe};g.isSupported=function(){return!!c("esri-wasm")};g.load=function(){return d?d:d=h.create(function(a,b){(new Promise(function(a,b){C(["./support/pe-wasm"],a,b)})).then(function(e){e({locateFile:function(a){return t.getAssetUrl("esri/geometry/support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){m(b);a()})})})};(function(a){function e(a,e,d){g._pe.ensureCache.prepare();var c=b(d),u=d===
c,c=g._pe.ensureFloat64(c);(a=g._pe._pe_geog_to_proj(g._pe.getPointer(a),e,c))&&p(d,e,c,u);return a}function d(a,b,e){return c(a,b,e,0)}function c(a,e,d,c){g._pe.ensureCache.prepare();var u=b(d),k=d===u,u=g._pe.ensureFloat64(u);(a=g._pe._pe_proj_to_geog_center(g._pe.getPointer(a),e,u,c))&&p(d,e,u,k);return a}a.geogToProj=e;a.projGeog=function(a,b,c,p){switch(p){case A.PE_TRANSFORM_P_TO_G:return d(a,b,c);case A.PE_TRANSFORM_G_TO_P:return e(a,b,c)}return 0};a.projToGeog=d;a.projToGeogCenter=c})(g.PeCSTransformations||
(g.PeCSTransformations={}));var A;(function(a){a.init=function(){a.PE_BUFFER_MAX=g._pe.PeDefs.prototype.PE_BUFFER_MAX;a.PE_NAME_MAX=g._pe.PeDefs.prototype.PE_NAME_MAX;a.PE_MGRS_MAX=g._pe.PeDefs.prototype.PE_MGRS_MAX;a.PE_USNG_MAX=g._pe.PeDefs.prototype.PE_USNG_MAX;a.PE_DD_MAX=g._pe.PeDefs.prototype.PE_DD_MAX;a.PE_DDM_MAX=g._pe.PeDefs.prototype.PE_DDM_MAX;a.PE_DMS_MAX=g._pe.PeDefs.prototype.PE_DMS_MAX;a.PE_UTM_MAX=g._pe.PeDefs.prototype.PE_UTM_MAX;a.PE_PARM_MAX=g._pe.PeDefs.prototype.PE_PARM_MAX;a.PE_TYPE_NONE=
g._pe.PeDefs.prototype.PE_TYPE_NONE;a.PE_TYPE_GEOGCS=g._pe.PeDefs.prototype.PE_TYPE_GEOGCS;a.PE_TYPE_PROJCS=g._pe.PeDefs.prototype.PE_TYPE_PROJCS;a.PE_TYPE_GEOGTRAN=g._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;a.PE_TYPE_COORDSYS=g._pe.PeDefs.prototype.PE_TYPE_COORDSYS;a.PE_TYPE_UNIT=g._pe.PeDefs.prototype.PE_TYPE_UNIT;a.PE_STR_OPTS_NONE=g._pe.PeDefs.prototype.PE_STR_OPTS_NONE;a.PE_STR_AUTH_NONE=g._pe.PeDefs.prototype.PE_STR_AUTH_NONE;a.PE_STR_AUTH_TOP=g._pe.PeDefs.prototype.PE_STR_AUTH_TOP;a.PE_STR_NAME_CANON=
g._pe.PeDefs.prototype.PE_STR_NAME_CANON;a.PE_PARM_X0=g._pe.PeDefs.prototype.PE_PARM_X0;a.PE_PARM_ND=g._pe.PeDefs.prototype.PE_PARM_ND;a.PE_TRANSFORM_1_TO_2=g._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;a.PE_TRANSFORM_2_TO_1=g._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;a.PE_TRANSFORM_P_TO_G=g._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;a.PE_TRANSFORM_G_TO_P=g._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;a.PE_HORIZON_RECT=g._pe.PeDefs.prototype.PE_HORIZON_RECT;a.PE_HORIZON_POLY=g._pe.PeDefs.prototype.PE_HORIZON_POLY;
a.PE_HORIZON_LINE=g._pe.PeDefs.prototype.PE_HORIZON_LINE;a.PE_HORIZON_DELTA=g._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(A=g.PeDefs||(g.PeDefs={}));(function(a){function b(a,b){var c=null,p=d[a];p||(p={},d[a]=p);p.hasOwnProperty(String(b))?c=p[b]:(a=g._pe.PeFactory.prototype.factoryByType(a,b),g._pe.compare(a,g._pe.NULL)||(c=a,p[b]=c));return c=e(c)}function e(a){if(a){var b=a.getType();switch(b){case A.PE_TYPE_GEOGCS:a=g._pe.castObject(a,g._pe.PeGeogcs);break;case A.PE_TYPE_PROJCS:a=g._pe.castObject(a,
g._pe.PeProjcs);break;case A.PE_TYPE_GEOGTRAN:a=g._pe.castObject(a,g._pe.PeGeogtran);break;default:b&A.PE_TYPE_UNIT&&(a=g._pe.castObject(a,g._pe.PeUnit))}}return a}var d={},c={};a.initialize=function(){g._pe.PeFactory.prototype.initialize(null)};a.coordsys=function(a){return b(A.PE_TYPE_COORDSYS,a)};a.factoryByType=b;a.fromString=function(a,b){var d=null,p=c[a];p||(p={},c[a]=p);p.hasOwnProperty(b)?d=p[b]:(a=g._pe.PeFactory.prototype.fromString(a,b),g._pe.compare(a,g._pe.NULL)||(d=a,p[b]=d));return d=
e(d)};a.geogcs=function(a){return b(A.PE_TYPE_GEOGCS,a)};a.geogtran=function(a){return b(A.PE_TYPE_GEOGTRAN,a)};a.getCode=function(a){return g._pe.PeFactory.prototype.getCode(a)};a.projcs=function(a){return b(A.PE_TYPE_PROJCS,a)};a.unit=function(a){return b(A.PE_TYPE_UNIT,a)}})(g.PeFactory||(g.PeFactory={}));g.PeGCSExtent=null;var y;(function(a){var b;a.init=function(){a.PE_GTLIST_OPTS_COMMON=g._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;b=g._pe._pe_getPeGTlistExtendedEntrySize()};a.getGTlist=
function(a,e,d,c,p,k){var u=null,w=new g._pe.PeInteger(k);try{var n=g._pe.PeGTlistExtended.prototype.getGTlist(a,e,d,c,p,w);if(k=w.val)if(u=[n],1<k){var m=g._pe.getPointer(n);for(a=1;a<k;a++)u.push(g._pe.wrapPointer(m+b*a,g._pe.PeGTlistExtendedEntry))}}finally{g._pe.destroy(w)}return u}})(y=g.PeGTlistExtended||(g.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var e=0;e<b.length;e++){var d=b[e];a(d);d.getEntries().forEach(function(b){a(b);b=b.getGeogtran();a(b);b.getParameters().forEach(a);
[b.getGeogcs1(),b.getGeogcs2()].forEach(function(b){a(b);var e=b.getDatum();a(e);a(e.getSpheroid());a(b.getPrimem());a(b.getUnit())})})}g._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(g.PeGTlistExtendedEntry||(g.PeGTlistExtendedEntry={}));(function(a){a.geogToGeog=function(a,e,d,c,k){g._pe.ensureCache.prepare();var u=b(d),w=d===u,u=g._pe.ensureFloat64(u),n=0;c&&(n=g._pe.ensureFloat64(c));(a=g._pe._pe_geog_to_geog(g._pe.getPointer(a),e,u,n,k))&&p(d,e,u,w);return a}})(g.PeGTTransformations||
(g.PeGTTransformations={}));(function(a){function d(a,d,c,p,k,n){g._pe.ensureCache.prepare();var u,w;switch(a){case "dd":u=g._pe._pe_geog_to_dd;w=A.PE_DD_MAX;break;case "ddm":u=g._pe._pe_geog_to_ddm;w=A.PE_DDM_MAX;break;case "dms":u=g._pe._pe_geog_to_dms,w=A.PE_DMS_MAX}a=0;d&&(a=g._pe.getPointer(d));d=b(p);d=g._pe.ensureFloat64(d);w=e(c,w);p=g._pe.ensureInt32(w);if(k=u(a,c,d,k,p))for(u=0;u<c;u++)n[u]=g._pe.UTF8ToString(w[u]);return k}function c(a,b,e,d,c){g._pe.ensureCache.prepare();var k;switch(a){case "dd":k=
g._pe._pe_dd_to_geog;break;case "ddm":k=g._pe._pe_ddm_to_geog;break;case "dms":k=g._pe._pe_dms_to_geog}a=0;b&&(a=g._pe.getPointer(b));b=d.map(function(a){return g._pe.ensureString(a)});d=g._pe.ensureInt32(b);b=g._pe.ensureFloat64(Array(2*e));(k=k(a,e,d,b))&&p(c,e,b);return k}a.geog_to_dms=function(a,b,e,c,p){return d("dms",a,b,e,c,p)};a.dms_to_geog=function(a,b,e,d){return c("dms",a,b,e,d)};a.geog_to_ddm=function(a,b,e,c,p){return d("ddm",a,b,e,c,p)};a.ddm_to_geog=function(a,b,e,d){return c("ddm",
a,b,e,d)};a.geog_to_dd=function(a,b,e,c,p){return d("dd",a,b,e,c,p)};a.dd_to_geog=function(a,b,e,d){return c("dd",a,b,e,d)}})(g.PeNotationDms||(g.PeNotationDms={}));var l;(function(a){a.init=function(){a.PE_MGRS_STYLE_NEW=g._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;a.PE_MGRS_STYLE_OLD=g._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;a.PE_MGRS_STYLE_AUTO=g._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;a.PE_MGRS_180_ZONE_1_PLUS=g._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;a.PE_MGRS_ADD_SPACES=
g._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};a.geog_to_mgrs_extended=function(a,d,c,p,k,u,n){g._pe.ensureCache.prepare();var w=0;a&&(w=g._pe.getPointer(a));a=b(c);c=g._pe.ensureFloat64(a);a=e(d,A.PE_MGRS_MAX);var m=g._pe.ensureInt32(a);if(p=g._pe._pe_geog_to_mgrs_extended(w,d,c,p,k,u,m))for(k=0;k<d;k++)n[k]=g._pe.UTF8ToString(a[k]);return p};a.mgrs_to_geog_extended=function(a,b,e,d,c){g._pe.ensureCache.prepare();var k=0;a&&(k=g._pe.getPointer(a));a=e.map(function(a){return g._pe.ensureString(a)});
e=g._pe.ensureInt32(a);a=g._pe.ensureFloat64(Array(2*b));(d=g._pe._pe_mgrs_to_geog_extended(k,b,e,d,a))&&p(c,b,a);return d}})(l=g.PeNotationMgrs||(g.PeNotationMgrs={}));(function(a){a.geog_to_usng=function(a,d,c,p,k,u,n){g._pe.ensureCache.prepare();var m=0;a&&(m=g._pe.getPointer(a));a=b(c);c=g._pe.ensureFloat64(a);a=e(d,A.PE_MGRS_MAX);var w=g._pe.ensureInt32(a);if(p=g._pe._pe_geog_to_usng(m,d,c,p,k,u,w))for(k=0;k<d;k++)n[k]=g._pe.UTF8ToString(a[k]);return p};a.usng_to_geog=function(a,b,e,d){g._pe.ensureCache.prepare();
var c=0;a&&(c=g._pe.getPointer(a));a=e.map(function(a){return g._pe.ensureString(a)});e=g._pe.ensureInt32(a);a=g._pe.ensureFloat64(Array(2*b));(c=g._pe._pe_usng_to_geog(c,b,e,a))&&p(d,b,a);return c}})(g.PeNotationUsng||(g.PeNotationUsng={}));var k;(function(a){a.init=function(){a.PE_UTM_OPTS_NONE=g._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;a.PE_UTM_OPTS_ADD_SPACES=g._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;a.PE_UTM_OPTS_NS=g._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};a.geog_to_utm=function(a,
d,c,p,k){g._pe.ensureCache.prepare();var u=0;a&&(u=g._pe.getPointer(a));a=b(c);c=g._pe.ensureFloat64(a);a=e(d,A.PE_UTM_MAX);var m=g._pe.ensureInt32(a);if(p=g._pe._pe_geog_to_utm(u,d,c,p,m))for(u=0;u<d;u++)k[u]=g._pe.UTF8ToString(a[u]);return p};a.utm_to_geog=function(a,b,e,d,c){g._pe.ensureCache.prepare();var k=0;a&&(k=g._pe.getPointer(a));a=e.map(function(a){return g._pe.ensureString(a)});e=g._pe.ensureInt32(a);a=g._pe.ensureFloat64(Array(2*b));(d=g._pe._pe_utm_to_geog(k,b,e,d,a))&&p(c,b,a);return d}})(k=
g.PeNotationUtm||(g.PeNotationUtm={}));var x;(function(a){var b=new Map;a.init=function(){a.PE_PCSINFO_OPTION_NONE=g._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;a.PE_PCSINFO_OPTION_DOMAIN=g._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;a.PE_POLE_OUTSIDE_BOUNDARY=g._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;a.PE_POLE_POINT=g._pe.PePCSInfo.prototype.PE_POLE_POINT};a.generate=function(e,d){void 0===d&&(d=a.PE_PCSINFO_OPTION_DOMAIN);var c,p;b.has(e)&&(p=b.get(e),p[d]&&(c=p[d]));c||(c=g._pe.PePCSInfo.prototype.generate(e,
d),p||(p=[],b.set(e,p)),p[d]=c);return c}})(x=g.PePCSInfo||(g.PePCSInfo={}));(function(a){a.version_string=function(){return g._pe.PeVersion.prototype.version_string()}})(g.PeVersion||(g.PeVersion={}));g._init=m})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(C,g,f){return function(){function t(c){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(c&&c.steps){var h=0;for(c=c.steps;h<
c.length;h++){var m=c[h];m instanceof f?this.steps.push(m):this.steps.push(new f({wkid:m.wkid,wkt:m.wkt,isInverse:m.isInverse}))}}}t.cacheKey=function(c,h){return[void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():"",void 0!==h.wkid&&null!==h.wkid?h.wkid.toString():"-1",void 0!==h.wkt&&null!==h.wkt?h.wkt.toString():""].join()};t.fromGE=function(c){var h=new t,m="",a=0;for(c=c.steps;a<c.length;a++){var e=f.fromGE(c[a]);h.steps.push(e);m+=e.uid.toString()+
","}h._cached_projection={};h._gtlistentry=null;h._chain=m;return h};t.prototype.getInverse=function(){var c=new t;c.steps=[];for(var h=this.steps.length-1;0<=h;h--)c.steps.push(this.steps[h].getInverse());return c};t.prototype.getGTListEntry=function(){for(var c="",h=0,m=this.steps;h<m.length;h++)c+=m[h].uid.toString()+",";c!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=c);return this._gtlistentry};t.prototype.assignCachedGe=function(c,h,m){this._cached_projection[t.cacheKey(c,
h)]=m};t.prototype.getCachedGeTransformation=function(c,h){for(var m="",a=0,e=this.steps;a<e.length;a++)m+=e[a].uid.toString()+",";m!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=m);c=this._cached_projection[t.cacheKey(c,h)];return void 0===c?null:c};return t}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(C,g){var f=0;return function(){function t(c){void 0===c&&(c=null);this.uid=f++;c?(this._wkt=void 0!==
c.wkt?c.wkt:null,this._wkid=void 0!==c.wkid?c.wkid:-1,this._isInverse=void 0!==c.isInverse?!0===c.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}t.fromGE=function(c){var h=new t;h._wkt=c.wkt;h._wkid=c.wkid;h._isInverse=c.isInverse;return h};Object.defineProperty(t.prototype,"wkt",{get:function(){return this._wkt},set:function(c){this._wkt=c;this.uid=f++},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"wkid",{get:function(){return this._wkid},set:function(c){this._wkid=
c;this.uid=f++},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isInverse",{get:function(){return this._isInverse},set:function(c){this._isInverse=c;this.uid=f++},enumerable:!0,configurable:!0});t.prototype.getInverse=function(){var c=new t;c._wkt=this.wkt;c._wkid=this._wkid;c._isInverse=!this.isInverse;return c};return t}()})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("require exports tslib ../../../core/Error ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc2Codec ./LercCodec ./Png ./Raw ./TiffDecoder".split(" "),
function(C,g,f,t,c,h,m,a,e,b,p,d){function A(a,b){if(!F)throw new t("rasterCoded:decode","lerc decoder is not supported on big endian platform");var d=b.width,p=b.height,k=b.pixelType,u=r(k),m=u.pixelTypeCtor;b=null==b.noDataValue?u.noDataValue:b.noDataValue;for(var u=0,l,n=0,w,q=a.byteLength-10;n<q;){var h=e.decode(a,{inputOffset:n,encodedMaskData:l,returnMask:0===u?!0:!1,returnEncodedMask:0===u?!0:!1,returnFileInfo:!0,pixelType:m,noDataValue:b});if(d&&p&&(h.width!==d||h.height!==p))throw new t("rasterCoded:decode",
"lerc decoded result has width or height different from specified in options");n=h.fileInfo.eofOffset;0===u&&(l=h.encodedMaskData,w=new c({width:h.width,height:h.height,pixels:[],pixelType:k,mask:h.maskData,statistics:[]}));u++;w.addData({pixels:h.pixelData,statistics:{minValue:h.minValue,maxValue:h.maxValue,noDataValue:h.noDataValue}});10<q-n&&(h=String.fromCharCode.apply(null,new Uint8Array(a,n,10)),n=-1<n+h.indexOf("CntZ")?h.indexOf("CntZ"):0)}return w}function y(b,e){if(!F)throw new t("rasterCoded:decode",
"lerc decoder is not supported on big endian platform");var d=0,p=0,k=0,u,m,n,l=b.byteLength-10,w=[],h=e.width;for(e=e.height;p<l;){m=a.decode(b,{inputOffset:p,maskData:u,returnFileInfo:!0});if(h&&e&&(m.width!==h||m.height!==e))throw new t("rasterCoded:decode","lerc2 decoded result has width or height different from what's specified in options");p=m.fileInfo.eofOffset;0===d&&(k=m.fileInfo.numValidPixel,u=m.maskData,n=new c({width:m.width,height:m.height,pixels:[],pixelType:m.fileInfo.pixelType,mask:m.maskData,
statistics:[]}));m.fileInfo.mask&&0<m.fileInfo.mask.numBytes&&w.push(m.maskData);d++;n.addData({pixels:m.pixelData,statistics:{minValue:m.minValue,maxValue:m.maxValue}});10<l-p&&(m=String.fromCharCode.apply(null,new Uint8Array(b,p,10)),p+=-1<m.indexOf("Lerc")?m.indexOf("Lerc"):0)}p=d=b=0;if(1<w.length){p=n.width*n.height;u=new Uint8Array(p);u.set(w[0]);for(b=1;b<w.length;b++)for(k=w[b],d=0;d<p;d++)u[d]&=k[d];for(d=k=0;d<p;d++)k+=u[d];n.mask=u}n.validPixelCount=k;return n}function l(a){a=d.decode(a);
a=new c({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType.toLowerCase(),mask:a.mask,statistics:null});a.updateStatistics();return a}function k(a){a=m.decode(a);a=new c({width:a.width,height:a.height,pixels:a.pixels,pixelType:"U8",mask:a.mask,statistics:null});a.updateStatistics();return a}function x(a,e){a=new Uint8Array(a);var d=new b(a);a=e.width;var p=e.height;e=a*p;for(var d=d.decode(),k=0,u=0,u=new Uint8Array(e),k=0;k<e;k++)u[k]=d[4*k+3];p=new c({width:a,height:p,pixels:[],
pixelType:"U8",mask:u,statistics:[]});for(k=0;3>k;k++){a=new Uint8Array(e);for(u=0;u<e;u++)a[u]=d[4*u+k];p.addData({pixels:a})}p.updateStatistics();return p}function n(a,b,e){return f.__awaiter(this,void 0,void 0,function(){var d,p,k,u;return f.__generator(this,function(m){switch(m.label){case 0:return d=new h,p=f.__assign({applyJpegMask:!1},b),[4,d.decode(a,p,e)];case 1:return k=m.sent(),u=new c(k),u.updateStatistics(),[2,u]}})})}function q(a){if(null==a)throw new t("rasterCodec:decode","parameter encodeddata is required.");
a=new Uint8Array(a,0,10);var b="";255===a[0]&&216===a[1]?b="jpg":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]?b="png":67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9]?b="lerc":76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5]?b="lerc2":73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&42===a[3]?b="tiff":-1<String.fromCharCode.apply(null,a).toLowerCase().indexOf("error")&&(b="error");return b}
function v(a){var b=null;switch(a){case "lerc":b=A;break;case "lerc2":b=y;break;case "jpg":b=k;break;case "png":b=x;break;case "bsq":case "bip":b=function(b,e){var d=r(e.pixelType).pixelTypeCtor,k=p.decode;b=k(b,{width:e.width,height:e.height,pixelType:d,format:a});e=new c({width:e.width,height:e.height,pixels:b.pixels,pixelType:e.pixelType,mask:b.mask,statistics:null});e.updateStatistics();return e};break;case "tiff":b=l;break;case "error":b=function(){throw new t("rasterCodec:decode","input data contains error");
};break;default:b=function(){throw new t("rasterCodec:decode","unsupported raster format");}}return b}function r(a){var b=null,e=null;switch(a?a.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":e=Math.pow(2,8)-1;b=Uint8Array;break;case "u16":e=e||Math.pow(2,16)-1;b=Uint16Array;break;case "u32":e=e||Math.pow(2,32)-1;b=Uint32Array;break;case "s8":e=e||0-Math.pow(2,7);b=Int8Array;break;case "s16":e=e||0-Math.pow(2,15);b=Int16Array;break;case "s32":e=e||0-Math.pow(2,31);b=Int32Array;break;
default:b=Float32Array}return{pixelTypeCtor:b,noDataValue:e}}var F=function(){var a=new ArrayBuffer(4),b=new Uint8Array(a);(new Uint32Array(a))[0]=1;return 1===b[0]}();return function(){function a(){}a.getFormat=function(a){a=q(a);"lerc2"===a?a="lerc":"error"===a&&(a="");return a};a.decode=function(a,b,e){return f.__awaiter(this,void 0,void 0,function(){var p,k,m;return f.__generator(this,function(u){switch(u.label){case 0:if(null==a)throw new t("rasterCodec:decode","missing encodeddata parameter.");
if(null==b||null==b.width||null==b.height)throw new t("rasterCodec:decode","requires width and height in options parameter.");p=b.format&&b.format.toLowerCase();if("tiff"===p&&b.customOptions)return u=d.decodeTileOrStrip(a,b.customOptions),u=new c({width:u.width,height:u.height,pixels:u.pixels,pixelType:u.pixelType.toLowerCase(),mask:u.mask,statistics:null}),u.updateStatistics(),[2,u];if(!p||"bsq"!==p&&"bip"!==p)p=q(a);return!b.useCanvas||"jpg"!==p&&"png"!==p?[3,2]:[4,n(a,b,e)];case 1:return m=u.sent(),
[3,3];case 2:k=v(p);b.isPoint&&(b=f.__assign({},b),b.width++,b.height++);m=k(a,b);if(b.isPoint){var l=m,h=void 0;void 0===h&&(h=1);if(l){var r=l.pixels,w=l.width,x=l.mask;if(r&&0!==r.length){var y=r.length,B=w-1,g=l.height-1,A=[],F,z,E,D,J,H,C=c.getPixelArrayConstructor(l.pixelType);if(0===h){for(h=0;h<y;h++){D=r[h];J=new C(B*g);for(F=0;F<g;F++)for(E=F*w,z=0;z<B;z++)J[F*B+z]=D[E+z];A.push(J)}if(x)for(H=new Uint8Array(B*g),F=0;F<g;F++)for(E=F*w,z=0;z<B;z++)H[F*B+z]=x[E+z]}else{for(h=0;h<y;h++){D=r[h];
J=new C(B*g);for(F=0;F<g;F++)for(E=F*w,z=0;z<B;z++)J[F*B+z]=(D[E+z]+D[E+z+1]+D[E+w+z]+D[E+w+z+1])/4;A.push(J)}if(x)for(H=new Uint8Array(B*g),F=0;F<g;F++)for(E=F*w,z=0;z<B;z++)H[F*B+z]=Math.min.apply(null,[x[E+z],x[E+z+1],x[E+w+z],x[E+w+z+1]])}l.width=B;l.height=g;l.mask=H;l.pixels=A}}}u.label=3;case 3:return[2,m]}})})};return a}()})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../core/promiseUtils ./Zlib".split(" "),
function(C,g,f,t,c,h){return function(){function m(a){a&&(this.canvas=a.canvas,this.ctx=a.ctx||a.canvas&&a.canvas.getContext("2d"))}m.getFormat=function(a){if(!a||10>a.byteLength)return"";a=new Uint8Array(a,0,10);var e="";255===a[0]&&216===a[1]?e="jpeg":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]&&(e="png");return e};m.prototype.decode=function(a,e,b){var p=this;if(!a||10>a.byteLength)throw new f("imagecanvasdecoder: decode","required a valid encoded data as input.");var d=m.getFormat(a);if(""===
d)throw new f("imagecanvasdecoder: decode","encoded data format is not a supported format (jpeg or png).");var h=e.width,y=e.height,l=e.applyJpegMask;if(l&&(!h||!y))throw new f("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return t.create(function(k,x){var n=null;"jpeg"===d&&l&&(n=m.getMask(a,e));var q=new Blob([new Uint8Array(a)],{type:"image/"+d}),f=URL.createObjectURL(q),r=new Image,g;r.src=f;r.onload=function(){URL.revokeObjectURL(f);if(t.isAborted(b))x(c.createAbortError());
else{h=r.width;y=r.height;if(p.canvas){if(p.canvas.width!==h||p.canvas.height!==y)p.canvas.width=h,p.canvas.height=y;p.ctx.clearRect(0,0,h,y)}else p.canvas=document.createElement("canvas"),p.canvas.width=h,p.canvas.height=y,p.ctx=p.canvas.getContext("2d");p.ctx.drawImage(r,0,0);var a=p.ctx.getImageData(0,0,h,y);g=a.data;var d;if(e.renderOnCanvas){if(n)for(d=0;d<n.length;d++)g[4*d+3]=n[d]?255:0;p.ctx.putImageData(a,0,0);k(null)}else{var a=h*y,m=new Uint8Array(a),l=new Uint8Array(a),q=new Uint8Array(a);
if(n)for(d=0;d<a;d++)m[d]=g[4*d],l[d]=g[4*d+1],q[d]=g[4*d+2];else for(n=new Uint8Array(a),d=0;d<a;d++)m[d]=g[4*d],l[d]=g[4*d+1],q[d]=g[4*d+2],n[d]=g[4*d+3];k({width:h,height:y,pixels:[m,l,q],mask:n,pixelType:"u8"})}}};r.onerror=function(){URL.revokeObjectURL(f);x("cannot load image")}})};m.getMask=function(a,e){var b=null;try{var c=new Uint8Array(a);a=0;var d=c.length-2;for(a=Math.ceil(c.length/2);a<d&&(255!==c[a]||217!==c[a+1]);a++);a+=2;if(a<c.length-1)for(var m=(new h(c.subarray(a))).getBytes(),
b=new Uint8Array(e.width*e.height),c=e=0;c<m.length;c++)for(d=7;0<=d;d--)b[e++]=m[c]>>d&1}catch(y){}return b};return m}()})},"esri/layers/support/rasterFormats/Zlib":function(){define([],function(){var C=function(){function g(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}g.prototype={ensureBuffer:function(f){var t=this.buffer,c=t?t.byteLength:0;if(f<c)return t;for(var h=512;h<f;)h<<=1;f=new Uint8Array(h);for(h=0;h<c;++h)f[h]=t[h];return this.buffer=f},getByte:function(){for(var f=this.pos;this.bufferLength<=
f;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(f){var t=this.pos;if(f){this.ensureBuffer(t+f);for(f=t+f;!this.eof&&this.bufferLength<f;)this.readBlock();var c=this.bufferLength;f>c&&(f=c)}else{for(;!this.eof;)this.readBlock();f=this.bufferLength}this.pos=f;return this.buffer.subarray(t,f)},lookChar:function(){for(var f=this.pos;this.bufferLength<=f;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var f=
this.pos;this.bufferLength<=f;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(f,t,c){for(var h=f+t;this.bufferLength<=h&&!this.eof;)this.readBlock();return new Stream(this.buffer,f,t,c)},skip:function(f){f||(f=1);this.pos+=f},reset:function(){this.pos=0}};return g}();return function(){function g(a){throw Error(a);}function f(a){var b=0,e=a[b++],d=a[b++];-1!=e&&-1!=d||g("Invalid header in flate stream");8!=(e&15)&&g("Unknown compression method in flate stream");
0!=((e<<8)+d)%31&&g("Bad FCHECK in flate stream");d&32&&g("FDICT bit set in flate stream");this.bytes=a;this.bytesPos=b;this.codeBuf=this.codeSize=0;C.call(this)}if(!self||!self.Uint32Array)return null;var t=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),h=new Uint32Array([1,2,3,4,65541,65543,131081,
131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),m=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,
524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,
524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,
524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,
524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,
524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,
524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,
524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],a=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];f.prototype=Object.create(C.prototype);
f.prototype.getBits=function(a){for(var b=this.codeSize,e=this.codeBuf,d=this.bytes,c=this.bytesPos,m;b<a;)"undefined"==typeof(m=d[c++])&&g("Bad encoding in flate stream"),e|=m<<b,b+=8;this.codeBuf=e>>a;this.codeSize=b-=a;this.bytesPos=c;return e&(1<<a)-1};f.prototype.getCode=function(a){var b=a[0],e=a[1];a=this.codeSize;for(var d=this.codeBuf,c=this.bytes,m=this.bytesPos;a<e;){var l;"undefined"==typeof(l=c[m++])&&g("Bad encoding in flate stream");d|=l<<a;a+=8}e=b[d&(1<<e)-1];b=e>>16;e&=65535;(0==
a||a<b||0==b)&&g("Bad encoding in flate stream");this.codeBuf=d>>b;this.codeSize=a-b;this.bytesPos=m;return e};f.prototype.generateHuffmanTable=function(a){for(var b=a.length,e=0,d=0;d<b;++d)a[d]>e&&(e=a[d]);for(var c=1<<e,m=new Uint32Array(c),l=1,k=0,h=2;l<=e;++l,k<<=1,h<<=1)for(var n=0;n<b;++n)if(a[n]==l){for(var q=0,f=k,d=0;d<l;++d)q=q<<1|f&1,f>>=1;for(d=q;d<c;d+=h)m[d]=l<<16|n;++k}return[m,e]};f.prototype.readBlock=function(){function e(a,b,e,d,c){for(a=a.getBits(e)+d;0<a--;)b[k++]=c}var b=this.getBits(3);
b&1&&(this.eof=!0);b>>=1;if(0==b){var p=this.bytes,d=this.bytesPos,f;"undefined"==typeof(f=p[d++])&&g("Bad block header in flate stream");var y=f;"undefined"==typeof(f=p[d++])&&g("Bad block header in flate stream");y|=f<<8;"undefined"==typeof(f=p[d++])&&g("Bad block header in flate stream");b=f;"undefined"==typeof(f=p[d++])&&g("Bad block header in flate stream");(b|f<<8)!=(~y&65535)&&g("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;f=this.bufferLength;b=this.ensureBuffer(f+
y);this.bufferLength=y=f+y;for(var l=f;l<y;++l){if("undefined"==typeof(f=p[d++])){this.eof=!0;break}b[l]=f}this.bytesPos=d}else{if(1==b)d=m,f=a;else if(2==b){b=this.getBits(5)+257;f=this.getBits(5)+1;for(var p=this.getBits(4)+4,d=Array(t.length),k=0;k<p;)d[t[k++]]=this.getBits(3);d=this.generateHuffmanTable(d);k=p=0;f=b+f;for(y=Array(f);k<f;)l=this.getCode(d),16==l?e(this,y,2,3,p):17==l?e(this,y,3,3,p=0):18==l?e(this,y,7,11,p=0):y[k++]=p=l;d=this.generateHuffmanTable(y.slice(0,b));f=this.generateHuffmanTable(y.slice(b,
f))}else g("Unknown block type in flate stream");y=(b=this.buffer)?b.length:0;for(l=this.bufferLength;;){var x=this.getCode(d);if(256>x)l+1>=y&&(b=this.ensureBuffer(l+1),y=b.length),b[l++]=x;else{if(256==x){this.bufferLength=l;break}var x=x-257,x=c[x],n=x>>16;0<n&&(n=this.getBits(n));p=(x&65535)+n;x=this.getCode(f);x=h[x];n=x>>16;0<n&&(n=this.getBits(n));x=(x&65535)+n;l+p>=y&&(b=this.ensureBuffer(l+p),y=b.length);for(n=0;n<p;++n,++l)b[l]=b[l-x]}}}};return f}()})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["require",
"exports","./Jpg","./Zlib"],function(C,g,f,t){return function(){function c(){}c.decode=function(c){var m=new Uint8Array(c),a=new f;a.parse(m);c=a.width;var e=a.height,b=a.numComponents,p=a.eof,a=a.getData(c,e,!0),d,h=c*e,y=0,l=0,k=0;if(p<m.length-1)for(m=(new t(m.subarray(p))).getBytes(),d=new Uint8Array(h),y=p=0;y<m.length;y++)for(k=7;0<=k;k--)d[p++]=m[y]>>k&1;m=null;if(1===b)m=[a,a,a];else{m=[];for(y=0;3>y;y++)b=new Uint8Array(h),m.push(b);for(l=k=0;l<h;l++)for(y=0;3>y;y++)m[y][l]=a[k++]}return{width:c,
height:e,pixels:m,mask:d}};return c}()})},"esri/layers/support/rasterFormats/Jpg":function(){define([],function(){var C=function(){function g(f){this.message="JPEG error: "+f}g.prototype=Error();g.prototype.name="JpegError";return g.constructor=g}();return function(){function g(){this.decodeTransform=null;this.colorTransform=-1}function f(a,e){for(var b=0,c=[],d,m,h=16;0<h&&!a[h-1];)h--;c.push({children:[],index:0});var l=c[0],k;for(d=0;d<h;d++){for(m=0;m<a[d];m++){l=c.pop();for(l.children[l.index]=
e[b];0<l.index;)l=c.pop();l.index++;for(c.push(l);c.length<=d;)c.push(k={children:[],index:0}),l.children[l.index]=k.children,l=k;b++}d+1<h&&(c.push(k={children:[],index:0}),l.children[l.index]=k.children,l=k)}return c[0].children}function t(a,e,b,c,d,f,t,l,k){function p(){if(0<J)return J--,E>>J&1;E=a[e++];if(255===E){var b=a[e++];if(b)throw new C("unexpected marker "+(E<<8|b).toString(16));}J=7;return E>>>7}function n(a){for(;;){a=a[p()];if("number"===typeof a)return a;if("object"!==typeof a)throw new C("invalid huffman sequence");
}}function q(a){for(var b=0;0<a;)b=b<<1|p(),a--;return b}function g(a){if(1===a)return 1===p()?1:-1;var b=q(a);return b>=1<<a-1?b:b+(-1<<a)+1}function r(a,b){var e=n(a.huffmanTableDC),e=0===e?0:g(e);a.blockData[b]=a.pred+=e;for(e=1;64>e;){var d=n(a.huffmanTableAC),c=d&15,d=d>>4;if(0===c){if(15>d)break;e+=16}else e+=d,a.blockData[b+m[e]]=g(c),e++}}function y(a,b){var e=n(a.huffmanTableDC),e=0===e?0:g(e)<<k;a.blockData[b]=a.pred+=e}function w(a,b){a.blockData[b]|=p()<<k}function u(a,b){if(0<H)H--;else for(var e=
f;e<=t;){var d=n(a.huffmanTableAC),c=d&15,d=d>>4;if(0===c){if(15>d){H=q(d)+(1<<d)-1;break}e+=16}else e+=d,a.blockData[b+m[e]]=g(c)*(1<<k),e++}}function B(a,b){for(var e=f,d=0,c;e<=t;){c=m[e];switch(M){case 0:d=n(a.huffmanTableAC);c=d&15;d>>=4;if(0===c)15>d?(H=q(d)+(1<<d),M=4):(d=16,M=1);else{if(1!==c)throw new C("invalid ACn encoding");I=g(c);M=d?2:3}continue;case 1:case 2:a.blockData[b+c]?a.blockData[b+c]+=p()<<k:(d--,0===d&&(M=2===M?3:0));break;case 3:a.blockData[b+c]?a.blockData[b+c]+=p()<<k:(a.blockData[b+
c]=I<<k,M=0);break;case 4:a.blockData[b+c]&&(a.blockData[b+c]+=p()<<k)}e++}4===M&&(H--,0===H&&(M=0))}var A=b.mcusPerLine,D=e,E=0,J=0,H=0,M=0,I,G=c.length,N,L,S,R,T;l=b.progressive?0===f?0===l?y:w:0===l?u:B:r;var Q=0;b=1===G?c[0].blocksPerLine*c[0].blocksPerColumn:A*b.mcusPerColumn;for(var K,U;Q<b;){var O=d?Math.min(b-Q,d):b;for(L=0;L<G;L++)c[L].pred=0;H=0;if(1===G)for(N=c[0],T=0;T<O;T++)l(N,64*((N.blocksPerLine+1)*(Q/N.blocksPerLine|0)+Q%N.blocksPerLine)),Q++;else for(T=0;T<O;T++){for(L=0;L<G;L++)for(N=
c[L],K=N.h,U=N.v,S=0;S<U;S++)for(R=0;R<K;R++)l(N,64*((N.blocksPerLine+1)*((Q/A|0)*N.v+S)+(Q%A*N.h+R)));Q++}J=0;(N=h(a,e))&&N.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+N.invalid),e=N.offset);N=N&&N.marker;if(!N||65280>=N)throw new C("marker was not found");if(65488<=N&&65495>=N)e+=2;else break}(N=h(a,e))&&N.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+N.invalid),e=N.offset);return e-D}function c(a,e){a=e.blocksPerLine;for(var b=e.blocksPerColumn,
c=new Int16Array(64),d=0;d<b;d++)for(var m=0;m<a;m++){var h=64*((e.blocksPerLine+1)*d+m),l=c,k=e.quantizationTable,f=e.blockData,n=void 0,q=void 0,t=void 0,r=void 0,g=void 0,w=void 0,u=void 0,B=void 0,z=void 0,D=B=void 0,E=u=q=w=void 0,J=void 0,z=void 0;if(!k)throw new C("missing required Quantization Table.");for(var H=0;64>H;H+=8)z=f[h+H],B=f[h+H+1],D=f[h+H+2],w=f[h+H+3],q=f[h+H+4],u=f[h+H+5],E=f[h+H+6],J=f[h+H+7],z*=k[H],0===(B|D|w|q|u|E|J)?(z=5793*z+512>>10,l[H]=z,l[H+1]=z,l[H+2]=z,l[H+3]=z,l[H+
4]=z,l[H+5]=z,l[H+6]=z,l[H+7]=z):(B*=k[H+1],D*=k[H+2],w*=k[H+3],q*=k[H+4],u*=k[H+5],E*=k[H+6],J*=k[H+7],n=5793*z+128>>8,q=5793*q+128>>8,t=D,r=E,g=2896*(B-J)+128>>8,B=2896*(B+J)+128>>8,w<<=4,u<<=4,n=n+q+1>>1,q=n-q,z=3784*t+1567*r+128>>8,t=1567*t-3784*r+128>>8,r=z,g=g+u+1>>1,u=g-u,B=B+w+1>>1,w=B-w,n=n+r+1>>1,r=n-r,q=q+t+1>>1,t=q-t,z=2276*g+3406*B+2048>>12,g=3406*g-2276*B+2048>>12,B=z,z=799*w+4017*u+2048>>12,w=4017*w-799*u+2048>>12,u=z,l[H]=n+B,l[H+7]=n-B,l[H+1]=q+u,l[H+6]=q-u,l[H+2]=t+w,l[H+5]=t-w,
l[H+3]=r+g,l[H+4]=r-g);for(k=0;8>k;++k)z=l[k],B=l[k+8],D=l[k+16],w=l[k+24],q=l[k+32],u=l[k+40],E=l[k+48],J=l[k+56],0===(B|D|w|q|u|E|J)?(z=5793*z+8192>>14,z=-2040>z?0:2024<=z?255:z+2056>>4,f[h+k]=z,f[h+k+8]=z,f[h+k+16]=z,f[h+k+24]=z,f[h+k+32]=z,f[h+k+40]=z,f[h+k+48]=z,f[h+k+56]=z):(n=5793*z+2048>>12,q=5793*q+2048>>12,t=D,r=E,g=2896*(B-J)+2048>>12,B=2896*(B+J)+2048>>12,n=(n+q+1>>1)+4112,q=n-q,z=3784*t+1567*r+2048>>12,t=1567*t-3784*r+2048>>12,r=z,g=g+u+1>>1,u=g-u,B=B+w+1>>1,w=B-w,n=n+r+1>>1,r=n-r,q=
q+t+1>>1,t=q-t,z=2276*g+3406*B+2048>>12,g=3406*g-2276*B+2048>>12,B=z,z=799*w+4017*u+2048>>12,w=4017*w-799*u+2048>>12,u=z,z=n+B,J=n-B,B=q+u,E=q-u,D=t+w,u=t-w,w=r+g,q=r-g,z=16>z?0:4080<=z?255:z>>4,B=16>B?0:4080<=B?255:B>>4,D=16>D?0:4080<=D?255:D>>4,w=16>w?0:4080<=w?255:w>>4,q=16>q?0:4080<=q?255:q>>4,u=16>u?0:4080<=u?255:u>>4,E=16>E?0:4080<=E?255:E>>4,J=16>J?0:4080<=J?255:J>>4,f[h+k]=z,f[h+k+8]=B,f[h+k+16]=D,f[h+k+24]=w,f[h+k+32]=q,f[h+k+40]=u,f[h+k+48]=E,f[h+k+56]=J)}return e.blockData}function h(a,
e,b){var c=a.length-1;b=b<e?b:e;if(e>=c)return null;var d=a[e]<<8|a[e+1];if(65472<=d&&65534>=d)return{invalid:null,marker:d,offset:e};for(e=a[b]<<8|a[b+1];!(65472<=e&&65534>=e);){if(++b>=c)return null;e=a[b]<<8|a[b+1]}return{invalid:d.toString(16),marker:e,offset:b}}if(!self||!self.Uint8ClampedArray)return null;var m=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,
54,47,55,62,63]);g.prototype={parse:function(a){function e(){var b=a[d]<<8|a[d+1];d+=2;return b}function b(){var b=e(),b=d+b-2,c=h(a,b,d);c&&c.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+c.invalid),b=c.offset);b=a.subarray(d,b);d+=b.length;return b}function p(a){for(var b=Math.ceil(a.samplesPerLine/8/a.maxH),e=Math.ceil(a.scanLines/8/a.maxV),d=0;d<a.components.length;d++){D=a.components[d];var c=Math.ceil(Math.ceil(a.samplesPerLine/8)*D.h/a.maxH),k=Math.ceil(Math.ceil(a.scanLines/
8)*D.v/a.maxV);D.blockData=new Int16Array(64*e*D.v*(b*D.h+1));D.blocksPerLine=c;D.blocksPerColumn=k}a.mcusPerLine=b;a.mcusPerColumn=e}var d=0,g=null,y=null,l,k,x=[],n=[],q=[],v=e();if(65496!==v)throw new C("SOI not found");for(v=e();65497!==v;){var r,F;switch(v){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:r=b();65504===v&&74===r[0]&&70===r[1]&&73===r[2]&&70===
r[3]&&0===r[4]&&(g={version:{major:r[5],minor:r[6]},densityUnits:r[7],xDensity:r[8]<<8|r[9],yDensity:r[10]<<8|r[11],thumbWidth:r[12],thumbHeight:r[13],thumbData:r.subarray(14,14+3*r[12]*r[13])});65518===v&&65===r[0]&&100===r[1]&&111===r[2]&&98===r[3]&&101===r[4]&&(y={version:r[5]<<8|r[6],flags0:r[7]<<8|r[8],flags1:r[9]<<8|r[10],transformCode:r[11]});break;case 65499:for(var v=e()+d-2,w;d<v;){var u=a[d++],B=new Uint16Array(64);if(0===u>>4)for(r=0;64>r;r++)w=m[r],B[w]=a[d++];else if(1===u>>4)for(r=
0;64>r;r++)w=m[r],B[w]=e();else throw new C("DQT - invalid table spec");x[u&15]=B}break;case 65472:case 65473:case 65474:if(l)throw new C("Only single frame JPEGs supported");e();l={};l.extended=65473===v;l.progressive=65474===v;l.precision=a[d++];l.scanLines=e();l.samplesPerLine=e();l.components=[];l.componentIds={};r=a[d++];for(v=B=u=0;v<r;v++){w=a[d];F=a[d+1]>>4;var z=a[d+1]&15;u<F&&(u=F);B<z&&(B=z);F=l.components.push({h:F,v:z,quantizationId:a[d+2],quantizationTable:null});l.componentIds[w]=F-
1;d+=3}l.maxH=u;l.maxV=B;p(l);break;case 65476:w=e();for(v=2;v<w;){u=a[d++];B=new Uint8Array(16);for(r=F=0;16>r;r++,d++)F+=B[r]=a[d];z=new Uint8Array(F);for(r=0;r<F;r++,d++)z[r]=a[d];v+=17+F;(0===u>>4?q:n)[u&15]=f(B,z)}break;case 65501:e();k=e();break;case 65498:e();w=a[d++];r=[];for(var D,v=0;v<w;v++)u=l.componentIds[a[d++]],D=l.components[u],u=a[d++],D.huffmanTableDC=q[u>>4],D.huffmanTableAC=n[u&15],r.push(D);v=a[d++];w=a[d++];u=a[d++];v=t(a,d,l,r,k,v,w,u>>4,u&15);d+=v;break;case 65535:255!==a[d]&&
d--;break;default:if(255===a[d-3]&&192<=a[d-2]&&254>=a[d-2])d-=3;else throw new C("unknown marker "+v.toString(16));}v=e()}this.width=l.samplesPerLine;this.height=l.scanLines;this.jfif=g;this.eof=d;this.adobe=y;this.components=[];for(v=0;v<l.components.length;v++){D=l.components[v];if(g=x[D.quantizationId])D.quantizationTable=g;this.components.push({output:c(l,D),scaleX:D.h/l.maxH,scaleY:D.v/l.maxV,blocksPerLine:D.blocksPerLine,blocksPerColumn:D.blocksPerColumn})}this.numComponents=this.components.length},
_getLinearizedBlockData:function(a,e){var b=this.width/a,c=this.height/e,d,m,h,l,k,f,n=0,q,t=this.components.length,r=a*e*t,g=new Uint8ClampedArray(r),w=new Uint32Array(a);for(f=0;f<t;f++){d=this.components[f];m=d.scaleX*b;h=d.scaleY*c;n=f;q=d.output;l=d.blocksPerLine+1<<3;for(k=0;k<a;k++)d=0|k*m,w[k]=(d&4294967288)<<3|d&7;for(m=0;m<e;m++)for(d=0|m*h,d=l*(d&4294967288)|(d&7)<<3,k=0;k<a;k++)g[n]=q[d+w[k]],n+=t}if(e=this.decodeTransform)for(f=0;f<r;)for(a=d=0;d<t;d++,f++,a+=2)g[f]=(g[f]*e[a]>>8)+e[a+
1];return g},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(a){for(var e,b,c,d=0,m=a.length;d<m;d+=3)e=a[d],b=a[d+1],c=a[d+2],a[d]=e-179.456+1.402*c,a[d+1]=e+135.459-.344*b-.714*c,a[d+2]=e-226.816+1.772*b;return a},_convertYcckToRgb:function(a){for(var e,b,c,d,m=0,h=0,l=a.length;h<l;h+=4)e=a[h],b=a[h+1],c=a[h+2],d=a[h+3],a[m++]=-122.67195406894+b*(-6.60635669420364E-5*
b+4.37130475926232E-4*c-5.4080610064599E-5*e+4.8449797120281E-4*d-.154362151871126)+c*(-9.57964378445773E-4*c+8.17076911346625E-4*e-.00477271405408747*d+1.53380253221734)+e*(9.61250184130688E-4*e-.00266257332283933*d+.48357088451265)+d*(-3.36197177618394E-4*d+.484791561490776),a[m++]=107.268039397724+b*(2.19927104525741E-5*b-6.40992018297945E-4*c+6.59397001245577E-4*e+4.26105652938837E-4*d-.176491792462875)+c*(-7.78269941513683E-4*c+.00130872261408275*e+7.70482631801132E-4*d-.151051492775562)+e*(.00126935368114843*
e-.00265090189010898*d+.25802910206845)+d*(-3.18913117588328E-4*d-.213742400323665),a[m++]=-20.810012546947+b*(-5.70115196973677E-4*b-2.63409051004589E-5*c+.0020741088115012*e-.00288260236853442*d+.814272968359295)+c*(-1.53496057440975E-5*c-1.32689043961446E-4*e+5.60833691242812E-4*d-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*d+.116935020465145)+d*(-3.43531996510555E-4*d+.24165260232407);return a},_convertYcckToCmyk:function(a){for(var e,b,c,d=0,m=a.length;d<m;d+=4)e=a[d],b=a[d+
1],c=a[d+2],a[d]=434.456-e-1.402*c,a[d+1]=119.541-e+.344*b+.714*c,a[d+2]=481.816-e-1.772*b;return a},_convertCmykToRgb:function(a){for(var e,b,c,d,m=0,h=1/255,l=0,k=a.length;l<k;l+=4)e=a[l]*h,b=a[l+1]*h,c=a[l+2]*h,d=a[l+3]*h,a[m++]=255+e*(-4.387332384609988*e+54.48615194189176*b+18.82290502165302*c+212.25662451639585*d-285.2331026137004)+b*(1.7149763477362134*b-5.6096736904047315*c-17.873870861415444*d-5.497006427196366)+c*(-2.5217340131683033*c-21.248923337353073*d+17.5119270841813)-d*(21.86122147463605*
d+189.48180835922747),a[m++]=255+e*(8.841041422036149*e+60.118027045597366*b+6.871425592049007*c+31.159100130055922*d-79.2970844816548)+b*(-15.310361306967817*b+17.575251261109482*c+131.35250912493976*d-190.9453302588951)+c*(4.444339102852739*c+9.8632861493405*d-24.86741582555878)-d*(20.737325471181034*d+187.80453709719578),a[m++]=255+e*(.8842522430003296*e+8.078677503112928*b+30.89978309703729*c-.23883238689178934*d-14.183576799673286)+b*(10.49593273432072*b+63.02378494754052*c+50.606957656360734*
d-112.23884253719248)+c*(.03296041114873217*c+115.60384449646641*d-193.58209356861505)-d*(22.33816807309886*d+180.12613974708367);return a},getData:function(a,e,b){if(4<this.numComponents)throw new C("Unsupported color mode");a=this._getLinearizedBlockData(a,e);if(1===this.numComponents&&b){b=a.length;e=new Uint8ClampedArray(3*b);for(var c=0,d=0;d<b;d++){var m=a[d];e[c++]=m;e[c++]=m;e[c++]=m}return e}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(a);if(4===
this.numComponents){if(this._isColorConversionNeeded())return b?this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(b)return this._convertCmykToRgb(a)}return a}};return g}()})},"esri/layers/support/rasterFormats/Lerc2Codec":function(){define([],function(){var C={unstuff:function(f,c,h,m,a,e,b,p){var d=(1<<h)-1,t=0,g,l=0,k,x;f[f.length-1]<<=8*(4*f.length-Math.ceil(h*m/8));if(a)for(g=0;g<m;g++)0===l&&(x=f[t++],l=32),l>=h?(k=x>>>l-h&d,l-=h):(l=h-l,k=(x&d)<<l&d,x=f[t++],l=32-l,k+=x>>>l),c[g]=a[k];
else for(a=Math.ceil((p-e)/b),g=0;g<m;g++)0===l&&(x=f[t++],l=32),l>=h?(k=x>>>l-h&d,l-=h):(l=h-l,k=(x&d)<<l&d,x=f[t++],l=32-l,k+=x>>>l),c[g]=k<a?e+k*b:p},unstuffLUT:function(f,c,h,m,a,e){var b=(1<<c)-1,p=0,d=0,g=0,t=g=0,l,k=[];f[f.length-1]<<=8*(4*f.length-Math.ceil(c*h/8));for(var x=Math.ceil((e-m)/a),d=0;d<h;d++)0===g&&(l=f[p++],g=32),g>=c?(t=l>>>g-c&b,g-=c):(g=c-g,t=(l&b)<<g&b,l=f[p++],g=32-g,t+=l>>>g),k[d]=t<x?m+t*a:e;k.unshift(m);return k},unstuff2:function(f,c,h,m,a,e,b,p){var d=(1<<h)-1,g=0,
t,l=0,k=0,x,n,q;if(a)for(t=0;t<m;t++)0===l&&(n=f[g++],l=32,k=0),l>=h?(x=n>>>k&d,l-=h,k+=h):(q=h-l,x=n>>>k&d,n=f[g++],l=32-q,x|=(n&(1<<q)-1)<<h-q,k=q),c[t]=a[x];else for(a=Math.ceil((p-e)/b),t=0;t<m;t++)0===l&&(n=f[g++],l=32,k=0),l>=h?(x=n>>>k&d,l-=h,k+=h):(q=h-l,x=n>>>k&d,n=f[g++],l=32-q,x|=(n&(1<<q)-1)<<h-q,k=q),c[t]=x<a?e+x*b:p;return c},unstuffLUT2:function(f,c,h,m,a,e){for(var b=(1<<c)-1,p=0,d=0,g=0,t=0,l=0,k=0,x,n=[],q=Math.ceil((e-m)/a),d=0;d<h;d++)0===t&&(x=f[p++],t=32,k=0),t>=c?(l=x>>>k&b,
t-=c,k+=c):(g=c-t,l=x>>>k&b,x=f[p++],t=32-g,l|=(x&(1<<g)-1)<<c-g,k=g),n[d]=l<q?m+l*a:e;n.unshift(m);return n},originalUnstuff:function(f,c,h,m){var a=(1<<h)-1,e=0,b,p=0,d,g;f[f.length-1]<<=8*(4*f.length-Math.ceil(h*m/8));for(b=0;b<m;b++)0===p&&(g=f[e++],p=32),p>=h?(d=g>>>p-h&a,p-=h):(p=h-p,d=(g&a)<<p&a,g=f[e++],p=32-p,d+=g>>>p),c[b]=d;return c},originalUnstuff2:function(f,c,h,m){var a=(1<<h)-1,e=0,b,p=0,d=0,g,t,l;for(b=0;b<m;b++)0===p&&(t=f[e++],p=32,d=0),p>=h?(g=t>>>d&a,p-=h,d+=h):(l=h-p,g=t>>>d&
a,t=f[e++],p=32-l,g|=(t&(1<<l)-1)<<h-l,d=l),c[b]=g;return c}},g={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(f){for(var c=65535,h=65535,m=f.length,a=Math.floor(m/2),e=0;a;){var b=359<=a?359:a,a=a-b;do c+=f[e++]<<8,h+=c+=f[e++];while(--b);c=(c&65535)+(c>>>16);h=(h&65535)+(h>>>16)}m&1&&(h+=c+=f[e]<<8);return((h&65535)+(h>>>16)<<16|(c&65535)+(c>>>16))>>>0},readHeaderInfo:function(f,c){var h=c.ptr,m=new Uint8Array(f,h,6),a={};a.fileIdentifierString=String.fromCharCode.apply(null,m);if(0!==
a.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+a.fileIdentifierString;var h=h+6,m=new DataView(f,h,8),e=m.getInt32(0,!0);a.fileVersion=e;h+=4;3<=e&&(a.checksum=m.getUint32(4,!0),h+=4);m=new DataView(f,h,12);a.height=m.getUint32(0,!0);a.width=m.getUint32(4,!0);h+=8;4<=e?(a.numDims=m.getUint32(8,!0),h+=4):a.numDims=1;m=new DataView(f,h,40);a.numValidPixel=m.getUint32(0,!0);a.microBlockSize=m.getInt32(4,!0);a.blobSize=m.getInt32(8,!0);a.imageType=
m.getInt32(12,!0);a.maxZError=m.getFloat64(16,!0);a.zMin=m.getFloat64(24,!0);a.zMax=m.getFloat64(32,!0);h+=40;c.headerInfo=a;c.ptr=h;if(3<=e&&(f=this.computeChecksumFletcher32(new Uint8Array(f,h-(4<=e?52:48),a.blobSize-14)),f!==a.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(f,c){var h=c.headerInfo,m=this.getDataTypeArray(h.imageType),a=h.numDims*this.getDataTypeSize(h.imageType),e=this.readSubArray(f,c.ptr,m,a);f=this.readSubArray(f,c.ptr+a,m,a);c.ptr+=2*a;a=!0;for(c=0;c<
h.numDims;c++)if(e[c]!==f[c]){a=!1;break}h.minValues=e;h.maxValues=f;return a},readSubArray:function(f,c,h,m){if(h===Uint8Array)f=new Uint8Array(f,c,m);else{var a=new ArrayBuffer(m);(new Uint8Array(a)).set(new Uint8Array(f,c,m));f=new h(a)}return f},readMask:function(f,c){var h=c.ptr,m=c.headerInfo,a=m.width*m.height,e=m.numValidPixel,b=new DataView(f,h,4),m={};m.numBytes=b.getUint32(0,!0);h+=4;if((0===e||a===e)&&0!==m.numBytes)throw"invalid mask";if(0===e)e=new Uint8Array(Math.ceil(a/8)),m.bitset=
e,b=new Uint8Array(a),c.pixels.resultMask=b,h+=m.numBytes;else if(0<m.numBytes){e=new Uint8Array(Math.ceil(a/8));b=new DataView(f,h,m.numBytes);f=b.getInt16(0,!0);var p=2,d=0,g=0;do{if(0<f)for(;f--;)e[d++]=b.getUint8(p++);else for(g=b.getUint8(p++),f=-f;f--;)e[d++]=g;f=b.getInt16(p,!0);p+=2}while(p<m.numBytes);if(-32768!==f||d<e.length)throw"Unexpected end of mask RLE encoding";b=new Uint8Array(a);for(p=p=f=0;p<a;p++)p&7?(f=e[p>>3],f<<=p&7):f=e[p>>3],f&128&&(b[p]=1);c.pixels.resultMask=b;m.bitset=
e;h+=m.numBytes}c.ptr=h;c.mask=m;return!0},readDataOneSweep:function(f,c,h){var m=c.ptr,a=c.headerInfo,e=a.numDims,b=a.width*a.height,a=a.numValidPixel*g.getDataTypeSize(a.imageType)*e,p=c.pixels.resultMask;if(h===Uint8Array)f=new Uint8Array(f,m,a);else{var d=new ArrayBuffer(a);(new Uint8Array(d)).set(new Uint8Array(f,m,a));f=new h(d)}if(f.length===b*e)c.pixels.resultPixels=f;else{c.pixels.resultPixels=new h(b*e);var t=d=h=0,y=0;if(1<e)for(t=0;t<e;t++)for(y=t*b,d=0;d<b;d++)p[d]&&(c.pixels.resultPixels[y+
d]=f[h++]);else for(d=0;d<b;d++)p[d]&&(c.pixels.resultPixels[d]=f[h++])}c.ptr=m+a;return!0},readHuffmanTree:function(t,c){var h=this.HUFFMAN_LUT_BITS_MAX,m=new DataView(t,c.ptr,16);c.ptr+=16;if(2>m.getInt32(0,!0))throw"unsupported Huffman version";var a=m.getInt32(4,!0),e=m.getInt32(8,!0),m=m.getInt32(12,!0);if(e>=m)return!1;var b=new Uint32Array(m-e);g.decodeBits(t,c,b);var p=[],d,A,y;for(d=e;d<m;d++)A=d-(d<a?0:a),p[A]={first:b[d-e],second:null};d=t.byteLength-c.ptr;b=new ArrayBuffer(4*Math.ceil(d/
4));(new Uint8Array(b)).set(new Uint8Array(t,c.ptr,d));t=new Uint32Array(b);c=0;var l,b=0;l=t[0];for(d=e;d<m;d++)A=d-(d<a?0:a),y=p[A].first,0<y&&(p[A].second=l<<c>>>32-y,32-c>=y?(c+=y,32===c&&(c=0,b++,l=t[b])):(c+=y-32,b++,l=t[b],p[A].second|=l>>>32-c));var k=l=0,x=new f;for(d=0;d<p.length;d++)void 0!==p[d]&&(l=Math.max(l,p[d].first));var k=l>=h?h:l,h=[],n,q;for(d=e;d<m;d++)if(A=d-(d<a?0:a),y=p[A].first,0<y)if(e=[y,A],y<=k)for(A=p[A].second<<k-y,n=1<<k-y,y=0;y<n;y++)h[A|y]=e;else for(A=p[A].second,
n=x,--y;0<=y;y--)(q=A>>>y&1)?(n.right||(n.right=new f),n=n.right):(n.left||(n.left=new f),n=n.left),0!==y||n.val||(n.val=e[1]);return{decodeLut:h,numBitsLUTQick:k,numBitsLUT:l,tree:x,stuffedData:t,srcPtr:b,bitPos:c}},readHuffman:function(f,c,h){var m=c.headerInfo,a=m.numDims,e=c.headerInfo.height,b=c.headerInfo.width,p=b*e,d=this.readHuffmanTree(f,c);f=d.decodeLut;var g=d.tree,t=d.stuffedData,l=d.srcPtr,k=d.bitPos,x=d.numBitsLUTQick,d=d.numBitsLUT,n=0===c.headerInfo.imageType?128:0,q,v,r=c.pixels.resultMask,
F,w,u,B,z,D,E=0;0<k&&(l++,k=0);var J=t[l],H=1===c.encodeMode,M=new h(p*a),I=M,G;for(G=0;G<m.numDims;G++){1<a&&(I=new h(M.buffer,p*G,p),E=0);if(c.headerInfo.numValidPixel===b*e)for(u=z=0;u<e;u++)for(B=0;B<b;B++,z++){v=0;q=F=J<<k>>>32-x;32-k<x&&(q=F|=t[l+1]>>>64-k-x);if(f[q])v=f[q][1],k+=f[q][0];else for(q=F=J<<k>>>32-d,32-k<d&&(q=F|=t[l+1]>>>64-k-d),q=g,D=0;D<d;D++)if(q=(w=F>>>d-D-1&1)?q.right:q.left,!q.left&&!q.right){v=q.val;k=k+D+1;break}32<=k&&(k-=32,l++,J=t[l]);v-=n;H?(v=0<B?v+E:0<u?v+I[z-b]:
v+E,v&=255,E=I[z]=v):I[z]=v}else for(u=z=0;u<e;u++)for(B=0;B<b;B++,z++)if(r[z]){v=0;q=F=J<<k>>>32-x;32-k<x&&(q=F|=t[l+1]>>>64-k-x);if(f[q])v=f[q][1],k+=f[q][0];else for(q=F=J<<k>>>32-d,32-k<d&&(q=F|=t[l+1]>>>64-k-d),q=g,D=0;D<d;D++)if(q=(w=F>>>d-D-1&1)?q.right:q.left,!q.left&&!q.right){v=q.val;k=k+D+1;break}32<=k&&(k-=32,l++,J=t[l]);v-=n;H?(v=0<B&&r[z-1]?v+E:0<u&&r[z-b]?v+I[z-b]:v+E,v&=255,E=I[z]=v):I[z]=v}c.ptr=c.ptr+4*(l+1)+(0<k?4:0)}c.pixels.resultPixels=M},decodeBits:function(f,c,h,m,a){var e=
c.headerInfo,b=e.fileVersion,p=0,d=new DataView(f,c.ptr,5<=f.byteLength-c.ptr?5:f.byteLength-c.ptr),g=d.getUint8(0);p++;var t=g>>6,l=0===t?4:3-t,k=0<(g&32)?!0:!1,t=g&31,g=0;if(1===l)g=d.getUint8(p),p++;else if(2===l)g=d.getUint16(p,!0),p+=2;else if(4===l)g=d.getUint32(p,!0),p+=4;else throw"Invalid valid pixel count type";var l=2*e.maxZError,x,n;a=1<e.numDims?e.maxValues[a]:e.zMax;if(k){c.counter.lut++;k=d.getUint8(p);p++;e=Math.ceil((k-1)*t/8);x=Math.ceil(e/4);x=new ArrayBuffer(4*x);n=new Uint8Array(x);
c.ptr+=p;n.set(new Uint8Array(f,c.ptr,e));p=new Uint32Array(x);c.ptr+=e;for(d=0;k-1>>>d;)d++;e=Math.ceil(g*d/8);x=Math.ceil(e/4);x=new ArrayBuffer(4*x);n=new Uint8Array(x);n.set(new Uint8Array(f,c.ptr,e));f=new Uint32Array(x);c.ptr+=e;c=3<=b?C.unstuffLUT2(p,t,k-1,m,l,a):C.unstuffLUT(p,t,k-1,m,l,a);3<=b?C.unstuff2(f,h,d,g,c):C.unstuff(f,h,d,g,c)}else c.counter.bitstuffer++,d=t,c.ptr+=p,0<d&&(e=Math.ceil(g*d/8),x=Math.ceil(e/4),x=new ArrayBuffer(4*x),n=new Uint8Array(x),n.set(new Uint8Array(f,c.ptr,
e)),f=new Uint32Array(x),c.ptr+=e,3<=b?null==m?C.originalUnstuff2(f,h,d,g):C.unstuff2(f,h,d,g,!1,m,l,a):null==m?C.originalUnstuff(f,h,d,g):C.unstuff(f,h,d,g,!1,m,l,a))},readTiles:function(f,c,h){var m=c.headerInfo,a=m.width,e=m.height,b=m.microBlockSize,p=m.imageType,d=g.getDataTypeSize(p),t=Math.ceil(a/b),y=Math.ceil(e/b);c.pixels.numBlocksY=y;c.pixels.numBlocksX=t;for(var l=c.pixels.ptr=0,k=0,x=0,n=0,q=0,v=0,r=0,F=0,w=0,u=0,B=0,z=0,D=0,r=D=r=0,E,J=new h(b*b),H=e%b||b,M=a%b||b,I=m.numDims,G,N=c.pixels.resultMask,
L=c.pixels.resultPixels,S=5<=m.fileVersion?14:15,R=m.zMax,x=0;x<y;x++)for(q=x!==y-1?b:H,n=0;n<t;n++)for(v=n!==t-1?b:M,B=x*a*b+n*b,z=a-v,G=0;G<I;G++){1<I?(D=L,B=x*a*b+n*b,L=new h(c.pixels.resultPixels.buffer,a*e*G*d,a*e),R=m.maxValues[G]):D=null;r=f.byteLength-c.ptr;l=new DataView(f,c.ptr,Math.min(10,r));k={};r=0;F=l.getUint8(0);r++;E=5<=m.fileVersion?F&4:0;w=F>>6&255;u=F>>2&S;if(u!==(n*b>>3&S))throw"integrity issue";if(E&&0===G)throw"integrity issue";F&=3;if(3<F)throw c.ptr+=r,"Invalid block encoding ("+
F+")";if(2===F){if(E)if(N)for(l=0;l<q;l++)for(k=0;k<v;k++)N[B]&&(L[B]=D[B]),B++;else for(l=0;l<q;l++)for(k=0;k<v;k++)L[B]=D[B],B++;c.counter.constant++;c.ptr+=r}else if(0===F){if(E)throw"integrity issue";c.counter.uncompressed++;c.ptr+=r;D=q*v*d;r=f.byteLength-c.ptr;D=D<r?D:r;r=new ArrayBuffer(0===D%d?D:D+d-D%d);E=new Uint8Array(r);E.set(new Uint8Array(f,c.ptr,D));r=new h(r);D=0;if(N)for(l=0;l<q;l++){for(k=0;k<v;k++)N[B]&&(L[B]=r[D++]),B++;B+=z}else for(l=0;l<q;l++){for(k=0;k<v;k++)L[B++]=r[D++];
B+=z}c.ptr+=D*d}else if(w=g.getDataTypeUsed(E&&6>p?4:p,w),u=g.getOnePixel(k,r,w,l),r+=g.getDataTypeSize(w),3===F)if(c.ptr+=r,c.counter.constantoffset++,N)for(l=0;l<q;l++){for(k=0;k<v;k++)N[B]&&(L[B]=E?Math.min(R,D[B]+u):u),B++;B+=z}else for(l=0;l<q;l++){for(k=0;k<v;k++)L[B]=E?Math.min(R,D[B]+u):u,B++;B+=z}else if(c.ptr+=r,g.decodeBits(f,c,J,u,G),r=0,E)if(N)for(l=0;l<q;l++){for(k=0;k<v;k++)N[B]&&(L[B]=J[r++]+D[B]),B++;B+=z}else for(l=0;l<q;l++){for(k=0;k<v;k++)L[B]=J[r++]+D[B],B++;B+=z}else if(N)for(l=
0;l<q;l++){for(k=0;k<v;k++)N[B]&&(L[B]=J[r++]),B++;B+=z}else for(l=0;l<q;l++){for(k=0;k<v;k++)L[B++]=J[r++];B+=z}}},formatFileInfo:function(f){return{fileIdentifierString:f.headerInfo.fileIdentifierString,fileVersion:f.headerInfo.fileVersion,imageType:f.headerInfo.imageType,height:f.headerInfo.height,width:f.headerInfo.width,numValidPixel:f.headerInfo.numValidPixel,microBlockSize:f.headerInfo.microBlockSize,blobSize:f.headerInfo.blobSize,maxZError:f.headerInfo.maxZError,pixelType:g.getPixelType(f.headerInfo.imageType),
eofOffset:f.eofOffset,mask:f.mask?{numBytes:f.mask.numBytes}:null,pixels:{numBlocksX:f.pixels.numBlocksX,numBlocksY:f.pixels.numBlocksY,maxValue:f.headerInfo.zMax,minValue:f.headerInfo.zMin,noDataValue:f.noDataValue}}},constructConstantSurface:function(f){var c=f.headerInfo.zMax,h=f.headerInfo.numDims,m=f.headerInfo.height*f.headerInfo.width,a=0,e=0,b=0,p=f.pixels.resultMask,d=f.pixels.resultPixels;if(p)if(1<h)for(a=0;a<h;a++)for(b=a*m,c=f.headerInfo.maxValues[a],e=0;e<m;e++)p[e]&&(d[b+e]=c);else for(e=
0;e<m;e++)p[e]&&(d[e]=c);else if(1<h)for(a=0;a<h;a++)for(b=a*m,c=f.headerInfo.maxValues[a],e=0;e<m;e++)d[b+e]=c;else for(e=0;e<m;e++)d[e]=c},getDataTypeArray:function(f){switch(f){case 0:f=Int8Array;break;case 1:f=Uint8Array;break;case 2:f=Int16Array;break;case 3:f=Uint16Array;break;case 4:f=Int32Array;break;case 5:f=Uint32Array;break;case 6:f=Float32Array;break;case 7:f=Float64Array;break;default:f=Float32Array}return f},getPixelType:function(f){switch(f){case 0:f="S8";break;case 1:f="U8";break;
case 2:f="S16";break;case 3:f="U16";break;case 4:f="S32";break;case 5:f="U32";break;case 6:f="F32";break;case 7:f="F64";break;default:f="F32"}return f},isValidPixelValue:function(f,c){if(null==c)return!1;switch(f){case 0:f=-128<=c&&127>=c;break;case 1:f=0<=c&&255>=c;break;case 2:f=-32768<=c&&32767>=c;break;case 3:f=0<=c&&65536>=c;break;case 4:f=-2147483648<=c&&2147483647>=c;break;case 5:f=0<=c&&4294967296>=c;break;case 6:f=-3.4027999387901484E38<=c&&3.4027999387901484E38>=c;break;case 7:f=4.9E-324<=
c&&1.7976931348623157E308>=c;break;default:f=!1}return f},getDataTypeSize:function(f){var c=0;switch(f){case 0:case 1:c=1;break;case 2:case 3:c=2;break;case 4:case 5:case 6:c=4;break;case 7:c=8;break;default:c=f}return c},getDataTypeUsed:function(f,c){var h=f;switch(f){case 2:case 4:h=f-c;break;case 3:case 5:h=f-2*c;break;case 6:h=0===c?f:1===c?2:1;break;case 7:h=0===c?f:f-2*c+1;break;default:h=f}return h},getOnePixel:function(f,c,h,m){f=0;switch(h){case 0:f=m.getInt8(c);break;case 1:f=m.getUint8(c);
break;case 2:f=m.getInt16(c,!0);break;case 3:f=m.getUint16(c,!0);break;case 4:f=m.getInt32(c,!0);break;case 5:f=m.getUInt32(c,!0);break;case 6:f=m.getFloat32(c,!0);break;case 7:f=m.getFloat64(c,!0);break;default:throw"the decoder does not understand this pixel type";}return f}},f=function(f,c,h){this.val=f;this.left=c;this.right=h};return{decode:function(f,c){c=c||{};var h=c.noDataValue,m=0,a={};a.ptr=c.inputOffset||0;a.pixels={};if(g.readHeaderInfo(f,a)){var m=a.headerInfo,e=m.fileVersion,b=g.getDataTypeArray(m.imageType);
if(5<e)throw"unsupported lerc version 2."+e;g.readMask(f,a);m.numValidPixel===m.width*m.height||a.pixels.resultMask||(a.pixels.resultMask=c.maskData);var p=m.width*m.height;a.pixels.resultPixels=new b(p*m.numDims);a.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};if(0!==m.numValidPixel)if(m.zMax===m.zMin)g.constructConstantSurface(a);else if(4<=e&&g.checkMinMaxRanges(f,a))g.constructConstantSurface(a);else{var d=new DataView(f,a.ptr,2),t=d.getUint8(0);a.ptr++;if(t)g.readDataOneSweep(f,
a,b);else if(1<e&&1>=m.imageType&&1E-5>Math.abs(m.maxZError-.5)){d=d.getUint8(1);a.ptr++;a.encodeMode=d;if(2<d||4>e&&1<d)throw"Invalid Huffman flag "+d;d?g.readHuffman(f,a,b):g.readTiles(f,a,b)}else g.readTiles(f,a,b)}a.eofOffset=a.ptr;c.inputOffset?(f=a.headerInfo.blobSize+c.inputOffset-a.ptr,1<=Math.abs(f)&&(a.eofOffset=c.inputOffset+a.headerInfo.blobSize)):(f=a.headerInfo.blobSize-a.ptr,1<=Math.abs(f)&&(a.eofOffset=a.headerInfo.blobSize));f={width:m.width,height:m.height,pixelData:a.pixels.resultPixels,
minValue:m.zMin,maxValue:m.zMax,validPixelCount:m.numValidPixel,dimCount:m.numDims,dimStats:{minValues:m.minValues,maxValues:m.maxValues},maskData:a.pixels.resultMask};if(a.pixels.resultMask&&g.isValidPixelValue(m.imageType,h)){e=a.pixels.resultMask;for(m=0;m<p;m++)e[m]||(f.pixelData[m]=h);f.noDataValue=h}a.noDataValue=h;c.returnFileInfo&&(f.fileInfo=g.formatFileInfo(a));return f}},getBandCount:function(f){for(var c=0,h=0,m={ptr:0,pixels:{}};h<f.byteLength-58;)g.readHeaderInfo(f,m),h+=m.headerInfo.blobSize,
c++,m.ptr=h;return c}}})},"esri/layers/support/rasterFormats/LercCodec":function(){define(["../../../core/mathUtils"],function(C){var g={};g.defaultNoDataValue=C.clampFloat32(-Infinity);g.decode=function(t,c){var h;c=c||{};var m=c.inputOffset||0,a=c.encodedMaskData||null===c.encodedMaskData,e={},b=new Uint8Array(t,m,10);e.fileIdentifierString=String.fromCharCode.apply(null,b);if("CntZImage"!=e.fileIdentifierString.trim())throw"Unexpected file identifier string: "+e.fileIdentifierString;m+=10;b=new DataView(t,
m,24);e.fileVersion=b.getInt32(0,!0);e.imageType=b.getInt32(4,!0);e.height=b.getUint32(8,!0);e.width=b.getUint32(12,!0);e.maxZError=b.getFloat64(16,!0);m+=24;if(!a)if(b=new DataView(t,m,16),e.mask={},e.mask.numBlocksY=b.getUint32(0,!0),e.mask.numBlocksX=b.getUint32(4,!0),e.mask.numBytes=b.getUint32(8,!0),e.mask.maxValue=b.getFloat32(12,!0),m+=16,0<e.mask.numBytes){var a=new Uint8Array(Math.ceil(e.width*e.height/8)),b=new DataView(t,m,e.mask.numBytes),p=b.getInt16(0,!0),d=2,A=0;do{if(0<p)for(;p--;)a[A++]=
b.getUint8(d++);else for(var y=b.getUint8(d++),p=-p;p--;)a[A++]=y;p=b.getInt16(d,!0);d+=2}while(d<e.mask.numBytes);if(-32768!==p||A<a.length)throw"Unexpected end of mask RLE encoding";e.mask.bitset=a;m+=e.mask.numBytes}else 0===(e.mask.numBytes|e.mask.numBlocksY|e.mask.maxValue)&&(a=new Uint8Array(Math.ceil(e.width*e.height/8)),e.mask.bitset=a);b=new DataView(t,m,16);e.pixels={};e.pixels.numBlocksY=b.getUint32(0,!0);e.pixels.numBlocksX=b.getUint32(4,!0);e.pixels.numBytes=b.getUint32(8,!0);e.pixels.maxValue=
b.getFloat32(12,!0);m+=16;a=e.pixels.numBlocksX;b=e.pixels.numBlocksY;a+=0<e.width%a?1:0;p=b+(0<e.height%b?1:0);e.pixels.blocks=Array(a*p);d=1E9;for(y=A=0;y<p;y++)for(var l=0;l<a;l++){var k=0,b=new DataView(t,m,Math.min(10,t.byteLength-m)),x={};e.pixels.blocks[A++]=x;var n=b.getUint8(0);k++;x.encoding=n&63;if(3<x.encoding)throw"Invalid block encoding ("+x.encoding+")";if(2===x.encoding)m++,d=Math.min(d,0);else{if(0!==n&&2!==n){n>>=6;x.offsetType=n;if(2===n)x.offset=b.getInt8(1),k++;else if(1===n)x.offset=
b.getInt16(1,!0),k+=2;else if(0===n)x.offset=b.getFloat32(1,!0),k+=4;else throw"Invalid block offset type";d=Math.min(x.offset,d);if(1===x.encoding)if(n=b.getUint8(k),k++,x.bitsPerPixel=n&63,n>>=6,x.numValidPixelsType=n,2===n)x.numValidPixels=b.getUint8(k),k++;else if(1===n)x.numValidPixels=b.getUint16(k,!0),k+=2;else if(0===n)x.numValidPixels=b.getUint32(k,!0),k+=4;else throw"Invalid valid pixel count type";}m+=k;if(3!=x.encoding)if(0===x.encoding){b=(e.pixels.numBytes-1)/4;if(b!==Math.floor(b))throw"uncompressed block has invalid length";
k=new ArrayBuffer(4*b);n=new Uint8Array(k);n.set(new Uint8Array(t,m,4*b));k=new Float32Array(k);for(n=0;n<k.length;n++)d=Math.min(d,k[n]);x.rawData=k;m+=4*b}else 1===x.encoding&&(b=Math.ceil(x.numValidPixels*x.bitsPerPixel/8),k=new ArrayBuffer(4*Math.ceil(b/4)),n=new Uint8Array(k),n.set(new Uint8Array(t,m,b)),x.stuffedData=new Uint32Array(k),m+=b)}}e.pixels.minValue=d;e.eofOffset=m;t=null!=c.noDataValue?C.clampFloat32(c.noDataValue):g.defaultNoDataValue;var a=c.encodedMaskData,x=c.returnMask,b=0,
p=e.pixels.numBlocksX,d=e.pixels.numBlocksY,A=Math.floor(e.width/p),y=Math.floor(e.height/d),l=2*e.maxZError,a=a||(e.mask?e.mask.bitset:null),q,m=new (c.pixelType||Float32Array)(e.width*e.height);x&&a&&(q=new Uint8Array(e.width*e.height));for(var x=new Float32Array(A*y),v,r,k=0;k<=d;k++)if(n=k!==d?y:e.height%d,0!==n)for(var F=0;F<=p;F++){var w=F!==p?A:e.width%p;if(0!==w){var u=k*e.width*y+F*A,B=e.width-w,z=e.pixels.blocks[b],D,E;if(2>z.encoding){if(0===z.encoding)D=z.rawData;else{D=z.stuffedData;
E=z.bitsPerPixel;v=z.numValidPixels;r=z.offset;var J=l,H=x,M=e.pixels.maxValue,I=(1<<E)-1,G=0,N=void 0,L=0,S=void 0,R=void 0,T=Math.ceil((M-r)/J);D[D.length-1]<<=8*(4*D.length-Math.ceil(E*v/8));for(N=0;N<v;N++)0===L&&(R=D[G++],L=32),L>=E?(S=R>>>L-E&I,L-=E):(L=E-L,S=(R&I)<<L&I,R=D[G++],L=32-L,S+=R>>>L),H[N]=S<T?r+S*J:M;D=x}E=0}else h=2===z.encoding?0:z.offset;var Q;if(a)for(r=0;r<n;r++){u&7&&(Q=a[u>>3],Q<<=u&7);for(v=0;v<w;v++)u&7||(Q=a[u>>3]),Q&128?(q&&(q[u]=1),m[u++]=2>z.encoding?D[E++]:h):(q&&(q[u]=
0),m[u++]=t),Q<<=1;u+=B}else if(2>z.encoding)for(r=0;r<n;r++){for(v=0;v<w;v++)m[u++]=D[E++];u+=B}else for(r=0;r<n;r++)if(m.fill)m.fill(h,u,u+w),u+=w+B;else{for(v=0;v<w;v++)m[u++]=h;u+=B}if(1===z.encoding&&E!==z.numValidPixels)throw"Block and Mask do not match";b++}}h=q;q={width:e.width,height:e.height,pixelData:m,minValue:e.pixels.minValue,maxValue:e.pixels.maxValue,noDataValue:t};h&&(q.maskData=h);c.returnEncodedMask&&e.mask&&(q.encodedMaskData=e.mask.bitset?e.mask.bitset:null);if(c.returnFileInfo&&
(q.fileInfo=f(e),c.computeUsedBitDepths)){c=q.fileInfo;h=e.pixels.numBlocksX*e.pixels.numBlocksY;Q={};for(D=0;D<h;D++)E=e.pixels.blocks[D],0===E.encoding?Q.float32=!0:1===E.encoding?Q[E.bitsPerPixel]=!0:Q[0]=!0;e=Object.keys(Q);c.bitDepths=e}return q};var f=function(f){return{fileIdentifierString:f.fileIdentifierString,fileVersion:f.fileVersion,imageType:f.imageType,height:f.height,width:f.width,maxZError:f.maxZError,eofOffset:f.eofOffset,mask:f.mask?{numBlocksX:f.mask.numBlocksX,numBlocksY:f.mask.numBlocksY,
numBytes:f.mask.numBytes,maxValue:f.mask.maxValue}:null,pixels:{numBlocksX:f.pixels.numBlocksX,numBlocksY:f.pixels.numBlocksY,numBytes:f.pixels.numBytes,maxValue:f.pixels.maxValue,minValue:f.pixels.minValue,noDataValue:this.noDataValue}}};return g})},"esri/layers/support/rasterFormats/Png":function(){define(["./Zlib"],function(C){return function(g){function f(c){var a,e,b,f;this.data=c;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(b=null;;){a=
this.readUInt32();f=c=void 0;f=[];for(c=0;4>c;++c)f.push(String.fromCharCode(this.data[this.pos++]));c=f.join("");switch(c){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};
break;case "PLTE":this.palette=this.read(a);break;case "fcTL":b&&this.animation.frames.push(b);this.pos+=4;b={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};c=this.readUInt16();a=this.readUInt16()||100;b.delay=1E3*c/a;b.disposeOp=this.data[this.pos++];b.blendOp=this.data[this.pos++];b.data=[];break;case "IDAT":case "fdAT":"fdAT"===c&&(this.pos+=4,a-=4);c=(null!=b?b.data:void 0)||this.imgData;for(f=0;0<=a?f<a:f>a;0<=a?++f:--f)c.push(this.data[this.pos++]);
break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(a);a=255-this.transparency.indexed.length;if(0<a)for(c=0;0<=a?c<a:c>a;0<=a?++c:--c)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case "tEXt":f=this.read(a);a=f.indexOf(0);c=String.fromCharCode.apply(String,f.slice(0,a));this.text[c]=String.fromCharCode.apply(String,f.slice(a+1));break;case "IEND":b&&
this.animation.frames.push(b);a:{switch(this.colorType){case 0:case 3:case 4:b=1;break a;case 2:case 6:b=3;break a}b=void 0}this.colors=b;this.hasAlphaChannel=4===(e=this.colorType)||6===e;e=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*e;a:{switch(this.colors){case 1:e="DeviceGray";break a;case 3:e="DeviceRGB";break a}e=void 0}this.colorSpace=e;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=a}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");
}}var t,c,h;f.load=function(c,a,e){var b;"function"===typeof a&&(e=a);b=new XMLHttpRequest;b.open("GET",c,!0);b.responseType="arraybuffer";b.onload=function(){var c;c=new Uint8Array(b.response||b.mozResponseArrayBuffer);c=new f(c);"function"===typeof(null!=a?a.getContext:void 0)&&c.render(a);return"function"===typeof e?e(c):void 0};return b.send(null)};f.prototype.read=function(c){var a,e;e=[];for(a=0;0<=c?a<c:a>c;0<=c?++a:--a)e.push(this.data[this.pos++]);return e};f.prototype.readUInt32=function(){var c,
a,e,b;c=this.data[this.pos++]<<24;a=this.data[this.pos++]<<16;e=this.data[this.pos++]<<8;b=this.data[this.pos++];return c|a|e|b};f.prototype.readUInt16=function(){var c,a;c=this.data[this.pos++]<<8;a=this.data[this.pos++];return c|a};f.prototype.decodePixels=function(c){var a,e,b,f,d,m,h,l,k,g,n,q,v,r,t;null==c&&(c=this.imgData);if(0===c.length)return new Uint8Array(0);c=new C(c);c=c.getBytes();l=this.pixelBitlength/8;q=l*this.width;k=new Uint8Array(q*this.height);m=c.length;for(e=g=n=0;g<m;){switch(c[g++]){case 0:for(f=
a=0;a<q;f=a+=1)k[e++]=c[g++];break;case 1:for(f=v=0;v<q;f=v+=1)a=c[g++],d=f<l?0:k[e-l],k[e++]=(a+d)%256;break;case 2:for(f=d=0;d<q;f=d+=1)a=c[g++],b=(f-f%l)/l,v=n&&k[(n-1)*q+b*l+f%l],k[e++]=(v+a)%256;break;case 3:for(f=t=0;t<q;f=t+=1)a=c[g++],b=(f-f%l)/l,d=f<l?0:k[e-l],v=n&&k[(n-1)*q+b*l+f%l],k[e++]=(a+Math.floor((d+v)/2))%256;break;case 4:for(f=t=0;t<q;f=t+=1)a=c[g++],b=(f-f%l)/l,d=f<l?0:k[e-l],0===n?v=r=0:(v=k[(n-1)*q+b*l+f%l],r=b&&k[(n-1)*q+(b-1)*l+f%l]),h=d+v-r,f=Math.abs(h-d),b=Math.abs(h-v),
h=Math.abs(h-r),d=f<=b&&f<=h?d:b<=h?v:r,k[e++]=(a+d)%256;break;default:throw Error("Invalid filter algorithm: "+c[g-1]);}n++}return k};f.prototype.decodePalette=function(){var c,a,e,b,f,d,h,g,l;e=this.palette;d=this.transparency.indexed||[];f=new Uint8Array((d.length||0)+e.length);a=h=c=b=0;for(g=e.length;h<g;a=h+=3)f[b++]=e[a],f[b++]=e[a+1],f[b++]=e[a+2],f[b++]=null!=(l=d[c++])?l:255;return f};f.prototype.copyToImageData=function(c,a){var e,b,f,d,m,h,l;b=this.colors;l=null;e=this.hasAlphaChannel;
this.palette.length&&(l=null!=(f=this._decodedPalette)?f:this._decodedPalette=this.decodePalette(),b=4,e=!0);c=c.data||c;h=c.length;d=l||a;f=m=0;if(1===b)for(;f<h;)b=l?4*a[f/4]:m,m=d[b++],c[f++]=m,c[f++]=m,c[f++]=m,c[f++]=e?d[b++]:this.transparency.grayscale&&this.transparency.grayscale===m?0:255,m=b;else for(;f<h;)b=l?4*a[f/4]:m,c[f++]=d[b++],c[f++]=d[b++],c[f++]=d[b++],c[f++]=e?d[b++]:this.transparency.rgb&&this.transparency.rgb[1]===d[b-3]&&this.transparency.rgb[3]===d[b-2]&&this.transparency.rgb[5]===
d[b-1]?0:255,m=b};f.prototype.decode=function(){var c;c=new Uint8Array(this.width*this.height*4);this.copyToImageData(c,this.decodePixels());return c};h=(c=g.document&&g.document.createElement("canvas"))&&c.getContext("2d");t=function(f){h.width=f.width;h.height=f.height;h.clearRect(0,0,f.width,f.height);h.putImageData(f,0,0);f=new Image;f.src=c.toDataURL();return f};f.prototype.decodeFrames=function(c){var a,e,b,f,d,m,h;if(this.animation){m=this.animation.frames;h=[];a=f=0;for(d=m.length;f<d;a=++f)a=
m[a],e=c.createImageData(a.width,a.height),b=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(e,b),a.imageData=e,h.push(a.image=t(e));return h}};f.prototype.renderFrame=function(c,a){var e,b;b=this.animation.frames;e=b[a];b=b[a-1];0===a&&c.clearRect(0,0,this.width,this.height);1===(null!=b?b.disposeOp:void 0)?c.clearRect(b.xOffset,b.yOffset,b.width,b.height):2===(null!=b?b.disposeOp:void 0)&&c.putImageData(b.imageData,b.xOffset,b.yOffset);0===e.blendOp&&c.clearRect(e.xOffset,e.yOffset,
e.width,e.height);return c.drawImage(e.image,e.xOffset,e.yOffset)};f.prototype.animate=function(c){var a,e,b,f,d,m,h=this;e=0;m=this.animation;f=m.numFrames;b=m.frames;d=m.numPlays;return(a=function(){var p,k;p=e++%f;k=b[p];h.renderFrame(c,p);if(1<f&&e/f<d)return h.animation._timeout=setTimeout(a,k.delay)})()};f.prototype.stopAnimation=function(){var c;return clearTimeout(null!=(c=this.animation)?c._timeout:void 0)};f.prototype.render=function(c){var a;c._png&&c._png.stopAnimation();c._png=this;c.width=
this.width;c.height=this.height;c=c.getContext("2d");if(this.animation)return this.decodeFrames(c),this.animate(c);a=c.createImageData(this.width,this.height);this.copyToImageData(a,this.decodePixels());return c.putImageData(a,0,0)};return f}(this)})},"esri/layers/support/rasterFormats/Raw":function(){define(["require","exports"],function(C,g){var f=function(f){var c=1;switch(f){case Uint8Array:case Int8Array:c=1;break;case Uint16Array:case Int16Array:c=2;break;case Uint32Array:case Int32Array:case Float32Array:c=
4;break;case Float64Array:c=8}return c};return function(){function g(){}g.decode=function(c,h){var m=h.pixelType,a=[],e=h.width*h.height,b=Math.floor(c.byteLength/(h.width*h.height*f(h.pixelType))),p=h.bandIds,d=h.format;h=p&&p.length||Math.floor(c.byteLength/(h.width*h.height*f(h.pixelType)));var g=c.byteLength-c.byteLength%(e*f(m)),y=new m(c,0,e*b),l,k,x,n;if("bip"===d)for(d=0;d<h;d++){x=new m(e);n=p?p[d]:d;for(l=0;l<e;l++)x[l]=y[l*b+n];a.push(x)}else if("bsq"===d)for(d=0;d<h;d++)n=p?p[d]:d,a.push(y.subarray(n*
e,(n+1)*e));if(g<c.byteLength-1)if(c=c.slice(g),8*c.byteLength<e)k=null;else{c=new Uint8Array(c,0,Math.ceil(e/8));m=new Uint8Array(e);for(k=h=k=p=b=0;k<c.length-1;k++)for(p=c[k],h=7;0<=h;h--)m[b++]=p>>h&1;for(h=7;b<e-1;)p=c[c.length-1],m[b++]=p>>h&1,h--;k=m}return{pixels:a,mask:k}};return g}()})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("require exports tslib ../rasterDatasets/byteStreamUtils ./Jpg ./TiffTags ./Zlib".split(" "),function(C,g,f,t,c,h,m){function a(a,b){var c=
"unknown";3===a?c="f32":1===a?1===b?c="u1":2===b?c="u2":4===b?c="u4":8>=b?c="u8":16>=b?c="u16":32>=b&&(c="u32"):2===a&&(8>=b?c="s8":16>=b?c="s16":32>=b&&(c="s32"));return c}function e(a){var b=null;switch(a?a.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":b=Uint8Array;break;case "u16":b=Uint16Array;break;case "u32":b=Uint32Array;break;case "s8":b=Int8Array;break;case "s16":b=Int16Array;break;case "s32":b=Int32Array;break;default:b=Float32Array}return b}function b(a,b){return{x:b[0]*
a.x+b[1]*a.y+b[2],y:b[3]*a.x+b[4]*a.y+b[5]}}function p(a,b){return(a=a.get(b))&&a.values}function d(a,b){return(a=a.get(b))&&a.values[0]}function A(a,b,c,e,d,f){void 0===e&&(e=0);void 0===d&&(d=h.TIFF_TAGS);void 0===f&&(f=4);var k=(new DataView(a,c,2)).getUint16(0,b),p=4+2*f,l=2+k*p;if(c+l>a.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:l};var n=c+l+4<=a.byteLength?(new DataView(a,c+l,4)).getUint32(0,b):null;c+=2;for(var m=new Map,u,g,r,q,w,x,B=0;B<k;B++){u=new DataView(a,
c+p*B,p);g=u.getUint16(0,b);q=u.getUint16(2,b);r=h.getTagName(g,d);if(2===f)w=u.getUint16(4,b),x=u.getUint16(6,b);else if(4===f)w=u.getUint32(4,b),x=u.getUint32(8,b);else if(8===f)if(x=w=0,b)for(var v=0;8>v;v++)w+=u.getUint8(4+v)*Math.pow(2,8*v),x+=u.getUint8(12+v)*Math.pow(2,8*v);else for(v=0;8>v;v++)w+=u.getUint8(4+v)*Math.pow(2,8*(7-v)),x+=u.getUint8(12+v)*Math.pow(2,8*(7-v));u={id:g,type:q,valueCount:w,valueOffset:x,values:null};y(a,b,u,e);m.set(r,u)}return{success:!0,ifd:m,nextIFD:n,requiredBufferSize:l}}
function y(a,b,c,e,d){void 0===e&&(e=0);if(c.values)return!0;var f=c.type,k=c.valueCount,p=c.valueOffset,l=[],h=q[f],n=8*h,m=k*h,u=k*q[f]*8;if(32<u&&m>(d?a.byteLength:a?a.byteLength-p+e:0))return c.offlineOffsetSize=[p,m],c.values=null,!1;if(32>=u)if(b||(p>>>=32-u),1===k)l=[p];else for(a=0;a<k;a++)l.push(p<<n*a>>>32-n);else for(p-=e,d&&(p=0),n=p;n<p+m;n+=h){switch(f){case 1:k=(new DataView(a,n,1)).getUint8(0);break;case 2:k=(new DataView(a,n,1)).getUint8(0);break;case 3:k=(new DataView(a,n,2)).getUint16(0,
b);break;case 4:k=(new DataView(a,n,4)).getUint32(0,b);break;case 5:k=(new DataView(a,n,4)).getUint32(0,b)/(new DataView(a,n+4,4)).getUint32(0,b);break;case 6:k=(new DataView(a,n,1)).getInt8(0);break;case 7:k=(new DataView(a,n,1)).getUint8(0);break;case 8:k=(new DataView(a,n,2)).getInt16(0,b);break;case 9:k=(new DataView(a,n,4)).getInt32(0,b);break;case 10:k=(new DataView(a,n,4)).getInt32(0,b)/(new DataView(a,n+4,4)).getInt32(0,b);break;case 11:k=(new DataView(a,n,4)).getFloat32(0,b);break;case 12:k=
(new DataView(a,n,8)).getFloat64(0,b);break;default:k=null}l.push(k)}if(2===f){f="";p=l;l=[];for(a=0;a<p.length;a++)0===p[a]&&""!==f?(l.push(f),f=""):f+=String.fromCharCode(p[a]);""===f&&0!==l.length||l.push(f)}c.values=l;return!0}function l(c){var e=c[0],f=d(e,"TILEWIDTH"),k=d(e,"TILELENGTH"),n=d(e,"IMAGEWIDTH"),l=d(e,"IMAGELENGTH"),h=d(e,"BITSPERSAMPLE"),m=d(e,"SAMPLESPERPIXEL"),g=d(e,"SAMPLEFORMAT")||1,r=a(g,h),q=p(e,"PLANARCONFIGURATION")?2===p(e,"PLANARCONFIGURATION")[0]:!1,w=p(e,"GDAL_NODATA"),
x;null!=w&&("string"===typeof w[0]?(x=w.map(function(a){return parseFloat(a)}),x.some(function(a){return isNaN(a)})&&(x=null)):"number"===typeof w[0]&&(x=w));var v=d(e,"COMPRESSION")||1;switch(v){case 1:w="NONE";break;case 2:case 3:case 4:case 32771:w="CCITT";break;case 5:w="LZW";break;case 6:case 7:w="JPEG";break;case 32773:w="PACKBITS";break;case 8:case 32946:w="DEFLATE";break;case 34712:w="JPEG2000";break;default:w=String(v)}var y=!0,t="";1!==v&&6!==v&&8!==v&&32946!==v&&(y=!1,t+="unsupported tag compression "+
v);3<g&&(y=!1,t+="unsupported tag sampleFormat "+g);0!==h%8&&(y=!1,t+="unsupported tag bitsPerSample "+h);var h=d(e,"GEOASCIIPARAMS"),A;h&&(A=(A=h.split("|").filter(function(a){return-1<a.indexOf("ESRI PE String \x3d ")})[0])?A.replace("ESRI PE String \x3d ",""):"",A=0===A.indexOf("PROJCS")||0===A.indexOf("GEOGCS")?{wkid:null,wkt:A}:null);var h=p(e,"GEOTIEPOINTS"),g=p(e,"GEOPIXELSCALE"),v=p(e,"GEOTRANSMATRIX"),K=e.has("GEOKEYDIRECTORY")?e.get("GEOKEYDIRECTORY").data:null,e=!1;if(K){var e=2===d(K,
"GTRasterTypeGeoKey"),C=d(K,"GTModelTypeGeoKey");2===C?(K=d(K,"GeographicTypeGeoKey"),1024<K&&32766>K&&(A={wkid:K})):1===C&&(K=d(K,"ProjectedCSTypeGeoKey"),1024<K&&32766>K&&(A={wkid:K}))}var O,V;g&&h&&6<=h.length?(O=[g[0],0,h[3]-h[0]*g[0],0,-Math.abs(g[1]),h[4]-h[1]*g[1]],e&&(O[2]-=.5*O[0]+.5*O[1],O[5]-=.5*O[3]+.5*O[4])):v&&16===v.length&&(O=[v[0],v[1],v[3],v[4],v[5],v[7]]);if(O){V=[{x:0,y:l},{x:0,y:0},{x:n,y:l},{x:n,y:0}];e=void 0;g=h=Number.POSITIVE_INFINITY;K=v=Number.NEGATIVE_INFINITY;for(C=0;C<
V.length;C++)e=b(V[C],O),h=e.x>h?h:e.x,v=e.x<v?v:e.x,g=e.y>g?g:e.y,K=e.y<K?K:e.y;V={xmin:h,xmax:v,ymin:g,ymax:K,spatialReference:A}}O=c.filter(function(a){return 1===d(a,"NEWSUBFILETYPE")});var P,W,X,Y;0<O.length&&(P=Math.round(Math.log(n/d(O[0],"IMAGEWIDTH"))/Math.LN2),W=Math.round(Math.log(n/d(O[O.length-1],"IMAGEWIDTH"))/Math.LN2),X=d(O[O.length-1],"TILEWIDTH"),Y=d(O[O.length-1],"TILEHEIGHT"));X=0<W?X||f:null;Y=0<W?Y||k:null;var Z;f&&(Z=[{maxCol:Math.ceil(n/f)-1,maxRow:Math.ceil(l/k)-1,minRow:0,
minCol:0}],O.forEach(function(a){Z.push({maxCol:Math.ceil(d(a,"IMAGEWIDTH")/d(a,"TILEWIDTH"))-1,maxRow:Math.ceil(d(a,"IMAGELENGTH")/d(a,"TILELENGTH"))-1,minRow:0,minCol:0})}));c=d(c[0],"GDAL_METADATA");c=F(c);return{width:n,height:l,tileWidth:f,tileHeight:k,planes:m,isBSQ:q,pixelType:r,compression:w,noData:x,isSupported:y,message:t,extent:V,firstPyramidLevel:P,maximumPyramidLevel:W,pyramidBlockWidth:X,pyramidBlockHeight:Y,tileBoundary:Z,metadata:c}}function k(a){var b=new DataView(a,0,8),c=b.getUint16(0,
!1),e=null;if(18761===c)e=!0;else if(19789===c)e=!1;else throw"unexpected endianess byte";if(42!==b.getUint16(2,e))throw"unexpected tiff identifier";c=b.getUint32(4,e);b=[];do if(c=x(a,e,c),c.success)b.push(c.ifd),c=c.nextIFD;else break;while(0<c);a=l(b);return f.__assign(f.__assign({},a),{littleEndian:e,ifds:b})}function x(a,b,c,e,d,f){void 0===e&&(e=0);void 0===d&&(d=h.TIFF_TAGS);void 0===f&&(f=4);c=A(a,b,c,e,d,f);var k,p=c.ifd;p&&(h.ifdTags.forEach(function(c,d){p.has(d)&&(k=p.get(d),k.data=A(a,
b,k.valueOffset-e,e,c).ifd)}),p.has("GEOKEYDIRECTORY")&&(k=p.get("GEOKEYDIRECTORY"),(d=k.values)&&4<d.length&&(d=d[0]+"."+d[1]+"."+d[2],k.data=A(a,b,k.valueOffset+6-e,e,h.GEO_KEYS,2).ifd,k.data&&k.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[d]}))),p.has("XMP")&&(k=p.get("XMP"),d=k.values,"number"===typeof d[0]&&7===k.type&&(k.values=[t.bytesToUTF8(new Uint8Array(d))])));return c}Object.defineProperty(g,"__esModule",{value:!0});var n=function(){var a=new ArrayBuffer(4),
b=new Uint8Array(a);(new Uint32Array(a))[0]=1;return 1===b[0]}(),q=[0,1,1,2,4,8,1,1,2,4,8,4,8],v=function(b,f,k,p,h){f=n===f;var l=d(k,"BITSPERSAMPLE"),g=d(k,"SAMPLEFORMAT")||1,l=a(g,l),g=d(k,"COMPRESSION")[0]||1;k=e(l);var u,r;1===g?(u=b.slice(p,p+h),r=new Uint8Array(u)):8===g||32946===g?(r=new Uint8Array(b,p,h),r=new m(r),b=r.getBytes(),u=new ArrayBuffer(b.length),r=new Uint8Array(u),r.set(b)):6===g&&(r=new Uint8Array(b,p,h),u=new c,u.parse(r),b=u.getData(u.width,u.height,!0),u=new ArrayBuffer(b.length),
r=new Uint8Array(u),r.set(b));if("u8"!==l&&"s8"!==l&&!f)switch(u=new ArrayBuffer(r.length),f=new Uint8Array(u),l){case "u16":case "s16":for(l=0;l<r.length;l+=2)f[l]=r[l+1],f[l+1]=r[l];break;case "u32":case "s32":case "f32":for(l=0;l<r.length;l+=4)f[l]=r[l+3],f[l+1]=r[l+2],f[l+2]=r[l+1],f[l+3]=r[l]}return new k(u)},r=function(a,b,c){if(!(a&&0<a.length&&b&&c))return null;for(var e,d,f,k=a[0].length,p=a.length,l=new Uint8Array(k),h=0;h<p;h++)if(e=a[h],d=b[h],f=c[h],0===h)for(var n=0;n<k;n++)l[n]=e[n]<
d||e[n]>f?0:1;else for(n=0;n<k;n++)l[n]&&(l[n]=e[n]<d||e[n]>f?0:1);return l},F=function(a){if(!a)return null;var b=a.match(/<Item(.*?)Item>/gi);if(!b||0===b.length)return null;a=new Map;for(var c,e,d,f,k=0;k<b.length;k++)c=b[k],e=c.slice(6,c.indexOf("\x3e")),d=c.indexOf("sample\x3d"),-1<d&&(f=c.slice(d+8,c.indexOf('"',d+8))),d=c.indexOf("name\x3d"),-1<d&&(e=c.slice(d+6,c.indexOf('"',d+6))),e&&(c=c.slice(c.indexOf("\x3e")+1,c.indexOf("\x3c/Item\x3e")).trim(),null!=f?a.has(e)?a.get(e)[f]=c:a.set(e,
[c]):a.set(e,c)),f=null;b=a.get("STATISTICS_MINIMUM");e=a.get("STATISTICS_MAXIMUM");c=a.get("STATISTICS_MEAN");d=a.get("STATISTICS_STDDEV");f=null;if(b&&e)for(f=[],k=0;k<b.length;k++)f.push({min:parseFloat(b[k]),max:parseFloat(e[k]),avg:c&&parseFloat(c[k]),stddev:d&&parseFloat(d[k])});e=a.get("BandName");c=a.get("WavelengthMin");d=a.get("WavelengthMax");b=null;if(e)for(b=[],k=0;k<e.length;k++)b.push({BandName:e[k],WavelengthMin:c&&parseFloat(c[k]),WavelengthMax:d&&parseFloat(d[k])});k=a.get("DataType");
return{statistics:f,bandProperties:b,dataType:k,rawMetadata:a}};g.parseFieldValues=y;g.getImageInfo=l;g.parseHeader=k;g.parseSignature=function(a){var b=new DataView(a,0,8),c=b.getUint16(0,!1);a=null;if(18761===c)a=!0;else if(19789===c)a=!1;else throw"unexpected endianess byte";if(42!==b.getUint16(2,a))throw"unexpected tiff identifier";b=b.getUint32(4,a);return{littleEndian:a,firstIFD:b}};g.parseIFD=x;g.decodeTileOrStrip=function(a,b){var c=b.headerInfo,f=b.ifd,k=v(a,c.littleEndian,f,b.offset||0,
b.size||a.byteLength);a=c.pixelType;for(var l=c.isBSQ,p=c.planes,n=e(a),h=k.length/p,m,g=[],q=0;q<p;q++){m=new n(h);if(l)m=k.slice(h*q,h*(q+1));else for(var u=0;u<h;u++)m[u]=k[u*p+q];g.push(m)}var k=d(f,"TILEWIDTH"),f=d(f,"TILELENGTH"),l=c.noData?c.noData[0]:null,c=(p=c.metadata?c.metadata.statistics:null)?p.map(function(a){return a.min}):null,p=p?p.map(function(a){return a.max}):null,x;if(null!=l)if(x=new Uint8Array(h),1E24<Math.abs(l))for(b=0;b<h;b++)x[b]=1E-6>Math.abs((g[0][b]-l)/l)?0:1;else for(b=
0;b<h;b++)x[b]=g[0][b]===l?0:1;else c&&p&&b.applyMinMaxConstraint&&(x=r(g,c,p));return{pixelType:a,width:k,height:f,pixels:g,mask:x,noDataValue:l}};g.decode=function(a,b){b=b||k(a);var d=b.ifds,f=b.noData;if(0===d.length)throw"no valid image file directory";d=d[0];f=f?f[0]:null;if(b.tileWidth){var l=p(d,"TILEOFFSETS");if(void 0===l)d=null;else{for(var h=p(d,"TILEBYTECOUNTS"),g=b.tileWidth,r=b.tileHeight,q=b.width,u=b.height,x=b.pixelType,w=b.isBSQ,y=b.planes,t=q*u,F=p(d,"BITSPERSAMPLE")[0],A=e(x),
C=[],K=0;K<y;K++)C.push(new A(t));var U,O,V,P,W,X,Y,Z,t=Math.ceil(q/g);if(0===F%8)for(F=0;F<l.length;F++)for(U=Math.floor(F/t)*r,P=F%t*g,K=U*q+P,A=v(a,b.littleEndian,d,l[F],h[F]),X=0,W=K,P=Math.min(g,q-P),Y=Math.min(r,u-U),U=0;U<y;U++)if(Z=C[U],w)for(O=0;O<Y;O++)for(W=K+O*q,X=g*r*U+O*g,V=0;V<P;V++,W++,X++)Z[W]=A[X];else for(O=0;O<Y;O++)for(W=K+O*q,X=O*g*y+U,V=0;V<P;V++,W++,X+=y)Z[W]=A[X];d={width:q,height:u,pixelType:x,pixels:C}}}else if(r=b,C=n===r.littleEndian,t=p(d,"STRIPOFFSETS"),void 0===t)d=
null;else{b=r.width;l=r.height;h=r.pixelType;r=r.planes;q=b*l;F=p(d,"BITSPERSAMPLE")[0];u=e(h);x=new u(q*r);A=p(d,"STRIPBYTECOUNTS");K=p(d,"ROWSPERSTRIP")[0];W=p(d,"COMPRESSION")?p(d,"COMPRESSION")[0]:1;P=K;if(0===F%8)for(d=0;d<t.length;d++){X=d*K*b*r;P=(d+1)*K>l?l-d*K:K;if("u8"===h||"s8"===h||C)8===W||32946===W?(w=new Uint8Array(a,t[d],A[d]),w=new m(w),U=w.getBytes(),y=new ArrayBuffer(U.length),w=new Uint8Array(y),w.set(U),w.length!==P*b*r*F/8&&console.log("strip byte counts is different than expected")):
6===W?(w=new Uint8Array(a,t[d],A[d]),y=new c,y.parse(w),P=y.getData(y.width,y.height,!0),y=new ArrayBuffer(P.length),w=new Uint8Array(y),w.set(P)):1===W&&(A[d]!==P*b*r*F/8&&console.log("strip byte counts is different than expected"),y=a.slice(t[d],t[d]+A[d]));else switch(6===W||8===W||32946===W?(w=new Uint8Array(a,t[d],A[d]),w=new m(w),w=w.getBytes(),y=new ArrayBuffer(w.length),g=new Uint8Array(y),w.length!==P*b*r*F/8&&console.log("strip byte counts is different than expected")):1===W&&(A[d]!==P*
b*r*F/8&&console.log("strip byte counts is different than expected"),y=new ArrayBuffer(A[d]),w=new Uint8Array(a,t[d],A[d]),g=new Uint8Array(y)),h){case "u16":case "s16":for(P=0;P<w.length;P+=2)g[P]=w[P+1],g[P+1]=w[P];break;case "u32":case "s32":case "f32":for(P=0;P<w.length;P+=4)g[P]=w[P+3],g[P+1]=w[P+2],g[P+2]=w[P+1],g[P+3]=w[P]}P=new u(y);x.set(P,X)}w=[];if(1===r)w.push(x);else for(d=0;d<r;d++){g=new u(q);for(a=0;a<q;a++)g[a]=x[a*r+d];w.push(g)}d={width:b,height:l,pixelType:h,pixels:w}}if(null!==
f){d.mask=new Uint8Array(d.width*d.height);if(1E24<Math.abs(f))for(a=0;a<d.width*d.height;a++)d.mask[a]=1E-6>Math.abs((d.pixels[0][a]-f)/f)?0:1;else for(a=0;a<d.width*d.height;a++)d.mask[a]=d.pixels[0][a]===f?0:1;d.noDataValue=f}return d}})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["require","exports"],function(C,g){Object.defineProperty(g,"__esModule",{value:!0});g.bytesToUTF8=function(f,g){for(var c=0,h="",m=0,a=0,e=f.length;c<e;)if(a=f[c++],m=a>>4,8>m?m=1:15===m?
(m=4,a=(a&7)<<18|(f[c++]&63)<<12|(f[c++]&63)<<6|f[c++]&63):14===m?(m=3,a=(a&15)<<12|(f[c++]&63)<<6|f[c++]&63):(m=2,a=(a&31)<<6|f[c++]&63),0!==a||g)h+=String.fromCharCode(a);return h}})},"esri/layers/support/rasterFormats/TiffTags":function(){define(["require","exports"],function(C,g){var f=function(){var c=[];c[254]="NEWSUBFILETYPE";c[255]="SUBFILETYPE";c[256]="IMAGEWIDTH";c[257]="IMAGELENGTH";c[258]="BITSPERSAMPLE";c[259]="COMPRESSION";c[262]="PHOTOMETRICINTERPRETATION";c[263]="THRESHHOLDING";c[264]=
"CELLWIDTH";c[265]="CELLLENGTH";c[266]="FILLORDER";c[269]="DOCUMENTNAME";c[270]="IMAGEDESCRIPTION";c[271]="MAKE";c[272]="MODEL";c[273]="STRIPOFFSETS";c[274]="ORIENTATION";c[277]="SAMPLESPERPIXEL";c[278]="ROWSPERSTRIP";c[279]="STRIPBYTECOUNTS";c[280]="MINSAMPLEVALUE";c[281]="MAXSAMPLEVALUE";c[282]="XRESOLUTION";c[283]="YRESOLUTION";c[284]="PLANARCONFIGURATION";c[285]="PAGENAME";c[286]="XPOSITION";c[287]="YPOSITION";c[288]="FREEOFFSETS";c[289]="FREEBYTECOUNTS";c[290]="GRAYRESPONSEUNIT";c[291]="GRAYRESPONSECURVE";
c[292]="T4OPTIONS";c[293]="T6OPTIONS";c[296]="RESOLUTIONUNIT";c[297]="PAGENUMBER";c[300]="COLORRESPONSEUNIT";c[301]="TRANSFERFUNCTION";c[305]="SOFTWARE";c[306]="DATETIME";c[315]="ARTIST";c[316]="HOSTCOMPUTER";c[317]="PREDICTOR";c[318]="WHITEPOINT";c[319]="PRIMARYCHROMATICITIES";c[320]="COLORMAP";c[321]="HALFTONEHINTS";c[322]="TILEWIDTH";c[323]="TILELENGTH";c[324]="TILEOFFSETS";c[325]="TILEBYTECOUNTS";c[326]="BADFAXLINES";c[327]="CLEANFAXDATA";c[328]="CONSECUTIVEBADFAXLINES";c[330]="SUBIFD";c[332]=
"INKSET";c[333]="INKNAMES";c[334]="NUMBEROFINKS";c[336]="DOTRANGE";c[337]="TARGETPRINTER";c[338]="EXTRASAMPLES";c[339]="SAMPLEFORMAT";c[340]="SMINSAMPLEVALUE";c[341]="SMAXSAMPLEVALUE";c[342]="TRANSFERRANGE";c[347]="JPEGTABLES";c[512]="JPEGPROC";c[513]="JPEGIFOFFSET";c[514]="JPEGIFBYTECOUNT";c[515]="JPEGRESTARTINTERVAL";c[517]="JPEGLOSSLESSPREDICTORS";c[518]="JPEGPOINTTRANSFORM";c[519]="JPEGQTABLES";c[520]="JPEGDCTABLES";c[521]="JPEGACTABLES";c[529]="YCBCRCOEFFICIENTS";c[530]="YCBCRSUBSAMPLING";c[531]=
"YCBCRPOSITIONING";c[532]="REFERENCEBLACKWHITE";c[700]="XMP";c[33550]="GEOPIXELSCALE";c[33922]="GEOTIEPOINTS";c[33432]="COPYRIGHT";c[42112]="GDAL_METADATA";c[42113]="GDAL_NODATA";c[50844]="RPCCOEFFICIENT";c[34264]="GEOTRANSMATRIX";c[34735]="GEOKEYDIRECTORY";c[34736]="GEODOUBLEPARAMS";c[34737]="GEOASCIIPARAMS";c[34665]="EXIFIFD";c[34853]="GPSIFD";c[40965]="INTEROPERABILITYIFD";return c}();C=function(){var c=[].concat(f);c[36864]="ExifVersion";c[40960]="FlashpixVersion";c[40961]="ColorSpace";c[42240]=
"Gamma";c[37121]="ComponentsConfiguration";c[37122]="CompressedBitsPerPixel";c[40962]="PixelXDimension";c[40963]="PixelYDimension";c[37500]="MakerNote";c[37510]="UserComment";c[40964]="RelatedSoundFile";c[36867]="DateTimeOriginal";c[36868]="DateTimeDigitized";c[36880]="OffsetTime";c[36881]="OffsetTimeOriginal";c[36882]="OffsetTimeDigitized";c[37520]="SubSecTime";c[37521]="SubSecTimeOriginal";c[37522]="SubSecTimeDigitized";c[37888]="Temperature";c[37889]="Humidity";c[37890]="Pressure";c[37891]="WaterDepth";
c[37892]="Acceleration";c[37893]="CameraElevationAngle";c[42016]="ImageUniqueID";c[42032]="CameraOwnerName";c[42033]="BodySerialNumber";c[42034]="LensSpecification";c[42035]="LensMake";c[42036]="LensModel";c[42037]="LensSerialNumber";c[33434]="ExposureTime";c[33437]="FNumber";c[34850]="ExposureProgram";c[34852]="SpectralSensitivity";c[34855]="PhotographicSensitivity";c[34856]="OECF";c[34864]="SensitivityType";c[34865]="StandardOutputSensitivity";c[34866]="RecommendedExposureIndex";c[34867]="ISOSpeed";
c[34868]="ISOSpeedLatitudeyyy";c[34869]="ISOSpeedLatitudezzz";c[37377]="ShutterSpeedValue";c[37378]="ApertureValue";c[37379]="BrightnessValue";c[37380]="ExposureBiasValue";c[37381]="MaxApertureValue";c[37382]="SubjectDistance";c[37383]="MeteringMode";c[37384]="LightSource";c[37385]="Flash";c[37386]="FocalLength";c[37396]="SubjectArea";c[41483]="FlashEnergy";c[41484]="SpatialFrequencyResponse";c[41486]="FocalPlaneXResolution";c[41487]="FocalPlaneYResolution";c[41488]="FocalPlaneResolutionUnit";c[41492]=
"SubjectLocation";c[41493]="ExposureIndex";c[41495]="SensingMethod";c[41728]="FileSource";c[41729]="SceneType";c[41730]="CFAPattern";c[41985]="CustomRendered";c[41986]="ExposureMode";c[41987]="WhiteBalance";c[41988]="DigitalZoomRatio";c[41989]="FocalLengthIn35mmFilm";c[41990]="SceneCaptureType";c[41991]="GainControl";c[41992]="Contrast";c[41993]="Saturation";c[41994]="Sharpness";c[41995]="DeviceSettingDescription";c[41996]="SubjectDistanceRange";return c}();g=function(){var c=[];c[1024]="GTModelTypeGeoKey";
c[1025]="GTRasterTypeGeoKey";c[1026]="GTCitationGeoKey";c[2048]="GeographicTypeGeoKey";c[2049]="GeogCitationGeoKey";c[2050]="GeogGeodeticDatumGeoKey";c[2051]="GeogPrimeMeridianGeoKey";c[2052]="GeogLinearUnitsGeoKey";c[2053]="GeogLinearUnitSizeGeoKey";c[2054]="GeogAngularUnitsGeoKey";c[2055]="GeogAngularUnitSizeGeoKey";c[2056]="GeogEllipsoidGeoKey";c[2057]="GeogSemiMajorAxisGeoKey";c[2058]="GeogSemiMinorAxisGeoKey";c[2059]="GeogInvFlatteningGeoKey";c[2061]="GeogPrimeMeridianLongGeoKey";c[2060]="GeogAzimuthUnitsGeoKey";
c[3072]="ProjectedCSTypeGeoKey";c[3073]="PCSCitationGeoKey";c[3074]="ProjectionGeoKey";c[3075]="ProjCoordTransGeoKey";c[3076]="ProjLinearUnitsGeoKey";c[3077]="ProjLinearUnitSizeGeoKey";c[3078]="ProjStdParallel1GeoKey";c[3079]="ProjStdParallel2GeoKey";c[3080]="ProjNatOriginLongGeoKey";c[3081]="ProjNatOriginLatGeoKey";c[3082]="ProjFalseEastingGeoKey";c[3083]="ProjFalseNorthingGeoKey";c[3084]="ProjFalseOriginLongGeoKey";c[3085]="ProjFalseOriginLatGeoKey";c[3086]="ProjFalseOriginEastingGeoKey";c[3087]=
"ProjFalseOriginNorthingGeoKey";c[3088]="ProjCenterLongGeoKey";c[3090]="ProjCenterEastingGeoKey";c[3091]="ProjCenterNorthingGeoKey";c[3092]="ProjScaleAtNatOriginGeoKey";c[3093]="ProjScaleAtCenterGeoKey";c[3094]="ProjAzimuthAngleGeoKey";c[3095]="ProjStraightVertPoleLongGeoKey";c[4096]="VerticalCSTypeGeoKey";c[4097]="VerticalCitationGeoKey";c[4098]="VerticalDatumGeoKey";c[4099]="VerticalUnitsGeoKey";return c}();var t=new Map;t.set("EXIFIFD",C);t.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{TIFF_TAGS:f,ifdTags:t,GEO_KEYS:g,getTagName:function(c,h){h=(h||f)[c];void 0===h&&(h="unknown"+String(c));return h}}})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(C,g,f){function t(a,c){a=Math.min(Math.max(a,-100),100);c=Math.min(Math.max(c,-100),100);var b,e,d=new Uint8Array(256);for(b=0;256>b;b++)0<a&&100>a?e=(200*b-25500+510*c)/(2*(100-a))+128:0>=a&&-100<a?e=(200*b-25500+510*c)*(100+a)/2E4+128:100===a?(e=200*b-25500+
256*(100-a)+510*c,e=0<e?255:0):-100===a&&(e=128),d[b]=255<e?255:0>e?0:e;return d}function c(a,c,b,f,d,h,m,l){return{xmin:d<=b*a?0:d<b*a+a?d-b*a:a,ymin:h<=f*c?0:h<f*c+c?h-f*c:c,xmax:d+m<=b*a?0:d+m<b*a+a?d+m-b*a:a,ymax:h+l<=f*c?0:h+l<f*c+c?h+l-f*c:c}}function h(a,e,b,h){var d=a.filter(function(a){return m(a)})[0];if(null==d)return null;var p=h?h.width:e.width;h=h?h.height:e.height;var g=d.width,l=d.height,k=e.width/g;e=e.height/l;var x=b?b.x:0;b=b?b.y:0;var n=d.pixelType,q=f.getPixelArrayConstructor(n),
v=d.pixels.length,d=[],r,t,w,u,B,z,D,E,J,H;for(B=0;B<v;B++){t=new q(p*h);for(z=0;z<e;z++)for(D=0;D<k;D++)if(w=a[z*k+D])for(r=w.pixels[B],H=c(g,l,D,z,x,b,p,h),E=H.ymin;E<H.ymax;E++)for(w=(z*l+E-b)*p+(D*g-x),u=E*g,J=H.xmin;J<H.xmax;J++)t[w+J]=r[u+J];d.push(t)}var M;if(a.some(function(a){return null==a||a.mask&&0<a.mask.length}))for(M=new Uint8Array(p*h),z=0;z<e;z++)for(D=0;D<k;D++)if(q=(w=a[z*k+D])?w.mask:null,H=c(g,l,D,z,x,b,p,h),q)for(E=H.ymin;E<H.ymax;E++)for(w=(z*l+E-b)*p+(D*g-x),u=E*g,J=H.xmin;J<
H.xmax;J++)M[w+J]=q[u+J];else if(w)for(E=H.ymin;E<H.ymax;E++)for(w=(z*l+E-b)*p+(D*g-x),u=E*g,J=H.xmin;J<H.xmax;J++)M[w+J]=1;else for(E=H.ymin;E<H.ymax;E++)for(w=(z*l+E-b)*p+(D*g-x),u=E*g,J=H.xmin;J<H.xmax;J++)M[w+J]=0;a=new f({width:p,height:h,pixels:d,pixelType:n,mask:M});a.updateStatistics();return a}Object.defineProperty(g,"__esModule",{value:!0});var m=function(a){return a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length};g.extractBands=function(a,c){if(!c||!m(a))return a;
var b=a.pixels.length;return c&&c.some(function(a){return a>=b})||1===b&&1===c.length&&0===c[0]||b===c.length&&!c.some(function(a,b){return a!==b})?a:new f({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:c.map(function(b){return a.pixels[b]}),statistics:a.statistics&&c.map(function(b){return a.statistics[b]})})};g.createColormapLUT=function(a){if(a){var c=a.colormap;if(c&&0!==c.length){var c=c.sort(function(a,b){return a[0]-
b[0]}),b=0;0>c[0][0]&&(b=c[0][0]);var f=Math.max(256,c[c.length-1][0]-b+1),d=new Uint8Array(4*f),h=[],m=0,l=0,k=5===c[0].length;if(65536<f)return c.forEach(function(a){h[a[0]-b]=k?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:h,offset:b,alphaSpecified:k};if(a.fillUnspecified)for(a=c[l],m=a[0]-b;m<f;m++)d[4*m]=a[1],d[4*m+1]=a[2],d[4*m+2]=a[3],d[4*m+3]=k?a[4]:255,m===a[0]-b&&(a=l===c.length-1?a:c[++l]);else for(m=0;m<c.length;m++)a=c[m],l=4*(a[0]-b),d[l]=a[1],d[l+1]=a[2],d[l+2]=a[3],d[l+
3]=k?a[4]:255;return{indexedColormap:d,offset:b,alphaSpecified:k}}}};g.colorize=function(a,c){if(!m(a)||!c&&(c.indexedColormap||c.indexed2DColormap))return a;var b=a.clone(),e=b.pixels,d=b.mask,f=b.width*b.height;if(1!==e.length)return a;var h=c.indexedColormap;a=c.indexed2DColormap;var l=c.offset;c=c.alphaSpecified;var k=h.length-1,g=0,e=e[0],n=new Uint8Array(e.length),q=new Uint8Array(e.length),v=new Uint8Array(e.length),r=0;if(h)if(d)for(g=0;g<f;g++)d[g]&&(r=4*(e[g]-l),r<l||r>k?d[g]=0:(n[g]=h[r],
q[g]=h[r+1],v[g]=h[r+2],d[g]=h[r+3]));else{d=new Uint8Array(f);for(g=0;g<f;g++)r=4*(e[g]-l),r<l||r>k?d[g]=0:(n[g]=h[r],q[g]=h[r+1],v[g]=h[r+2],d[g]=h[r+3]);b.mask=d}else if(d)for(g=0;g<f;g++)d[g]&&(h=a[e[g]],n[g]=h[0],q[g]=h[1],v[g]=h[2],d[g]=h[3]);else{d=new Uint8Array(f);for(g=0;g<f;g++)h=a[e[g]],n[g]=h[0],q[g]=h[1],v[g]=h[2],d[g]=h[3];b.mask=d}b.pixels=[n,q,v];b.statistics=null;b.pixelType="u8";b.maskIsAlpha=c;return b};g.estimateStatisticsHistograms=function(a){if(!m(a))return null;a.statistics||
a.updateStatistics();var c=a.pixels,b=a.mask,f=a.pixelType,d=a.statistics;a=a.width*a.height;var h=c.length,g,l,k,x,n,q=[],v=[],r,t,w;for(x=0;x<h;x++){r=new Uint32Array(256);w=c[x];if("u8"===f)if(g=-.5,l=255.5,b)for(n=0;n<a;n++)b[n]&&r[w[n]]++;else for(n=0;n<a;n++)r[w[n]]++;else{g=d[x].minValue;l=d[x].maxValue;k=(l-g)/256;t=new Uint32Array(257);if(b)for(n=0;n<a;n++)b[n]&&t[Math.floor((w[n]-g)/k)]++;else for(n=0;n<a;n++)t[Math.floor((w[n]-g)/k)]++;for(n=0;255>n;n++)r[n]=t[n];r[255]=t[255]+t[256]}q.push({min:g,
max:l,size:256,counts:r});for(n=w=t=k=0;256>n;n++)k+=r[n],t+=n*r[n];t/=k;for(n=0;256>n;n++)w+=r[n]*Math.pow(n-t,2);r=Math.sqrt(w/(k-1));k=(l-g)/256;n=(t+.5)*k+g;r*=k;v.push({min:g,max:l,avg:n,stddev:r})}return{statistics:v,histograms:q}};g.createStretchLUT=function(a){var c=a.minCutOff,b=a.maxCutOff,f=a.gamma,d=a.pixelType,h=a.outMin||0,m=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(d))return null;var l=c.length,k,g=0;"s8"===d?g=-127:"s16"===d&&(g=-32767);var n=256;-1<["u16","s16"].indexOf(d)&&
(n=65536);for(var q=[],v=m-h,d=0;d<l;d++)q[d]=b[d]-c[d];k=f&&f.length>=l;var r=[];if(k)for(d=0;d<l;d++)r[d]=1<f[d]?2<f[d]?6.5+Math.pow(f[d]-2,2.5):6.5+100*Math.pow(2-f[d],4):1;var F,w=[],u,B,z;if(k)for(d=0;d<l;d++){z=[];for(k=0;k<n;k++)u=k+g,F=(u-c[d])/q[d],B=1,1<f[d]&&(B-=Math.pow(1/v,F*r[d])),z[k]=u<b[d]&&u>c[d]?Math.floor(B*v*Math.pow(F,1/f[d]))+h:u>=b[d]?m:h;w[d]=z}else for(d=0;d<l;d++){z=[];for(k=0;k<n;k++)u=k+g,z[k]=u<=c[d]?h:u>=b[d]?m:Math.floor((u-c[d])/q[d]*v)+h;w[d]=z}if(null!=a.contrastOffset)for(a=
t(a.contrastOffset,a.brightnessOffset),d=0;d<l;d++)for(z=w[d],k=0;k<n;k++)z[k]=a[z[k]];return{lut:w,offset:g}};g.createContrastBrightnessLUT=t;g.stretch=function(a,c){if(!m(a))return null;a=a.clone();var b=a.pixels,e=a.mask,d=c.minCutOff,f=c.maxCutOff,h=c.gamma,l=c.outMin||0;c=c.outMax||255;var k=a.width*a.height,g=b.length,n,q,v,r,t,w=c-l,u=[];for(n=0;n<g;n++)u[n]=f[n]-d[n];q=h&&h.length>=g;var B=[];if(q)for(n=0;n<g;n++)B[n]=1<h[n]?2<h[n]?6.5+Math.pow(h[n]-2,2.5):6.5+100*Math.pow(2-h[n],4):1;if(q)if(null!=
e)for(q=0;q<k;q++){if(e[q])for(n=0;n<g;n++)v=b[n][q],t=(v-d[n])/u[n],r=1,1<h[n]&&(r-=Math.pow(1/w,t*B[n])),b[n][q]=v<f[n]&&v>d[n]?Math.floor(r*w*Math.pow(t,1/h[n]))+l:v>=f[n]?c:l}else for(q=0;q<k;q++)for(n=0;n<g;n++)v=b[n][q],t=(v-d[n])/u[n],r=1,1<h[n]&&(r-=Math.pow(1/w,t*B[n])),b[n][q]=v<f[n]&&v>d[n]?Math.floor(r*w*Math.pow(t,1/h[n]))+l:v>=f[n]?c:l;else if(null!=e)for(q=0;q<k;q++){if(e[q])for(n=0;n<g;n++)v=b[n][q],b[n][q]=v<f[n]&&v>d[n]?Math.floor((v-d[n])/u[n]*w)+l:v>=f[n]?c:l}else for(q=0;q<k;q++)for(n=
0;n<g;n++)v=b[n][q],b[n][q]=v<f[n]&&v>d[n]?Math.floor((v-d[n])/u[n]*w)+l:v>=f[n]?c:l;a.pixelType="u8";a.updateStatistics();return a};g.lookupPixels=function(a,c){if(!m(a))return null;var b=a.pixels,e=a.mask,d=a.width*a.height,h=b.length,g=c.lut;c=c.offset;var l,k;g&&1===g[0].length&&(g=b.map(function(){return g}));var x=[],n,q,v;if(c)if(null==e)for(l=0;l<h;l++){n=b[l];q=g[l];v=new Uint8Array(d);for(k=0;k<d;k++)v[k]=q[n[k]-c];x.push(v)}else for(l=0;l<h;l++){n=b[l];q=g[l];v=new Uint8Array(d);for(k=
0;k<d;k++)e[k]&&(v[k]=q[n[k]-c]);x.push(v)}else if(null==e)for(l=0;l<h;l++){n=b[l];q=g[l];v=new Uint8Array(d);for(k=0;k<d;k++)v[k]=q[n[k]];x.push(v)}else for(l=0;l<h;l++){n=b[l];q=g[l];v=new Uint8Array(d);for(k=0;k<d;k++)e[k]&&(v[k]=q[n[k]]);x.push(v)}a=new f({width:a.width,height:a.height,pixels:x,mask:e,pixelType:"u8"});a.updateStatistics();return a};g.remapColor=function(a,c){if(!m(a))return null;a=a.clone();var b=a.width*a.height,e=c.length,d=Math.floor(e/2),f=c[Math.floor(d)],h=a.pixels[0],l,
k,g,n,q,v,r=!1,t=new Uint8Array(b),w=new Uint8Array(b),u=new Uint8Array(b),B=a.mask,z=4===c[0].mappedColor.length;B||(B=new Uint8Array(b),B.fill(z?255:1),a.mask=B);for(q=0;q<b;q++)if(B[q]){l=h[q];r=!1;v=d;k=f;g=0;for(n=e-1;1<n-g;){if(l===k.value){r=!0;break}l>k.value?g=v:n=v;v=Math.floor((g+n)/2);k=c[Math.floor(v)]}r||(l===c[g].value?(k=c[g],r=!0):l===c[n].value?(k=c[n],r=!0):l<c[g].value?(r=!1,k=null):l>c[g].value&&(l<c[n].value?(k=c[g],r=!0):n===e-1?(r=!1,k=null):(k=c[n],r=!0)));r?(t[q]=k.mappedColor[0],
w[q]=k.mappedColor[1],u[q]=k.mappedColor[2],B[q]=k.mappedColor[3]):t[q]=w[q]=u[q]=B[q]=0}a.pixels=[t,w,u];a.mask=B;a.pixelType="u8";a.maskIsAlpha=z;return a};g.getClipBounds=c;g.mosaicPixelData=function(a,c){if(!a||0===a.length)return null;var b=a.filter(function(a){return a.pixelBlock})[0];if(!b)return null;var e=(b.extent.xmax-b.extent.xmin)/b.pixelBlock.width,d=(b.extent.ymax-b.extent.ymin)/b.pixelBlock.height,f=.01*Math.min(e,d),g=a.sort(function(a,b){return Math.abs(a.extent.ymax-b.extent.ymax)>
f?b.extent.ymax-a.extent.ymax:Math.abs(a.extent.xmin-b.extent.xmin)>f?a.extent.xmin-b.extent.xmin:0}),l=Math.min.apply(null,g.map(function(a){return a.extent.xmin})),k=Math.min.apply(null,g.map(function(a){return a.extent.ymin})),m=Math.max.apply(null,g.map(function(a){return a.extent.xmax})),n=Math.max.apply(null,g.map(function(a){return a.extent.ymax}));a={x:Math.round((c.xmin-l)/e),y:Math.round((n-c.ymax)/d)};l={width:Math.round((m-l)/e),height:Math.round((n-k)/d)};e={width:Math.round((c.xmax-
c.xmin)/e),height:Math.round((c.ymax-c.ymin)/d)};if(Math.round(l.width/b.pixelBlock.width)*Math.round(l.height/b.pixelBlock.height)!==g.length||0>a.x||0>a.y||l.width<e.width||l.height<e.height)return null;b=g.map(function(a){return a.pixelBlock});b=h(b,l,a,e);return{extent:c,pixelBlock:b}};g.mosaic=h;g.setValidBoundary=function(a,c,b){if(!m(a))return null;var e=a.width,d=a.height,f=c.x;c=c.y;var h=b.width+f;b=b.height+c;if(0>f||0>c||h>e||b>d||0===f&&0===c&&h===e&&b===d)return a;a.mask||(a.mask=new Uint8Array(e*
d));for(var l=a.mask,k=0;k<d;k++)for(var g=k*e,n=0;n<e;n++)l[g+n]=k<c||k>=b||n<f||n>=h?0:1;a.updateStatistics();return a};g.clip=function(a,c,b){if(!m(a))return null;var e=c.x,d=c.y,h=c.x+b.width;c=c.x+b.height;if(c===a.height&&h===a.width)return a;for(var g=a.pixels,l=a.mask,k=a.width,x=k*a.height,n=g.length,q=[],v=0;v<n;v++){for(var r=g[v],t=f.createEmptyBand(a.pixelType,x),w=0,u=d;u<=c;u++)for(var B=u*k,z=e;z<=h;z++)t[w++]=r[B+z];q.push(t)}var D;if(l)for(D=new Uint8Array(b.width*b.height),w=0,
u=d;u<=c;u++)for(B=u*k,z=e;z<=h;z++)D[w++]=l[B+z];a=new f({width:b.width,height:b.height,pixels:q,mask:D});a.updateStatistics();return a};g.approximateTransform=function(a,c,b,h){if(!m(a))return null;var d=a.pixels,e=a.mask,g=a.pixelType,l=a.width,k=a.height;a=f.getPixelArrayConstructor(g);var p=d.length,n=c.width,q=c.height;c=h.cols;var v=h.rows,r=Math.ceil(n/c),t=Math.ceil(q/v),w=!1;for(h=0;h<b.length;h+=3)-1===b[h]&&-1===b[h+1]&&-1===b[h+2]&&(w=!0);var u,B,z,D,E,J,H,M=new Float32Array(n*q),I=new Float32Array(n*
q),G=0,N,L;for(h=0;h<t;h++)for(var S=0;S<r;S++){u=12*(h*r+S);B=b[u];z=b[u+1];D=b[u+2];E=b[u+3];J=b[u+4];H=b[u+5];for(var R=0;R<v;R++){G=(h*v+R)*n+S*c;L=(R+.5)/v;for(var C=0;C<R;C++)N=(C+.5)/c,M[G+C]=Math.round((B*N+z*L+D)*l-.5),I[G+C]=Math.round((E*N+J*L+H)*k-.5)}u+=6;B=b[u];z=b[u+1];D=b[u+2];E=b[u+3];J=b[u+4];H=b[u+5];for(R=0;R<v;R++)for(G=(h*v+R)*n+S*c,L=(R+.5)/v,C=R;C<c;C++)N=(C+.5)/c,M[G+C]=Math.round((B*N+z*L+D)*l-.5),I[G+C]=Math.round((E*N+J*L+H)*k-.5)}b=function(a,b){for(var c=0;c<q;c++){u=
c*n;for(var d=0;d<n;d++)a[u]=w&&(0>M[u]||0>I[u])?0:b[M[u]+I[u]*l],u++}};k=[];for(h=0;h<p;h++)c=new a(n*q),b(c,d[h]),k.push(c);d=new f({width:n,height:q,pixelType:g,pixels:k});if(e)d.mask=new Uint8Array(n*q),b(d.mask,e);else if(w)for(d.mask=new Uint8Array(n*q),h=0;h<n*q;h++)d.mask[h]=0>M[h]||0>I[h]?0:1;d.updateStatistics();return d}})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["require","exports","./byteStreamUtils"],function(C,g,f){function t(c){var f=c.fields;c=c.records;
var g=f.some(function(a){return"oid"===a.name.toLowerCase()})?"OBJECTID":"OID",f=[{name:g,type:"esriFieldTypeOID",alias:"OID"}].concat(f.map(function(a){return{name:a.name,type:"esriFieldType"+a.typeName,alias:a.name}})),a=f.map(function(a){return a.name}),e=[],b=0,p=0;c.forEach(function(c){var d={};d[g]=b++;for(p=1;p<a.length;p++)d[a[p]]=c[p-1];e.push({attributes:d})});return{displayFieldName:"",fields:f,features:e}}return function(){function c(){}Object.defineProperty(c,"supportedVersions",{get:function(){return[5]},
enumerable:!0,configurable:!0});c.parse=function(c){var h=new DataView(c),a=h.getUint8(0)&3;if(3!==a)return{header:{version:a},recordSet:null};var e=h.getUint32(4,!0),b=h.getUint16(8,!0),g=h.getUint16(10,!0),b={version:a,recordCount:e,headerByteCount:b,recordByteCount:g},d=32,A=[],y=[];if(3===a){for(;13!==h.getUint8(d);)a=String.fromCharCode(h.getUint8(d+11)).trim(),A.push({name:f.bytesToUTF8(new Uint8Array(c,d,11)),type:a,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(a)],
length:h.getUint8(d+16)}),d+=32;d+=1;if(0<A.length)for(a=function(){var a=[];32===h.getUint8(d)?(d+=1,A.forEach(function(b){if("C"===b.type)a.push(f.bytesToUTF8(new Uint8Array(c,d,b.length)).trim());else if("N"===b.type)a.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(c,d,b.length)).trim(),10));else if("F"===b.type)a.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(c,d,b.length)).trim()));else if("D"===b.type){var e=String.fromCharCode.apply(null,new Uint8Array(c,d,b.length)).trim();
a.push(new Date(parseInt(e.substring(0,4),10),parseInt(e.substring(4,6),10)-1,parseInt(e.substring(6,8),10)))}d+=b.length}),y.push(a)):d+=g};y.length<e&&c.byteLength-d>g;)a()}e=t({fields:A,records:y});return{header:b,fields:A,records:y,recordSet:e}};return c}()})},"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("require exports tslib ../../../geometry ../../../request ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators ../RasterInfo ../RasterStorageInfo ../serviceTileInfoProperty ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../../../tasks/support/FeatureSet".split(" "),
function(C,g,f,t,c,h,m,a,e,b,p,d,A,y,l,k,x,n){return function(k){function g(){var a=null!==k&&k.apply(this,arguments)||this;a._levelOffset=0;a._slices=null;a._tilemapCache=null;return a}f.__extends(g,k);g.prototype.open=function(a){return f.__awaiter(this,void 0,void 0,function(){var b,k,g,n,p,r,q,x,v,t,I,G,C,L,S,R,T,Q,K,U,O,V,P,W,X;return f.__generator(this,function(f){switch(f.label){case 0:return[4,this.init()];case 1:f.sent();b=a&&a.signal;if(!this.sourceJSON)return[3,2];g={data:this.sourceJSON};
return[3,4];case 2:return[4,c(this.url,{responseType:"json",query:{f:"json"},signal:b})];case 3:g=f.sent(),f.label=4;case 4:k=g;k.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=n=k.data;p="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=n.cacheType;null===this.tileType&&(-1<p.indexOf(n.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===n.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster");if(!n)throw new h("imageserverraster:open",
"cannot initialize tiled image service, missing service info");if(!n.tileInfo)throw new h("imageserverraster:open","use ImageryLayer to open non-tiled image services");this.datasetName=n.name;return[4,this._fetchRasterInfo({signal:b})];case 5:r=f.sent();if(m.isSome(r)){q="Map"===this.tileType?A.readServiceTileInfo(n.tileInfo,n,null):y.fromJSON(n.tileInfo);x=r.extent;v=r.pixelSize;t=.5/r.width*v.x;G=I=void 0;C=q.lodAt(Math.max.apply(null,q.lods.map(function(a){return a.level})));"Map"!==this.tileType&&
0!==n.maxScale&&("Raster"===this.tileType?(I=q.lods.filter(function(a){return a.resolution===v.x})[0])||(I=q.lods.filter(function(a){return a.resolution>v.x}).sort(function(a,b){return a.resolution>b.resolution?1:-1})[0]):(I=q.lods.filter(function(a){return Math.abs(a.scale-n.maxScale)<t})[0])||(I=q.lods.filter(function(a){return a.scale>n.maxScale}).sort(function(a,b){return a.scale>b.scale?1:-1})[0]),v.x=v.y=I.resolution,r.width=Math.ceil((x.xmax-x.xmin)/v.x-.1),r.height=Math.ceil((x.ymax-x.ymin)/
v.y-.1));I||(I=C);L=q.lodAt(Math.min.apply(null,q.lods.map(function(a){return a.level})));"Map"===this.tileType?this._levelOffset=q.lods[0].level:0!==n.minScale&&"Elevation"===this.tileType&&(G=q.lods.filter(function(a){return Math.abs(a.scale-n.minScale)<t})[0],this._levelOffset=G.level-L.level);G||(G=L);S=Math.max(v.x,v.y);if(Math.abs(v.x-v.y)>t||!q.lods.some(function(a){return Math.abs(a.resolution-S)<t}))v.x=v.y=I.resolution,r.width=Math.ceil((x.xmax-x.xmin)/v.x-.1),r.height=Math.ceil((x.ymax-
x.ymin)/v.y-.1);R=I.level-G.level;T=q.size;Q=T[0];K=T[1];U=q.origin;O=v.x;V=v.y;P=[{minCol:Math.floor((x.xmin-U.x+.1*O)/Q/O),maxCol:Math.floor((x.xmax-U.x-.1*O)/Q/O),minRow:Math.floor((U.y-x.ymax+.1*V)/K/V),maxRow:Math.floor((U.y-x.ymin-.1*V)/K/V)}];if(0<R)for(W=0;W<R;W++)O*=2,V*=2,P.push({minCol:Math.floor((x.xmin-U.x+.1*O)/Q/O),maxCol:Math.floor((x.xmax-U.x-.1*O)/Q/O),minRow:Math.floor((U.y-x.ymax+.1*V)/K/O),maxRow:Math.floor((U.y-x.ymin-.1*V)/K/O)});r.storageInfo=new d({blockWidth:q.size[0],blockHeight:q.size[1],
pyramidBlockWidth:q.size[0],pyramidBlockHeight:q.size[1],compression:q.format,origin:q.origin,firstPyramidLevel:1,maximumPyramidLevel:R,tileInfo:q,blockBoundary:P});this._set("rasterInfo",r)}else throw new h("image-server-raster:open","cannot initialize image service");-1<n.capabilities.toLowerCase().indexOf("tilemap")&&(X={tileInfo:r.storageInfo.tileInfo,parsedUrl:e.urlToObject(this.url),url:this.url,tileServers:[],type:"tile"},this._tilemapCache=new l.TilemapCache({layer:X}));return[2]}})})};g.prototype.fetchRawTile=
function(a,b,c,d){void 0===d&&(d={});return f.__awaiter(this,void 0,void 0,function(){var e,k,h,g,l,n,m,r,p,q,u,w,v,t,F,y,A,C,V,P,W,X;return f.__generator(this,function(f){switch(f.label){case 0:return e=this.rasterInfo,k=e.storageInfo,h=e.extent,g=e.pixelSize,l=k.maximumPyramidLevel-a+this._levelOffset,n=this.url+"/tile/"+l+"/"+b+"/"+c,m=this._slices?{sliceId:d.sliceId||0}:null,[4,this.request({url:n,query:m,responseType:"array-buffer"},d.signal)];case 1:return(r=f.sent())?[4,this.decodePixelBlock(r,
{width:k.tileInfo.size[0],height:k.tileInfo.size[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType})]:[2,null];case 2:p=f.sent();q=k.blockBoundary[a];if("jpg"!==k.compression||c>q.minCol&&c<q.maxCol&&b>q.minRow&&b<q.maxRow)return[2,p];u=k.origin;w=k.blockWidth;v=k.blockHeight;t=Math.pow(2,a);F=Math.round((h.xmin-u.x)/(g.x*t))%w;y=Math.round((h.xmax-u.x)/(g.x*t))%w;A=Math.round((u.y-h.ymax)/(g.x*t))%v;C=Math.round((u.y-h.ymin)/(g.x*t))%v;V=c===q.minCol?F:0;P=b===q.minRow?A:0;W=c===
q.maxCol?y:w;X=b===q.maxRow?C:v;x.setValidBoundary(p,{x:V,y:P},{width:W-V,height:X-P});return[2,p]}})})};g.prototype.getSliceIndex=function(a){for(var b=0;b<this._slices.length;b++){var c=this._slices[b].multidimensionalDefinition;if(c.length===a.length&&!c.some(function(b){var c=a.filter(function(a){return b.variableName===a.variableName&&a.dimensionName===b.dimensionName})[0];if(!c)return null;var d=Array.isArray(b.values[0])?b.values[0][0]:b.values[0],c=Array.isArray(c.values[0])?c.values[0][0]:
c.values[0];return d!==c}))return b}return null};g.prototype.computeBestPyramidLevelForLocation=function(a,b){void 0===b&&(b={});return f.__awaiter(this,void 0,void 0,function(){var c,d,e,k,h,g;return f.__generator(this,function(f){switch(f.label){case 0:if(!this._tilemapCache)return[2,0];c=this.identifyPixelLocation(a,0,b.datumTransformation);if(null===c)return[2,null];d=0;e=this.rasterInfo.storageInfo.maximumPyramidLevel;k=e-d+this._levelOffset;h=c.srcLocation;f.label=1;case 1:if(!(0<=k))return[3,
6];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,this._tilemapCache.fetchAvailability(k,c.row,c.col,b)];case 3:return g=f.sent(),"available"===g?[3,6]:[3,5];case 4:return f.sent(),[3,5];case 5:return k--,d++,c=this.identifyPixelLocation(h,d,b.datumTransformation),null===c?[2,null]:[3,1];case 6:return-1===k||null==c?[2,null]:[2,d]}})})};g.prototype._fetchRasterInfo=function(b){return f.__awaiter(this,void 0,void 0,function(){var d,e,k,h,g,l,m,r,q,x,v,y,A=this;return f.__generator(this,function(f){d=
this.sourceJSON;e=Math.ceil((d.extent.xmax-d.extent.xmin)/d.pixelSizeX-.1);k=Math.ceil((d.extent.ymax-d.extent.ymin)/d.pixelSizeY-.1);h=t.SpatialReference.fromJSON(d.spatialReference||d.extent.spatialReference);if("Map"===this.tileType)return[2,new p({width:e,height:k,bandCount:3,extent:t.Extent.fromJSON(d.extent),spatialReference:h,pixelSize:new t.Point({x:d.pixelSizeX,y:d.pixelSizeY,spatialReference:h}),pixelType:"u8",statistics:null})];g=b.slice;l=b.signal;m=d.hasRasterAttributeTable?c(this.url+
"/rasterAttributeTable",{query:{slice:g,f:"json"},signal:l}).then(function(a){return n.fromJSON(a.data)}).catch(function(){return null}):!1;r=d.hasColormap?c(this.url+"/colormap",{query:{slice:g,f:"json"},signal:l}).then(function(a){return a.data&&a.data.colormap}):!1;q=d.hasHistograms?c(this.url+"/histograms",{query:{slice:g,f:"json"},signal:l}).then(function(a){return a.data&&a.data.histograms}):!1;x=c(this.url+"/keyProperties",{query:{f:"json"},signal:l}).then(function(a){return a.data}).catch(function(){});
v=d.hasMultidimensions?c(this.url+"/multidimensionalInfo",{query:{f:"json"},signal:l}).then(function(a){return a.data&&a.data.multidimensionalInfo}):!1;y=d.hasMultidimensions?c(this.url+"/slices",{query:{f:"json"},signal:l}).then(function(a){return a.data&&a.data.slices}).catch(function(){}):!1;return[2,a.all([m,r,q,x,v,y]).then(function(a){var b=null;if(d.minValues&&d.minValues.length===d.bandCount)for(var b=[],c=0;c<d.minValues.length;c++)b.push({min:d.minValues[c],max:d.maxValues[c],avg:d.meanValues[c],
stddev:d.stdvValues[c]});A._slices=a[5]||null;return new p({width:e,height:k,bandCount:d.bandCount,extent:t.Extent.fromJSON(d.extent),spatialReference:h,pixelSize:new t.Point({x:d.pixelSizeX,y:d.pixelSizeY,spatialReference:h}),pixelType:d.pixelType.toLowerCase(),statistics:b,attributeTable:a[0]||null,colormap:a[1]||null,histograms:a[2]||null,keyProperties:a[3]||null,multidimensionalInfo:a[4]||null})})]})})};f.__decorate([b.property({type:String,json:{write:!0}})],g.prototype,"datasetFormat",void 0);
f.__decorate([b.property()],g.prototype,"tileType",void 0);return g=f.__decorate([b.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],g)}(k)})},"esri/layers/support/serviceTileInfoProperty":function(){define(["require","exports","tslib","./TileInfo"],function(C,g,f,t){function c(c,g,a,e){if(!c)return null;a=g.minScale;var b=g.maxScale,h=g.minLOD,d=g.maxLOD;if(null!=h&&null!=d)return e&&e.ignoreMinMaxLOD?t.fromJSON(c):t.fromJSON(f.__assign(f.__assign({},c),{lods:c.lods.filter(function(a){a=
a.level;return null!=a&&a>=h&&a<=d})}));if(0!==a&&0!==b){var m=a?Math.round(1E4*a)/1E4:Infinity,y=b?Math.round(1E4*b)/1E4:-Infinity;return t.fromJSON(f.__assign(f.__assign({},c),{lods:c.lods.filter(function(a){a=Math.round(1E4*a.scale)/1E4;return a<=m&&a>=y})}))}return t.fromJSON(c)}Object.defineProperty(g,"__esModule",{value:!0});g.serviceTileInfoProperty={type:t,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:c}}}}};g.readServiceTileInfo=c})},"esri/layers/support/TilemapCache":function(){define("require exports tslib ../../request ../../core/Accessor ../../core/Error ../../core/Handles ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/scheduling ../../core/urlUtils ../../core/watchUtils ../../core/accessorSupport/decorators ./Tilemap".split(" "),
function(C,g,f,t,c,h,m,a,e,b,p,d,A,y,l,k){Object.defineProperty(g,"__esModule",{value:!0});var x=a.getLogger("esri.layers.support.TilemapCache");C=function(a){function c(b){b=a.call(this,b)||this;b._handles=new m;b._pendingTilemapRequests={};b._availableLevels={};b.levels=5;b.cacheByteSize=2097152;b.request=t;b._prefetchingEnabled=!0;return b}f.__extends(c,a);g=c;c.prototype.initialize=function(){var a=this;this._tilemapCache=new e(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl",
"layer.tileServers?"],function(){return a._initializeTilemapDefinition()}),y.init(this,"layer.tileInfo.lods",function(b){return a._initializeAvailableLevels(b)},!0)]);this._initializeTilemapDefinition()};c.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};c.prototype.castLevels=function(a){return 2>=a?(x.error("Minimum levels for Tilemap is 3, but got ",a),3):a};Object.defineProperty(c.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0});
c.prototype.fetchTilemap=function(a,b,c,d){var e=this;if(!this._availableLevels[a])return p.reject(new h("tilemap-cache:level-unavailable","Level "+a+" is unavailable in the service"));var g=this._tmpTilemapDefinition;if(a=this._tilemapFromCache(a,b,c,g))return p.resolve(a);var l=d&&d.signal;d=f.__assign(f.__assign({},d),{signal:null});return p.create(function(a,b){p.onAbort(l,function(){return b(p.createAbortError())});var c=k.tilemapDefinitionId(g),f=e._pendingTilemapRequests[c];if(!f){var f=k.Tilemap.fromDefinition(g,
d).then(function(a){e._tilemapCache.put(c,a,a.byteSize);return a}),h=function(){return delete e._pendingTilemapRequests[c]};e._pendingTilemapRequests[c]=f;f.then(h,h)}f.then(a,b)})};c.prototype.getAvailability=function(a,b,c){return this._availableLevels[a]?(a=this._tilemapFromCache(a,b,c,this._tmpTilemapDefinition))?a.getAvailability(b,c):"unknown":"unavailable"};c.prototype.getAvailabilityUpsample=function(a,b,c,d){d.level=a;d.row=b;d.col=c;a=this.layer.tileInfo;for(a.updateTileInfo(d);;)if(b=this.getAvailability(d.level,
d.row,d.col),"unavailable"===b){if(!a.upsampleTile(d))return"unavailable"}else return b};c.prototype.fetchAvailability=function(a,b,c,d){return this._availableLevels[a]?this.fetchTilemap(a,b,c,d).catch(function(a){return a}).then(function(d){if(d instanceof k.Tilemap)return d=d.getAvailability(b,c),"unavailable"===d?p.reject(new h("tile-map:tile-unavailable","Tile is not available",{level:a,row:b,col:c})):d;if(p.isAbortError(d))throw d;return"unknown"}):p.reject(new h("tilemap-cache:level-unavailable",
"Level "+a+" is unavailable in the service"))};c.prototype.fetchAvailabilityUpsample=function(a,b,c,d,e){var f=this;d.level=a;d.row=b;d.col=c;var k=this.layer.tileInfo;k.updateTileInfo(d);var h=this.fetchAvailability(a,b,c,e).catch(function(a){if(p.isAbortError(a))throw a;if(k.upsampleTile(d))return f.fetchAvailabilityUpsample(d.level,d.row,d.col,d);throw a;});this._fetchAvailabilityUpsamplePrefetch(d.id,a,b,c,e,h);return h};c.prototype._fetchAvailabilityUpsamplePrefetch=function(a,b,c,e,k,h){return f.__awaiter(this,
void 0,void 0,function(){var l,n,m,q,r,u,x,w,v,t;return f.__generator(this,function(y){switch(y.label){case 0:if(!this._prefetchingEnabled)return[2];l="prefetch-"+a;if(this._handles.has(l))return[2];n=p.createAbortController();h.then(function(){return n.abort()},function(){return n.abort()});m=!1;q={remove:function(){m||(m=!0,n.abort())}};this._handles.add(q,l);y.label=1;case 1:return y.trys.push([1,3,,4]),[4,d.waitTicks(10,n.signal)];case 2:return y.sent(),[3,4];case 3:return y.sent(),[3,4];case 4:m||
(m=!0,this._handles.remove(l));if(p.isAborted(n))return[2];r={id:a,level:b,row:c,col:e};u=f.__assign(f.__assign({},k),{signal:n.signal});x=this.layer.tileInfo;w=function(a){var b=v.fetchAvailability(r.level,r.row,r.col,u);g._prefetches.push(b);a=function(){g._prefetches.removeUnordered(b)};b.then(a,a)};v=this;for(t=0;g._prefetches.length<g._maxPrefetch&&x.upsampleTile(r);++t)w(t);return[2]}})})};c.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var a=this.layer.parsedUrl,
b=a.query;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:a.path,query:b?A.objectToQuery(b):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};c.prototype._tilemapFromCache=function(a,b,c,d){d.level=a;d.row=b-b%this.size;d.col=c-c%this.size;a=k.tilemapDefinitionId(d);return this._tilemapCache.get(a)};c.prototype._initializeAvailableLevels=function(a){var b=this;this._availableLevels={};a&&a.forEach(function(a){return b._availableLevels[a.level]=
!0})};Object.defineProperty(c.prototype,"test",{get:function(){var a=this;return{get prefetchingEnabled(){return a._prefetchingEnabled},set prefetchingEnabled(b){a._prefetchingEnabled=b},hasTilemap:function(b,c,d){return!!a._tilemapFromCache(b,c,d,a._tmpTilemapDefinition)}}},enumerable:!0,configurable:!0});var g;c._maxPrefetch=4;c._prefetches=new b({initialSize:g._maxPrefetch});f.__decorate([l.property({constructOnly:!0,type:Number})],c.prototype,"levels",void 0);f.__decorate([l.cast("levels")],c.prototype,
"castLevels",null);f.__decorate([l.property({readOnly:!0,dependsOn:["levels"],type:Number})],c.prototype,"size",null);f.__decorate([l.property({constructOnly:!0,type:Number})],c.prototype,"cacheByteSize",void 0);f.__decorate([l.property({constructOnly:!0})],c.prototype,"layer",void 0);f.__decorate([l.property({constructOnly:!0})],c.prototype,"request",void 0);return c=g=f.__decorate([l.subclass("esri.layers.support.TilemapCache")],c)}(c);g.TilemapCache=C})},"esri/layers/support/Tilemap":function(){define("require exports tslib ../../request ../../core/arrayUtils ../../core/Error ../../core/lang".split(" "),
function(C,g,f,t,c,h,m){function a(a){var b;"vector-tile"===a.service.type?b=a.service.url+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height:(b=a.service.tileServers,b=(b&&b.length?b[a.row%b.length]:a.service.url)+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height);(a=a.service.query)&&(b=b+"?"+a);return b}Object.defineProperty(g,"__esModule",{value:!0});C=function(){function e(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=
40}e.prototype.getAvailability=function(a,c){if("unknown"!==this._allAvailability)return this._allAvailability;a=(a-this.location.top)*this.location.width+(c-this.location.left);c=a>>3;var b=this._tileAvailabilityBitSet;return 0>c||c>b.length?"unknown":b[c]&1<<a%8?"available":"unavailable"};e.prototype._updateFromData=function(a){for(var b=!0,c=!0,e=new Uint8Array(Math.ceil(this.location.width*this.location.height/8)),f=0,h=0;h<a.length;h++){var k=h%8;a[h]?(c=!1,e[f]|=1<<k):b=!1;7===k&&++f}c?this._allAvailability=
"unavailable":b?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=e,this.byteSize+=e.length)};e.fromDefinition=function(b,g){var d=b.service.request||t,m=b.row,p=b.col,l=b.width,k=b.height,x={query:{f:"json"}};g=g?f.__assign(f.__assign({},x),g):x;return d(a(b),g).then(function(a){return a.data}).catch(function(a){if(a&&a.details&&422===a.details.httpStatus)return{location:{top:m,left:p,width:l,height:k},valid:!0,data:c.constant(l*k,0)};throw a;}).then(function(a){if(a.location&&
(a.location.top!==m||a.location.left!==p||a.location.width!==l||a.location.height!==k))throw new h("tilemap:location-mismatch","Tilemap response for different location than requested",{response:a,definition:{top:m,left:p,width:l,height:k}});return e.fromJSON(a)})};e.fromJSON=function(a){e.validateJSON(a);var b=new e;b.location=Object.freeze(m.clone(a.location));b._updateFromData(a.data);return Object.freeze(b)};e.validateJSON=function(a){if(!a||!a.location)throw new h("tilemap:missing-location","Location missing from tilemap response");
if(!1===a.valid)throw new h("tilemap:invalid","Tilemap response was marked as invalid");if(!a.data)throw new h("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(a.data))throw new h("tilemap:data-mismatch","Data must be an array of numbers");if(a.data.length!==a.location.width*a.location.height)throw new h("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return e}();g.Tilemap=C;g.tilemapDefinitionId=function(a){return a.level+"/"+
a.row+"/"+a.col+"/"+a.width+"/"+a.height};g.tilemapDefinitionUrl=a;g.default=C})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("require exports tslib ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./xmlUtilities".split(" "),function(C,g,f,t,c,h,m,a,e,b,p,d,A){var y=function(){var a=new ArrayBuffer(4),b=new Uint8Array(a);(new Uint32Array(a))[0]=
1;return 1===b[0]}(),l=new Map;l.set("Int8","s8");l.set("UInt8","u8");l.set("Int16","s16");l.set("UInt16","u16");l.set("Int32","s32");l.set("UInt32","u32");l.set("Float32","f32");l.set("Float64","f32");l.set("Double64","f32");var k=new Map;k.set("lerc",".lrc");k.set("none",".til");k.set("deflate",".pzp");k.set("jpeg",".jzp");return function(d){function g(){var a=null!==d&&d.apply(this,arguments)||this;a._files=null;a._storageIndex=null;return a}f.__extends(g,d);g.prototype.open=function(a){return f.__awaiter(this,
void 0,void 0,function(){var b,c,d,e,k,g,l,n,m,p,q,x,t,y,A,L,S,C,T,Q,K;return f.__generator(this,function(f){switch(f.label){case 0:return[4,this.init()];case 1:return f.sent(),this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),b=a?h.unwrap(a.signal):null,[4,this.request({url:this.url,responseType:"xml"},b)];case 2:return c=f.sent(),d=this._parseHeader(c),e=d.rasterInfo,k=d.files,this._set("rasterInfo",e),this._files=k,[4,this.request({url:k.index,responseType:"array-buffer"},b)];case 3:g=
f.sent();this._storageIndex=this._parseIndex(g);l=0;n=-1;q=this.rasterInfo.storageInfo;x=q.blockWidth;t=q.blockHeight;y=q.compression;A=this.rasterInfo.storageInfo.pyramidScalingFactor;L=this.rasterInfo;S=L.width;C=L.height;T=L.bandCount;Q=[];for(K="none"===y?1:T;l<this._storageIndex.length;)n++,m=Math.ceil(S/x/Math.pow(A,n)),p=Math.ceil(C/t/Math.pow(A,n)),l+=m*p*K*4,Q.push({maxRow:p,maxCol:m,minCol:0,minRow:0});this.rasterInfo.storageInfo.blockBoundary=Q;0<n&&(this.rasterInfo.storageInfo.firstPyramidLevel=
1,this.rasterInfo.storageInfo.maximumPyramidLevel=n);return[2]}})})};g.prototype.fetchRawTile=function(a,b,c,d){void 0===d&&(d={});return f.__awaiter(this,void 0,void 0,function(){var k,h,g,l,n,p,q,r,x,t,v,y,F,A,C,T,Q,K,U,O,V,P,W,X,Y,Z;return f.__generator(this,function(f){switch(f.label){case 0:k=this.rasterInfo.storageInfo;h=k.blockWidth;g=k.blockHeight;l=k.blockBoundary;n=k.compression;p=l[a];if(!p||p.maxRow<b||p.maxCol<c||p.minRow>b||p.minCol>c)return[2,null];q=this.rasterInfo;r=q.bandCount;x=
q.pixelType;t=this._getTileLocation(a,b,c);v=t.ranges;y=t.actualTileWidth;F=t.actualTileHeight;if(!v||0===v.length)return[2,null];if(0===v[0].from&&0===v[0].to)return A=new Uint8Array(h*g),[2,new e({width:h,height:g,pixels:null,mask:A,validPixelCount:0})];C=this.ioConfig.bandIds;T="none"===n?1:r;Q=[];for(K=K=0;K<T;K++)(!C||-1<C.indexOf[K])&&Q.push(this.request({url:this._files.data,range:{from:v[K].from,to:v[K].to},responseType:"array-buffer"},d.signal));return[4,m.all(Q)];case 1:U=f.sent();O=U.map(function(a){return a.byteLength}).reduce(function(a,
b){return a+b});V=new Uint8Array(O);for(K=P=0;K<T;K++)V.set(new Uint8Array(U[K]),P),P+=U[K].byteLength;W="lerc"===this.rasterInfo.storageInfo.compression?"lerc":"bip";return[4,this.decodePixelBlock(V.buffer,{width:h,height:g,format:W,pixelType:x})];case 2:X=f.sent();Z=Y=0;if(y!==h||F!==g)if(A=X.mask)for(K=0;K<g;K++)for(Z=K*h,Y=K<F?y:0;Y<h;Y++)A[Z+Y]=0;else for(A=new Uint8Array(h*g),X.mask=A,K=0;K<F;K++)for(Z=K*h,Y=0;Y<y;Y++)A[Z+Y]=1;return[2,X]}})})};g.prototype._parseIndex=function(a){if(0<a.byteLength%
16)throw"invalid array buffer must be multiples of 16";var b,c,d,e,f;if(y){b=new Uint8Array(a);d=new ArrayBuffer(a.byteLength);c=new Uint8Array(d);for(e=0;e<a.byteLength/4;e++)for(f=0;4>f;f++)c[4*e+f]=b[4*e+3-f];a=new Uint32Array(d)}else a=new Uint32Array(a);return a};g.prototype._getTileLocation=function(a,b,c){var d=this.rasterInfo.storageInfo,e=d.blockWidth,f=d.blockHeight,k=d.pyramidScalingFactor,h=this.rasterInfo,g=h.width,l=h.height,h=h.bandCount,d="none"===d.compression?1:h,n,m,p=0,q=0;for(m=
0;m<a;m++)q=Math.pow(k,m),h=Math.ceil(g/e/q),n=Math.ceil(l/f/q),p+=h*n;q=Math.pow(k,a);h=Math.ceil(g/e/q);n=Math.ceil(l/f/q);p=4*(p+(b*h+c))*d;a=this._storageIndex.subarray(p,p+4*d);m=k=0;for(var p=[],r=0;r<d;r++)k=a[4*r+0]*Math.pow(2,32)+a[4*r+1],m=k+a[4*r+2]*Math.pow(2,32)+a[4*r+3],p.push({from:k,to:m});return{ranges:p,actualTileWidth:c<h-1?e:Math.ceil(g/q)-e*(h-1),actualTileHeight:b<n-1?f:Math.ceil(l/q)-f*(n-1)}};g.prototype._parseHeader=function(a){var d=A.getElement(a,"MRF_META/Raster");if(!d)throw new c("mrf:open",
"not a valid MRF format");var e=A.getElement(d,"Size"),f=parseInt(e.getAttribute("x"),10),h=parseInt(e.getAttribute("y"),10),g=parseInt(e.getAttribute("c"),10),e=(A.getElementValue(d,"Compression")||"none").toLowerCase(),n=["none","lerc"];if(!e||-1===n.indexOf(e))throw new c("mrf:open","currently does not support compression "+e);var m=A.getElementValue(d,"DataType")||"UInt8",n=l.get(m);if(null==n)throw new c("mrf:open","currently does not support pixel type "+m);var q=A.getElement(d,"PageSize"),
m=parseInt(q.getAttribute("x"),10),q=parseInt(q.getAttribute("y"),10),d=A.getElement(d,"DataValues"),x;d&&(d=d.getAttribute("NoData"),null!=d&&(x=d.trim().split(" ").map(function(a){return parseFloat(a)})));if(A.getElement(a,"MRF_META/CachedSource"))throw new c("mrf:open","currently does not support MRF referencing other data files");var y=A.getElement(a,"MRF_META/GeoTags"),C=A.getElement(y,"BoundingBox");if(null==C)throw new c("mrf:open","missing node MRF_META/GeoTags/BoundingBox");var d=parseFloat(C.getAttribute("minx")),
M=parseFloat(C.getAttribute("miny")),I=parseFloat(C.getAttribute("maxx")),G=parseFloat(C.getAttribute("maxy")),N=A.getElementValue(y,"Projection"),y=A.getElementValue(a,"datafile"),C=A.getElementValue(a,"IndexFile"),L;"LOCAL_CS[]"!==N&&(L=new t.SpatialReference({wkt:N}));N=new t.Extent(d,M,I,G);N.spatialReference=L;a=A.getElement(a,"MRF_META/Rsets");a=parseInt(a&&a.getAttribute("scale")||"2",10);a=new p({origin:new t.Point({x:N.xmin,y:N.ymax,spatialReference:L}),blockWidth:m,blockHeight:q,pyramidBlockWidth:m,
pyramidBlockHeight:q,compression:e,pyramidScalingFactor:a});m=new t.Point({x:(I-d)/f,y:(G-M)/h,spatialReference:L});f=new b({width:f,height:h,extent:N,spatialReference:L,bandCount:g,pixelType:n,pixelSize:m,noDataValue:x,storageInfo:a});h={mrf:this.url,index:C||this.url.replace(".mrf",".idx"),data:y||this.url.replace(".mrf",k.get(e))};return{rasterInfo:f,files:h}};f.__decorate([a.property()],g.prototype,"_files",void 0);f.__decorate([a.property()],g.prototype,"_storageIndex",void 0);f.__decorate([a.property({type:String,
json:{write:!0}})],g.prototype,"datasetFormat",void 0);return g=f.__decorate([a.subclass("esri.layers.support.rasterIO.MRFRaster")],g)}(d)})},"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["require","exports"],function(C,g){function f(c,f){if(!c||!f)return[];var h=f;-1<f.indexOf("/")?(h=f.slice(0,f.indexOf("/")),f=f.slice(f.indexOf("/")+1)):f="";c=f?t(c,h).getElementsByTagNameNS("*",f):c.getElementsByTagNameNS("*",h);if(!c||0===c.length)return[];f=[];for(h=0;h<c.length;h++)f.push(c[h]||
c.item[h]);return f}function t(c,h){if(!c||!h)return null;var g=h;-1<h.indexOf("/")?(g=h.slice(0,h.indexOf("/")),h=h.slice(h.indexOf("/")+1)):h="";c=f(c,g);return 0<c.length?h?t(c[0],h):c[0]:null}Object.defineProperty(g,"__esModule",{value:!0});g.getElements=f;g.getElement=t;g.getElementValue=function(c,f){if(c=t(c,f))if(c=c.textContent||c.nodeValue||c.innerText)return c.trim();return null};g.getElementValues=function(c,h){c=f(c,h);h=[];for(var g,a=0;a<c.length;a++)if(g=c[a].textContent||c[a].nodeValue||
c[a].innerText)g=g.trim(),""!==g&&h.push(g);return h}})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("require exports tslib ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators ../RasterInfo ../RasterStorageInfo ./BaseRaster ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags".split(" "),function(C,g,f,t,c,h,m,a,e,b,p,d){var A=function(a,b){return(a=a.get(b))&&a.values},y=function(a,b){return(a=a.get(b))&&a.values[0]};return function(b){function k(){var a=
null!==b&&b.apply(this,arguments)||this;a._files=null;a._headerInfo=null;a._bufferSize=1048576;return a}f.__extends(k,b);k.prototype.open=function(b){return f.__awaiter(this,void 0,void 0,function(){var d,k,g,l,m,x,u,y,z,A,E,C,H,M,I,G,N,L,S,R,T,Q,K,U,O,V,P;return f.__generator(this,function(n){switch(n.label){case 0:return[4,this.init()];case 1:return n.sent(),d=b?h.unwrap(b.signal):null,[4,this.request({url:this.url,range:{from:0,to:this._bufferSize},responseType:"array-buffer"},d)];case 2:k=n.sent();
if(!k)throw new c("tiffraster:open","failed to open url "+this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);g=p.parseSignature(k);l=g.littleEndian;m=g.firstIFD;x=[];return[4,this.readIFDs(x,k,l,m,0,4,d)];case 3:n.sent();u=p.getImageInfo(x);y=u.width;z=u.height;A=u.tileWidth;E=u.tileHeight;C=u.planes;H=u.pixelType;M=u.compression;I=u.firstPyramidLevel;G=u.maximumPyramidLevel;N=u.pyramidBlockWidth;L=u.pyramidBlockHeight;S=u.tileBoundary;R=u.metadata;T=t.Extent.fromJSON(u.extent);
Q=T.spatialReference;K=T?new t.Point({x:T.xmin,y:T.ymax,spatialReference:Q}):new t.Point({x:0,y:0});U=new e({blockWidth:A,blockHeight:E,pyramidBlockWidth:N,pyramidBlockHeight:L,compression:M,origin:K,firstPyramidLevel:I,maximumPyramidLevel:G,blockBoundary:S});O=new t.Point({x:(T.xmax-T.xmin)/y,y:(T.ymax-T.ymin)/z,spatialReference:Q});V=R?{BandProperties:R.bandProperties,DataType:R.dataType}:null;P=new a({width:y,height:z,bandCount:C,pixelType:H,compression:M,pixelSize:O,storageInfo:U,spatialReference:Q,
keyProperties:V,extent:T,statistics:R?R.statistics:null});this._set("rasterInfo",P);this._headerInfo=f.__assign({littleEndian:l,ifds:x},u);if(!this._headerInfo.isSupported)throw new c("tiffraster:open","this tiff is not supported: "+this._headerInfo.message);return[2]}})})};k.prototype.fetchRawTile=function(a,b,c,d){void 0===d&&(d={});return f.__awaiter(this,void 0,void 0,function(){var e,k,h,g,l,n,m,p,q,x,t,v,y,A,C;return f.__generator(this,function(f){switch(f.label){case 0:if(!this._headerInfo&&
this._headerInfo.isSupported)return[2,null];e=this.rasterInfo.storageInfo.blockBoundary;k=0<a?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth;h=0<a?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight;g=e[a];if(!g||g.maxRow<b||g.maxCol<c||g.minRow>b||g.minCol>c)return[2,null];l=this.getTileLocation(a,b,c);if(!l)return[2,null];n=l.range;m=l.actualTileWidth;p=l.actualTileHeight;q=l.ifd;return[4,this.request({url:this.url,range:n,
responseType:"array-buffer"},d.signal)];case 1:return x=f.sent(),[4,this.decodePixelBlock(x,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:q,offset:0,size:0},width:k,height:h,planes:null,pixelType:null})];case 2:t=f.sent();if(m!==k||p!==h)if(C=t.mask)for(v=0;v<h;v++)for(A=v*k,y=v<p?m:0;y<k;y++)C[A+y]=0;else for(C=new Uint8Array(k*h),t.mask=C,v=0;v<p;v++)for(A=v*k,y=0;y<m;y++)C[A+y]=1;return[2,t]}})})};k.prototype.readIFDs=function(a,b,c,e,k,h,g){void 0===h&&(h=4);return f.__awaiter(this,
void 0,void 0,function(){var l;return f.__generator(this,function(f){switch(f.label){case 0:return e?e>=b.byteLength||0>e?[4,this.request({url:this.url,range:{from:e+k,to:e+k+this._bufferSize},responseType:"array-buffer"},g)]:[3,2]:[2,null];case 1:b=f.sent(),k=e+k,e=0,f.label=2;case 2:return[4,this.readIFD(b,c,e,k,d.TIFF_TAGS,h,g)];case 3:return l=f.sent(),a.push(l.ifd),l.nextIFD?[4,this.readIFDs(a,b,c,l.nextIFD-k,k,h,g)]:[2,null];case 4:return f.sent(),[2]}})})};k.prototype.readIFD=function(a,b,
c,e,k,h,g){void 0===k&&(k=d.TIFF_TAGS);void 0===h&&(h=4);return f.__awaiter(this,void 0,void 0,function(){var l,n,m,q,r,x,t,w,v;return f.__generator(this,function(f){switch(f.label){case 0:if(!a)return[2,null];l=p.parseIFD(a,b,c,e,k,h);if(!l.success)return[3,5];n=[];l.ifd.forEach(function(a){a.values||n.push(a)});if(!(0<n.length))return[3,2];m=n.map(function(a){return a.offlineOffsetSize});q=Math.min.apply(null,m.map(function(a){return a[0]}));r=Math.min.apply(null,m.map(function(a){return a[0]+a[1]}));
return r-q<=this._bufferSize?[4,this.request({url:this.url,range:{from:q,to:q+this._bufferSize},responseType:"array-buffer"},g)]:[3,2];case 1:a=f.sent(),e=q,n.forEach(function(c){return p.parseFieldValues(a,b,c,e)}),f.label=2;case 2:if(!l.ifd.has("GEOKEYDIRECTORY"))return[3,4];x=l.ifd.get("GEOKEYDIRECTORY");t=x.values;if(!(t&&4<t.length))return[3,4];w=t[0]+"."+t[1]+"."+t[2];return[4,this.readIFD(a,b,x.valueOffset+6-e,e,d.GEO_KEYS,2,g)];case 3:v=f.sent(),x.data=v.ifd,x.data&&x.data.set("GEOTIFFVersion",
{id:0,type:2,valueCount:1,valueOffset:null,values:[w]}),f.label=4;case 4:return[2,l];case 5:return l.requiredBufferSize&&l.requiredBufferSize!==a.byteLength?[4,this.request({url:this.url,range:{from:e,to:e+l.requiredBufferSize+4},responseType:"array-buffer"},g)]:[3,7];case 6:return a=f.sent(),a.byteLength<l.requiredBufferSize?[2,null]:[2,this.readIFD(a,b,0,e,d.TIFF_TAGS,4,g)];case 7:return[2]}})})};k.prototype.getTileLocation=function(a,b,c){var d=this.rasterInfo.storageInfo,e=d.firstPyramidLevel,
f=d.blockBoundary,k=0===a?0:a-(e-1);a=this._headerInfo.ifds[k];if(!a)return null;d=A(a,"TILEOFFSETS");if(void 0===d)return null;var e=A(a,"TILEBYTECOUNTS"),k=f[k],h=k.minRow,g=k.minCol,f=k.maxRow,k=k.maxCol;if(b>f||c>k||b<h||c<g)return null;var h=y(a,"IMAGEWIDTH"),g=y(a,"IMAGELENGTH"),l=y(a,"TILEWIDTH"),n=y(a,"TILELENGTH"),m=b*(k+1)+c,d=d[m],e=e[m];return null==d||null==e?null:{range:{from:d,to:d+e-1},ifd:a,actualTileWidth:c===k?h%l:l,actualTileHeight:b===f?g%n:n}};f.__decorate([m.property()],k.prototype,
"_files",void 0);f.__decorate([m.property()],k.prototype,"_headerInfo",void 0);f.__decorate([m.property()],k.prototype,"_bufferSize",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],k.prototype,"datasetFormat",void 0);return k=f.__decorate([m.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],k)}(b)})},"esri/renderers/support/RasterSymbolizer":function(){define("require exports tslib ../../rasterRenderers ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/surfaceUtils ../support/colorRampUtils".split(" "),
function(C,g,f,t,c,h,m,a,e,b,p,d){var A=m.getLogger("esri.renderers.support.RasterSymbolizer");return function(h){function g(a){return h.call(this,a)||this}f.__extends(g,h);g.prototype.readRenderer=function(a,b,c){return t.read(a,c)};g.prototype.bind=function(){if(!this.renderer)return!1;this.lookup={rendererJson:{}};var a;switch(this.renderer.type){case "unique-value":a=this._updateUVRenderer(this.renderer);break;case "raster-colormap":a=this._updateColormapRenderer(this.renderer);break;case "raster-stretch":a=
this._updateStretchRenderer(this.renderer);break;case "class-breaks":a=this._updateClassBreaksRenderer(this.renderer);break;case "raster-shaded-relief":a=this._updateShadedReliefRenderer(this.renderer)}return a};g.prototype.symbolize=function(a){var c=a&&a.pixelBlock;if(!this.isValidPixelBlock(c))return c;if(a.simpleStretchParams&&"raster-stretch"===this.renderer.type)return this.simpleStretch(c,a.simpleStretchParams);try{3<c.pixels.length&&(c=b.extractBands(c,[0,1,2]));var d=void 0;switch(this.renderer.type){case "unique-value":case "raster-colormap":d=
this._symbolize_colormap(c);break;case "class-breaks":d=this._symbolize_classBreaks(c);break;case "raster-stretch":d=this._symbolize_stretch(c,a.bandIds);break;case "raster-shaded-relief":var e=a.extent,d=this._symbolize_shadedRelief(c,{isGCS:e.spatialReference.isGeographic,resolution:{x:(e.xmax-e.xmin)/c.width,y:(e.ymax-e.ymin)/c.height}})}return d}catch(v){return A.error("symbolize",v.message),c}};g.prototype.simpleStretch=function(a,c){if(!this.isValidPixelBlock(a))return a;try{return 3<a.pixels.length&&
(a=b.extractBands(a,[0,1,2])),b.stretch(a,c)}catch(n){return A.error("symbolize",n.message),a}};g.prototype.generateWebGLParameters=function(a){if(-1<["unique-value","raster-colormap","class-breaks"].indexOf(this.renderer.type)){var b=this.lookup.colormapLut;return{colormap:b.indexedColormap,colormapOffset:b.offset,type:"lut"}}var b=a.pixelBlock,c=a.isGCS,d=a.resolution;a=a.bandIds;return"raster-stretch"===this.renderer.type?this.generateStretchWebGLParams(b,this.renderer,a):"raster-shaded-relief"===
this.renderer.type?this.generateShadedReliefWebGLParams(this.renderer,c,d):null};g.prototype._isLUTChanged=function(a){if(!this.lookup||!this.lookup.rendererJson)return!0;if("colorRamp"in this.renderer){var b=this.renderer.colorRamp;if(a)return JSON.stringify(b.toJSON())!==JSON.stringify(this.lookup.rendererJson.colorRamp);a=f.__assign({},this.renderer.toJSON());b=f.__assign({},this.lookup.rendererJson);a.colorRamp=null;b.colorRamp=null}return JSON.stringify(this.renderer.toJSON())!==JSON.stringify(this.lookup.rendererJson)};
g.prototype._symbolize_colormap=function(a){return this._isLUTChanged()&&!this.bind()?a:b.colorize(a,this.lookup.colormapLut)};g.prototype._symbolize_classBreaks=function(a){var c=-1<["u8","u16","s8","s16"].indexOf(this.rasterInfo.pixelType);return this._isLUTChanged()&&!this.bind()?a:c?b.colorize(a,this.lookup.colormapLut):b.remapColor(a,this.lookup.remapLut)};g.prototype._symbolize_stretch=function(a,c){var d=this.rasterInfo,e=d.pixelType,k=d.bandCount,d=this.renderer,g=-1<["u8","u16","s8","s16"].indexOf(e),
h,l=d.gamma,m=d.useGamma;if(g){if(d.dynamicRangeAdjustment)g=this.getStretchCutoff(d,a,c),h=b.createStretchLUT(f.__assign(f.__assign({pixelType:e},g),{gamma:m?l:null}));else{if(this._isLUTChanged()&&(e=this.bind(),!e))return a;h=this.lookup?this.lookup.stretchLut:null}if(!h)return a;1<k&&(null===c||void 0===c?void 0:c.length)===a.pixels.length&&(null===h||void 0===h?void 0:h.lut.length)===k&&(h={lut:c.map(function(a){return h.lut[a]}),offset:h.offset});c=b.lookupPixels(a,h)}else g=this.getStretchCutoff(d,
a,c),c=b.stretch(a,f.__assign(f.__assign({},g),{gamma:m?l:null}));if(d.colorRamp){if(this._isLUTChanged(!0)&&(e=this.bind(),!e))return a;c=b.colorize(c,this.lookup.colormapLut)}return c};g.prototype._symbolize_shadedRelief=function(a,b){var c=this.renderer;b=f.__assign(f.__assign({},c.toJSON()),b);b=p.hillshade(a,b);if(!c.colorRamp||this._isLUTChanged(!0)&&!this.bind())return b;c=this.lookup?this.lookup.hsvMap:null;if(!c)return b;p.tintHillshade(b,a,c,this.rasterInfo.statistics[0]);return b};g.prototype._updateUVRenderer=
function(a){var c=this.rasterInfo,d=c.bandCount,e=c.attributeTable,f=c.statistics,c=-1<["u8","s8"].indexOf(c.pixelType)&&f&&null!=f[0].min&&null!=f[0].max;if(1!==d||!e&&!c)return!1;var k=a.field;if(!k)return!1;var g=[];if(e){var h=e.fields.filter(function(a){return"value"===a.name.toLowerCase()})[0];if(!h)return!1;e.features.forEach(function(b){var c=a.uniqueValueInfos.filter(function(a){return String(a.value)===String(b.attributes[k])})[0];(c=c&&c.symbol&&c.symbol.color)&&g.push([b.attributes[h.name],
c.r,c.g,c.b,1<c.a?c.a:Math.round(255*c.a)])})}else{if("value"!==k.toLowerCase())return!1;a.uniqueValueInfos.forEach(function(a){var b=a&&a.symbol&&a.symbol.color;b&&g.push([parseInt(a.value,10),b.r,b.g,b.b,1<b.a?b.a:Math.round(255*b.a)])})}if(0===g.length)return!1;d=b.createColormapLUT({colormap:g});this.lookup={rendererJson:a.toJSON(),colormapLut:d};return this.canRenderInWebGL=!0};g.prototype._updateColormapRenderer=function(a){var c=a.extractColormap();if(!c||0===c.length)return!1;c=b.createColormapLUT({colormap:c});
this.lookup={rendererJson:a.toJSON(),colormapLut:c};return this.canRenderInWebGL=!0};g.prototype._updateShadedReliefRenderer=function(a){if("elevation"!==this.rasterInfo.dataType)return!1;if(a.colorRamp){for(var e=d.convertColorRampToColormap(a.colorRamp,256),e=b.createColormapLUT({colormap:e}),f=[],g=e.indexedColormap,k=0;k<g.length;k+=4){var h=c.toHSV({r:g[k],g:g[k+1],b:g[k+2]});f.push([h.h/60,h.s/100,255*h.v/100])}this.lookup={rendererJson:a.toJSON(),colormapLut:e,hsvMap:f}}else this.lookup=null;
return this.canRenderInWebGL=!0};g.prototype._updateClassBreaksRenderer=function(a){var c=-1<["u8","u16","s8","s16"].indexOf(this.rasterInfo.pixelType),d=a.classBreakInfos;if(!d||0===d.length)return!1;var e=d.sort(function(a,b){return a.minValue-b.minValue}),d=e[e.length-1];if(!c)return c=e.map(function(a){return{value:a.minValue,mappedColor:[a.symbol.color.r,a.symbol.color.g,a.symbol.color.b,1<a.symbol.color.a?a.symbol.color.a:Math.round(255*a.symbol.color.a)]}}),c.push({value:d.maxValue,mappedColor:[d.symbol.color.g,
d.symbol.color.b,1<d.symbol.color.a?d.symbol.color.a:Math.round(255*d.symbol.color.a)]}),this.lookup={rendererJson:a.toJSON(),remapLut:c},this.canRenderInWebGL=!1,!0;var f=[],g,k=0;e.forEach(function(a){g=Math.ceil(a.minValue);k=Math.floor(a.maxValue);for(var b=g;b<k;b++)f.push([b,a.symbol.color.r,a.symbol.color.g,a.symbol.color.b,1<a.symbol.color.a?a.symbol.color.a:Math.round(255*a.symbol.color.a)])});f.push([d.maxValue,d.symbol.color.r,d.symbol.color.g,d.symbol.color.b,1<d.symbol.color.a?d.symbol.color.a:
Math.round(255*d.symbol.color.a)]);c=b.createColormapLUT({colormap:f,fillUnspecified:!1});this.lookup={rendererJson:a.toJSON(),colormapLut:c};return this.canRenderInWebGL=!0};g.prototype._updateStretchRenderer=function(a){if(!(a.statistics||this.rasterInfo.statistics||a.dynamicRangeAdjustment))return!1;var c=a.histograms||this.rasterInfo.histograms;if(!a.dynamicRangeAdjustment&&"percent-clip"===a.stretchType&&!c)return!1;var e=a.gamma,g=a.useGamma,c=a.colorRamp,h=this.rasterInfo.pixelType;if(!a.dynamicRangeAdjustment&&
-1<["u8","u16","s8","s16"].indexOf(h)){var k=this.getStretchCutoff(a),e=b.createStretchLUT(f.__assign(f.__assign({pixelType:h},k),{gamma:g?e:null}));this.lookup={rendererJson:a.toJSON(),stretchLut:e}}c&&(c=d.convertColorRampToColormap(c,256),this.lookup||(this.lookup={rendererJson:a.toJSON()}),this.lookup.colormapLut=b.createColormapLUT({colormap:c}),this.lookup.rendererJson=a.toJSON());return this.canRenderInWebGL=!0};g.prototype.getStretchCutoff=function(a,c,d){var e,f,g=a.stretchType;a.dynamicRangeAdjustment?
"min-max"===g&&c.statistics?e=c.statistics.map(function(a){return[a.minValue,a.maxValue,0,0]}):(f=b.estimateStatisticsHistograms(c),e=f.statistics,f=f.histograms):(e=a.statistics&&0<a.statistics.length?a.statistics:this.rasterInfo.statistics,f=a.histograms||this.rasterInfo.histograms);var h=e||f?(e||f).length:this.rasterInfo.bandCount;c=[];var k=[],l,m,n,p,t;e[0]instanceof Array||(e=e.map(function(a){return[a.min,a.max,a.avg,a.stddev]}));switch(g){case "none":for(g=0;g<h;g++)c[g]="u8"===this.rasterInfo.pixelType?
0:e?e[g][0]:0,k[g]="u8"===this.rasterInfo.pixelType?255:e?e[g][1]:255;break;case "min-max":for(g=0;g<h;g++)c[g]=e[g][0],k[g]=e[g][1];break;case "standard-deviation":for(g=0;g<h;g++)c[g]=e[g][2]-a.numberOfStandardDeviations*e[g][3],k[g]=e[g][2]+a.numberOfStandardDeviations*e[g][3],c[g]<e[g][0]&&(c[g]=e[g][0]),k[g]>e[g][1]&&(k[g]=e[g][1]);break;case "percent-clip":for(g=0;g<f.length;g++){e=f[g];n=new Uint32Array(e.size);m=e.counts;l=0;h=(e.max-e.min)/e.size;p=-.5===e.min&&1===h?.5:0;for(t=0;t<e.size;t++)l+=
m[t],n[t]=l;m=a.minPercent*l/100;for(t=0;t<e.size;t++)if(n[t]>m){c[g]=e.min+h*(t+p);break}m=(1-a.maxPercent/100)*l;for(t=e.size-2;0<=t;t--)if(n[t]<m){k[g]=e.min+h*(t+2-p);break}}break;default:for(g=0;g<h;g++)c[g]=e[g][0],k[g]=e[g][1]}return this.getSelectedBandCutoffs({minCutOff:c,maxCutOff:k,outMax:a.outputMax||255,outMin:a.outputMin||0},d)};g.prototype.getSelectedBandCutoffs=function(a,b){if(null==b||0===b.length)return a;var c=Math.max.apply(null,b),d=a.minCutOff,e=a.maxCutOff,f=a.outMin,g=a.outMax;
return d.length===b.length||d.length<=c?a:{minCutOff:b.map(function(a){return d[a]}),maxCutOff:b.map(function(a){return e[a]}),outMin:f,outMax:g}};g.prototype.generateStretchWebGLParams=function(a,b,c){var d=null,e=null,f=this.lookup&&this.lookup.colormapLut;b.colorRamp&&f&&(d=f.indexedColormap,e=f.offset);var f=b.gamma,g=!!(b.useGamma&&f&&f.some(function(a){return 1!==a})),h=this.getStretchCutoff(b,a,c);b=h.minCutOff;var k=h.maxCutOff,l=h.outMin,h=h.outMax;a&&a.pixels&&2===a.pixels.length&&(a=a.clone(),
a.statistics=[a.statistics[0]],a.pixels=[a.pixels[0]]);a=Math.min(3,c&&c.length||a&&a.getPlaneCount()||this.rasterInfo.bandCount);c=new Float32Array(a);var m=d||g?1:255,n;for(n=0;n<a;n++)c[n]=(h-l)/(k[n]-b[n])/m;var p=new Float32Array(a);if(g)for(n=0;n<a;n++)p[n]=1<f[n]?2<f[n]?6.5+Math.pow(f[n]-2,2.5):6.5+100*Math.pow(2-f[n],4):1;return{bandCount:a,outMin:l/m,outMax:h/m,minCutOff:b,maxCutOff:k,factor:c,useGamma:g,gamma:g?f:[1,1,1],gammaCorrection:g?p:[1,1,1],colormap:d,colormapOffset:e,type:"stretch"}};
g.prototype.generateShadedReliefWebGLParams=function(a,b,c){var d=null,e=null,g=this.lookup&&this.lookup.colormapLut;a.colorRamp&&g&&(d=g.indexedColormap,e=g.offset);b=f.__assign(f.__assign({},a.toJSON()),{isGCS:b,resolution:c});b=p.calculateHillshadeParams(b);c=this.rasterInfo.statistics[0];return f.__assign(f.__assign({},b),{minValue:c.min,maxValue:c.max,hillshadeType:"traditional"===a.hillshadeType?0:1,type:"hillshade",colormap:d,colormapOffset:e})};g.prototype.isValidPixelBlock=function(a){return!!(a&&
a.pixels&&0<a.pixels.length&&0!==a.validPixelCount)};f.__decorate([a.property({types:t.rasterRendererTypes,json:{write:!0}})],g.prototype,"renderer",void 0);f.__decorate([a.reader("renderer")],g.prototype,"readRenderer",null);f.__decorate([a.property({type:e,json:{write:!0}})],g.prototype,"rasterInfo",void 0);f.__decorate([a.property({json:{write:!0}})],g.prototype,"lookup",void 0);f.__decorate([a.property({})],g.prototype,"canRenderInWebGL",void 0);return g=f.__decorate([a.subclass("esri.renderers.support.RasterSymbolizer")],
g)}(h.JSONSupport)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["require","exports","../PixelBlock"],function(C,g,f){function t(c){var f=c.altitude,a=c.azimuth,e=c.hillshadeType,b=c.pixelSizePower,g=c.pixelSizeFactor,d=c.scalingType,h=c.isGCS,t=c.resolution,l="multi-directional"===e?2*c.zFactor:c.zFactor,k=t.x,x=t.y;c=l/(8*k);var n=l/(8*x);h&&.001<l&&(c/=111E3,n/=111E3);"adjusted"===d&&(h?(c=111E3*k,n=111E3*x,c=(l+Math.pow(c,b)*g)/(8*c),n=(l+Math.pow(n,b)*g)/(8*n)):(c=
(l+Math.pow(k,b)*g)/(8*k),n=(l+Math.pow(x,b)*g)/(8*x)));var q=(90-f)*Math.PI/180,f=Math.cos(q),v=(360-a+90)*Math.PI/180,a=Math.sin(q)*Math.cos(v),q=Math.sin(q)*Math.sin(v),b=[315,270,225,360,180,0],g=[60,60,60,60,60,90],l=new Float32Array([3,5,3,2,1,4]),r=l.reduce(function(a,b){return a+b}),l=l.map(function(a){return a/r}),d="multi-directional"===e?b.length:1,h=new Float32Array(6),x=new Float32Array(6),k=new Float32Array(6);if("multi-directional"===e)for(var C=0;C<d;C++)f=g[C],a=b[C],q=(90-f)*Math.PI/
180,f=Math.cos(q),v=(360-a+90)*Math.PI/180,a=Math.sin(q)*Math.cos(v),q=Math.sin(q)*Math.sin(v),h[C]=f,x[C]=a,k[C]=q;else h.fill(f),x.fill(a),k.fill(q);return{resolution:t,factor:[c,n],sinZcosA:a,sinZsinA:q,cosZ:f,sinZcosAs:x,sinZsinAs:k,cosZs:h,weights:l,hillshadeType:["traditional","multi-directional"].indexOf(e)}}Object.defineProperty(g,"__esModule",{value:!0});var c=function(c){return c&&"esri.layers.support.PixelBlock"===c.declaredClass&&c.pixels&&0<c.pixels.length};g.calculateHillshadeParams=
t;g.hillshade=function(g,m){if(!c(g))return g;var a=g.width,e=g.height,b=g.mask,h=new Uint8Array(a*e);b&&h.set(b);var d=t(m),A=d.factor,y=d.sinZcosA,l=d.sinZsinA,k=d.cosZ,x=d.sinZcosAs,n=d.sinZsinAs,q=d.cosZs,d=d.weights,v=A[0],A=A[1];m=m.hillshadeType;for(var r=g.pixels[0],C=new Uint8Array(a*e),w,u,B,z,D,E,J,H,M=1;M<e-1;M++)for(var I=M*a,G=1;G<a-1;G++)if(b&&!b[I+G])C[I+G]=0;else{z=8;if(b&&(z=b[I-a+G-1]+b[I-a+G]+b[I-a+G+1]+b[I+G-1]+b[I+G+1]+b[I+a+G-1]+b[I+a+G]+b[I+a+G+1],7>z)){C[I+G]=0;h[I+G]=0;continue}7===
z?(w=b[I-a+G-1]?r[I-a+G-1]:r[I+G],u=b[I-a+G]?r[I-a+G]:r[I+G],B=b[I-a+G+1]?r[I-a+G+1]:r[I+G],z=b[I+G-1]?r[I+G-1]:r[I+G],D=b[I+G+1]?r[I+G+1]:r[I+G],E=b[I+a+G-1]?r[I+a+G-1]:r[I+G],J=b[I+a+G]?r[I+a+G]:r[I+G],H=b[I+a+G+1]?r[I+a+G+1]:r[I+G]):(w=r[I-a+G-1],u=r[I-a+G],B=r[I-a+G+1],z=r[I+G-1],D=r[I+G+1],E=r[I+a+G-1],J=r[I+a+G],H=r[I+a+G+1]);z=(B+D+D+H-(w+z+z+E))*v;w=(E+J+J+H-(w+u+u+B))*A;u=Math.sqrt(1+z*z+w*w);B=0;if("traditional"===m)E=255*(k+l*w-y*z)/u,0>E&&(E=0),B=E;else for(J=n.length,H=0;H<J;H++)E=255*
(q[H]+n[H]*w-x[H]*z)/u,0>E&&(E=0),B+=E*d[H];C[I+G]=B&255}for(M=0;M<e;M++)C[M*a]=C[M*a+1],C[(M+1)*a-1]=C[(M+1)*a-2];for(M=1;M<a-1;M++)C[M]=C[M+a],C[M+(e-1)*a]=C[M+(e-2)*a];return new f({width:a,height:e,pixels:[C],mask:b?h:null,pixelType:"u8",validPixelCount:g.validPixelCount,statistics:[{minValue:0,maxValue:255}]})};g.tintHillshade=function(f,g,a,e){if(c(f)&&c(g)){var b=e.min,h=f.pixels[0],d=g.mask;g=g.pixels[0];e=255.00001/(e.max-b);for(var m=new Uint8ClampedArray(g.length),t=new Uint8ClampedArray(g.length),
l=new Uint8ClampedArray(g.length),k=a.length-1,x=0;x<g.length;x++)if(!d||0!==d[x]){var n=Math.floor((g[x]-b)*e),q=a[0>n?0:n>k?k:n],n=q[0],v=h[x],q=v*q[1],r=q*(1-Math.abs(n%2-1)),v=v-q;switch(Math.floor(n)){case 0:m[x]=q+v;t[x]=r+v;l[x]=v;break;case 1:m[x]=r+v;t[x]=q+v;l[x]=v;break;case 2:m[x]=v;t[x]=q+v;l[x]=r+v;break;case 3:m[x]=v;t[x]=r+v;l[x]=q+v;break;case 4:m[x]=r+v;t[x]=v;l[x]=q+v;break;case 5:case 6:m[x]=q+v,t[x]=v,l[x]=r+v}}f.pixels=[m,t,l];f.updateStatistics()}}})},"*noref":1}});
define("require exports tslib ../geometry ../PopupTemplate ../rasterRenderers ../request ../core/Error ../core/jsonMap ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../geometry/support/spatialReferenceUtils ./Layer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./support/commonProperties ./support/DimensionalDefinition ./support/Field ./support/imageryRendererUtils ./support/RasterJobHandler ./support/TileInfo ./support/rasterDatasets/RasterFactory ../renderers/support/RasterSymbolizer ../support/popupUtils".split(" "),function(C,
g,f,t,c,h,m,a,e,b,p,d,A,y,l,k,x,n,q,v,r,F,w,u,B,z,D,E,J,H){function M(){return{enabled:this.loaded?"RasterTileServer"===this.raster.datasetFormat&&"Raster"===this.raster.tileType:!0}}var I=e.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),G=b.getLogger("esri.layers.ImageryTileLayer");return function(b){function d(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a._rasterJobHandler=
{instance:null,refCount:0,connectionPromise:null};a.bandIds=null;a.copyright=null;a.fullExtent=null;a.interpolation="nearest";a.legendEnabled=!0;a.isReference=null;a.listMode="show";a.raster=null;a.rasterInfo=null;a.sourceJSON=null;a.spatialReference=null;a.tileInfo=null;a.version=null;a.title=null;a.type="imagery-tile";a.url=null;a.operationalLayerType="ArcGISTiledImageServiceLayer";a.popupEnabled=!0;a.popupTemplate=null;a.symbolizer=null;return a}f.__extends(d,b);d.prototype.normalizeCtorArgs=function(a,
b){return"string"===typeof a?f.__assign({url:a},b):a};d.prototype.load=function(a){var b=this,c=p.isSome(a)?a.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},a).then(function(){return b._openRaster(c)},function(){return b._openRaster(c)}));return A.resolve(this)};Object.defineProperty(d.prototype,"multidimensionalDefinition",{set:function(a){this.raster&&(this._sliceId=this.raster.getSliceIndex(a));this._set("multidimensionalDefinition",a)},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fields",{get:function(){var a,b,c=[new u({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"})],d=null===(b=null===(a=this.rasterInfo)||void 0===a?void 0:a.attributeTable)||void 0===b?void 0:b.fields;d&&(a=d.filter(function(a){return"oid"!==a.type&&"value"!==
a.name.toLowerCase()}).map(function(a){var b=a.clone();b.name="Raster."+a.name;return b}),c=c.concat(a));return c},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"renderer",{set:function(a){this._set("renderer",a);this.updateRenderer()},enumerable:!0,configurable:!0});d.prototype.readRenderer=function(a,b,c){a=h.read(b&&b.layerDefinition&&b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer,c)||void 0;if(null!=a)return a};d.prototype.createPopupTemplate=function(a){return H.createPopupTemplate(this,
a)};d.prototype.updateRenderer=function(){return f.__awaiter(this,void 0,void 0,function(){var a;return f.__generator(this,function(b){switch(b.label){case 0:if(!this.loaded||JSON.stringify(this._cachedRendererJson)===JSON.stringify(this.renderer))return[2];a=this._rasterJobHandler.instance;if(!a)return[2];this.symbolizer.renderer=this.renderer;this.symbolizer.bind();return[4,a.updateSymbolizer(this.symbolizer)];case 1:return b.sent(),this._cachedRendererJson=this.renderer.toJSON(),[2]}})})};d.prototype.applyRenderer=
function(a,b){return f.__awaiter(this,void 0,void 0,function(){var c,d,e,g;return f.__generator(this,function(h){switch(h.label){case 0:c=a&&a.pixelBlock;if(!(c&&c.pixels&&0<c.pixels.length))return[2,null];this.updateRenderer();e=this._rasterJobHandler.instance;g=this.bandIds;return e?[4,e.symbolize(f.__assign(f.__assign({},a),{simpleStretchParams:b,bandIds:g}))]:[3,2];case 1:return d=h.sent(),[3,3];case 2:d=this.symbolizer.symbolize(f.__assign(f.__assign({},a),{simpleStretchParams:b,bandIds:g})),
h.label=3;case 3:return[2,d]}})})};d.prototype.getTileUrl=function(a,b,c){return"RasterTileServer"===this.raster.datasetFormat?this.url+"/tile/"+a+"/"+b+"/"+c:""};d.prototype.getCompatibleTileInfo=function(a,b){if(!this.loaded)return null;var c=k.getInfo(a);return D.create({size:256,spatialReference:a,origin:c?{x:c.origin[0],y:c.origin[1]}:{x:b.xmin,y:b.ymax}})};d.prototype.getCompatibleFullExtent=function(a){return this.loaded?this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(a)?
this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(a):null};d.prototype.fetchTile=function(a,b,c,d){void 0===d&&(d={});return f.__awaiter(this,void 0,void 0,function(){var e,g;return f.__generator(this,function(h){switch(h.label){case 0:return d.requestAsImageElement?(e=this.getTileUrl(a,b,c),[2,m(e,{responseType:"image",query:{sliceId:this._sliceId,_ts:d.timestamp},signal:d.signal}).then(function(a){return a.data})]):[4,this._initJobHandler()];case 1:return h.sent(),
this.multidimensionalDefinition&&(g=this._sliceId,d=f.__assign({multidimensionalDefinition:this.multidimensionalDefinition,sliceId:g},d)),[2,this.raster.fetchTile(a,b,c,d)]}})})};d.prototype.fetchPixels=function(a,b,c,d){return f.__awaiter(this,void 0,void 0,function(){var e;return f.__generator(this,function(g){switch(g.label){case 0:return[4,this._initJobHandler()];case 1:return g.sent(),this.multidimensionalDefinition&&(e=this._sliceId,d=f.__assign({multidimensionalDefinition:this.multidimensionalDefinition,
sliceId:e},d)),[2,this.raster.fetchPixels(a,b,c,d)]}})})};d.prototype.identify=function(a,b){void 0===b&&(b={});return this.raster.identify(a,b)};d.prototype.increaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount++};d.prototype.decreaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()};d.prototype.write=function(c,d){var e=this.raster;if(this.loaded?"RasterTileServer"===e.datasetFormat&&("Raster"===e.tileType||
"Map"===e.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return b.prototype.write.call(this,c,d);d&&d.messages&&d.messages.push(new a("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' are not supported in the context of '"+(d.origin+"/"+(d.layerContainerType||"operational-layers"))+"'",{layer:this}));return null};d.prototype._initJobHandler=function(){var a=this;if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;
var b=new z;this._rasterJobHandler.connectionPromise=b.initialize().then(function(){a._rasterJobHandler.instance=b;a.raster.rasterJobHandler=b;a.renderer&&a.updateRenderer()}).catch(function(){return null});return this._rasterJobHandler.connectionPromise};d.prototype._shutdownJobHandler=function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this.raster.rasterJobHandler=
null};d.prototype._openRaster=function(b){return f.__awaiter(this,void 0,void 0,function(){var c,d,e,g,h,k,l,m,n,p,q;return f.__generator(this,function(f){switch(f.label){case 0:return[4,E.open(this.raster||{url:this.url,sourceJSON:this.sourceJSON,signal:b})];case 1:c=f.sent();this.url||(this.url=c.url);this.raster=c;d=c.rasterInfo;if(!d)throw new a("tile-imagery-layer:load","cannot load resources on "+this.url);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON&&(this._set("version",
this.sourceJSON.currentVersion),this._set("copyright",this.sourceJSON.copyrightText));"Map"===this.raster.tileType&&(this.popupEnabled=!1);e=d.spatialReference;g=d.pixelSize;h=d.storageInfo;k=h.tileInfo;if(!k){l=[];m=h.maximumPyramidLevel||0;n=Math.max(g.x,g.y);p=1/.0254*96*n;for(q=0;q<=m;q++)l.push({level:m-q,resolution:n,scale:p}),n*=2,p*=2;k=new D({origin:h.origin,size:[h.blockWidth,h.blockHeight],spatialReference:e,lods:l});h.tileInfo=k}null==this.title&&(this.title=this.raster.datasetName);d.multidimensionalInfo&&
(this._configDefaultSlice(),this._sliceId=this.raster.getSliceIndex(this.multidimensionalDefinition));this._configDefaultRenderer();return[2,c]}})})};d.prototype._configDefaultSlice=function(){var a=this.raster.rasterInfo.multidimensionalInfo.variables[0],b=[];a.dimensions.forEach(function(c){b.push(new w({variableName:a.name,dimensionName:c.name,values:c.values[0],isSlice:!0}))});this.multidimensionalDefinition=b};d.prototype._configDefaultRenderer=function(){var a=this.raster.rasterInfo,b=a.pixelType;
this.bandIds||(this.bandIds=B.getDefaultBandCombination(a));this.renderer||(this.renderer=B.createDefaultRenderer(a,this.bandIds));"u8"===b&&this.renderer&&"stretchType"in this.renderer&&"min-max"===this.renderer.stretchType&&this.renderer.dynamicRangeAdjustment&&(this.renderer.dynamicRangeAdjustment=!1,this.renderer.statistics=this.renderer.statistics||[[0,255],[0,255],[0,255]]);this.symbolizer?(this.symbolizer.renderer=this.renderer,this.symbolizer.rasterInfo=a):this.symbolizer=new J({renderer:this.renderer,
rasterInfo:a});this.symbolizer.bind()||G.warn("ImageryTileLayer","The given renderer is not supported by the layer.")};f.__decorate([y.property()],d.prototype,"_cachedRendererJson",void 0);f.__decorate([y.property()],d.prototype,"_sliceId",void 0);f.__decorate([y.property()],d.prototype,"_compatibleFullExtent",void 0);f.__decorate([y.property()],d.prototype,"_rasterJobHandler",void 0);f.__decorate([y.property({type:[l.Integer],json:{write:{overridePolicy:M}}})],d.prototype,"bandIds",void 0);f.__decorate([y.property()],
d.prototype,"copyright",void 0);f.__decorate([y.property({type:t.Extent}),y.aliasOf("rasterInfo.extent")],d.prototype,"fullExtent",void 0);f.__decorate([y.property({type:String,json:{read:{reader:I.read},write:{writer:I.write,overridePolicy:M}}})],d.prototype,"interpolation",void 0);f.__decorate([y.property(F.legendEnabled)],d.prototype,"legendEnabled",void 0);f.__decorate([y.property({type:Boolean,json:{read:!1}})],d.prototype,"isReference",void 0);f.__decorate([y.property({type:["show","hide"]})],
d.prototype,"listMode",void 0);f.__decorate([y.property({type:[w]})],d.prototype,"multidimensionalDefinition",null);f.__decorate([y.property()],d.prototype,"raster",void 0);f.__decorate([y.property({readOnly:!0}),y.aliasOf("raster.rasterInfo")],d.prototype,"rasterInfo",void 0);f.__decorate([y.property()],d.prototype,"sourceJSON",void 0);f.__decorate([y.property({type:t.SpatialReference}),y.aliasOf("rasterInfo.spatialReference")],d.prototype,"spatialReference",void 0);f.__decorate([y.property({type:D,
dependsOn:["rasterInfo"]}),y.aliasOf("rasterInfo.storageInfo.tileInfo")],d.prototype,"tileInfo",void 0);f.__decorate([y.property({readOnly:!0})],d.prototype,"version",void 0);f.__decorate([y.property()],d.prototype,"title",void 0);f.__decorate([y.property({readOnly:!0,json:{read:!1}})],d.prototype,"type",void 0);f.__decorate([y.property(F.url)],d.prototype,"url",void 0);f.__decorate([y.property({type:["ArcGISTiledImageServiceLayer"]})],d.prototype,"operationalLayerType",void 0);f.__decorate([y.property({type:Boolean,
value:!0,json:{read:{source:"disablePopup",reader:function(a,b){return!b.disablePopup}},write:{target:"disablePopup",overridePolicy:M,writer:function(a,b,c){b[c]=!a}}}})],d.prototype,"popupEnabled",void 0);f.__decorate([y.property({type:c,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:M}}})],d.prototype,"popupTemplate",void 0);f.__decorate([y.property({readOnly:!0,dependsOn:["title"]})],d.prototype,"defaultPopupTemplate",null);f.__decorate([y.property({readOnly:!0,type:[u],
dependsOn:["rasterInfo"]})],d.prototype,"fields",null);f.__decorate([y.property({types:h.rasterRendererTypes,json:{read:{source:"layerDefinition.drawingInfo.renderer"},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:M}}})],d.prototype,"renderer",null);f.__decorate([y.reader("renderer")],d.prototype,"readRenderer",null);f.__decorate([y.property()],d.prototype,"symbolizer",void 0);return d=f.__decorate([y.subclass("esri.layers.ImageryTileLayer")],d)}(r.ScaleRangeLayer(v.RefreshableLayer(n.OperationalLayer(q.PortalLayer(d.MultiOriginJSONMixin(x))))))});