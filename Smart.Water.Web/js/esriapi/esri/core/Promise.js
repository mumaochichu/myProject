// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ./Accessor ./promiseUtils ./accessorSupport/decorators".split(" "),function(g,f,e,k,d,h){Object.defineProperty(f,"__esModule",{value:!0});var m=function(){function b(c){var a=this;this.instance=c;this._resolver=d.createDeferred();this._status=void 0;this._resolvingPromises=[];this._resolver.promise.then(function(){a._status=0;a._cleanUp()},function(){a._status=1;a._cleanUp()})}b.prototype.addResolvingPromise=function(c){this._resolvingPromises.push(c);this._tryResolve()};
b.prototype.isResolved=function(){return 0===this._status};b.prototype.isRejected=function(){return 1===this._status};b.prototype.isFulfilled=function(){return null!=this._status};b.prototype.abort=function(){this._resolver.reject(d.createAbortError())};b.prototype.when=function(c,a){return this._resolver.promise.then(c,a)};b.prototype._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};b.prototype._tryResolve=function(){var c=this;if(!this.isFulfilled()){var a=d.createDeferred(),
l=e.__spreadArrays(this._resolvingPromises,[a.promise]),b=this._allPromise=d.all(l);b.then(function(){c.isFulfilled()||c._allPromise!==b||c._resolver.resolve(c.instance)},function(a){c.isFulfilled()||c._allPromise!==b||d.isAbortError(a)||c._resolver.reject(a)});a.resolve()}};return b}();f.EsriPromiseMixin=function(b){return function(c){function a(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=c.apply(this,a)||this;a._promiseProps=new m(a);a.addResolvingPromise(d.resolve());return a}
e.__extends(a,c);a.prototype.isResolved=function(){return this._promiseProps.isResolved()};a.prototype.isRejected=function(){return this._promiseProps.isRejected()};a.prototype.isFulfilled=function(){return this._promiseProps.isFulfilled()};a.prototype.when=function(a,b){var c=this;return d.create(function(a,b){c._promiseProps.when(a,b)}).then(a,b)};a.prototype.catch=function(a){return this.when(null,a)};a.prototype.addResolvingPromise=function(a){a&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in
a?a.when():a)};return a=e.__decorate([h.subclass("esri.core.Promise")],a)}(b)};g=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}e.__extends(c,b);return c=e.__decorate([h.subclass("esri.core.Promise")],c)}(f.EsriPromiseMixin(k));f.EsriPromise=g});