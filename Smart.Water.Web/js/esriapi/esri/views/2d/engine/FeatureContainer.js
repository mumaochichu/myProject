// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../core/promiseUtils ../../../core/promiseUtils ../../../geometry/support/aaBoundingRect ../engine".split(" "),function(f,g,c,h,l,m,e){Object.defineProperty(g,"__esModule",{value:!0});f=function(d){function b(a){a=d.call(this,a)||this;a._rendererInfo=new e.WGLRendererInfo;a._attachedResolver=h.createResolver();a.attributeView=new e.AttributeStoreView;return a}c.__extends(b,d);b.prototype.destroy=function(){this.removeAllChildren();this.children.forEach(function(a){return a.destroy()});
this.attributeView.destroy()};b.prototype.whenAttached=function(){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(a){switch(a.label){case 0:return[4,this._attachedResolver.promise];case 1:return a.sent(),[2]}})})};b.prototype.setRendererInfo=function(a,b,c){this._rendererInfo.setInfo(a,b,c);this.requestRender()};b.prototype.getMaterialItems=function(a,b){return c.__awaiter(this,void 0,void 0,function(){var k,d,e,f;return c.__generator(this,function(c){switch(c.label){case 0:return a&&
0!==a.length?[4,this.whenAttached()]:[2,null];case 1:return c.sent(),k=this.stage.painter.textureManager,d=a.map(function(a){return k.rasterizeItem(a.symbol,a.glyphIds,b)}),[4,l.all(d)];case 2:return e=c.sent(),f=e.map(function(b,c){return{id:a[c].id,mosaicItem:b}}),[2,f]}})})};b.prototype.onTileData=function(a,b){if(!(b.addOrUpdate&&"tileDisplayData"in b.addOrUpdate)){var d=b.addOrUpdate&&e.TileData.decode(b.addOrUpdate);b=c.__assign(c.__assign({},b),{addOrUpdate:d})}a.setData(b,this.hasLabels,this.labelsVisible);
this.contains(a)||this.addChild(a);this.requestRender()};b.prototype.onTileError=function(a){a.clear();this.contains(a)||this.addChild(a)};b.prototype.renderChildren=function(a){this._rendererInfo.update(a.state);this.attributeView.bindTextures(this.stage.context);d.prototype.renderChildren.call(this,a)};b.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(m.create(),a);return new e.WGLTile(a,b)};b.prototype.destroyTile=function(a){this.removeChild(a);a.destroy()};b.prototype.createRenderParams=
function(a){return c.__assign(c.__assign({},d.prototype.createRenderParams.call(this,a)),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})};b.prototype.onAttach=function(){d.prototype.onAttach.call(this);var a=this.stage.context.capabilities;a.textureFloat;a.vao;this._attachedResolver()};b.prototype.onDetach=function(){d.prototype.onDetach.call(this);this._attachedResolver=h.createResolver()};return b}(e.TileContainer);g.FeatureContainer=f});