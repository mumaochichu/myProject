// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../../../symbols/cim/Rect ../../../engine ../../../engine/webgl/definitions ../../graphics/graphicsUtils".split(" "),function(M,g,d,D,E,F,G,H,I){function J(a){if(!("visualVariables"in a&&a.hasVisualVariables("size")))return 0;a=a.getVisualVariablesForType("size");if(!a[0])return 0;a=a[0];if("stops"===a.transformationType)return a.stops.map(function(a){return a.size}).reduce(l,0);if("clamped-linear"===
a.transformationType)return"number"===typeof a.maxSize?a.maxSize:a.maxSize.stops.map(function(a){return a.size}).reduce(l,0);if("real-world-size"===a.transformationType)return 30}function c(a,b){return null==a?b:a}function u(a,b){return d.__awaiter(this,void 0,void 0,function(){var v,e,f,h,k,m,w,x,l,g,q,y,n,z;return d.__generator(this,function(r){switch(r.label){case 0:if("simple-marker"===a.type)return v=Math.max(c(a.size,12),b),[2,A(a)+.707*v];if("picture-marker"===a.type)return e=Math.max(c(a.height,
12),b),f=c(a.width,12)*(e/c(a.height,12)),h=f/2,k=e/2,[2,A(a)+Math.sqrt(h*h+k*k)];if("text"===a.type){if(r=a.text&&a.text.length){for(var B=[],t=0;t<r;t++)B.push(d.__assign(d.__assign({},C),{code:a.text.charCodeAt(t)}));m={glyphMosaicItems:B}}else m={glyphMosaicItems:[C]};I.getTextSymbolSize(p,a,m);w=Math.abs(p[0]);x=Math.abs(p[1]);l=p[2];g=p[3];return[2,Math.max(w,x)+Math.max(l,g)]}if("simple-line"===a.type)return q=a,y=Math.max(c(q.width,.75),b)/2,q.marker?[2,Math.max(6*q.width,2*b)]:[2,y];if("simple-fill"===
a.type||"picture-fill"===a.type)return[2,Math.max(null==a.outline?0:c(a.outline.width,0),b)/2];if("cim"===a.type)return(n=G.CIMSymbolHelper.getEnvelope(a.data))?[2,Math.sqrt(n.width*n.width+n.height*n.height)]:[2,0];if("web-style"!==a.type)return[3,2];z=u;return[4,a.fetchCIMSymbol()];case 1:return[2,z.apply(void 0,[r.sent(),b])];case 2:return[2,0]}})})}function K(a,b){return d.__awaiter(this,void 0,void 0,function(){var c,e;return d.__generator(this,function(f){switch(f.label){case 0:if(!(a.type in
L))return[2,0];e=(c=Math).min;return[4,u(a,b)];case 1:return[2,e.apply(c,[f.sent(),75])]}})})}function A(a){var b=c(a.xoffset,0);a=c(a.yoffset,0);return Math.sqrt(b*b+a*a)}function l(a,b){return Math.max(a,b)}Object.defineProperty(g,"__esModule",{value:!0});var L={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1};g.computePxBuffer=function(a,b){return d.__awaiter(this,void 0,void 0,function(){var c,e,f,h,k,m,g;return d.__generator(this,
function(d){switch(d.label){case 0:if("heatmap"===a.type)return[2,Math.round(3*a.blurRadius)];if("dot-density"===a.type)return[2,0];if("dictionary"===a.type)return"esriGeometryPoint"===b||"esriGeometryMultipoint"===b?[2,100]:[2,50];c=a.getSymbols();e=J(a);f=[];h=0;for(k=c;h<k.length;h++)m=k[h],f.push(K(m,e));return[4,D.all(f)];case 1:return g=d.sent(),[2,E.pt2px(g.reduce(l,0))]}})})};var p=[0,0,0,0],C={sdf:!0,code:99,metrics:H.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new F.default(0,0,24,24),page:0,
textureBinding:2}});