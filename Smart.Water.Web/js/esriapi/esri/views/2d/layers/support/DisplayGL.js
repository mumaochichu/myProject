// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../core/maybe ../../engine ../../ViewState".split(" "),function(c,k,l,n,m,p){Object.defineProperty(k,"__esModule",{value:!0});c=function(c){function f(b){var a=c.call(this)||this;a.layerView=b;a._lastTime=null;a._childrenRenderParameters={context:null,pixelRatio:1,state:new p,stationary:!0,painter:null};a._name=a.constructor.name;a.requestRender=a.requestRender.bind(a);return a}l.__extends(f,c);f.prototype.doRender=function(b){if(b.drawPhase===m.enums.WGLDrawPhase.MAP){var a=
window.devicePixelRatio,g=this.stage,e=g.context,c=g.painter,g=g.profiler,d=b.state,f=b.stationary,h=this._childrenRenderParameters;h.context=e.gl;h.state.copy(d);h.state.pixelRatio=a;h.stationary=f;h.painter=c;b=this.createRenderParams(b);c.beforeRenderLayer(b,this.clips?255:0,b.globalOpacity);g.recordContainerStart(this._name);a=e.getBoundFramebufferObject();d=e.getViewport();e.resetState();e.bindFramebuffer(a);e.setViewport(d.x,d.y,d.width,d.height);this.layerView._renderTarget.framebufferObject=
a.glName;this.layerView._renderTarget.viewport[0]=d.x;this.layerView._renderTarget.viewport[1]=d.y;this.layerView._renderTarget.viewport[2]=d.width;this.layerView._renderTarget.viewport[3]=d.height;this.layerView.render(h);e.enforceState();c.compositeLayer(b,b.globalOpacity);g.recordContainerEnd()}};f.prototype.createRenderParams=function(b){var a=Date.now(),c=(n.isSome(this._lastTime)?a-this._lastTime:0)/1E3;this._lastTime=a;return l.__assign(l.__assign({},b),{context:this.stage.context,painter:this.stage.painter,
profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:c,timeline:this.stage.timeline,blendMode:this.blendMode,globalOpacity:b.globalOpacity*this.opacity})};return f}(m.Container);k.DisplayGL=c;k.default=c});