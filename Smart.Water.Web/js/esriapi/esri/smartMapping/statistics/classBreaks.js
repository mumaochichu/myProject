// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../core/Error ../../core/maybe ./support/utils ../support/utils".split(" "),function(D,E,e,b,B,v,h){function C(c){return e.__awaiter(this,void 0,void 0,function(){var m,f,g,d,a,w,n,k,l,x,p,q,r,t,y,z,A;return e.__generator(this,function(u){switch(u.label){case 0:if(!c||!c.layer||!c.field&&!c.valueExpression)throw new b("class-breaks:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");if(c.valueExpression&&!c.view)throw new b("class-breaks:missing-parameters",
"View is required when 'valueExpression' is specified");m=[0,2,1,3];f=c.layer;g=e.__rest(c,["layer"]);d=h.createLayerAdapter(f,m);a=e.__assign({layerAdapter:d},g);a.normalizationType=h.getNormalizationType(a);a.numClasses=a.numClasses||5;if(!d)throw new b("class-breaks:invalid-parameters","'layer' must be one of these types: "+h.getLayerTypeLabels(m).join(", "));w=B.isSome(a.signal)?{signal:a.signal}:null;return[4,d.load(w)];case 1:return u.sent(),n=a.field,k=a.minValue,l=a.maxValue,x=null!=k||null!=
l,p=a.classificationMethod,q="percent-of-total"===a.normalizationType,r=!1!==a.analyzeData,t=n?d.getField(n):null,[4,h.getFieldsList({field:a.field,normalizationField:a.normalizationField,valueExpression:a.valueExpression})];case 2:y=u.sent();if(z=v.verifyBasicFieldValidity(d,y,"class-breaks:invalid-parameters"))throw z;if(t&&(A=v.verifyNumericField(d,t,"class-breaks:invalid-parameters")))throw A;if(a.valueExpression&&a.normalizationType)throw new b("class-breaks:invalid-parameters","Normalization is not allowed when 'valueExpression' is specified");
if(x)if(r){if(q&&null==a.normalizationTotal)throw new b("class-breaks:missing-parameters","'normalizationTotal' is required when 'normalizationType' is 'precent-of-total' and 'minValue', 'maxValue' are specified");}else{if(null==k||null==l)throw new b("class-breaks:missing-parameters","Both 'minValue' and 'maxValue' are required when 'analyzeData' is false");if(k>=l)throw new b("class-breaks:invalid-parameters","'minValue' should be less than 'maxValue'");if(p&&"equal-interval"!==p)throw new b("class-breaks:invalid-parameters",
"'classificationMethod' other than 'equal-interval' is not allowed when 'analyzeData' is false");if(q&&null==a.normalizationTotal)throw new b("class-breaks:missing-parameters","'normalizationTotal' is required when 'normalizationType' is 'precent-of-total' and 'analyzeData' is false");}else if(!r)throw new b("class-breaks:missing-parameters","Both 'minValue' and 'maxValue' are required when 'analyzeData' is false");return[2,a]}})})}return function(b){return e.__awaiter(this,void 0,void 0,function(){var c,
f,g;return e.__generator(this,function(d){switch(d.label){case 0:return[4,C(b)];case 1:return c=d.sent(),f=c.layerAdapter,g=e.__rest(c,["layerAdapter"]),[2,f.classBreaks(g)]}})})}});