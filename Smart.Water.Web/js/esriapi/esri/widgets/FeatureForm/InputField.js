// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../intl ../../core/Accessor ../../core/accessorSupport/decorators ../../layers/support/CodedValueDomain ../../layers/support/domains ../../layers/support/fieldUtils".split(" "),function(t,u,c,l,q,d,r,k,f){var m={type:"number"},n={type:"number",intlOptions:{notation:"scientific"}},p={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}};return function(g){function b(a){a=g.call(this,a)||this;a.arcade=
null;a.config=null;a.feature=null;a.field=null;a.layer=null;a.description=null;a.editorType=null;a.error=null;a.format=null;a.group=null;a.hint=null;a.messages=null;a.name=null;return a}c.__extends(b,g);Object.defineProperty(b.prototype,"compiledFunc",{get:function(){var a,b=this.arcade;return b&&b.arcadeUtils.createFunction(null===(a=this.config)||void 0===a?void 0:a.visibilityExpression)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"compiledRequiredFunc",{get:function(){var a,
b=this.arcade;return b&&b.arcadeUtils.createFunction(null===(a=this.config)||void 0===a?void 0:a.requiredExpression)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"evaluatedRequirement",{get:function(){var a=this.compiledRequiredFunc;if(!a)return null;var b=this.arcade;return b.arcadeUtils.executeFunction(a,b.arcadeUtils.createExecContext(this.feature))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"evaluatedVisibility",{get:function(){var a=this.compiledFunc;
if(!a)return null;var b=this.arcade;return b.arcadeUtils.executeFunction(a,b.arcadeUtils.createExecContext(this.feature))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"domain",{get:function(){var a,b,c=this.layer.typeIdField,d=c===this.name,e=null===(a=this.field)||void 0===a?void 0:a.domain;if(d&&!e)return new r({name:"__internal-type-based-coded-value-domain__",codedValues:this.layer.types.map(function(a){return{code:a.id,name:a.name}})});a=this.feature;c=c&&this.layer.getFieldDomain(this.name,
{feature:a})||e;e=null===(b=this.config)||void 0===b?void 0:b.domain;return this._isDomainCompatible(e)?e:c},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"editable",{get:function(){var a;return this.layer.capabilities.operations.supportsEditing&&this.field.editable&&!1!==(null===(a=this.config)||void 0===a?void 0:a.editable)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"errorMessage",{get:function(){return this._toErrorMessage()},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"label",{get:function(){var a;return(null===(a=this.config)||void 0===a?void 0:a.label)||this.field.alias||this.field.name},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"maxLength",{get:function(){var a,b;if("date"===this.type)return-1;var c=null===(a=this.field)||void 0===a?void 0:a.length;a=null===(b=this.config)||void 0===b?void 0:b.maxLength;return!isNaN(a)&&-1<=a&&(-1===c||a<=c)?a:c},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"minLength",{get:function(){var a,b;if("date"===this.type)return-1;var c=null===(a=this.field)||void 0===a?void 0:a.length;a=null===(b=this.config)||void 0===b?void 0:b.minLength;return!isNaN(a)&&-1<=a&&(-1===c||a<=c)?a:-1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"required",{get:function(){var a,b;return this.editable?null!==(a=this.field)&&void 0!==a&&a.nullable?"boolean"===typeof this.evaluatedRequirement?this.evaluatedRequirement:!0===(null===(b=this.config)||void 0===
b?void 0:b.required):!0:!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){var a=this.field;return f.isNumericField(a)?"number":f.isStringField(a)?"text":f.isDateField(a)?"date":"unsupported"},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"valid",{get:function(){var a=this.editable?this._validate():null;this._set("error",a);return null===a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this._get("value")},
set:function(a){this.notifyChange("evaluatedVisibility");this._set("value",a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visible",{get:function(){return this._isEditorField()?!1:"boolean"===typeof this.evaluatedVisibility?this.evaluatedVisibility:!!this.config||this._shownByDefault()},enumerable:!0,configurable:!0});b.prototype._isDomainCompatible=function(a){var b=this.field;if(a&&"coded-value"===a.type){var c=typeof a.codedValues[0].code;if("string"===c&&f.isStringField(b)||
"number"===c&&f.isNumericField(b))return!0}return a&&"range"===a.type&&f.isNumericField(b)?!0:!1};b.prototype._validate=function(){var a=this.domain,b=this.field,c=this.minLength,d=this.required,e=this.value;return"text"===this.type&&-1<c&&"string"===typeof e&&e.length<c?"length-validation-error::too-short":a?null!==e||d?k.validateDomainValue(a,e):null:f.validateFieldValue(b,e)};b.prototype._shownByDefault=function(){var a,b=null===(a=this.field)||void 0===a?void 0:a.type;return"oid"!==b&&"global-id"!==
b&&!this._isGeometryField()};b.prototype._isEditorField=function(){return-1<f.getFeatureEditFields(this.layer).indexOf(this.name)};b.prototype._isGeometryField=function(){return-1<f.getFeatureGeometryFields(this.layer).indexOf(this.name)};b.prototype._toErrorMessage=function(){var a=this.domain,b=this.field,c=this.messages,d=this.minLength,e=this.value,g=this.type,h=this.error;return this.required&&null===e?c.validationErrors.cannotBeNull:h===k.DomainValidationError.VALUE_OUT_OF_RANGE||h===f.NumericRangeValidationError.OUT_OF_RANGE?
(a=k.getDomainRange(a)||f.getFieldRange(b),l.substitute(c.validationErrors.outsideRange,a,{format:{max:"date"===g?p:a.isInteger?m:n,min:"date"===g?p:a.isInteger?m:n}})):h===k.DomainValidationError.INVALID_CODED_VALUE?c.validationErrors.invalidCodedValue:h===f.TypeValidationError.INVALID_TYPE?c.validationErrors.invalidType:"length-validation-error::too-short"===h?l.substitute(c.validationErrors.tooShort,{min:d}):null};c.__decorate([d.property()],b.prototype,"arcade",void 0);c.__decorate([d.property({dependsOn:["arcade",
"config.visibilityExpression"]})],b.prototype,"compiledFunc",null);c.__decorate([d.property({dependsOn:["arcade","config.requiredExpression"]})],b.prototype,"compiledRequiredFunc",null);c.__decorate([d.property()],b.prototype,"config",void 0);c.__decorate([d.property({dependsOn:["compiledRequiredFunc","feature"]})],b.prototype,"evaluatedRequirement",null);c.__decorate([d.property({dependsOn:["compiledFunc","feature"]})],b.prototype,"evaluatedVisibility",null);c.__decorate([d.property()],b.prototype,
"feature",void 0);c.__decorate([d.property()],b.prototype,"field",void 0);c.__decorate([d.property()],b.prototype,"layer",void 0);c.__decorate([d.property({aliasOf:"config.description"})],b.prototype,"description",void 0);c.__decorate([d.property({dependsOn:["config","feature","field","layer"]})],b.prototype,"domain",null);c.__decorate([d.property({dependsOn:["config","field","layer"]})],b.prototype,"editable",null);c.__decorate([d.property({aliasOf:"config.editorType"})],b.prototype,"editorType",
void 0);c.__decorate([d.property({readOnly:!0})],b.prototype,"error",void 0);c.__decorate([d.property({dependsOn:["error","messages","value"]})],b.prototype,"errorMessage",null);c.__decorate([d.property({aliasOf:"config.format"})],b.prototype,"format",void 0);c.__decorate([d.property()],b.prototype,"group",void 0);c.__decorate([d.property({aliasOf:"config.hint"})],b.prototype,"hint",void 0);c.__decorate([d.property({dependsOn:["field","config"]})],b.prototype,"label",null);c.__decorate([d.property({dependsOn:["field.length",
"config"]})],b.prototype,"maxLength",null);c.__decorate([d.property({dependsOn:["field.length","config"]})],b.prototype,"minLength",null);c.__decorate([d.property()],b.prototype,"messages",void 0);c.__decorate([d.property({aliasOf:"field.name"})],b.prototype,"name",void 0);c.__decorate([d.property({dependsOn:["config","evaluatedRequirement","field"]})],b.prototype,"required",null);c.__decorate([d.property({dependsOn:["field"]})],b.prototype,"type",null);c.__decorate([d.property({dependsOn:["config",
"domain","field","layer","value"]})],b.prototype,"valid",null);c.__decorate([d.property({value:null})],b.prototype,"value",null);c.__decorate([d.property({dependsOn:["config","evaluatedVisibility","field","layer"]})],b.prototype,"visible",null);return b=c.__decorate([d.subclass("esri.widgets.FeatureForm.InputField")],b)}(q)});