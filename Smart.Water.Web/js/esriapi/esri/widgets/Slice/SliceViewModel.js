// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../core/Accessor ../../core/Collection ../../core/collectionUtils ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/analysisTools/slice/SliceTool ../../views/3d/interactive/analysisTools/slice/sliceToolUtils ../../views/3d/support/geometryUtils/boundedPlane ./SlicePlane ../support/InteractiveToolViewModel".split(" "),function(y,z,d,t,k,l,u,v,f,m,e,w,n,p,q,x){var r=v.getLogger("esri.widgets.Slice.SliceViewModel"),
g=new Set;return function(h){function c(a){a=h.call(this,a)||this;a.supportedViewType="3d";a.handles=new u;g.add(a);return a}d.__extends(c,h);c.prototype.destroy=function(){g.delete(this);this.handles.destroy()};Object.defineProperty(c.prototype,"state",{get:function(){return this.isDisabled?"disabled":this.tool?this.tool.state:"ready"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"plane",{get:function(){return this.tool?this.tool.plane:this._get("plane")},set:function(a){this._clearOverride("shape");
this._set("plane",a);this.updateToolOrRecreate(function(b){return b.plane=a})},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"shape",{get:function(){if(f.isNone(this.plane))return null;var a=this._get("shape"),b=this.view,b=n.planeToShape(this.plane,b.renderCoordsHelper,b.spatialReference,new q);return f.isNone(b)||f.isNone(a)?b:b.heading===a.heading&&b.tilt===a.tilt&&f.isSome(b.position)&&f.isSome(a.position)&&b.position.equals(a.position)&&b.width===a.width&&b.height===a.height?
a:b},set:function(a){f.isNone(this.view)||!this.view.ready?this._override("shape",a):(a=n.shapeToPlane(a,this.view.renderCoordsHelper,p.create()),f.isSome(this.plane)&&f.isSome(a)&&p.equals(this.plane,a)||(this.plane=a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"tiltEnabled",{get:function(){var a,b,c;return null!==(c=null!==(b=null===(a=this.tool)||void 0===a?void 0:a.tiltEnabled)&&void 0!==b?b:this._get("tiltEnabled"))&&void 0!==c?c:!1},set:function(a){this._set("tiltEnabled",
a);this.updateToolOrRecreate(function(b){return b.tiltEnabled=a})},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"excludedLayers",{get:function(){return this.tool?this.tool.excludedLayers:this._get("excludedLayers")||new k},set:function(a){this._set("excludedLayers",l.referenceSetter(a,this.excludedLayers));this.updateToolOrRecreate(function(b){return b.excludedLayers=a})},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"excludeGroundSurface",{get:function(){return this.tool?
this.tool.excludeGroundSurface:this._get("excludeGroundSurface")||!1},set:function(a){this._set("excludeGroundSurface",a);this.updateToolOrRecreate(function(b){return b.excludeGroundSurface=a})},enumerable:!0,configurable:!0});c.prototype.start=function(){var a=this;g.forEach(function(b){b.view===a.view&&b!==a&&b.clear()});return this.createTool()};c.prototype.clear=function(){this.removeTool();this._set("plane",null);this._set("excludeGroundSurface",!1);this._set("excludedLayers",new k)};c.prototype.newSlice=
function(){m.ignoreAbortErrors(this.start())};c.prototype.clearSlice=function(){this.clear()};c.prototype.removeSliceAndStart=function(){this.removeTool();this.plane=null;return this.start()};c.prototype.enterExcludeLayerMode=function(){this.tool&&this.tool.enterExcludeLayerMode()};c.prototype.exitExcludeLayerMode=function(){this.tool&&this.tool.exitExcludeLayerMode()};c.prototype.createTool=function(){return d.__awaiter(this,void 0,void 0,function(){var a;return d.__generator(this,function(b){switch(b.label){case 0:return[4,
this.view.whenReady()];case 1:return b.sent(),this._isOverridden("shape")&&(a=this.shape,this._clearOverride("shape"),this.shape=a),[4,h.prototype.createTool.call(this)];case 2:return b.sent(),[2]}})})};c.prototype.updateToolOrRecreate=function(a){this.tool?a(this.tool):(this.removeTool(),m.ignoreAbortErrors(this.createTool()))};c.prototype.createToolParams=function(){var a=this;return{toolConstructor:w,constructorArguments:function(){return{excludeGroundSurface:a.excludeGroundSurface,plane:a.plane,
excludedLayers:a.excludedLayers,tiltEnabled:a.tiltEnabled}}}};c.prototype.logUnsupportedError=function(){this.logError("Slice widget is not implemented for MapView")};c.prototype.logError=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];r.error.apply(r,a)};d.__decorate([e.property({dependsOn:["isDisabled","tool.attached","tool.state"],readOnly:!0})],c.prototype,"state",null);d.__decorate([e.property()],c.prototype,"tool",void 0);d.__decorate([e.property({dependsOn:["tool.plane"]})],
c.prototype,"plane",null);d.__decorate([e.property({types:{key:"type",base:t,typeMap:{plane:q},defaultKeyValue:"plane"},dependsOn:["plane"]})],c.prototype,"shape",null);d.__decorate([e.property({type:Boolean,dependsOn:["tool.tiltEnabled"]})],c.prototype,"tiltEnabled",null);d.__decorate([e.aliasOf("tool.layersMode")],c.prototype,"layersMode",void 0);d.__decorate([e.property({dependsOn:["tool.excludedLayers"],cast:l.castForReferenceSetter})],c.prototype,"excludedLayers",null);d.__decorate([e.property({dependsOn:["tool.excludeGroundSurface"],
nonNullable:!0})],c.prototype,"excludeGroundSurface",null);return c=d.__decorate([e.subclass("esri.widgets.slice.SliceViewModel")],c)}(x.InteractiveToolViewModel)});