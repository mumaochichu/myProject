// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(k,l,q,n,t){function p(b,c){for(var a=Math.PI;Math.abs(c-b)>a+2E-15;)c=c-b>a?c-2*a:c+2*a;return(b+c)/2}Object.defineProperty(l,"__esModule",{value:!0});k=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(b,a,d){return new u(b,a,d)};b.instance=null;return b}();l.PlacementOnVertices=k;var u=function(b){function c(a,d,c){a=b.call(this,a,!0,!0)||
this;a._curveHelper=new t.CurveHelper;a._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;a._offset=void 0!==d.offset?d.offset*c:0;a._endPoints=void 0!==d.placeOnEndPoints?d.placeOnEndPoints:!0;a._controlPoints=void 0!==d.placeOnControlPoints?d.placeOnControlPoints:!0;a._regularVertices=void 0!==d.placeOnRegularVertices?d.placeOnRegularVertices:!0;a._tags=[];a._tagIterator=0;return a}q.__extends(c,b);c.prototype.processPath=function(a){this.iteratePath||(this._preparePath(a),this.iteratePath=!0);
if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;a=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(a[2]);var d=a[0],b=a[1];if(0!==this._offset)var c=Math.cos(a[2]),d=d-this._offset*Math.sin(a[2]),b=b+this._offset*c;this.internalPlacement.setTranslate(d,b);this._tagIterator++;return this.internalPlacement};c.prototype._preparePath=function(a){this._tagIterator=this._tags.length=0;for(var b=n.isClosedPath(a),
c=a.length-1,g=0,r=0,k=0,m=0,h=0,e,f;g<c;){g++;e=a[g-1];f=a[g];var l=n.getId(e),q=n.getId(f);if(this._angleToLine||0!==this._offset)m=this._curveHelper.getAngle(e,f,0);1===g?b?(r=m,k=l):this._endPoints&&this._tags.push([e[0],e[1],m]):1===l?this._controlPoints&&this._tags.push([e[0],e[1],p(h,m)]):this._regularVertices&&this._tags.push([e[0],e[1],p(h,m)]);if(this._angleToLine||0!==this._offset)h=this._curveHelper.getAngle(e,f,1);g===c&&(b?1===q||1===k?this._controlPoints&&this._tags.push([f[0],f[1],
p(h,r)]):this._regularVertices&&this._tags.push([f[0],f[1],p(h,r)]):this._endPoints&&this._tags.push([f[0],f[1],h]))}this._tagIterator=0};return c}(n.PathTransformationCursor)});