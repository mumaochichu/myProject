// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(n,p,q,g,r){Object.defineProperty(p,"__esModule",{value:!0});n=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(c,b,a){return new t(c,b,a)};c.instance=null;return c}();p.PlacementOnLine=n;var t=function(c){function f(b,a,e){b=c.call(this,b,!0,!0)||this;b._curveHelper=new r.CurveHelper;b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=
void 0!==a.offset?a.offset*e:0;b._relativeTo=a.relativeTo;b._position=void 0!==a.startPointOffset?a.startPointOffset*e:0;b._epsilon=.001*e;return b}q.__extends(f,c);f.prototype.processPath=function(b){var a=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=b.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var e=this._curSegment;this._curSegment++;var a=b[e-1],e=b[e],c=this._curveHelper.calculateLength(a,e);if(!(c<
this._epsilon)){var c=.5+this._position/c,d=this._curveHelper.getAngleCS(a,e,c);b=d[0];d=d[1];a=g.getCoord2D(a,e,c);this.internalPlacement.setTranslate(a[0]-this._offset*d,a[1]+this._offset*b);this._angleToLine&&this.internalPlacement.setRotateCS(b,d);return this.internalPlacement}}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&g.reversePath(b);a=this.onLine(b,a);"LineEnd"===this._relativeTo&&g.reversePath(b);return a};f.prototype.onLine=function(b,a){var c,f=!1;switch(this._relativeTo){default:c=
this._curveHelper.calculatePathLength(b)/2+a;break;case "LineBeginning":c=a;break;case "LineEnd":c=a,f=!0}for(var d=b.length,k=0,h=b[0],l=1;l<d;++l){a=h;var h=b[l],m=this._curveHelper.calculateLength(a,h);if(k+m>c)return c=(c-k)/m,d=this._curveHelper.getAngleCS(a,h,c),b=d[0],d=d[1],a=g.getCoord2D(a,h,c),this.internalPlacement.setTranslate(a[0]-this._offset*d,a[1]+this._offset*b),this._angleToLine&&(f?this.internalPlacement.setRotateCS(-b,-d):this.internalPlacement.setRotateCS(b,d)),this.internalPlacement;
k+=m}return null};return f}(g.PathTransformationCursor)});