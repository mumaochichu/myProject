// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../geometry ../../../Ground ../../../core/promiseUtils ../../../core/unitUtils ../../Mesh".split(" "),function(H,m,c,v,C,D,E,F){function G(a){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(b){switch(b.label){case 0:return z(a)?[2,a.load()]:[4,a.load()];case 1:return b.sent(),[4,D.eachAlways(a.layers.map(function(a){return a.load()}))];case 2:return b.sent(),[2,a]}})})}function z(a){return"type"in a&&("elevation"===a.type||"base-elevation"===
a.type)}Object.defineProperty(m,"__esModule",{value:!0});m.create=function(a,b,q){return c.__awaiter(this,void 0,void 0,function(){var w,m;return c.__generator(this,function(e){switch(e.label){case 0:return z(a)||a instanceof C?[4,G(a)]:[3,3];case 1:return m=e.sent(),[4,m.createElevationSampler(b,{demResolution:q&&q.demResolution||"finest-contiguous"})];case 2:return w=e.sent(),[3,4];case 3:w=a,e.label=4;case 4:e=w;var f=E.getMetersPerUnitForSR(b.spatialReference),d=e.demResolution.min/f,f=Math.round(b.width/
d),d=Math.round(b.height/d),k=f+1,c=d+1,r=new Float64Array(k*c*3),x=new Float32Array(k*c*2),y=0,A=0,g=new Uint32Array(f*d*6),h=0,l=0;t.spatialReference=b.spatialReference;for(var n=0;n<c;n++)for(var B=b.ymin+n/d*b.height,p=0;p<k;p++){var u=b.xmin+p/f*b.width;t.x=u;t.y=B;r[y++]=u;r[y++]=B;r[y++]=e.elevationAt(t)||0;var u=p/f,v=n/d;x[A++]=u;x[A++]=v;n!==d&&p!==f&&(g[l++]=h+1,g[l++]=h+k+1,g[l++]=h+k,g[l++]=h,g[l++]=h+1,g[l++]=h+k);h++}return[2,new F({vertexAttributes:{position:r,uv:x},components:[{faces:g,
shading:"smooth",material:q&&q.material||null}],spatialReference:b.spatialReference})]}})})};var t=new v.Point});