// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../assets ../core/Error ../core/maybe ../core/promiseUtils ../core/SetUtils ./locale @dojo/framework/shim/Promise".split(" "),function(C,c,f,w,p,x,y,z,q){function r(a){if(!t.test(a))return null;var b=t.exec(a);a=b[1];b=b[2];b=a+(b?"-"+b.toUpperCase():"");return u.has(b)?b:u.has(a)?a:null}function A(a){return f.__awaiter(this,void 0,void 0,function(){var b,d,c,g,k,h,l,m,n;return f.__generator(this,function(e){switch(e.label){case 0:b=/^(.*)\/t9n\/(.*)$/g.exec(a);if(!b)throw new p("esri-intl:invalid-bundle",
'Missing "t9n" folder in locale bundle path "'+a+'"');d=b[1]+"/t9n/";c=b[2];g=q.getLocale();k=r(g);h=""+d+c+".json";l=k?""+d+c+"_"+k+".json":h;e.label=1;case 1:return e.trys.push([1,3,,8]),[4,v(l)];case 2:return m=e.sent(),[3,8];case 3:n=e.sent();if(l===h)throw n;e.label=4;case 4:return e.trys.push([4,6,,7]),[4,v(h)];case 5:return m=e.sent(),[3,7];case 6:throw e.sent(),new p("esri-intl:unknown-bundle",'Bundle "'+a+'" cannot be loaded',{error:n});case 7:return[3,8];case 8:return[2,m]}})})}function v(a){return f.__awaiter(this,
void 0,void 0,function(){var b;return f.__generator(this,function(d){switch(d.label){case 0:return x.isSome(c.test.fetchBundleAsset)?[2,c.test.fetchBundleAsset(a)]:[4,w.fetchAsset(a,{responseType:"json"})];case 1:return b=d.sent(),[2,b.data]}})})}Object.defineProperty(c,"__esModule",{value:!0});var t=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,u=z.SetFromValues("ar bs ca cs da de el en es et fi fr he hi hr hu id it ja ko lt lv nb nl pl pt-BR pt-PT ro ru sl sr sv th tr uk vi zh-CN zh-HK zh-TW".split(" ")),
g=new Map;q.beforeLocaleChange(function(){g.clear()});c.loadMessageBundle=function(a){return f.__awaiter(this,void 0,void 0,function(){var b;return f.__generator(this,function(d){switch(d.label){case 0:return g.has(a)||g.set(a,A(a)),b=g.get(a),[4,B.add(b)];case 1:return d.sent(),[2,b]}})})};c.getKnownMessageBundleLocale=r;var B=new (function(){function a(){this._numLoading=0}a.prototype.waitForAll=function(){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(b){switch(b.label){case 0:return this._dfd?
[4,this._dfd.promise]:[3,2];case 1:b.sent(),b.label=2;case 2:return[2]}})})};a.prototype.add=function(b){var a=this;this._increase();b.then(function(){return a._decrease()},function(){return a._decrease()});return this.waitForAll()};a.prototype._increase=function(){this._numLoading++;this._dfd||(this._dfd=y.createDeferred())};a.prototype._decrease=function(){this._numLoading=Math.max(this._numLoading-1,0);this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)};return a}());c.test={cache:g}});