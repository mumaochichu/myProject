// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(u,v,w,C,f,D,E,t,F,q,B,G,H){Object.defineProperty(v,"__esModule",{value:!0});u=function(u){function n(d,a,f,b,h,e,k,l,m,n,t,I,J,A,g,x,y,r,z,v,w){var c=u.call(this)||this;c.angle=
b;c.height=k;c.width=e;c.xOffset=a*z;c.yOffset=f*z;c._markerPlacement=v;c.effects=w;c._anchorX=.5-((.5+x)*g.width+1)/g.rect.width;c._anchorY=.5-((.5+y)*g.height+1)/g.rect.height;a=(1===A?1:0)|(t?1:0)<<1|(J?1:0)<<2|(I?1:0)<<3;f=g&&g.sdf;d=B.MarkerMaterialKey.load(B.createMaterialKey(c.geometryType,d,!1));d.sdf=f;d.pattern=!0;d.textureBinding=g.textureBinding;c._materialKey=d.data;c._fillColor=h;c._outlineColor=m;c._sizeOutlineWidth=q.i8888to32(Math.round(Math.min(Math.sqrt(128*e),255)),Math.round(Math.min(Math.sqrt(128*
k),255)),Math.round(Math.min(Math.sqrt(128*n),255)),Math.round(Math.min(Math.sqrt(128*l),255)));h=g.rect.x;l=g.rect.y;m=h+g.rect.width;n=l+g.rect.height;c._texUpperLeft=q.i1616to32(h,l);c._texUpperRight=q.i1616to32(m,l);c._texBottomLeft=q.i1616to32(h,n);c._texBottomRight=q.i1616to32(m,n);e=e*r*z;k=k*r*z;c._bitestAndDistRatio=q.i8888to32(0,0,a,Math.round(Math.min(64*r,255)));e*=g.rect.width/g.width;k*=g.rect.height/g.height;c._computedWidth=e;c._computedHeight=k;e=E.vec2f32.create();k=D.mat2df32.create();
c._applyTransformation(k,e);return c}w.__extends(n,u);n.fromCIMMarker=function(d,a,p){var b=a.size,h=(p&&p.width||1)/(p&&p.height||1)*a.scaleX,e=a.scaleSymbolsProportionally&&a.frameHeight?b/a.frameHeight:1,k=t.premultiplyAlphaRGBA(a.color),l=t.premultiplyAlphaRGBA(a.outlineColor),m=f.pt2px(b),q=m*h,u=f.pt2px(a.offsetX||0),v=f.pt2px(a.offsetY||0),e=f.pt2px(a.outlineWidth||0)*e,w=a.alignment||0,A=f.pt2px(a.referenceSize),g=a.rotation||0;a.rotateClockwise||(g=-g);var x=0,y=0,r=a.anchorPoint;r&&(a.isAbsoluteAnchorPoint?
b&&(x=-r.x/(b*h),y=r.y/b):(x=r.x,y=r.y));return new n(d,u,v,g,k,q,m,A,l,e,a.colorLocked,a.scaleSymbolsProportionally,!1,w,p,x,y,a.sizeRatio,C.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects)};n.fromPictureMarker=function(d,a,p){var b=Math.round(f.pt2px(a.width)),h=Math.round(f.pt2px(a.height)),e=F.PICTURE_FILL_COLOR,k=Math.round(f.pt2px(a.xoffset||0)),l=Math.round(f.pt2px(a.yoffset||0));return new n(d,k,l,a.angle,e,b,h,h,0,0,!1,!1,!1,0,p,0,0,1,1,null,null)};n.fromSimpleMarker=function(d,a,p){var b=
t.premultiplyAlphaRGBA(a.color),h=Math.round(f.pt2px(a.size)),e=Math.round(f.pt2px(a.xoffset||0)),k=Math.round(f.pt2px(a.yoffset||0)),l=a.style,m=a.outline,q=(m&&m.color&&t.premultiplyAlphaRGBA(m.color))|0,m=(m&&m.width&&Math.round(f.pt2px(m.width)))|0;d=new n(d,e,k,a.angle,b,h,h,h,q,m,!1,!1,"cross"===l||"x"===l,0,p,0,0,1.96875,1,null,null);d.boundsType="circle"===l?"circle":"square";return d};n.fromLineSymbolMarker=function(d,a,p){var b=a.marker,h=b.color?t.premultiplyAlphaRGBA(b.color):t.premultiplyAlphaRGBA(a.color),
e=Math.round(f.pt2px(6*a.width)),k=b.style,l="cross"===k||"x"===k;switch(b.placement){case "begin-end":b="Both";break;case "begin":b="JustBegin";break;case "end":b="JustEnd";break;default:b="None"}b={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:b,offsetAlongLine:0};d=new n(d,0,0,0,h,e,e,e/6,h,l?Math.round(f.pt2px(a.width)):0,!1,!1,l,1,p,0,0,1.96875,1,b,null);d.boundsType="circle"===k?"circle":"square";return d};return n}(G.default(H.default));v.default=u});