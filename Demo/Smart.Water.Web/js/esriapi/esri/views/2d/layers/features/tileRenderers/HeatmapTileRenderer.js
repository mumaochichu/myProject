// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/renderers/support/heatmapUtils":function(){define(["require","exports","../../core/global","../../core/mathUtils"],function(k,b,g,n){function l(a,c,f,h,e){a=new Uint32Array(a*a);c="buffer"in c?c:new Float64Array(c);f="buffer"in f?new Uint32Array(f.buffer):new Uint32Array((new Uint8Array(f)).buffer);e=f.length/(e-h);for(var m=0;m<c.length;m++)a[m]=f[n.clamp(Math.floor((c[m]-h)*e),0,f.length-1)];return a.buffer}function t(a){for(var c=Math.round(3*a),f=2*a*a,h=new Float64Array(2*
c+1),e=0;e<=h.length;e++)h[e]=Math.exp(-Math.pow(e-c,2)/f)/Math.sqrt(2*Math.PI)*(a/2);return h}function d(a,c){return"function"===typeof a?a:a?"string"===typeof c?function(c){return-1*+c[a]}:function(f){return+f[a]+c}:function(){return 1}}Object.defineProperty(b,"__esModule",{value:!0});b.generateGradient=function(){if(!("document"in g))return function(){return null};var a=document.createElement("canvas"),c=a.getContext("2d");a.height=512;a.width=1;return function(f){c.clearRect(0,0,1,a.height);var h=
c.createLinearGradient(0,0,0,a.height),e=0;for(f=f.colorStops;e<f.length;e++){var m=f[e],d=m.color;h.addColorStop(Math.max(m.ratio,.001),"rgba("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")")}c.fillStyle=h;c.fillRect(0,0,1,a.height);return c.getImageData(0,0,1,a.height).data}}();b.calculateHeatmapIntensityInfo=function(a,c,f,h){var e=c.blurRadius,m=c.fieldOffset,b=c.field;c=new Float64Array(f*h);for(var g=t(e),e=Math.round(3*e),l=Number.NEGATIVE_INFINITY,p,m=d(b,m),b=0;b<a.length;b++){var k=a[b],n=k.geometry,
u=n.x-e,v=n.y-e,w=Math.max(0,u);p=Math.max(0,v);for(var x=Math.min(h,n.y+e),n=Math.min(f,n.x+e),k=+m(k.attributes),q=p;q<x;q++)for(var y=g[q-v],r=w;r<n;r++)p=c[q*f+r]+=y*g[r-u]*k,p>l&&(l=p)}return{matrix:c.buffer,max:l}};b.drawHeatmap=function(a,c,f,d,e,m){a.canvas.width=a.canvas.height=c;a.clearRect(0,0,c,c);var h=a.getImageData(0,0,c,c);f&&d&&h.data.set(new Uint8ClampedArray(l(c,f,d,e,m)));a.putImageData(h,0,0)};b.createHeatmapImageData=l;b.createKernel=t;b.createValueFunction=d})},"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":function(){define(["require",
"exports","tslib","../../../../../core/HandleOwner","../../../../../core/accessorSupport/decorators"],function(k,b,g,n,l){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function d(a){a=b.call(this,a)||this;a.tiles=new Map;return a}g.__extends(d,b);d.prototype.destroy=function(){this.tiles.clear();this.layer=this.layerView=this.tileInfoView=this.tiles=null};Object.defineProperty(d.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0});d.prototype.acquireTile=
function(a){var c=this,d=this.createTile(a);d.once("isReady",function(){return c.notifyChange("updating")});this.tiles.set(a.id,d);return d};d.prototype.lockAttributeTextureUpload=function(){};d.prototype.unlockAttributeTextureUpload=function(){};d.prototype.forceAttributeTextureUpload=function(){};d.prototype.forEachTile=function(a){this.tiles.forEach(a)};d.prototype.releaseTile=function(a){this.tiles.delete(a.key.id);this.disposeTile(a)};d.prototype.isUpdating=function(){var a=!0;this.tiles.forEach(function(c){a=
a&&c.isReady});return!a};d.prototype.setHighlight=function(){};d.prototype.invalidateLabels=function(){};d.prototype.requestUpdate=function(){this.layerView.requestUpdate()};g.__decorate([l.property()],d.prototype,"layer",void 0);g.__decorate([l.property()],d.prototype,"layerView",void 0);g.__decorate([l.property()],d.prototype,"tileInfoView",void 0);g.__decorate([l.property()],d.prototype,"updating",null);return d=g.__decorate([l.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],
d)}(n.HandleOwner);b.default=k})},"esri/views/2d/layers/features/tileRenderers/support/HeatmapSource":function(){define(["require","exports","../../../../../../renderers/support/heatmapUtils"],function(k,b,g){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(){this.gradient=null;this.width=this.height=512}b.prototype.render=function(b){g.drawHeatmap(b,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)};return b}();b.HeatmapSource=k})},"*noref":1}});
define("require exports tslib ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../renderers/support/heatmapUtils ../../../engine/BitmapTileContainer ./BaseTileRenderer ./support/HeatmapSource".split(" "),function(k,b,g,n,l,t,d,a,c){Object.defineProperty(b,"__esModule",{value:!0});k=function(a){function b(e){var b=a.call(this,e)||this;b._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0};b.featuresView={attributeView:{initialize:function(){},requestUpdate:function(){}},
requestRender:function(){}};b._container=new d.BitmapTileContainer(e.tileInfoView);return b}g.__extends(b,a);b.prototype.createTile=function(a){var b=this._container.createTile(a);this.tileInfoView.getTileCoords(b.bitmap,a);b.bitmap.resolution=this.tileInfoView.getTileResolution(a);return b};b.prototype.onConfigUpdate=function(){var a=this,b=this.layer.renderer;if("heatmap"===b.type){var c=b.minPixelIntensity,d=b.maxPixelIntensity;this._intensityInfo.minPixelIntensity=c;this._intensityInfo.maxPixelIntensity=
d;this._gradient=t.generateGradient(b.toJSON());this.tiles.forEach(function(b){var e=b.bitmap.source;e&&(e.minPixelIntensity=c,e.maxPixelIntensity=d,e.gradient=a._gradient,b.bitmap.invalidateTexture())})}};b.prototype.hitTest=function(){return n.resolve([])};b.prototype.install=function(a){a.addChild(this._container)};b.prototype.uninstall=function(a){this._container.removeAllChildren();a.removeChild(this._container)};b.prototype.disposeTile=function(a){this._container.removeChild(a);a.destroy()};
b.prototype.supportsRenderer=function(a){return a&&"heatmap"===a.type};b.prototype.onTileData=function(a){var b=this.tiles.get(a.tileKey);if(b){a=a.intensityInfo;var d=this._intensityInfo,e=d.minPixelIntensity,d=d.maxPixelIntensity,f=b.bitmap.source||new c.HeatmapSource;f.intensities=a&&a.matrix||null;f.minPixelIntensity=e;f.maxPixelIntensity=d;f.gradient=this._gradient;b.bitmap.source=f;this._container.addChild(b);this.requestUpdate()}};b.prototype.onTileError=function(a){console.error(a)};return b=
g.__decorate([l.subclass("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],b)}(a.default);b.default=k});