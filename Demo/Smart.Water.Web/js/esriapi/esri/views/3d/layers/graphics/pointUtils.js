// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/coordsUtils ../../../../layers/graphics/dehydratedFeatures ./elevationAlignmentUtils ./elevationAlignmentUtils ./graphicUtils ../../support/projectionUtils ../../webgl-engine/lib/Object3D".split(" "),function(A,f,r,t,n,u,g,l,v,w,x,p,y){Object.defineProperty(f,"__esModule",{value:!0});var c=n.vec3f64.create();
f.createStageObjectForHUD=function(a,b,d,f,q,e,z,k,h,g,l){var n=d?d.length:0,m=a.clippingExtent;p.pointToVector(b,c,a.elevationProvider.spatialReference);if(r.isSome(m)&&!u.containsPoint(m,c))return null;p.pointToVector(b,c,a.renderCoordsHelper.spatialReference);m=a.localOriginFactory.getOrigin(c);k=new y({castShadow:!1,metadata:{layerUid:h,graphicUid:g,usesVerticalDistanceToGround:!0},idHint:k});for(h=0;h<n;h++)k.addGeometry(d[h],f[h],q?q[h]:t.mat4f64.IDENTITY,e,m,l);a=w.applyElevationAlignmentForHUD(k,
b,a.elevationProvider,a.renderCoordsHelper,z);return{object:k,sampledElevation:a}};f.extendPointGraphicElevationContext=function(a,b,d){a=a.elevationContext;d=d.spatialReference;p.pointToVector(b,c,d);a.centerPointInElevationSR=l.makeDehydratedPoint(c[0],c[1],b.hasZ?c[2]:0,d)};f.placePointOnGeometry=function(a){switch(a.type){case "point":return a;case "polygon":case "extent":return x.computeCentroid(a);case "polyline":var b=a.paths[0];if(!b||0===b.length)break;b=g.getPointOnPath(b,g.getPathLength(b)/
2);return l.makeDehydratedPoint(b[0],b[1],b[2],a.spatialReference);case "mesh":return a.extent.center}return null};f.geometryToRenderInfo=function(a,b,d,c,f){var e=new Float64Array(3*a.length),g=new Float64Array(e.length);a.forEach(function(a,b){e[3*b+0]=a[0];e[3*b+1]=a[1];e[3*b+2]=2<a.length?a[2]:0});b=v.applyPerVertexElevationAlignment(e,b,0,g,0,e,0,e.length/3,d,c,f);return{numVertices:a.length,position:e,mapPosition:g,projectionSuccess:null!=b,sampledElevation:b}}});