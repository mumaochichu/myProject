// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/data/FeatureStore":function(){define("require exports tslib ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),function(A,a,p,m,c,b,l,g,q,u,C,v,z,E){Object.defineProperty(a,"__esModule",{value:!0});
var F=b.getLogger("esri.layers.graphics.data.FeatureStore");A=function(){function a(a){this.geometryInfo=a;this._boundsStore=new v.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new c;this.featureAdapter=E.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var h=q.create(q.NEGATIVE_INFINITY);this._featuresById.forEach(function(d){if(d=a._boundsStore.get(d.objectId))h[0]=Math.min(d[0],
h[0]),h[1]=Math.min(d[1],h[1]),h[2]=Math.max(d[2],h[2]),h[3]=Math.max(d[3],h[3])});return h},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(h){h.geometry&&h.geometry.coords&&(a+=h.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=function(a){this._add(a);this._emitChanged()};a.prototype.addMany=
function(a){for(var h=0;h<a.length;h++)this._add(a[h]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var h=0;h<a.length;h++){var d=this._featuresById.get(a[h]);d&&this._remove(d)}this._emitChanged()};a.prototype.forEachBounds=
function(a,h,d){for(var b=0;b<a.length;b++){var c=this._boundsStore.get(a[b].objectId);c&&h(g.fromRect(d,c))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(h){return a(h)})};a.prototype.forEachInBounds=function(a,h){var d=this;this._boundsStore.forEachInBounds(a,function(a){h(d._featuresById.get(a))})};a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();
this._markedIds.clear()};a.prototype.sweep=function(){var a=this,h=!1;this._featuresById.forEach(function(d,b){a._markedIds.has(b)||(h=!0,a._remove(d))});this._markedIds.clear();h&&this._emitChanged()};a.prototype.executeTileQuery=function(a,h,d){return p.__awaiter(this,void 0,void 0,function(){var b,c,g,k,r,l,E,m,F,L,x,J,Z,U;return p.__generator(this,function(n){b=d.returnGeometry;c=d.returnCentroid;g=d.returnOutline;k=d.pixelBuffer;r=new Set;l=[];E=k*a.resolution;m=q.pad(a.bounds,E,q.create());
z.createTileFeatures(l,r,this.geometryInfo,this,m,b,c,g,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||c)if(F=u.getInfo(h))L=F.valid,x=L[0],J=L[1],m[0]<x&&(Z=q.fromValues(J-E,m[1],J,m[3]),z.createTileFeatures(l,r,this.geometryInfo,this,Z,b,c,g,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[J,a.bounds[3]]})),m[2]>J&&(U=q.fromValues(x,m[1],x+E,m[3]),z.createTileFeatures(l,r,this.geometryInfo,
this,U,b,c,g,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[x-J+a.bounds[0],a.bounds[3]]}));l.sort(function(a,x){return a.localId-x.localId});return[2,{features:l,objectIds:r}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var b=a.objectId;if(null==b)F.error(new m("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var d=this._featuresById.get(b),c;this._markedIds.add(b);if(d)a.localId=
d.localId,c=this._boundsStore.get(b),this._boundsStore.delete(b);else if(l.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(c=C.getBoundsOptimizedGeometry(c||q.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(b,c)):this._boundsStore.set(b,null);this._featuresById.set(b,a)}}};a.prototype._remove=function(a){if(l.isSome(this.onFeatureRemove))this.onFeatureRemove(a);this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);
this._featuresById.delete(a.objectId);return a};return a}();a.default=A})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(A,a,p,m){Object.defineProperty(a,"__esModule",{value:!0});var c={minX:0,minY:0,maxX:0,maxY:0};A=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=m(9,p("csp-restrictions")?
function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,g){b[c++]=g});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();
this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,b){this._loadIndex();var g=0,l=this._index;c.minX=a[0];c.minY=a[1];c.maxX=a[2];c.maxY=a[3];for(a=l.search(c);g<a.length;g++)b(this._idByBounds.get(a[g]))};a.prototype.get=function(a){return this._boundsById.get(a)};a.prototype.has=function(a){return this._boundsById.has(a)};
a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||(this._boundsToLoad.push(b),5E4<this._boundsToLoad.length&&this._loadIndex()))};return a}();a.BoundsStore=A})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(A){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function p(a,b){m(a,0,a.children.length,b,a)}function m(a,b,g,l,h){h||(h=v(null));h.minX=Infinity;h.minY=Infinity;h.maxX=-Infinity;h.maxY=-Infinity;for(var d;b<g;b++)d=a.children[b],c(h,a.leaf?l(d):d);return h}function c(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function b(a,b){return a.minX-b.minX}function l(a,b){return a.minY-b.minY}function g(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function q(a){return a.maxX-a.minX+(a.maxY-a.minY)}function u(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function C(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function v(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function z(a,b,c,g,h){for(var d=[b,c],n;d.length;)c=d.pop(),b=d.pop(),c-b<=g||(n=b+Math.ceil((c-b)/g/2)*g,A(a,n,b,c,h),d.push(b,n,n,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],g=this.toBBox;if(!C(a,b))return c;for(var h=[],d,n,t,B;b;){d=0;for(n=b.children.length;d<n;d++)t=b.children[d],B=b.leaf?g(t):t,C(a,B)&&(b.leaf?c.push(t):u(a,B)?this._all(t,c):h.push(t));b=h.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!C(a,b))return!1;for(var g=[],h,d,n,t;b;){h=0;for(d=b.children.length;h<d;h++)if(n=b.children[h],t=b.leaf?c(n):n,C(a,t)){if(b.leaf||u(a,t))return!0;g.push(n)}b=g.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=v([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,g=this.toBBox(a),h=[],d=[],n,t,B,k;c||h.length;){c||(c=h.pop(),t=h[h.length-1],n=d.pop(),k=!0);if(c.leaf){a:{B=a;var r=c.children,l=b;if(l){for(var q=0;q<r.length;q++)if(l(B,r[q])){B=q;break a}B=-1}else B=r.indexOf(B)}if(-1!==B){c.children.splice(B,
1);h.push(c);this._condense(h);break}}k||c.leaf||!u(c,g)?t?(n++,c=t.children[n],k=!1):c=null:(h.push(c),d.push(n),n=0,t=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:b,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,g){var h=c-b+1,d=this._maxEntries,n;if(h<=d)return n=v(a.slice(b,c+1)),p(n,
this.toBBox),n;g||(g=Math.ceil(Math.log(h)/Math.log(d)),d=Math.ceil(h/Math.pow(d,g-1)));n=v([]);n.leaf=!1;n.height=g;var h=Math.ceil(h/d),d=h*Math.ceil(Math.sqrt(d)),t,B,k;for(z(a,b,c,d,this.compareMinX);b<=c;b+=d)for(B=Math.min(b+d-1,c),z(a,b,B,h,this.compareMinY),t=b;t<=B;t+=h)k=Math.min(t+h-1,B),n.children.push(this._build(a,t,k,g-1));p(n,this.toBBox);return n},_chooseSubtree:function(a,b,c,l){for(var h,d,n,t,B,k,r,q;;){l.push(b);if(b.leaf||l.length-1===c)break;r=q=Infinity;h=0;for(d=b.children.length;h<
d;h++)n=b.children[h],B=g(n),k=(Math.max(n.maxX,a.maxX)-Math.min(n.minX,a.minX))*(Math.max(n.maxY,a.maxY)-Math.min(n.minY,a.minY))-B,k<q?(q=k,r=B<r?B:r,t=n):k===q&&B<r&&(r=B,t=n);b=t||b.children[0]}return b},_insert:function(a,b,g){var l=this.toBBox;g=g?a:l(a);var l=[],h=this._chooseSubtree(g,this.data,b,l);h.children.push(a);for(c(h,g);0<=b;)if(l[b].children.length>this._maxEntries)this._split(l,b),b--;else break;this._adjustParentBBoxes(g,l,b)},_split:function(a,b){var c=a[b],g=c.children.length,
h=this._minEntries;this._chooseSplitAxis(c,h,g);g=this._chooseSplitIndex(c,h,g);g=v(c.children.splice(g,c.children.length-g));g.height=c.height;g.leaf=c.leaf;p(c,this.toBBox);p(g,this.toBBox);b?a[b-1].children.push(g):this._splitRoot(c,g)},_splitRoot:function(a,b){this.data=v([a,b]);this.data.height=a.height+1;this.data.leaf=!1;p(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var l,h,d,n,t,B,k;t=B=Infinity;for(l=b;l<=c-b;l++)h=m(a,0,l,this.toBBox),d=m(a,l,c,this.toBBox),n=Math.max(0,Math.min(h.maxX,
d.maxX)-Math.max(h.minX,d.minX))*Math.max(0,Math.min(h.maxY,d.maxY)-Math.max(h.minY,d.minY)),h=g(h)+g(d),n<t?(t=n,k=l,B=h<B?h:B):n===t&&h<B&&(B=h,k=l);return k},_chooseSplitAxis:function(a,c,g){var q=a.leaf?this.compareMinX:b,h=a.leaf?this.compareMinY:l,d=this._allDistMargin(a,c,g,q);c=this._allDistMargin(a,c,g,h);d<c&&a.children.sort(q)},_allDistMargin:function(a,b,g,l){a.children.sort(l);l=this.toBBox;var h=m(a,0,b,l),d=m(a,g-b,g,l),n=q(h)+q(d),t,B;for(t=b;t<g-b;t++)B=a.children[t],c(h,a.leaf?l(B):
B),n+=q(h);for(t=g-b-1;t>=b;t--)B=a.children[t],c(d,a.leaf?l(B):B),n+=q(d);return n},_adjustParentBBoxes:function(a,b,g){for(;0<=g;g--)c(b[g],a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():p(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function A(m,c,b,l,g){for(;l>b;){if(600<l-b){var q=l-b+1,u=c-b+1,C=Math.log(q),v=.5*Math.exp(2*C/3),C=.5*Math.sqrt(C*v*(q-v)/q)*(0>u-q/2?-1:1);A(m,c,Math.max(b,Math.floor(c-u*v/q+C)),Math.min(l,Math.floor(c+(q-u)*v/q+C)),g)}q=m[c];u=b;v=l;a(m,b,c);for(0<g(m[l],q)&&a(m,b,l);u<v;){a(m,u,v);u++;for(v--;0>g(m[u],q);)u++;for(;0<g(m[v],q);)v--}0===g(m[b],q)?
a(m,b,v):(v++,a(m,v,l));v<=c&&(b=v+1);c<=v&&(l=v-1)}}function a(a,c,b){var l=a[c];a[c]=a[b];a[b]=l}function p(a,c){return a<c?-1:a>c?1:0}return function(a,c,b,l,g){A(a,c,b||0,l||a.length-1,g||p)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),function(A,a,p,m,c,b,l){function g(a,b,c,g,l,q){a.lengths.length&&(a.lengths.length=0);a.coords.length&&
(a.coords.length=0);if(!b||!b.coords.length)return null;var h=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=m.quantizeX(q,h[0]),a.coords[1]=m.quantizeY(q,h[1]),a.coords.length=c,a;for(var d,n,t,B,k=0,r,u=0,T=0;T<b.length;T++){var v=b[T];if(!(v<g))if(r=u,t=d=m.quantizeX(q,h[k]),B=n=m.quantizeY(q,h[k+1]),a.coords[r]=t,a.coords[r+1]=B,k+=c,1===v)a.lengths.push(1),u=r+2;else{t=m.quantizeX(q,h[k]);B=m.quantizeY(q,h[k+1]);var C=t-d,L=B-n,x=L/C;r+=2;a.coords[r]=C;a.coords[r+1]=L;d=t;n=B;for(var k=
k+c,J=2;J<v;J++){t=m.quantizeX(q,h[k]);B=m.quantizeY(q,h[k+1]);if(t!==d||B!==n){d=t-d;n=B-n;var Z=n/d,x=x===Z||!isFinite(x)&&!isFinite(Z),U=(0<=L&&0<=n||0>=L&&0>=n)&&(0<=C&&0<=d||0>=C&&0>=d);x&&(l||U)?(C+=d,L+=n):(C=d,L=n,r+=2);a.coords[r]=C;a.coords[r+1]=L;x=Z;d=t;n=B}k+=c}t=(r+2-u)/2;t>=g&&(a.lengths.push(t),u=r+2)}}a.coords.length>u&&(a.coords.length=u);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});var q=new c.default,u={esriGeometryPoint:m.convertToPoint,esriGeometryPolyline:m.convertToPolyline,
esriGeometryPolygon:m.convertToPolygon,esriGeometryMultipoint:m.convertToMultipoint};a.executeTileQueryForIds=function(a,b,c){b=p.pad(b.bounds,c.pixelBuffer*b.resolution,p.create());var g=[];a.featureStore.forEachInBounds(b,function(b){return g.push(a.featureAdapter.getObjectId(b))});return g};a.createTileFeatures=function(a,c,m,p,A,D,h,d,n){var t=u[m.geometryType],B=C[m.geometryType],k="esriGeometryPolygon"===m.geometryType&&!d,r=m.hasZ?m.hasM?4:3:m.hasM?3:2;h&&!D?p.forEachInBounds(A,function(d){if(!c.has(d.objectId)){var g=
l.getCentroid(m,d,n),h=d.attributes;g&&(c.add(d.objectId),a.push(new b.Feature(h,d.localId,null,g)))}}):D&&!h?p.forEachInBounds(A,function(d){if(!c.has(d.objectId)){var h=d.attributes,l=t(g(q,d.geometry,r,B,k,n),!1,!1);l&&(c.add(d.objectId),a.push(new b.Feature(h,d.localId,l,null)))}}):p.forEachInBounds(A,function(d){if(!c.has(d.objectId)){var h=l.getCentroid(m,d,n),u=d.attributes,S=t(g(q,d.geometry,r,B,k,n),!1,!1);S&&h&&(c.add(d.objectId),a.push(new b.Feature(u,d.localId,S,h)))}})};var C={esriGeometryPoint:0,
esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=g})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports tslib ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(A,a,p,m,c,b,l,g,q,u,C,v,z,E,F,G,D,h,d,n,t,B,k,r){function S(a){return a.every(function(a){return"exceedslimit"!==a.statisticType})}Object.defineProperty(a,"__esModule",{value:!0});A=function(){return function(a,b,c,d,x){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=d;this.filterFlags=x;this.groupId=-1;this.localId=b}}();a.Feature=A;var T=new Set,pa=new l.MemCacheStorage(2E6),La=0;A=function(){function a(a){var b=this;this.capabilities={query:h.queryCapabilities};this.geometryType=
a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new l.MemCache(La++ +"$$",pa));this.fieldsIndex=new k(a.fields);a.scheduler&&a.task&&(this._frameQueue=new r.default,this._frameTask=
a.scheduler.registerTask(a.task,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=t.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});
a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,x,g,h=this;return p.__generator(this,function(k){switch(k.label){case 0:b=c.clone(a),k.label=1;case 1:return k.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,h.definitionExpression,h.spatialReference)})];case 2:return b=k.sent(),
[4,this._reschedule(function(){return h._checkQuerySupport(b)})];case 3:return b=k.sent(),[4,this._reschedule(function(){return h._executeGeometryQuery(b)})];case 4:return x=k.sent(),[4,this._reschedule(function(){return x.executeObjectIdsQuery(b)})];case 5:return x=k.sent(),[4,this._reschedule(function(){return x.executeTimeQuery(b)})];case 6:return x=k.sent(),[4,this._reschedule(function(){return x.executeAttributesQuery(b)})];case 7:return x=k.sent(),[3,9];case 8:g=k.sent();if(g!==B.QUERY_ENGINE_EMPTY_RESULT)throw g;
x=new d.default([],null,this);return[3,9];case 9:return[2,x.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,x,d,g=this;return p.__generator(this,function(h){switch(h.label){case 0:b=c.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,h.label=1;case 1:return h.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,g.definitionExpression,g.spatialReference)})];case 2:return b=
h.sent(),[4,this._reschedule(function(){return g._checkQuerySupport(b)})];case 3:return b=h.sent(),[4,this._reschedule(function(){return g._executeGeometryQuery(b)})];case 4:return x=h.sent(),[4,this._reschedule(function(){return x.executeObjectIdsQuery(b)})];case 5:return x=h.sent(),[4,this._reschedule(function(){return x.executeTimeQuery(b)})];case 6:return x=h.sent(),[4,this._reschedule(function(){return x.executeAttributesQuery(b)})];case 7:return x=h.sent(),[2,x.size];case 8:d=h.sent();if(d!==
B.QUERY_ENGINE_EMPTY_RESULT)throw d;return[2,0];case 9:return[2]}})})};a.prototype.executeQueryForExtent=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,d,h,g,k,n,t,r,l=this;return p.__generator(this,function(J){switch(J.label){case 0:b=c.clone(a),h=b.outSR,J.label=1;case 1:return J.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,l.definitionExpression,l.spatialReference)})];case 2:return b=J.sent(),[4,this._reschedule(function(){return l._checkQuerySupport(b)})];
case 3:return b=J.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return l._executeGeometryQuery(b)})];case 4:return d=J.sent(),[4,this._reschedule(function(){return d.executeObjectIdsQuery(b)})];case 5:return d=J.sent(),[4,this._reschedule(function(){return d.executeTimeQuery(b)})];case 6:return d=J.sent(),[4,this._reschedule(function(){return d.executeAttributesQuery(b)})];case 7:d=J.sent();g=d.size;if(!g)return[2,{count:g,extent:null}];C.set(x,C.NEGATIVE_INFINITY);
this.featureStore.forEachBounds(d.items,function(a){return C.expand(x,a)},L);k={xmin:x[0],ymin:x[1],xmax:x[3],ymax:x[4],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(x[2])&&isFinite(x[5])&&(k.zmin=x[2],k.zmax=x[5]);n=D.project(k,d.spatialReference,h);n.spatialReference=B.cleanFromGeometryEngine(h||this.spatialReference);0===n.xmax-n.xmin&&(t=u.getMetersPerUnitForSR(n.spatialReference),n.xmin-=t,n.xmax+=t);0===n.ymax-n.ymin&&(t=u.getMetersPerUnitForSR(n.spatialReference),
n.ymin-=t,n.ymax+=t);this.hasZ&&null!=n.zmin&&null!=n.zmax&&0===n.zmax-n.zmin&&(t=u.getMetersPerUnitForSR(n.spatialReference),n.zmin-=t,n.zmax+=t);return[2,{count:g,extent:n}];case 8:r=J.sent();if(r===B.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw r;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,this.executeQueryForIdSet(a,b).then(function(a){return q.valuesOfSet(a)})]})})};
a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,x,d,h,g,n=this;return p.__generator(this,function(k){switch(k.label){case 0:b=c.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,k.label=1;case 1:return k.trys.push([1,9,,10]),[4,this._schedule(function(){return B.normalizeQuery(b,n.definitionExpression,n.spatialReference)})];case 2:return b=k.sent(),[4,this._reschedule(function(){return n._checkQuerySupport(b)})];
case 3:return b=k.sent(),[4,this._reschedule(function(){return n._executeGeometryQuery(b)})];case 4:return x=k.sent(),[4,this._reschedule(function(){return x.executeObjectIdsQuery(b)})];case 5:return x=k.sent(),[4,this._reschedule(function(){return x.executeTimeQuery(b)})];case 6:return x=k.sent(),[4,this._reschedule(function(){return x.executeAttributesQuery(b)})];case 7:return x=k.sent(),d=x.items,h=new Set,[4,this._reschedule(function(){for(var a=0,b=d;a<b.length;a++)h.add(x.featureAdapter.getObjectId(b[a]))})];
case 8:return k.sent(),[2,h];case 9:g=k.sent();if(g===B.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw g;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,x,h,g=this;return p.__generator(this,function(k){switch(k.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new m("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});
b=c.clone(a);k.label=1;case 1:return k.trys.push([1,9,,10]),[4,this._schedule(function(){return B.normalizeQuery(b,g.definitionExpression,g.spatialReference)})];case 2:return b=k.sent(),[4,this._reschedule(function(){return g._checkQuerySupport(b)})];case 3:return b=k.sent(),[4,this._reschedule(function(){return g._executeGeometryQuery(b)})];case 4:return x=k.sent(),[4,this._reschedule(function(){return x.executeObjectIdsQuery(b)})];case 5:return x=k.sent(),[4,this._reschedule(function(){return x.executeTimeQuery(b)})];
case 6:return x=k.sent(),[4,this._reschedule(function(){return x.executeAttributesQuery(b)})];case 7:return x=k.sent(),[4,this._reschedule(function(){return x.filterLatest()})];case 8:return x=k.sent(),[3,10];case 9:h=k.sent();if(h!==B.QUERY_ENGINE_EMPTY_RESULT)throw h;x=new d.default([],null,this);return[3,10];case 10:return[2,x.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(b){return this._frameQueue?
[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=
new d.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return p.__awaiter(this,void 0,void 0,function(){var x,c,g,h,k,t,r,l,B,J,q,T,u,m,Z,L,S,C,v,z,pa=this;return p.__generator(this,function(U){switch(U.label){case 0:x=a.geometry;c=a.outSR;g=a.spatialRel;h=F.isValid(c)&&!F.equals(this.spatialReference,c);if(k=this._geometryQueryCache?h?JSON.stringify({geometry:x,spatialRelationship:g,outSpatialReference:c}):JSON.stringify({geometry:x,spatialRelationship:g}):
null)if(t=this._geometryQueryCache.get(k),!b.isUndefined(t))return[2,t];r=function(b){return p.__awaiter(pa,void 0,void 0,function(){var x;return p.__generator(this,function(d){switch(d.label){case 0:return h&&(a.returnGeometry||a.returnCentroid)?[4,b.project(c)]:[3,2];case 1:return x=d.sent(),k&&this._geometryQueryCache.put(k,x,x.size||1),[2,x];case 2:return k&&this._geometryQueryCache.put(k,b,b.size||1),[2,b]}})})};if(!x)return[2,r(this._getAll())];l=this.featureAdapter;if("esriSpatialRelDisjoint"!==
g)return[3,3];B=this._searchFeatures(this._getQueryBBoxes(x));if(!B.length)return[2,r(this._getAll())];T=new Set;u=0;for(m=B;u<m.length;u++)Z=m[u],T.add(l.getObjectId(Z));return[4,this._reschedule(function(){var a=0;J=Array(T.size);pa.featureStore.forEach(function(b){return J[a++]=b});q=T})];case 1:return U.sent(),[4,this._reschedule(function(){return p.__awaiter(pa,void 0,void 0,function(){var a,b,c;return p.__generator(this,function(h){switch(h.label){case 0:return[4,n.getSpatialQueryOperator(g,
x,this.geometryType,this.hasZ,this.hasM)];case 1:return a=h.sent(),b=function(b){return!q.has(l.getObjectId(b))||a(l.getGeometry(b))},c=d.default.bind,[4,this._runSpatialFilter(J,b)];case 2:return[2,new (c.apply(d.default,[void 0,h.sent(),x,this]))]}})})})];case 2:return L=U.sent(),[2,r(L)];case 3:return S=this._searchFeatures(this._getQueryBBoxes(x)),S.length?(C=this._canExecuteSoloPass(x,a))?[2,r(new d.default(S,x,this))]:[4,n.getSpatialQueryOperator(g,x,this.geometryType,this.hasZ,this.hasM)]:
(L=new d.default([],x,this),k&&this._geometryQueryCache.put(k,L,L.size||1),[2,L]);case 4:return v=U.sent(),[4,this._runSpatialFilter(S,function(a){return v(l.getGeometry(a))})];case 5:return z=U.sent(),[2,r(new d.default(z,x,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return p.__awaiter(this,void 0,void 0,function(){var x,c,d,h=this;return p.__generator(this,function(g){if(!b)return[2,a];if(!this._budget)return[2,a.filter(function(a){return b(a)})];x=0;c=[];d=function(){return p.__awaiter(h,
void 0,void 0,function(){var h;return p.__generator(this,function(g){switch(g.label){case 0:if(!(x<a.length))return[3,3];h=a[x];b(h)&&c.push(h);return this._budget.done?[4,this._reschedule(function(){return d()})]:[3,2];case 1:g.sent(),g.label=2;case 2:return++x,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return d()}).then(function(){return c})]})})};a.prototype._canExecuteSoloPass=function(a,b){var x=this.geometryType;b=b.spatialRel;return n.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===
b||"esriGeometryPoint"===x&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(n.canQueryWithRBush(a)){if(E.isExtent(a))return[v.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(E.isPolygon(a))return a.rings.map(function(a){return v.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[z.getBoundsXY(v.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=
0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){T.add(a)});var x=Array(T.size),c=0;T.forEach(function(a){return x[c++]=a});T.clear();return x};a.prototype._checkQuerySupport=function(a){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new m("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,g.all([this._checkAttributesQuerySupport(a),
this._checkStatisticsQuerySupport(a),n.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),D.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,x=a.orderByFields,c=a.returnDistinctValues,d=a.outStatistics,h=d?d.map(function(a){return a.outStatisticFieldName&&a.outStatisticFieldName.toLowerCase()}):[];x&&0<x.length&&(x=x.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?
b.split(" asc")[0]:-1<b.indexOf(" desc")?b.split(" desc")[0]:a}).filter(function(a){return-1===h.indexOf(a)}),G.validateFields(this.fieldsIndex,x,"orderByFields contains missing fields"));if(b&&0<b.length)G.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(c)throw new m("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});G.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return p.__awaiter(this,
void 0,void 0,function(){var b,x,c,d,h,g,k,n,t,r,l,B,J;return p.__generator(this,function(q){b=a.outStatistics;x=a.groupByFieldsForStatistics;c=a.having;d=x&&x.length;h=b&&b.length;if(c){if(!d||!h)throw new m("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});G.validateHaving(this.fieldsIndex,c,b)}if(h){if(!S(b))return[2];g=b.map(function(a){return a.onStatisticField});G.validateFields(this.fieldsIndex,g,"onStatisticFields contains missing fields");
d&&G.validateFields(this.fieldsIndex,x,"groupByFieldsForStatistics contains missing fields");k=0;for(n=b;k<n.length;k++)if(t=n[k],r=t.onStatisticField,l=t.statisticType,(B="percentile_disc"===l||"percentile_cont"===l)&&"statisticParameters"in t){if(J=t.statisticParameters,!J)throw new m("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:t,query:a});}else if("count"!==l&&r&&G.hasInvalidFieldType(r,this.fieldsIndex))throw new m("feature-store:unsupported-query",
"outStatistics contains non-numeric fields",{definition:t,query:a});}return[2]})})};return a}();a.default=A;var L=C.create(),x=C.create()})},"esri/layers/graphics/data/attributeSupport":function(){define(["require","exports","../../../core/Error","../../../core/SetUtils","../../../core/sql/WhereClauseCache"],function(A,a,p,m,c){function b(a,b){return a?q.get(a,b):null}function l(a,c,q,u){void 0===u&&(u=!0);for(var m=[],C=0;C<c.length;C++){var v=c[C];if("*"!==v&&!a.has(v))if(u){var h=g(v);try{var d=
b(h,a);if(!d)throw new p("feature-store:unsupported-query","invalid SQL expression",{where:h});if(!d.isStandardized)throw new p("feature-store:unsupported-query","expression is not standard",{clause:d});l(a,d.fieldNames,"expression contains missing fields")}catch(n){if((h=n&&n.details)&&(h.clause||h.where))throw n;h&&h.missingFields?m.push.apply(m,h.missingFields):m.push(v)}}else m.push(v)}if(m.length)throw new p("feature-store:unsupported-query",q,{missingFields:m});}function g(a){return a.split(" as ")[0]}
Object.defineProperty(a,"__esModule",{value:!0});var q=new c.WhereClauseCache(50,500),u=m.SetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;var c=q.get(b,a);if(!c)throw new p("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new p("feature-store:unsupported-query","where clause is not standard",
{where:b});l(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var g=q.get(b,a);if(!g)throw new p("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!g.isAggregate)throw new p("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:b});l(a,g.fieldNames,"having contains missing fields");if(!g.getExpressions().every(function(b){var g=b.aggregateType;b=b.field;var l=a.has(b)&&
a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===l&&b.toLowerCase().trim()===g})}))throw new p("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=b;a.validateFields=l;a.getExpressionFromFieldName=g;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!u.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require",
"exports","../ItemCache","./WhereClause"],function(A,a,p,m){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(a,c){this._cache=new p(a);this._invalidCache=new p(c)}a.prototype.get=function(a,c){var b=c.uid+":"+a,l=this._cache.get(b);if(l)return l;if(void 0!==this._invalidCache.get(b))return null;try{var u=m.WhereClause.create(a,c);this._cache.put(b,u);return u}catch(C){return this._invalidCache.put(b,null),null}};return a}();a.WhereClauseCache=A})},"esri/core/ItemCache":function(){define(["require",
"exports","./MemCache"],function(A,a,p){return function(){function a(a,b){this._storage=new p.MemCacheStorage;this._storage.maxSize=a;b&&this._storage.registerRemoveFunc("",b)}a.prototype.put=function(a,b){this._storage.put(a,b,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(A,a,p,m,c,b,l){function g(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function q(a,b,c,d,h,k,n,t,r){void 0===c&&(c="0");void 0===d&&(d="0");void 0===h&&(h="0");void 0===k&&(k="0");void 0===n&&(n="");void 0===t&&(t="0");void 0===r&&(r="0");return"+"===n||"-"===n?(a=g(parseInt(a,10),4)+"-"+g(parseInt(b,10),2)+"-"+g(parseInt(c,10),2),b="",10>parseFloat(k)&&(b="0"),d=g(parseInt(d,10),2)+":"+g(parseInt(h,10),2)+":"+(b+parseFloat(k).toString()),n=""+n+g(parseInt(t,10),2)+":"+
g(parseInt(r,10),2),new Date(a+"T"+d+n)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(c,10),parseInt(d,10),parseInt(h,10),parseFloat(k))}function u(a){var b=r.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],h=b[4],g=b[5],n=b[6];return q(a,c,d,h,g,n)}b=S.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],h=b[4],g=b[5],n=b[6],t=b[7],l=b[8],b=b[9];return q(a,c,d,h,g,n,t,l,b)}b=T.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],h=b[4],g=b[5],t=b[6],l=b[7],b=b[8],q(a,c,d,h,g,"0",t,l,b);b=pa.exec(a);if(null!==
b)return a=b[1],c=b[2],d=b[3],h=b[4],g=b[5],q(a,c,d,h,g);b=k.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],q(a,c,d);throw Error("SQL Invalid Timestamp");}function C(a){a=k.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,10))}function v(a){return Array.isArray(a)?a:[a]}function z(a){return null!==a?!0!==a:null}function E(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function F(a,b){return null!=
a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function G(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var x=b[d];if(null==x)c=null;else if(a===x){c=!0;break}}return c}function D(a,b,c){if(null==a)return null;for(var d="",x=0,h=0;h<b.length;h++){var g=b.charAt(h);switch(x){case 0:g===c?x=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):"%"===g?d+".*":"_"===g?d+".":d+g;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):d+g,x=0}}return(new RegExp("^"+d+"$")).test(a)}function h(a){return a instanceof
Date?a.valueOf():a}function d(a,b,c){if(null==b||null==c)return null;b=h(b);c=h(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function n(a){for(var b=[],c={},d=0;d<a.length;d++){var g=a[d],h=g.toLowerCase();void 0===c[h]&&(b.push(g),c[h]=1)}return b}function t(a,c,d){if(c instanceof b.SqlInterval)if(d instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+
d.getTime());case "-":return c.valueInMilliseconds()-d.getTime();case "*":return c.valueInMilliseconds()*d.getTime();case "/":return c.valueInMilliseconds()/d.getTime()}else if(d instanceof b.SqlInterval)switch(a){case "+":return b.SqlInterval.createFromMilliseconds(c.valueInMilliseconds()+d.valueInMilliseconds());case "-":return b.SqlInterval.createFromMilliseconds(c.valueInMilliseconds()-d.valueInMilliseconds());case "*":return c.valueInMilliseconds()*d.valueInMilliseconds();case "/":return c.valueInMilliseconds()/
d.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(d instanceof b.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(d.valueInMilliseconds()+c.getTime());case "-":return new Date(c.getTime()-d.valueInMilliseconds());case "*":return c.getTime()*d.valueInMilliseconds();case "/":return c.getTime()/d.valueInMilliseconds()}else d=d.valueInMilliseconds();else if(c instanceof Date&&"number"===typeof d)switch(d*=864E5,c=c.getTime(),a){case "+":return new Date(c+d);case "-":return new Date(c-
d);case "*":return new Date(c*d);case "/":return new Date(c/d)}else if(d instanceof Date&&"number"===typeof c)switch(c*=864E5,d=d.getTime(),a){case "+":return new Date(c+d);case "-":return new Date(c-d);case "*":return new Date(c*d);case "/":return new Date(c/d)}switch(a){case "+":return c+d;case "-":return c-d;case "*":return c*d;case "/":return c/d}}function B(a,b,c,d){a=d.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var k=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,
r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,S=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,T=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,pa=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,La=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,d){return B(a,b,c,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return D(a,
b,c)};a.ensureArray=function(a){return v(a)};a.applyIn=function(a,b){return G(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=function(a,c,d){return b.SqlInterval.createFromValueAndQualifer(a,c,d)};a.convertInterval=function(a){return a instanceof b.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return d(a,b,c)};a.calculate=function(a,b,c){return t(a,b,c)};a.makeComparable=function(a){return h(a)};
a.evaluateFunction=function(a,c){return b.evaluateFunction(a,c)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return z(a)};a.ternaryAnd=function(a,b){return E(a,b)};a.ternaryOr=function(a,b){return F(a,b)};return a}();A=function(){function g(a,b){this.fieldsIndex=b;this.datefields={};this.parameters=
{};this.parseTree=l.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;this.isStandardized=b;this.isAggregate=c}g.create=function(a,b){return new g(a,b)};Object.defineProperty(g.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});g.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var d={},g=function(a){d[a]=b.map(function(b){return c.getAttribute(b,
a)})},h=0,k=this.fieldNames;h<k.length;h++)g(k[h]);return!!this.evaluateNode(this.parseTree,{attributes:d},a.defaultAttributeAdapter)};g.prototype.calculateValue=function(c,d){void 0===d&&(d=a.defaultAttributeAdapter);c=this.evaluateNode(this.parseTree,c,d);return c instanceof b.SqlInterval?c.valueInMilliseconds()/864E5:c};g.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,
c,this.datefields);if(p("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};g.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,c)};g.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);
if(p("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};g.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return n(a)};g.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var d=
c+"-"+b;a.has(d)||a.set(d,{aggregateType:c,field:b})}}});return m.valuesOfMap(a)};g.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return n(a)};g.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(La)};g.prototype.extractExpressionInfo=function(a){var d=
this,g=[],h=!0,k=!0;this.visitAll(this.parseTree,function(n){switch(n.type){case "column_ref":var t=a.get(n.column),r=t&&t.name;!t||"date"!==t.type&&"esriFieldTypeDate"!==t.type||(d.datefields[t.name]=1);void 0!==r?(g.push(r),n.column=r):g.push(n.column);break;case "function":t=n.name,n=n.args.value.length,h&&(h=b.isStandardized(t,n)),k&&(k=c.isAggregate(t,n))}});return{referencedFieldNames:n(g),isStandardized:h,isAggregate:k}};g.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,
b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var g=d[c];this.visitAll(g,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)g=a[c],this.visitAll(g,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};g.prototype.evaluateNodeToJavaScript=
function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var c="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",d=0;d<a.clauses.length;d++)b+=" ("+c+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";
else for(b="( ",d=0;d<a.clauses.length;d++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";c=0;for(a=a.value;c<a.length;c++)d=a[c],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(d);return b+"]";case "unary_expr":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+
JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+C(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+
u(a.value).getTime().toString()+"))";case "current_time":return"date"===a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};g.prototype.evaluateNode=function(a,g,k){switch(a.type){case "interval":return g=this.evaluateNode(a.value,
g,k),b.SqlInterval.createFromValueAndQualifer(g,a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var n=h(this.evaluateNode(a.operand,g,k)),r=0;r<a.clauses.length;r++){if(n===h(this.evaluateNode(a.clauses[r].operand,g,k)))return this.evaluateNode(a.clauses[r].value,g,k)}else for(r=0;r<a.clauses.length;r++)if(!0===this.evaluateNode(a.clauses[r].operand,g,k))return this.evaluateNode(a.clauses[r].value,g,k);return null!==a.else?this.evaluateNode(a.else,g,k):null;case "param":return this.parameters[a.value.toLowerCase()];
case "expr_list":n=[];r=0;for(a=a.value;r<a.length;r++)n.push(this.evaluateNode(a[r],g,k));return n;case "unary_expr":return z(this.evaluateNode(a.expr,g,k));case "binary_expr":switch(a.operator){case "AND":return E(this.evaluateNode(a.left,g,k),this.evaluateNode(a.right,g,k));case "OR":return F(this.evaluateNode(a.left,g,k),this.evaluateNode(a.right,g,k));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,g,k);case "ISNOT":if("null"!==
a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,g,k);case "IN":return n=v(this.evaluateNode(a.right,g,k)),G(this.evaluateNode(a.left,g,k),n);case "NOT IN":return n=v(this.evaluateNode(a.right,g,k)),z(G(this.evaluateNode(a.left,g,k),n));case "BETWEEN":return n=this.evaluateNode(a.left,g,k),a=this.evaluateNode(a.right,g,k),null==n||null==a[0]||null==a[1]?null:n>=h(a[0])&&n<=h(a[1]);case "NOTBETWEEN":return n=this.evaluateNode(a.left,g,k),a=this.evaluateNode(a.right,
g,k),null==n||null==a[0]||null==a[1]?null:n<h(a[0])||n>h(a[1]);case "LIKE":return D(this.evaluateNode(a.left,g,k),this.evaluateNode(a.right,g,k),a.escape);case "NOT LIKE":return z(D(this.evaluateNode(a.left,g,k),this.evaluateNode(a.right,g,k),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return d(a.operator,this.evaluateNode(a.left,g,k),this.evaluateNode(a.right,g,k));case "-":case "+":case "*":case "/":return t(a.operator,this.evaluateNode(a.left,
g,k),this.evaluateNode(a.right,g,k))}case "null":case "bool":case "string":case "number":return a.value;case "date":return C(a.value);case "timestamp":return u(a.value);case "current_time":return g=new Date,"date"===a.mode&&g.setHours(0,0,0,0),g;case "column_ref":return B(g,a.column,this.datefields,k);case "function":return g=this.evaluateNode(a.args,g,k),this.isAggregate?c.aggregateFunction(a.name,g):b.evaluateFunction(a.name,g)}throw Error("Unsupported sql syntax "+a.type);};return g}();a.WhereClause=
A;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(A,a){function p(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function m(a){for(var b=p(a),c=a.length,q=0,u=0;u<a.length;u++)q+=Math.pow(a[u]-b,2);return 1<c?q/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,l){var b=c[a.toLowerCase()];if(null==
b)throw Error("Function Not Recognised");if(l.length<b.minParams||l.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(l)};a.isAggregate=function(a,l){a=c[a.toLowerCase()];return null!=a&&l>=a.minParams&&l<=a.maxParams};var c={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:p(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(m(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:m(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require",
"exports","../string"],function(A,a,p){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var c=new a;c.second=b/1E3;return c};a.createFromValueAndQualifer=function(b,c,g){var l=null,u=new a;u.op="-"===g?"-":"+";if("interval-period"===
c.type){a.fixDefaults(c);if("year"===c.period||"month"===c.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))u[c.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(c.start);a.fixDefaults(c.end);if("year"===c.start.period||"month"===c.start.period)throw Error("Year-Month Intervals not supported");if("year"===c.end.period||"month"===c.end.period)throw Error("Year-Month Intervals not supported");switch(c.start.period){case "day":switch(c.end.period){case "hour":l=
/^[0-9]{1,} [0-9]{1,}$/;if(l.test(b))u[c.start.period]=parseFloat(b.split(" ")[0]),u[c.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":l=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(l.test(b))u[c.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),u.hour=parseFloat(b[0]),u.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":l=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(l.test(b))u[c.start.period]=
parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),u.hour=parseFloat(b[0]),u.minute=parseFloat(b[1]),u.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(c.end.period){case "minute":l=/^[0-9]{1,}:[0-9]{1,}$/;if(l.test(b))u.hour=parseFloat(b.split(":")[0]),u.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":l=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(l.test(b))b=
b.split(":"),u.hour=parseFloat(b[0]),u.minute=parseFloat(b[1]),u.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(c.end.period){case "second":l=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(l.test(b))b=b.split(":"),u.minute=parseFloat(b[0]),u.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return u};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=A;a.evaluateFunction=function(a,b){var c=m[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");if(b.length<c.minParams||b.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(b)};a.isStandardized=function(a,b){a=m[a.toLowerCase()];return null!=a&&b>=a.minParams&&
b<=a.maxParams};var m={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],c=a[1];return null==b||null==c?null:b.toString().substring(c-1)}if(3===a.length)return b=a[0],c=a[1],a=a[2],null==b||null==c||null==a?null:0>=a?"":b.toString().substring(c-1,c+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,c=b?a[1]:" ",b=b?a[2]:a[1];if(null==c||null==b)return null;c="("+p.escapeRegExpString(c)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
c+"*|"+c+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+c+"*","g"),"");case "TRAILING":return b.replace(new RegExp(c+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",c=0;c<
a.length;c++){if(null==a[c])return null;b+=a[c].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(A,a,p){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(){}a.parse=function(a){return p.parse(a)};
return a}();a.WhereGrammar=A})},"esri/core/sql/sql92grammar":function(){(function(A,a){"function"===typeof define&&define.amd?define([],a):"object"===typeof module&&module.exports&&(module.exports=a())})(this,function(){function A(a,p,m,c){this.message=a;this.expected=p;this.found=m;this.location=c;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,A)}(function(a,p){function m(){this.constructor=a}m.prototype=p.prototype;a.prototype=new m})(A,Error);
A.buildMessage=function(a,p){function m(a){return a.charCodeAt(0).toString(16).toUpperCase()}function c(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+m(a)})}function b(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,
"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+m(a)})}var l={literal:function(a){return'"'+c(a.text)+'"'},"class":function(a){var c="",g;for(g=0;g<a.parts.length;g++)c+=a.parts[g]instanceof Array?b(a.parts[g][0])+"-"+b(a.parts[g][1]):b(a.parts[g]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};
return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var g=c,m;m=a[c];m=l[m.type](m);b[g]=m}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(p?'"'+c(p)+'"':"end of input")+" found."};return{SyntaxError:A,parse:function(a,p){function m(a,e){return{type:"literal",text:a,ignoreCase:e}}function c(a,
e,b){return{type:"class",parts:a,inverted:e,ignoreCase:b}}function b(e){var b=xa[e],f;if(!b){for(f=e-1;!xa[f];)f--;b=xa[f];for(b={line:b.line,column:b.column};f<e;)10===a.charCodeAt(f)?(b.line++,b.column=1):b.column++,f++;xa[e]=b}return b}function l(a,e){var f=b(a),Bc=b(e);return{start:{offset:a,line:f.line,column:f.column},end:{offset:e,line:Bc.line,column:Bc.column}}}function g(a){f<X||(f>X&&(X=f,Oa=[]),Oa.push(a))}function q(){var a,b,d;a=f;b=y();b!==e?(b=C(),b!==e?(d=y(),d!==e?a=b:(f=a,a=e)):
(f=a,a=e)):(f=a,a=e);return a}function u(){var a,b,d,c,g,h,k,n;a=f;b=C();if(b!==e){d=[];c=f;g=y();g!==e?(h=Da(),h!==e?(k=y(),k!==e?(n=C(),n!==e?c=g=[g,h,k,n]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);for(;c!==e;)d.push(c),c=f,g=y(),g!==e?(h=Da(),h!==e?(k=y(),k!==e?(n=C(),n!==e?c=g=[g,h,k,n]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);if(d!==e){a={type:"expr_list"};b=[b];for(c=0;c<d.length;c++)b.push(d[c][3]);a.value=b}else f=a,a=e}else f=a,a=e;return a}function C(){var a,b,c,d,g,h,k,n;a=f;b=v();if(b!==
e){c=[];d=f;g=y();g!==e?(h=da(),h!==e?(k=y(),k!==e?(n=v(),n!==e?d=g=[g,h,k,n]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);for(;d!==e;)c.push(d),d=f,g=y(),g!==e?(h=da(),h!==e?(k=y(),k!==e?(n=v(),n!==e?d=g=[g,h,k,n]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);c!==e?a=b=ya(b,c):(f=a,a=e)}else f=a,a=e;return a}function v(){var a,b,d,c,g,h,k,n;a=f;b=z();if(b!==e){d=[];c=f;g=y();g!==e?(h=V(),h!==e?(k=y(),k!==e?(n=z(),n!==e?c=g=[g,h,k,n]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);for(;c!==e;)d.push(c),c=f,
g=y(),g!==e?(h=V(),h!==e?(k=y(),k!==e?(n=z(),n!==e?c=g=[g,h,k,n]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);d!==e?a=b=ya(b,d):(f=a,a=e)}else f=a,a=e;return a}function z(){var b,c,d,h,k;b=f;c=W();c===e&&(c=f,33===a.charCodeAt(f)?(d=bd,f++):(d=e,0===w&&g(cd)),d!==e?(h=f,w++,61===a.charCodeAt(f)?(k=Ya,f++):(k=e,0===w&&g(Za)),w--,k===e?h=void 0:(f=h,h=e),h!==e?c=d=[d,h]:(f=c,c=e)):(f=c,c=e));c!==e?(d=y(),d!==e?(h=z(),h!==e?b=c={type:"unary_expr",operator:"NOT",expr:h}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e);
if(b===e)if(b=f,c=D(),c!==e)if(d=y(),d!==e){var n,t,B;d=[];h=f;k=y();k!==e?(n=E(),n!==e?(t=y(),t!==e?(B=D(),B!==e?h=k=[k,n,t,B]:(f=h,h=e)):(f=h,h=e)):(f=h,h=e)):(f=h,h=e);if(h!==e)for(;h!==e;)d.push(h),h=f,k=y(),k!==e?(n=E(),n!==e?(t=y(),t!==e?(B=D(),B!==e?h=k=[k,n,t,B]:(f=h,h=e)):(f=h,h=e)):(f=h,h=e)):(f=h,h=e);else d=e;d!==e&&(d={type:"arithmetic",tail:d});d===e&&(d=f,h=G(),h!==e?(k=y(),k!==e?(k=ea(),k!==e?(k=y(),k!==e?(k=u(),k!==e?(n=y(),n!==e?(n=fa(),n!==e?d=h={op:h,right:k}:(f=d,d=e)):(f=d,d=
e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,h=G(),h!==e?(k=y(),k!==e?(k=ea(),k!==e?(k=y(),k!==e?(k=fa(),k!==e?d=h={op:h,right:{type:"expr_list",value:[]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,h=G(),h!==e?(k=y(),k!==e?(k=T(),k!==e?d=h={op:h,right:k}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e))),d===e&&(d=f,k=W(),k!==e?(h=y(),h!==e?(h=ia(),h!==e?(n=y(),n!==e?(n=D(),n!==e?(t=y(),t!==e?(t=V(),t!==e?(k=y(),k!==e?(k=D(),k!==e?d=k={op:"NOT"+h,right:{type:"expr_list",
value:[n,k]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,k=ia(),k!==e?(h=y(),h!==e?(h=D(),h!==e?(n=y(),n!==e?(n=V(),n!==e?(t=y(),t!==e?(t=D(),t!==e?d=k={op:k,right:{type:"expr_list",value:[h,t]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)),d===e&&(d=f,h=ca(),h!==e?(k=y(),k!==e?(k=W(),k!==e?(k=y(),k!==e?(k=D(),k!==e?d=h={op:h+"NOT",right:k}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&
(d=f,h=ca(),h!==e?(k=y(),k!==e?(k=D(),k!==e?d=h={op:h,right:k}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)),d===e&&(d=f,h=F(),h!==e?(k=y(),k!==e?(k=Z(),k!==e?(n=y(),n!==e?(n=f,a.substr(f,6).toLowerCase()===dd?(t=a.substr(f,6),f+=6):(t=e,0===w&&g(ed)),t!==e?(t=f,w++,B=r(),w--,B===e?t=void 0:(f=t,t=e),t!==e?n="ESCAPE":(f=n,n=e)):(f=n,n=e),n!==e?(n=y(),n!==e?(n=U(),n!==e?d=h={op:h,right:k,escape:n.value}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,h=F(),h!==e?(k=y(),k!==
e?(k=Z(),k!==e?d=h={op:h,right:k,escape:""}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e))))));d===e&&(d=null);d!==e?(b=c,c=d,""==c||void 0==c||null==c?c=b:(d=null,c=d="arithmetic"==c.type?ya(b,c.tail):$a(c.op,b,c.right,c.escape)),b=c):(f=b,b=e)}else f=b,b=e;else f=b,b=e;return b}function E(){var b;a.substr(f,2)===ab?(b=ab,f+=2):(b=e,0===w&&g(fd));b===e&&(62===a.charCodeAt(f)?(b=gd,f++):(b=e,0===w&&g(hd)),b===e&&(a.substr(f,2)===bb?(b=bb,f+=2):(b=e,0===w&&g(id)),b===e&&(a.substr(f,2)===cb?(b=cb,f+=2):(b=e,0===
w&&g(jd)),b===e&&(60===a.charCodeAt(f)?(b=kd,f++):(b=e,0===w&&g(ld)),b===e&&(61===a.charCodeAt(f)?(b=Ya,f++):(b=e,0===w&&g(Za)),b===e&&(a.substr(f,2)===db?(b=db,f+=2):(b=e,0===w&&g(md))))))));return b}function F(){var a,b,d,c;a=a=f;b=W();b!==e?(d=y(),d!==e?(c=ha(),c!==e?a=b=[b,d,c]:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=ha());return a}function G(){var a,b,d,c;a=a=f;b=W();b!==e?(d=y(),d!==e?(c=qa(),c!==e?a=b=[b,d,c]:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);a!==e&&(a=a[0]+" "+a[2]);
a===e&&(a=qa());return a}function D(){var a,b,c,k,g,n,t,r;a=f;b=d();if(b!==e){c=[];k=f;g=y();g!==e?(n=h(),n!==e?(t=y(),t!==e?(r=d(),r!==e?k=g=[g,n,t,r]:(f=k,k=e)):(f=k,k=e)):(f=k,k=e)):(f=k,k=e);for(;k!==e;)c.push(k),k=f,g=y(),g!==e?(n=h(),n!==e?(t=y(),t!==e?(r=d(),r!==e?k=g=[g,n,t,r]:(f=k,k=e)):(f=k,k=e)):(f=k,k=e)):(f=k,k=e);c!==e?a=b=ya(b,c):(f=a,a=e)}else f=a,a=e;return a}function h(){var b;43===a.charCodeAt(f)?(b=ac,f++):(b=e,0===w&&g(bc));b===e&&(45===a.charCodeAt(f)?(b=cc,f++):(b=e,0===w&&
g(dc)));return b}function d(){var a,b,d,c,k,h,g,r;a=f;b=t();if(b!==e){d=[];c=f;k=y();k!==e?(h=n(),h!==e?(g=y(),g!==e?(r=t(),r!==e?c=k=[k,h,g,r]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);for(;c!==e;)d.push(c),c=f,k=y(),k!==e?(h=n(),h!==e?(g=y(),g!==e?(r=t(),r!==e?c=k=[k,h,g,r]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);d!==e?a=b=ya(b,d):(f=a,a=e)}else f=a,a=e;return a}function n(){var b;42===a.charCodeAt(f)?(b=nd,f++):(b=e,0===w&&g(od));b===e&&(47===a.charCodeAt(f)?(b=pd,f++):(b=e,0===w&&g(qd)));
return b}function t(){var b,d,c,h,n,t,l;l=U();if(l===e){var q,m,x,p;q=f;var v,z,E,L;v=f;z=Ma();z!==e?(E=aa(),E!==e?(L=ja(),L!==e?v=z=parseFloat(z+E+L):(f=v,v=e)):(f=v,v=e)):(f=v,v=e);v===e&&(v=f,z=Ma(),z!==e?(E=aa(),E!==e?v=z=parseFloat(z+E):(f=v,v=e)):(f=v,v=e),v===e&&(v=f,z=Ma(),z!==e?(E=ja(),E!==e?v=z=parseFloat(z+E):(f=v,v=e)):(f=v,v=e),v===e&&(v=f,z=Ma(),z!==e&&(z=parseFloat(z)),v=z)));m=v;m!==e?(x=f,w++,p=k(),w--,p===e?x=void 0:(f=x,x=e),x!==e?q=m={type:"number",value:m}:(f=q,q=e)):(f=q,q=e);
l=q;if(l===e){var J,A;J=f;var F,G,D,I;F=f;a.substr(f,4).toLowerCase()===rd?(G=a.substr(f,4),f+=4):(G=e,0===w&&g(sd));G!==e?(D=f,w++,I=r(),w--,I===e?D=void 0:(f=D,D=e),D!==e?F=G=[G,D]:(f=F,F=e)):(f=F,F=e);A=F;A!==e&&(A={type:"bool",value:!0});J=A;if(J===e){J=f;var ia,W,V,ha;ia=f;a.substr(f,5).toLowerCase()===td?(W=a.substr(f,5),f+=5):(W=e,0===w&&g(ud));W!==e?(V=f,w++,ha=r(),w--,ha===e?V=void 0:(f=V,V=e),V!==e?ia=W=[W,V]:(f=ia,ia=e)):(f=ia,ia=e);A=ia;A!==e&&(A={type:"bool",value:!1});J=A}l=J;if(l===
e){var ba,X,ca,da,ya;X=f;a.substr(f,4).toLowerCase()===vd?(ca=a.substr(f,4),f+=4):(ca=e,0===w&&g(wd));ca!==e?(da=f,w++,ya=r(),w--,ya===e?da=void 0:(f=da,da=e),da!==e?X=ca=[ca,da]:(f=X,X=e)):(f=X,X=e);ba=X;ba!==e&&(ba={type:"null",value:null});l=ba;if(l===e){var ta,xa,Da,Ba;ta=f;var Ea,va,eb,Oa;Ea=f;a.substr(f,4).toLowerCase()===xd?(va=a.substr(f,4),f+=4):(va=e,0===w&&g(yd));va!==e?(eb=f,w++,Oa=r(),w--,Oa===e?eb=void 0:(f=eb,eb=e),eb!==e?Ea=va="DATE":(f=Ea,Ea=e)):(f=Ea,Ea=e);xa=Ea;xa!==e?(Da=y(),Da!==
e?(Ba=Z(),Ba!==e?ta=xa={type:"date",value:Ba.value}:(f=ta,ta=e)):(f=ta,ta=e)):(f=ta,ta=e);l=ta;if(l===e){var ua,ec,Ya,fc;ua=f;var Fa,Fb,fb,Za;Fa=f;a.substr(f,9).toLowerCase()===zd?(Fb=a.substr(f,9),f+=9):(Fb=e,0===w&&g(Ad));Fb!==e?(fb=f,w++,Za=r(),w--,Za===e?fb=void 0:(f=fb,fb=e),fb!==e?Fa=Fb="TIMESTAMP":(f=Fa,Fa=e)):(f=Fa,Fa=e);ec=Fa;ec!==e?(Ya=y(),Ya!==e?(fc=Z(),fc!==e?ua=ec={type:"timestamp",value:fc.value}:(f=ua,ua=e)):(f=ua,ua=e)):(f=ua,ua=e);l=ua;if(l===e){var M,Pa,Gb,ra,Hb,Qa,$a,gc;M=f;Pa=
vc();Pa!==e?(Gb=y(),Gb!==e?(45===a.charCodeAt(f)?(ra=cc,f++):(ra=e,0===w&&g(dc)),ra===e&&(43===a.charCodeAt(f)?(ra=ac,f++):(ra=e,0===w&&g(bc))),ra!==e?(Hb=y(),Hb!==e?(Qa=Z(),Qa!==e?($a=y(),$a!==e?(gc=La(),gc!==e?M=Pa={type:"interval",value:Qa,qualifier:gc,op:ra}:(f=M,M=e)):(f=M,M=e)):(f=M,M=e)):(f=M,M=e)):(f=M,M=e)):(f=M,M=e)):(f=M,M=e);M===e&&(M=f,Pa=vc(),Pa!==e?(Gb=y(),Gb!==e?(ra=Z(),ra!==e?(Hb=y(),Hb!==e?(Qa=La(),Qa!==e?M=Pa={type:"interval",value:ra,qualifier:Qa,op:""}:(f=M,M=e)):(f=M,M=e)):(f=
M,M=e)):(f=M,M=e)):(f=M,M=e));l=M}}}}}}b=l;if(b===e){var Q,hc,ab,bb,cb,ic,db,pb,qb,jc,rb,sb;Q=f;var Ga,Ib,gb,tb;Ga=f;a.substr(f,7).toLowerCase()===Bd?(Ib=a.substr(f,7),f+=7):(Ib=e,0===w&&g(Cd));Ib!==e?(gb=f,w++,tb=r(),w--,tb===e?gb=void 0:(f=gb,gb=e),gb!==e?Ga=Ib="EXTRACT":(f=Ga,Ga=e)):(f=Ga,Ga=e);hc=Ga;if(hc!==e)if(ab=y(),ab!==e)if(bb=ea(),bb!==e)if(cb=y(),cb!==e){var ka;ka=wc();ka===e&&(ka=xc(),ka===e&&(ka=yc(),ka===e&&(ka=zc(),ka===e&&(ka=Ac(),ka===e&&(ka=Ca())))));ic=ka;ic!==e?(db=y(),db!==e?
(pb=Na(),pb!==e?(qb=y(),qb!==e?(jc=C(),jc!==e?(rb=y(),rb!==e?(sb=fa(),sb!==e?Q=hc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:ic},jc]}}:(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)}else f=Q,Q=e;else f=Q,Q=e;else f=Q,Q=e;else f=Q,Q=e;b=Q;if(b===e){var O,kc,ub,vb,wb,Jb,xb,yb,zb,Kb,Ab,ga,Ra,lc,mc,nc;O=f;var Ha,Lb,hb,Bb;Ha=f;a.substr(f,9).toLowerCase()===Dd?(Lb=a.substr(f,9),f+=9):(Lb=e,0===w&&g(Ed));Lb!==e?(hb=f,w++,Bb=r(),w--,Bb===
e?hb=void 0:(f=hb,hb=e),hb!==e?Ha=Lb="SUBSTRING":(f=Ha,Ha=e)):(f=Ha,Ha=e);kc=Ha;if(kc!==e)if(ub=y(),ub!==e)if(vb=ea(),vb!==e)if(wb=y(),wb!==e)if(Jb=C(),Jb!==e)if(xb=y(),xb!==e)if(yb=Na(),yb!==e)if(zb=y(),zb!==e)if(Kb=C(),Kb!==e)if(Ab=y(),Ab!==e){ga=f;var Ia,Mb,ib,Cc;Ia=f;a.substr(f,3).toLowerCase()===Fd?(Mb=a.substr(f,3),f+=3):(Mb=e,0===w&&g(Gd));Mb!==e?(ib=f,w++,Cc=r(),w--,Cc===e?ib=void 0:(f=ib,ib=e),ib!==e?Ia=Mb="FOR":(f=Ia,Ia=e)):(f=Ia,Ia=e);Ra=Ia;Ra!==e?(lc=y(),lc!==e?(mc=C(),mc!==e?(nc=y(),
nc!==e?ga=Ra=[Ra,lc,mc,nc]:(f=ga,ga=e)):(f=ga,ga=e)):(f=ga,ga=e)):(f=ga,ga=e);ga===e&&(ga=null);ga!==e?(Ra=fa(),Ra!==e?O=kc={type:"function",name:"substring",args:{type:"expr_list",value:ga?[Jb,Kb,ga[2]]:[Jb,Kb]}}:(f=O,O=e)):(f=O,O=e)}else f=O,O=e;else f=O,O=e;else f=O,O=e;else f=O,O=e;else f=O,O=e;else f=O,O=e;else f=O,O=e;else f=O,O=e;else f=O,O=e;else f=O,O=e;b=O;if(b===e){var H,Sa,Nb,Ob,Pb,la,Qb,Ta,Rb,Sb,Dc,oc,Ec,Fc;H=f;Sa=uc();Sa!==e?(Nb=y(),Nb!==e?(Ob=ea(),Ob!==e?(Pb=y(),Pb!==e?(la=pa(),la===
e&&(la=null),la!==e?(Qb=y(),Qb!==e?(Ta=C(),Ta!==e?(Rb=y(),Rb!==e?(Sb=Na(),Sb!==e?(Dc=y(),Dc!==e?(oc=C(),oc!==e?(Ec=y(),Ec!==e?(Fc=fa(),Fc!==e?H=Sa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==la?"BOTH":la},Ta,oc]}}:(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e);H===e&&(H=f,Sa=uc(),Sa!==e?(Nb=y(),Nb!==e?(Ob=ea(),Ob!==e?(Pb=y(),Pb!==e?(la=pa(),la===e&&(la=null),la!==
e?(Qb=y(),Qb!==e?(Ta=C(),Ta!==e?(Rb=y(),Rb!==e?(Sb=fa(),Sb!==e?H=Sa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==la?"BOTH":la},Ta]}}:(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e));b=H;if(b===e){var R,pc,Gc,Hc,Ic,qc,Jc,Kc,Lc,rc,Mc,Nc;R=f;var Ja,Tb,jb,Oc;Ja=f;a.substr(f,8).toLowerCase()===Hd?(Tb=a.substr(f,8),f+=8):(Tb=e,0===w&&g(Id));Tb!==e?(jb=f,w++,Oc=r(),w--,Oc===e?jb=void 0:(f=jb,jb=e),jb!==e?Ja=Tb="POSITION":
(f=Ja,Ja=e)):(f=Ja,Ja=e);pc=Ja;pc!==e?(Gc=y(),Gc!==e?(Hc=ea(),Hc!==e?(Ic=y(),Ic!==e?(qc=C(),qc!==e?(Jc=y(),Jc!==e?(Kc=qa(),Kc!==e?(Lc=y(),Lc!==e?(rc=C(),rc!==e?(Mc=y(),Mc!==e?(Nc=fa(),Nc!==e?R=pc={type:"function",name:"position",args:{type:"expr_list",value:[qc,rc]}}:(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e);b=R;if(b===e){var Y,Ub,Pc,Qc,Rc,Ua,Sc,Tc;Y=f;var ma,kb,lb,sa;ma=f;ma=kb=B();if(ma===e)if(ma=f,96===a.charCodeAt(f)?
(kb=Uc,f++):(kb=e,0===w&&g(Vc)),kb!==e){lb=[];Wc.test(a.charAt(f))?(sa=a.charAt(f),f++):(sa=e,0===w&&g(Xc));if(sa!==e)for(;sa!==e;)lb.push(sa),Wc.test(a.charAt(f))?(sa=a.charAt(f),f++):(sa=e,0===w&&g(Xc));else lb=e;lb!==e?(96===a.charCodeAt(f)?(sa=Uc,f++):(sa=e,0===w&&g(Vc)),sa!==e?ma=kb=lb.join(""):(f=ma,ma=e)):(f=ma,ma=e)}else f=ma,ma=e;Ub=ma;Ub!==e?(Pc=y(),Pc!==e?(Qc=ea(),Qc!==e?(Rc=y(),Rc!==e?(Ua=u(),Ua===e&&(Ua=null),Ua!==e?(Sc=y(),Sc!==e?(Tc=fa(),Tc!==e?Y=Ub={type:"function",name:Ub,args:Ua?
Ua:{type:"expr_list",value:[]}}:(f=Y,Y=e)):(f=Y,Y=e)):(f=Y,Y=e)):(f=Y,Y=e)):(f=Y,Y=e)):(f=Y,Y=e)):(f=Y,Y=e);b=Y;if(b===e){var Vb,K,Va,Wb,Wa,Xb,za,na,mb,Yc,Zc;K=f;Va=Db();if(Va!==e)if(Wb=y(),Wb!==e)if(Wa=C(),Wa!==e)if(Xb=y(),Xb!==e){za=[];for(na=P();na!==e;)za.push(na),na=P();za!==e?(na=y(),na!==e?(mb=Eb(),mb!==e?K=Va={type:"case_expression",format:"simple",operand:Wa,clauses:za,else:null}:(f=K,K=e)):(f=K,K=e)):(f=K,K=e)}else f=K,K=e;else f=K,K=e;else f=K,K=e;else f=K,K=e;if(K===e)if(K=f,Va=Db(),Va!==
e)if(Wb=y(),Wb!==e)if(Wa=C(),Wa!==e)if(Xb=y(),Xb!==e){za=[];for(na=P();na!==e;)za.push(na),na=P();za!==e?(na=y(),na!==e?(mb=wa(),mb!==e?(Yc=y(),Yc!==e?(Zc=Eb(),Zc!==e?K=Va={type:"case_expression",format:"simple",operand:Wa,clauses:za,else:mb.value}:(f=K,K=e)):(f=K,K=e)):(f=K,K=e)):(f=K,K=e)):(f=K,K=e)}else f=K,K=e;else f=K,K=e;else f=K,K=e;else f=K,K=e;Vb=K;if(Vb===e){var N,Xa,Yb,Aa,oa,nb,$c,ad;N=f;Xa=Db();if(Xa!==e)if(Yb=y(),Yb!==e){Aa=[];for(oa=Cb();oa!==e;)Aa.push(oa),oa=Cb();Aa!==e?(oa=y(),oa!==
e?(nb=Eb(),nb!==e?N=Xa={type:"case_expression",format:"searched",clauses:Aa,else:null}:(f=N,N=e)):(f=N,N=e)):(f=N,N=e)}else f=N,N=e;else f=N,N=e;if(N===e)if(N=f,Xa=Db(),Xa!==e)if(Yb=y(),Yb!==e){Aa=[];for(oa=Cb();oa!==e;)Aa.push(oa),oa=Cb();Aa!==e?(oa=y(),oa!==e?(nb=wa(),nb!==e?($c=y(),$c!==e?(ad=Eb(),ad!==e?N=Xa={type:"case_expression",format:"searched",clauses:Aa,else:nb.value}:(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e)}else f=N,N=e;else f=N,N=e;Vb=N}b=Vb;if(b===e){var ob,Ka,sc,Zb,$b;
Ka=f;sc=k();if(sc!==e){Zb=[];for($b=S();$b!==e;)Zb.push($b),$b=S();Zb!==e?Ka=sc+=Zb.join(""):(f=Ka,Ka=e)}else f=Ka,Ka=e;ob=Ka;if(ob!==e){var tc=ob;ob=/^CURRENT_DATE$/i.test(tc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(tc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:tc}}b=ob;b===e&&(b=T(),b===e&&(b=f,d=ea(),d!==e?(c=y(),c!==e?(h=C(),h!==e?(n=y(),n!==e?(t=fa(),t!==e?(h.paren=!0,b=d=h):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)))}}}}}}}return b}
function B(){var a,b,d,c;a=f;b=k();if(b!==e){d=[];for(c=r();c!==e;)d.push(c),c=r();d!==e?a=b+=d.join(""):(f=a,a=e)}else f=a,a=e;return a}function k(){var b;Jd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&g(Kd));return b}function r(){var b;Ld.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&g(Md));return b}function S(){var b;Nd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&g(Od));return b}function T(){var b,d,c;b=f;64===a.charCodeAt(f)?(d=Pd,f++):(d=e,0===w&&g(Qd));d!==e?(c=B(),c!==e?b=d=
[d,c]:(f=b,b=e)):(f=b,b=e);b!==e&&(b={type:"param",value:b[1]});return b}function pa(){var b,d,c;b=f;a.substr(f,7).toLowerCase()===Rd?(d=a.substr(f,7),f+=7):(d=e,0===w&&g(Sd));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="LEADING":(f=b,b=e)):(f=b,b=e);b===e&&(b=f,a.substr(f,8).toLowerCase()===Td?(d=a.substr(f,8),f+=8):(d=e,0===w&&g(Ud)),d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="TRAILING":(f=b,b=e)):(f=b,b=e),b===e&&(b=f,a.substr(f,4).toLowerCase()===Vd?(d=a.substr(f,
4),f+=4):(d=e,0===w&&g(Wd)),d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="BOTH":(f=b,b=e)):(f=b,b=e)));return b}function La(){var b,d,c;b=f;var k,h;d=f;c=L();c!==e?(k=y(),k!==e?(k=ea(),k!==e?(k=y(),k!==e?(k=J(),k!==e?(h=y(),h!==e?(h=fa(),h!==e?d=c={type:"interval-period",period:c.value,precision:k,secondary:null}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);d===e&&(d=f,c=L(),c!==e&&(c=pb(c)),d=c);if(d!==e)if(c=y(),c!==e)if(c=f,a.substr(f,2).toLowerCase()===
Xd?(k=a.substr(f,2),f+=2):(k=e,0===w&&g(Yd)),k!==e?(k=f,w++,h=r(),w--,h===e?k=void 0:(f=k,k=e),k!==e?c="TO":(f=c,c=e)):(f=c,c=e),c!==e)if(c=y(),c!==e){var n;c=f;k=L();k!==e&&(k={type:"interval-period",period:k.value,precision:null,secondary:null});c=k;c===e&&(c=f,k=Ca(),k!==e?(k=y(),k!==e?(k=ea(),k!==e?(k=y(),k!==e?(k=J(),k!==e?(h=y(),h!==e?(h=Da(),h!==e?(h=y(),h!==e?(h=x(),h!==e?(n=y(),n!==e?(n=fa(),n!==e?c=k=qb(k,h):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=
c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e),c===e&&(c=f,k=Ca(),k!==e?(k=y(),k!==e?(k=ea(),k!==e?(k=y(),k!==e?(k=J(),k!==e?(h=y(),h!==e?(h=fa(),h!==e?c=k={type:"interval-period",period:"second",precision:k,secondary:null}:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e),c===e&&(c=f,k=Ca(),k!==e&&(k={type:"interval-period",period:"second",precision:null,secondary:null}),c=k)));c!==e?b=d={type:"interval-qualifier",start:d,end:c}:(f=b,b=e)}else f=b,b=e;else f=b,b=e;else f=b,b=e;
else f=b,b=e;b===e&&(b=f,c=L(),c!==e?(d=y(),d!==e?(d=ea(),d!==e?(d=y(),d!==e?(d=x(),d!==e?(k=y(),k!==e?(k=fa(),k!==e?b=c={type:"interval-period",period:c.value,precision:d,secondary:null}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e),b===e&&(b=f,c=L(),c!==e&&(c=pb(c)),b=c,b===e&&(b=f,c=Ca(),c!==e?(d=y(),d!==e?(d=ea(),d!==e?(d=y(),d!==e?(d=J(),d!==e?(k=y(),k!==e?(k=Da(),k!==e?(c=y(),c!==e?(c=x(),c!==e?(k=y(),k!==e?(k=fa(),k!==e?b=c=qb(d,c):(f=b,b=e)):(f=b,b=e)):(f=b,b=
e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e),b===e&&(b=f,c=Ca(),c!==e?(d=y(),d!==e?(d=ea(),d!==e?(d=y(),d!==e?(d=x(),d!==e?(k=y(),k!==e?(k=fa(),k!==e?b=c={type:"interval-period",period:"second",precision:d,secondary:null}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e),b===e&&(b=f,c=Ca(),c!==e&&(c={type:"interval-period",period:"second",precision:null,secondary:null}),b=c)))));return b}function L(){var a;a=f;a=yc();a!==e&&(a=
{type:"string",value:"day"});a===e&&(a=f,a=zc(),a!==e&&(a={type:"string",value:"hour"}),a===e&&(a=f,a=Ac(),a!==e&&(a={type:"string",value:"minute"}),a===e&&(a=f,a=xc(),a!==e&&(a={type:"string",value:"month"}),a===e&&(a=f,a=wc(),a!==e&&(a={type:"string",value:"year"})))));return a}function x(){var a;a=I();a!==e&&(a=parseFloat(a));return a}function J(){var a;a=I();a!==e&&(a=parseFloat(a));return a}function Z(){var a;a=U();a===e&&(a=T());return a}function U(){var b,d,c;b=f;39===a.charCodeAt(f)?(d=rb,
f++):(d=e,0===w&&g(sb));d===e&&(a.substr(f,2)===tb?(d=tb,f+=2):(d=e,0===w&&g(Zd)));if(d!==e){d=[];c=f;a.substr(f,2)===Ba?(c=Ba,f+=2):(c=e,0===w&&g(ub));c!==e&&(c="'");c===e&&(vb.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&g(wb)));for(;c!==e;)d.push(c),c=f,a.substr(f,2)===Ba?(c=Ba,f+=2):(c=e,0===w&&g(ub)),c!==e&&(c="'"),c===e&&(vb.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&g(wb)));d!==e?(39===a.charCodeAt(f)?(c=rb,f++):(c=e,0===w&&g(sb)),c!==e?b=d={type:"string",value:d.join("")}:(f=b,
b=e)):(f=b,b=e)}else f=b,b=e;return b}function Cb(){var a,b,d;a=f;b=xb();b!==e?(b=y(),b!==e?(b=C(),b!==e?(d=y(),d!==e?(d=yb(),d!==e?(d=y(),d!==e?(d=C(),d!==e?a=b={type:"when_clause",operand:b,value:d}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function P(){var a,b,d;a=f;b=xb();b!==e?(b=y(),b!==e?(b=C(),b!==e?(d=y(),d!==e?(d=yb(),d!==e?(d=y(),d!==e?(d=C(),d!==e?a=b={type:"when_clause",operand:b,value:d}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):
(f=a,a=e)):(f=a,a=e);return a}function wa(){var b,d;b=f;var c,k;d=f;a.substr(f,4).toLowerCase()===$d?(c=a.substr(f,4),f+=4):(c=e,0===w&&g(ae));c!==e?(c=f,w++,k=r(),w--,k===e?c=void 0:(f=c,c=e),c!==e?d="ELSE":(f=d,d=e)):(f=d,d=e);d!==e?(d=y(),d!==e?(d=C(),d!==e?b={type:"else_clause",value:d}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e);return b}function Ma(){var b,d,c;b=I();b===e&&(b=f,45===a.charCodeAt(f)?(d=cc,f++):(d=e,0===w&&g(dc)),d===e&&(43===a.charCodeAt(f)?(d=ac,f++):(d=e,0===w&&g(bc))),d!==e?(c=I(),c!==
e?b=d=d[0]+c:(f=b,b=e)):(f=b,b=e));return b}function aa(){var b,d;b=f;46===a.charCodeAt(f)?(d=be,f++):(d=e,0===w&&g(ce));d!==e?(d=I(),d===e&&(d=null),d!==e?b="."+(null!=d?d:""):(f=b,b=e)):(f=b,b=e);return b}function ja(){var b,d,c;d=b=f;de.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&g(ee));c!==e?(fe.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&g(ge)),c===e&&(c=null),c!==e?d="e"+(null===c?"":c):(f=d,d=e)):(f=d,d=e);d!==e?(c=I(),c!==e?b=d+c:(f=b,b=e)):(f=b,b=e);return b}function I(){var a,
b;a=[];b=ba();if(b!==e)for(;b!==e;)a.push(b),b=ba();else a=e;a!==e&&(a=a.join(""));return a}function ba(){var b;he.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&g(ie));return b}function qa(){var b,d,c;b=f;a.substr(f,2).toLowerCase()===je?(d=a.substr(f,2),f+=2):(d=e,0===w&&g(ke));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="IN":(f=b,b=e)):(f=b,b=e);return b}function ca(){var b,d,c;b=f;a.substr(f,2).toLowerCase()===le?(d=a.substr(f,2),f+=2):(d=e,0===w&&g(me));d!==e?(d=f,w++,c=r(),
w--,c===e?d=void 0:(f=d,d=e),d!==e?b="IS":(f=b,b=e)):(f=b,b=e);return b}function ha(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===ne?(d=a.substr(f,4),f+=4):(d=e,0===w&&g(oe));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="LIKE":(f=b,b=e)):(f=b,b=e);return b}function W(){var b,d,c;b=f;a.substr(f,3).toLowerCase()===pe?(d=a.substr(f,3),f+=3):(d=e,0===w&&g(qe));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="NOT":(f=b,b=e)):(f=b,b=e);return b}function V(){var b,d,c;b=f;a.substr(f,
3).toLowerCase()===re?(d=a.substr(f,3),f+=3):(d=e,0===w&&g(se));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="AND":(f=b,b=e)):(f=b,b=e);return b}function da(){var b,d,c;b=f;a.substr(f,2).toLowerCase()===te?(d=a.substr(f,2),f+=2):(d=e,0===w&&g(ue));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="OR":(f=b,b=e)):(f=b,b=e);return b}function ia(){var b,d,c;b=f;a.substr(f,7).toLowerCase()===ve?(d=a.substr(f,7),f+=7):(d=e,0===w&&g(we));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,
d=e),d!==e?b="BETWEEN":(f=b,b=e)):(f=b,b=e);return b}function Na(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===xe?(d=a.substr(f,4),f+=4):(d=e,0===w&&g(ye));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="FROM":(f=b,b=e)):(f=b,b=e);return b}function uc(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===ze?(d=a.substr(f,4),f+=4):(d=e,0===w&&g(Ae));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="TRIM":(f=b,b=e)):(f=b,b=e);return b}function vc(){var b,d,c;b=f;a.substr(f,8).toLowerCase()===
Be?(d=a.substr(f,8),f+=8):(d=e,0===w&&g(Ce));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="INTERVAL":(f=b,b=e)):(f=b,b=e);return b}function wc(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===De?(d=a.substr(f,4),f+=4):(d=e,0===w&&g(Ee));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="YEAR":(f=b,b=e)):(f=b,b=e);return b}function xc(){var b,d,c;b=f;a.substr(f,5).toLowerCase()===Fe?(d=a.substr(f,5),f+=5):(d=e,0===w&&g(Ge));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?
b="MONTH":(f=b,b=e)):(f=b,b=e);return b}function yc(){var b,d,c;b=f;a.substr(f,3).toLowerCase()===He?(d=a.substr(f,3),f+=3):(d=e,0===w&&g(Ie));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="DAY":(f=b,b=e)):(f=b,b=e);return b}function zc(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Je?(d=a.substr(f,4),f+=4):(d=e,0===w&&g(Ke));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="HOUR":(f=b,b=e)):(f=b,b=e);return b}function Ac(){var b,d,c;b=f;a.substr(f,6).toLowerCase()===Le?(d=a.substr(f,
6),f+=6):(d=e,0===w&&g(Me));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="MINUTE":(f=b,b=e)):(f=b,b=e);return b}function Ca(){var b,d,c;b=f;a.substr(f,6).toLowerCase()===Ne?(d=a.substr(f,6),f+=6):(d=e,0===w&&g(Oe));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="SECOND":(f=b,b=e)):(f=b,b=e);return b}function Db(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Pe?(d=a.substr(f,4),f+=4):(d=e,0===w&&g(Qe));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="CASE":(f=b,b=e)):
(f=b,b=e);return b}function Eb(){var b,d,c;b=f;a.substr(f,3).toLowerCase()===Re?(d=a.substr(f,3),f+=3):(d=e,0===w&&g(Se));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="END":(f=b,b=e)):(f=b,b=e);return b}function xb(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Te?(d=a.substr(f,4),f+=4):(d=e,0===w&&g(Ue));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="WHEN":(f=b,b=e)):(f=b,b=e);return b}function yb(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Ve?(d=a.substr(f,4),f+=4):(d=
e,0===w&&g(We));d!==e?(d=f,w++,c=r(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="THEN":(f=b,b=e)):(f=b,b=e);return b}function Da(){var b;44===a.charCodeAt(f)?(b=Xe,f++):(b=e,0===w&&g(Ye));return b}function ea(){var b;40===a.charCodeAt(f)?(b=Ze,f++):(b=e,0===w&&g($e));return b}function fa(){var b;41===a.charCodeAt(f)?(b=af,f++):(b=e,0===w&&g(bf));return b}function y(){var a,b;a=[];for(b=zb();b!==e;)a.push(b),b=zb();return a}function zb(){var b;cf.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&g(df));
return b}function $a(a,b,d,e){a={type:"binary_expr",operator:a,left:b,right:d};void 0!==e&&(a.escape=e);return a}function ya(a,b){for(var d=0;d<b.length;d++)a=$a(b[d][1],a,b[d][3]);return a}p=void 0!==p?p:{};var e={},Ab={start:q},Bb=q,bd="!",cd=m("!",!1),Ya="\x3d",Za=m("\x3d",!1),ab="\x3e\x3d",fd=m("\x3e\x3d",!1),gd="\x3e",hd=m("\x3e",!1),bb="\x3c\x3d",id=m("\x3c\x3d",!1),cb="\x3c\x3e",jd=m("\x3c\x3e",!1),kd="\x3c",ld=m("\x3c",!1),db="!\x3d",md=m("!\x3d",!1),ac="+",bc=m("+",!1),cc="-",dc=m("-",!1),
nd="*",od=m("*",!1),pd="/",qd=m("/",!1),Jd=/^[A-Za-z_\x80-\uFFFF]/,Kd=c([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Ld=/^[A-Za-z0-9_]/,Md=c([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Nd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Od=c([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Pd="@",Qd=m("@",!1),pb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},qb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},rb="'",
sb=m("'",!1),tb="N'",Zd=m("N'",!1),Ba="''",ub=m("''",!1),vb=/^[^']/,wb=c(["'"],!0,!1),be=".",ce=m(".",!1),he=/^[0-9]/,ie=c([["0","9"]],!1,!1),de=/^[eE]/,ee=c(["e","E"],!1,!1),fe=/^[+\-]/,ge=c(["+","-"],!1,!1),vd="null",wd=m("NULL",!0),rd="true",sd=m("TRUE",!0),td="false",ud=m("FALSE",!0),je="in",ke=m("IN",!0),le="is",me=m("IS",!0),ne="like",oe=m("LIKE",!0),dd="escape",ed=m("ESCAPE",!0),pe="not",qe=m("NOT",!0),re="and",se=m("AND",!0),te="or",ue=m("OR",!0),ve="between",we=m("BETWEEN",!0),xe="from",
ye=m("FROM",!0),Fd="for",Gd=m("FOR",!0),Dd="substring",Ed=m("SUBSTRING",!0),Bd="extract",Cd=m("EXTRACT",!0),ze="trim",Ae=m("TRIM",!0),Hd="position",Id=m("POSITION",!0),zd="timestamp",Ad=m("TIMESTAMP",!0),xd="date",yd=m("DATE",!0),Rd="leading",Sd=m("LEADING",!0),Td="trailing",Ud=m("TRAILING",!0),Vd="both",Wd=m("BOTH",!0),Xd="to",Yd=m("TO",!0),Be="interval",Ce=m("INTERVAL",!0),De="year",Ee=m("YEAR",!0),Fe="month",Ge=m("MONTH",!0),He="day",Ie=m("DAY",!0),Je="hour",Ke=m("HOUR",!0),Le="minute",Me=m("MINUTE",
!0),Ne="second",Oe=m("SECOND",!0),Pe="case",Qe=m("CASE",!0),Re="end",Se=m("END",!0),Te="when",Ue=m("WHEN",!0),Ve="then",We=m("THEN",!0),$d="else",ae=m("ELSE",!0),Xe=",",Ye=m(",",!1),Ze="(",$e=m("(",!1),af=")",bf=m(")",!1),cf=/^[ \t\n\r]/,df=c([" ","\t","\n","\r"],!1,!1),Uc="`",Vc=m("`",!1),Wc=/^[^`]/,Xc=c(["`"],!0,!1),f=0,xa=[{line:1,column:1}],X=0,Oa=[],w=0,va;if("startRule"in p){if(!(p.startRule in Ab))throw Error("Can't start parsing from rule \""+p.startRule+'".');Bb=Ab[p.startRule]}va=Bb();if(va!==
e&&f===a.length)return va;va!==e&&f<a.length&&g({type:"end"});throw function(a,b,d){return new A(A.buildMessage(a,b),a,b,d)}(Oa,X<a.length?a.charAt(X):null,X<a.length?l(X,X+1):l(X,X));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(A,
a,p,m,c,b,l,g,q){function u(a,b){var d;if(!b)return null;if("x"in b){var c={x:0,y:0};a=a(b.x,b.y,E);c.x=a[0];c.y=a[1];null!=b.z&&(c.z=b.z);null!=b.m&&(c.m=b.m);return c}if("xmin"in b)return c={xmin:0,ymin:0,xmax:0,ymax:0},d=a(b.xmin,b.ymin,E),c.xmin=d[0],c.ymin=d[1],a=a(b.xmax,b.ymax,E),c.xmax=a[0],c.ymax=a[1],b.hasZ&&(c.zmin=b.zmin,c.zmax=b.zmax,c.hasZ=!0),b.hasM&&(c.mmin=b.mmin,c.mmax=b.mmax,c.hasM=!0),c;if("rings"in b)return{rings:C(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:C(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:v(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function C(a,b){for(var d=[],c=0;c<a.length;c++)d.push(v(a[c],b));return d}function v(a,b){for(var d=[],c=0;c<a.length;c++){var h=a[c],k=b(h[0],h[1],[0,0]);d.push(k);2<h.length&&k.push(h[2]);3<h.length&&k.push(h[3])}return d}function z(a,b){return!g.isValid(a)||!g.isValid(b)||g.equals(a,b)||q.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var E=[0,0];a.doesBrowserSupportProjection=
function(a,d){return z(a,d)?b.isSupported():!0};a.checkProjectionSupport=function(a,d){return p.__awaiter(this,void 0,void 0,function(){var c,h,g;return p.__generator(this,function(k){if(!d)return[2];if(Array.isArray(a)){c=0;for(h=a;c<h.length;c++)if(g=h[c],z(g.geometry&&g.geometry.spatialReference,d)){if(b.isSupported())return[2,b.load()];throw new m("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:d});}return[2]}if(!z(a,d))return[2];if(b.isSupported())return[2,
b.load()];throw new m("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:d});})})};var F=u.bind(null,q.lngLatToXY),G=u.bind(null,q.xyToLngLat);a.project=function(a,d,c){if(!a)return a;c||(c=d,d=a.spatialReference);return g.isValid(d)&&g.isValid(c)&&!g.equals(d,c)?q.canProject(d,c)?g.isWebMercator(c)?F(a):G(a):b.projectMany(l.jsonAdapter,[a],d,c,null)[0]:a};var D=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}
a.prototype.push=function(a,b,h){return p.__awaiter(this,void 0,void 0,function(){var d,k=this;return p.__generator(this,function(n){a&&a.length&&b&&h&&!g.equals(b,h)||c.resolve(a);d={geometries:a,inSpatialReference:b,outSpatialReference:h,resolve:null};this._jobs.push(d);return[2,c.create(function(a){d.resolve=a;null===k._timer&&(k._timer=setTimeout(k._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var c=a.geometries,h=a.inSpatialReference,B=
a.outSpatialReference,a=a.resolve;q.canProject(h,B)?g.isWebMercator(B)?a(c.map(F)):a(c.map(G)):a(b.projectMany(l.jsonAdapter,c,h,B,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(d){return[2,D.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),
function(A,a,p,m,c){function b(a,b,q,m,u){void 0===u&&(u=null);if(null===u){var v=c.cacheKey(q,m);void 0!==C[v]?u=C[v]:(u=l(q,m,null),null===u&&(u=new c),C[v]=u)}return g._project(a,b,q,m,u)}function l(a,b,l){void 0===l&&(l=null);a=g._getTransformation(q,a,b,l,null===l||void 0===l?void 0:l.spatialReference);return null!==a?c.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var g=null,q=null;a.isLoaded=function(){return!!g&&m.isLoaded()};a.isSupported=function(){return m.isSupported()};
var u=null;a.load=function(){return u?u:u=p.all([m.load(),new Promise(function(a,b){A(["./geometryEngineBase"],a,b)}),new Promise(function(a,b){A(["./geometryAdapters/hydrated"],a,b)})]).then(function(a){var b=a[1];q=a[2].hydratedAdapter;g=b;g._enableProjection(m)})};a.project=function(a,c,g){void 0===g&&(g=null);return a instanceof Array?0===a.length?[]:b(q,a,a[0].spatialReference,c,g):b(q,[a],a.spatialReference,c,g)[0]};var C={};a.projectMany=b;a.getTransformation=l;a.getTransformations=function(a,
b,l){void 0===l&&(l=null);a=g._getTransformationBySuitability(q,a,b,l,null===l||void 0===l?void 0:l.spatialReference);if(null!==a){b=[];for(l=0;l<a.length;l++)b.push(c.fromGE(a[l]));return b}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(A,a,p,m,c,b){function l(b){function d(a,b,d){a[b]=d(a[b])}a._pe=b;z.init();E.init();F.init();G.init();D.init();a.PeGCSExtent=function(b){function d(){return null!==
b&&b.apply(this,arguments)||this}p.__extends(d,b);d.prototype.destroy=function(){a._pe.destroy(this)};return d}(a._pe.PeGCSExtent);for(var c=0,h=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];c<h.length;c++)b=h[c],d(b.prototype,"getName",function(a){return function(){return a.call(this,Array(z.PE_NAME_MAX))}});c=0;for(h=[a._pe.PeGeogtran,a._pe.PeProjcs];c<h.length;c++)b=h[c],d(b.prototype,"getParameters",
function(b){return function(){for(var d=Array(z.PE_PARM_MAX),c=b.call(this),k=0;k<d.length;k++){var h=a._pe.getValue(c,"*");d[k]=h?a._pe.wrapPointer(h,a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return d}});d(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var d=[],c=a.call(this);C(d,b,c);return d}});d(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var d=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var c=
null,k=b.call(this);if(!a._pe.compare(k,a._pe.NULL)){var c=[k],h=this.getSteps();if(1<h)for(var k=a._pe.getPointer(k),g=1;g<h;g++)c.push(a._pe.wrapPointer(k+d*g,a._pe.PeGTlistExtendedGTs))}return c}});var g=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var d=this._cache;d||(this._cache=d=new Map);if(d.has(b))return d.get(b);var c=null,k=b.call(this);if(!a._pe.compare(k,a._pe.NULL)){var c=[k],h=k.getNump();if(1<h)for(var k=a._pe.getPointer(k),n=1;n<h;n++)c.push(a._pe.wrapPointer(k+g*
n,a._pe.PeHorizon))}d.set(b,c);return c}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=z.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var d=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(z.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(d,b,c))}}function g(b){if(b){var d=a._pe.getClass(b);d&&(d=a._pe.getCache(d))&&(b=a._pe.getPointer(b))&&delete d[b]}}function q(b,
d){var c=[];d=Array(d);for(var h=0;h<b;h++)c.push(a._pe.ensureInt8(d));return c}function u(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function C(b,d,c,g){void 0===g&&(g=!1);if(g)for(g=0;g<2*d;g++)b[g]=a._pe.getValue(c+g*Float64Array.BYTES_PER_ELEMENT,"double");else{var h=0===b.length;for(g=0;g<d;g++)h&&(b[g]=Array(2)),b[g][0]=a._pe.getValue(c,"double"),b[g][1]=a._pe.getValue(c+Float64Array.BYTES_PER_ELEMENT,"double"),c+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});var v;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!c("esri-wasm")};a.load=function(){return v?v:v=b.create(function(a,b){(new Promise(function(a,b){A(["./support/pe-wasm"],a,b)})).then(function(d){d({locateFile:function(a){return m.getAssetUrl("esri/geometry/support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){l(b);a()})})})};(function(b){function d(b,d,c){a._pe.ensureCache.prepare();var k=u(c),g=c===
k,k=a._pe.ensureFloat64(k);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),d,k))&&C(c,d,k,g);return b}function c(a,b,d){return g(a,b,d,0)}function g(b,d,c,g){a._pe.ensureCache.prepare();var k=u(c),h=c===k,k=a._pe.ensureFloat64(k);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),d,k,g))&&C(c,d,k,h);return b}b.geogToProj=d;b.projGeog=function(a,b,g,h){switch(h){case z.PE_TRANSFORM_P_TO_G:return c(a,b,g);case z.PE_TRANSFORM_G_TO_P:return d(a,b,g)}return 0};b.projToGeog=c;b.projToGeogCenter=g})(a.PeCSTransformations||
(a.PeCSTransformations={}));var z;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=
a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=
a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;
b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(z=a.PeDefs||(a.PeDefs={}));(function(b){function d(b,d){var k=null,h=g[b];h||(h={},g[b]=h);h.hasOwnProperty(String(d))?k=h[d]:(b=a._pe.PeFactory.prototype.factoryByType(b,d),a._pe.compare(b,a._pe.NULL)||(k=b,h[d]=k));return k=c(k)}function c(b){if(b){var d=b.getType();switch(d){case z.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case z.PE_TYPE_PROJCS:b=a._pe.castObject(b,
a._pe.PeProjcs);break;case z.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:d&z.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var g={},h={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return d(z.PE_TYPE_COORDSYS,a)};b.factoryByType=d;b.fromString=function(b,d){var k=null,g=h[b];g||(g={},h[b]=g);g.hasOwnProperty(d)?k=g[d]:(b=a._pe.PeFactory.prototype.fromString(b,d),a._pe.compare(b,a._pe.NULL)||(k=b,g[d]=k));return k=
c(k)};b.geogcs=function(a){return d(z.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return d(z.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return d(z.PE_TYPE_PROJCS,a)};b.unit=function(a){return d(z.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var E;(function(b){var d;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;d=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=
function(b,c,g,k,h,l){var n=null,r=new a._pe.PeInteger(l);try{var t=a._pe.PeGTlistExtended.prototype.getGTlist(b,c,g,k,h,r);if(l=r.val)if(n=[t],1<l){var B=a._pe.getPointer(t);for(b=1;b<l;b++)n.push(a._pe.wrapPointer(B+d*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(r)}return n}})(E=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var d=0;d<b.length;d++){var c=b[d];g(c);c.getEntries().forEach(function(a){g(a);a=a.getGeogtran();g(a);a.getParameters().forEach(g);
[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){g(a);var b=a.getDatum();g(b);g(b.getSpheroid());g(a.getPrimem());g(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,g,h,k){a._pe.ensureCache.prepare();var d=u(g),n=g===d,d=a._pe.ensureFloat64(d),l=0;h&&(l=a._pe.ensureFloat64(h));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,d,l,k))&&C(g,c,d,n);return b}})(a.PeGTTransformations||
(a.PeGTTransformations={}));(function(b){function d(b,d,c,g,h,n){a._pe.ensureCache.prepare();var k,l;switch(b){case "dd":k=a._pe._pe_geog_to_dd;l=z.PE_DD_MAX;break;case "ddm":k=a._pe._pe_geog_to_ddm;l=z.PE_DDM_MAX;break;case "dms":k=a._pe._pe_geog_to_dms,l=z.PE_DMS_MAX}b=0;d&&(b=a._pe.getPointer(d));d=u(g);d=a._pe.ensureFloat64(d);l=q(c,l);g=a._pe.ensureInt32(l);if(h=k(b,c,d,h,g))for(k=0;k<c;k++)n[k]=a._pe.UTF8ToString(l[k]);return h}function c(b,d,c,g,h){a._pe.ensureCache.prepare();var k;switch(b){case "dd":k=
a._pe._pe_dd_to_geog;break;case "ddm":k=a._pe._pe_ddm_to_geog;break;case "dms":k=a._pe._pe_dms_to_geog}b=0;d&&(b=a._pe.getPointer(d));d=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(d);d=a._pe.ensureFloat64(Array(2*c));(k=k(b,c,g,d))&&C(h,c,d);return k}b.geog_to_dms=function(a,b,c,g,h){return d("dms",a,b,c,g,h)};b.dms_to_geog=function(a,b,d,g){return c("dms",a,b,d,g)};b.geog_to_ddm=function(a,b,c,g,h){return d("ddm",a,b,c,g,h)};b.ddm_to_geog=function(a,b,d,g){return c("ddm",
a,b,d,g)};b.geog_to_dd=function(a,b,c,g,h){return d("dd",a,b,c,g,h)};b.dd_to_geog=function(a,b,d,g){return c("dd",a,b,d,g)}})(a.PeNotationDms||(a.PeNotationDms={}));var F;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=
a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,g,h,k,l,m){a._pe.ensureCache.prepare();var d=0;b&&(d=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=q(c,z.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_mgrs_extended(d,c,g,h,k,l,n))for(k=0;k<c;k++)m[k]=a._pe.UTF8ToString(b[k]);return h};b.mgrs_to_geog_extended=function(b,c,g,h,k){a._pe.ensureCache.prepare();var d=0;b&&(d=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});
g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(h=a._pe._pe_mgrs_to_geog_extended(d,c,g,h,b))&&C(k,c,b);return h}})(F=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,g,h,k,l,m){a._pe.ensureCache.prepare();var d=0;b&&(d=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=q(c,z.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_usng(d,c,g,h,k,l,n))for(k=0;k<c;k++)m[k]=a._pe.UTF8ToString(b[k]);return h};b.usng_to_geog=function(b,c,g,h){a._pe.ensureCache.prepare();
var d=0;b&&(d=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(d=a._pe._pe_usng_to_geog(d,c,g,b))&&C(h,c,b);return d}})(a.PeNotationUsng||(a.PeNotationUsng={}));var G;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
c,g,h,k){a._pe.ensureCache.prepare();var d=0;b&&(d=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=q(c,z.PE_UTM_MAX);var n=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_utm(d,c,g,h,n))for(d=0;d<c;d++)k[d]=a._pe.UTF8ToString(b[d]);return h};b.utm_to_geog=function(b,c,g,h,k){a._pe.ensureCache.prepare();var d=0;b&&(d=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(h=a._pe._pe_utm_to_geog(d,c,g,h,b))&&C(k,c,b);return h}})(G=
a.PeNotationUtm||(a.PeNotationUtm={}));var D;(function(b){var d=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(c,g){void 0===g&&(g=b.PE_PCSINFO_OPTION_DOMAIN);var h,k;d.has(c)&&(k=d.get(c),k[g]&&(h=k[g]));h||(h=a._pe.PePCSInfo.prototype.generate(c,
g),k||(k=[],d.set(c,k)),k[g]=h);return h}})(D=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=l})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(A,a,p){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<
a.length;b++){var c=a[b];c instanceof p?this.steps.push(c):this.steps.push(new p({wkid:c.wkid,wkt:c.wkt,isInverse:c.isInverse}))}}}a.cacheKey=function(a,b){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==b.wkid&&null!==b.wkid?b.wkid.toString():"-1",void 0!==b.wkt&&null!==b.wkt?b.wkt.toString():""].join()};a.fromGE=function(c){var b=new a,l="",g=0;for(c=c.steps;g<c.length;g++){var q=p.fromGE(c[g]);b.steps.push(q);l+=q.uid.toString()+
","}b._cached_projection={};b._gtlistentry=null;b._chain=l;return b};a.prototype.getInverse=function(){var c=new a;c.steps=[];for(var b=this.steps.length-1;0<=b;b--)c.steps.push(this.steps[b].getInverse());return c};a.prototype.getGTListEntry=function(){for(var a="",b=0,l=this.steps;b<l.length;b++)a+=l[b].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(c,b,l){this._cached_projection[a.cacheKey(c,
b)]=l};a.prototype.getCachedGeTransformation=function(c,b){for(var l="",g=0,q=this.steps;g<q.length;g++)l+=q[g].uid.toString()+",";l!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=l);c=this._cached_projection[a.cacheKey(c,b)];return void 0===c?null:c};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(A,a){var p=0;return function(){function a(a){void 0===a&&(a=null);this.uid=p++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(c){var b=new a;b._wkt=c.wkt;b._wkid=c.wkid;b._isInverse=c.isInverse;return b};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=p++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=p++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=p++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var c=new a;c._wkt=this.wkt;c._wkid=this._wkid;c._isInverse=!this.isInverse;return c};return a}()})},"esri/geometry/geometryAdapters/json":function(){define(["require","exports"],function(A,a){Object.defineProperty(a,"__esModule",{value:!0});a.jsonAdapter=
{convertToGEGeometry:function(a,b){return null==b?null:a.convertJSONToGeometry(b)},exportPoint:function(a,b,c){c=new p(a.getPointX(b),a.getPointY(b),c);var g=a.hasZ(b),l=a.hasM(b);g&&(c.z=a.getPointZ(b));l&&(c.m=a.getPointM(b));return c},exportPolygon:function(a,b,c){return new m(a.exportPaths(b),c,a.hasZ(b),a.hasM(b))},exportPolyline:function(a,b,l){return new c(a.exportPaths(b),l,a.hasZ(b),a.hasM(b))},exportMultipoint:function(a,c,l){return new b(a.exportPoints(c),l,a.hasZ(c),a.hasM(c))},exportExtent:function(a,
b,c){var g=a.hasZ(b),m=a.hasM(b);c=new l(a.getXMin(b),a.getYMin(b),a.getXMax(b),a.getYMax(b),c);g&&(g=a.getZExtent(b),c.zmin=g.vmin,c.zmax=g.vmax);m&&(a=a.getMExtent(b),c.mmin=a.vmin,c.mmax=a.vmax);return c}};var p=function(){return function(a,b,c){this.x=a;this.y=b;this.spatialReference=c;this.m=this.z=void 0}}(),m=function(){return function(a,b,c,l){this.rings=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);l&&(this.hasM=l)}}(),c=function(){return function(a,b,c,l){this.paths=
a;this.spatialReference=b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);l&&(this.hasM=l)}}(),b=function(){return function(a,b,c,l){this.points=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);l&&(this.hasM=l)}}(),l=function(){return function(a,b,c,l,m){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=l;this.spatialReference=m;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(A,
a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,
supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports tslib ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(A,a,p,m,c,b,l,g,q,u,C,v,z,E,F){function G(a){return a.substr(24,12)+a.substr(19,4)+a.substr(16,2)+a.substr(14,2)+a.substr(11,2)+a.substr(9,2)+a.substr(6,2)+a.substr(4,2)+a.substr(2,2)+a.substr(0,2)}function D(a,b,c,g){if(c&&"esriFieldTypeDate"===c.type){var d=(new Date(a)).getTime(),k=(new Date(b)).getTime();if(!isNaN(d)&&!isNaN(k))return g?k-d:d-k}return"number"===typeof a&&"number"===typeof b?g?b-a:a-b:"string"===typeof a&&"string"===typeof b?(d=a.toUpperCase(),k=b.toUpperCase(),!c||"esriFieldTypeGUID"!==
c.type&&"esriFieldTypeGlobalID"!==c.type?g=(g?d>k:d<k)?-1:(g?d<k:d>k)?1:0:(a=G(d),k=G(k),g=(g?a>k:a<k)?-1:(g?a<k:a>k)?1:0),g):g?1:-1}Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=
c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(q.isValid(a.outSR)&&!q.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=
F.cleanFromGeometryEngine(p.__assign({spatialReference:a.outSR},z.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):b.queryGeometry=F.cleanFromGeometryEngine(p.__assign({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(d){var c=v.getWhereClause(d.where,this.fieldsIndex);if(!c)return b.resolve(this);if(c.isStandardized){for(var g=0,h=[],k=0,l=this.items;k<l.length;k++){var m=l[k];c.testFeature(m,this.featureAdapter)&&(h[g++]=
m)}c=new a(h,this.queryGeometry,this);c.definitionExpression=d.where;return b.resolve(c)}return b.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=function(d){if(!d.objectIds||!d.objectIds.length)return b.resolve(this);var c=l.SetFromValues(d.objectIds),g=this.featureAdapter.getObjectId;return b.resolve(new a(this.items.filter(function(a){return c.has(g(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(d){d=E.getTimeOperator(this.timeInfo,
d.timeExtent,this.featureAdapter);if(!c.isSome(d))return b.resolve(this);d=this.items.filter(d);return b.resolve(new a(d,this.queryGeometry,this))};a.prototype.filterLatest=function(){for(var d=this.timeInfo,c=d.trackIdField,g=d.startTimeField,d=d.endTimeField||g,g=new Map,h=this.featureAdapter.getAttribute,k=0,l=this.items;k<l.length;k++){var q=l[k],u=h(q,c),p=h(q,d),v=g.get(u);(!v||p>h(v,d))&&g.set(u,q)}c=m.valuesOfMap(g);return b.resolve(new a(c,this.queryGeometry,this))};a.prototype.project=function(b){return p.__awaiter(this,
void 0,void 0,function(){var d,c,g,k=this;return p.__generator(this,function(h){switch(h.label){case 0:if(!b||q.equals(this.spatialReference,b))return[2,this];d=this.featureAdapter;return[4,z.projectMany(this.items.map(function(a){return F.getGeometry(k.geometryType,k.hasZ,k.hasM,d.getGeometry(a))}),this.spatialReference,b)];case 1:return c=h.sent(),g=c.map(function(a,b){return d.cloneWithGeometry(k.items[b],u.convertFromGeometry(a,k.hasZ,k.hasM))}),[2,new a(g,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:b,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._sortFeatures=function(a,b,c){if(1<a.length&&b&&b.length){var d=function(b){b=b.split(" ");var d=b[0],k=g.fieldsIndex.get(d),h=b[1]&&"desc"===b[1].toLowerCase();a.sort(function(a,b){a=c(a,d,k);b=c(b,d,k);return D(a,b,k,h)})},g=this,h=0;for(b=b.reverse();h<b.length;h++)d(b[h])}};a.prototype._createFeatureQueryResponse=
function(a){var b=this,d=this.items,c=this.geometryType,k=this.hasM,h=this.hasZ,l=this.objectIdField,m=this.spatialReference,q=a.outFields,u=a.outSR,v=a.quantizationParameters,x=a.resultRecordCount,z=a.resultOffset,C=a.returnZ,U=a.returnM,E=!1;null!=x&&null!=z&&(x=z+x,E=d.length>x,d=d.slice(z,Math.min(d.length,x)));q=q&&(-1<q.indexOf("*")?p.__spreadArrays(this.fieldsIndex.fields):q.map(function(a){return b.fieldsIndex.get(a)}));return{exceededTransferLimit:E,features:this._createFeatures(a,d),fields:q,
geometryType:c,hasM:k&&U,hasZ:h&&C,objectIdFieldName:l,spatialReference:F.cleanFromGeometryEngine(u?u:m),transform:v&&g.toQuantizationTransform(v)||null}};a.prototype._createFeatures=function(a,b){var c=new C.default(a,this.featureAdapter,this.fieldsIndex),d=a.orderByFields,k=a.quantizationParameters,h=a.returnGeometry,l=a.returnCentroid,n=a.maxAllowableOffset,m=a.returnZ;a=a.returnM;var q=this.hasZ&&(void 0===m?!1:m),u=this.hasM&&(void 0===a?!1:a),m=[];a=0;if(h||l)if(k=g.toQuantizationTransform(k),
h&&!l)for(l=0;l<b.length;l++)h=b[l],m[a++]={attributes:c.getAttributes(h),geometry:F.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(h),n,k,q,u)};else if(!h&&l)for(n=0;n<b.length;n++)h=b[n],m[a++]={attributes:c.getAttributes(h),centroid:F.transformCentroid(this,this.featureAdapter.getCentroid(h,this),k)};else for(l=0;l<b.length;l++)h=b[l],m[a++]={attributes:c.getAttributes(h),centroid:F.transformCentroid(this,this.featureAdapter.getCentroid(h,this),k),geometry:F.getGeometry(this.geometryType,
this.hasZ,this.hasM,this.featureAdapter.getGeometry(h),n,k,q,u)};else for(n=0;n<b.length;n++)h=b[n],(q=c.getAttributes(h))&&(m[a++]={attributes:q});this._sortFeatures(m,d,function(a,b,d){return c.getFieldValue(a,b,d)});return m};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,g=0;for(a=a.outStatistics;g<a.length;g++){var h=a[g];if("exceedslimit"===h.statisticType){c=null!=h.maxPointCount?h.maxPointCount:
Number.POSITIVE_INFINITY;d=null!=h.maxRecordCount?h.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=h.maxVertexCount?h.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter,b=this.items.reduce(function(a,b){b=l.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",
sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=this,c={attributes:{}},d=[],g=new Map,h=new Map,l=new Map,q=new Map,u=new C.default(a,this.featureAdapter,this.fieldsIndex),p=a.outStatistics,v=a.groupByFieldsForStatistics,x=a.having;a=a.orderByFields;for(var z=v&&v.length,E=!!z,U=E&&v[0],A=E&&!this.fieldsIndex.get(U),F=0;F<p.length;F++){var D=p[F],G=D.outStatisticFieldName,aa=D.statisticType,
ja=D,I="exceedslimit"!==aa?D.onStatisticField:void 0,ba="percentile_disc"===aa||"percentile_cont"===aa,qa=E&&1===z&&(I===U||A)&&"count"===aa;if(E){if(!l.has(I)){for(var D=[],aa=0,ca=v;aa<ca.length;aa++){var ha=this._getAttributeValues(u,ca[aa],g);D.push(ha)}l.set(I,this._calculateUniqueValues(D))}var W=l.get(I),D=function(a){var c=W[a];a=c.count;var d=c.data,k=c.items,h=c.itemPositions,c=d.join(",");if(!x||u.validateItems(k,x)){var l=q.get(c)||{attributes:{}},k=null;if(qa)k=a;else{var n=V._getAttributeValues(u,
I,g);a=h.map(function(a){return n[a]});k=ba&&"statisticParameters"in ja?V._getPercentileValue(ja,a):V._getStatisticValue(ja,a)}l.attributes[G]=k;v.forEach(function(a,c){return l.attributes[b.fieldsIndex.get(a)?a:"EXPR_"+(c+1)]=d[c]});q.set(c,l)}},V=this,da;for(da in W)D(da)}else ha=this._getAttributeValues(u,I,g),c.attributes[G]=ba&&"statisticParameters"in ja?this._getPercentileValue(ja,ha):this._getStatisticValue(ja,ha,h);d.push({name:G,alias:G,type:"esriFieldTypeDouble"})}c=E?m.valuesOfMap(q):[c];
this._sortFeatures(c,a,function(a,b){return a.attributes[b]});return{fields:d,features:c}};a.prototype._getStatisticValue=function(a,b,c){var d=a.onStatisticField;a=a.statisticType;b=c&&c.has(d)?c.get(d):this._calculateStatistics(b);c&&c.set(d,b);return b["var"===a?"variance":a]};a.prototype._getPercentileValue=function(a,b){var c=a.statisticParameters,d=a.statisticType,g=c.value,h="desc"===c.orderBy,l=this.fieldsIndex.get(a.onStatisticField);a=p.__spreadArrays(b).sort(function(a,b){return D(a,b,
l,h)});return this._calculatePercentile(a,g,"percentile_disc"===d)};a.prototype._getAttributeValues=function(a,b,c){if(c.has(b))return c.get(b);var d=this.fieldsIndex.get(b),g=this.items.map(function(c){return a.getFieldValue(c,b,d)});c.set(b,g);return g};a.prototype._calculateStatistics=function(a){for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=null,g=null,h=null,l=null,m=[],q=0,u=0;u<a.length;u++){var p=a[u];"string"===typeof p?q++:null==p||isNaN(p)||(d+=p,b=Math.min(b,p),c=Math.max(c,
p),m.push(p),q++)}if(q){g=d/q;for(h=a=0;h<m.length;h++)p=m[h],a+=Math.pow(p-g,2);l=1<q?a/(q-1):0;h=Math.sqrt(l)}else c=b=null;return{avg:g,count:q,max:c,min:b,stddev:h,sum:d,variance:l}};a.prototype._calculateUniqueValues=function(a){for(var b={},c=this.items,d=c.length,g=0;g<d;g++){for(var h=c[g],l=[],m=0,q=a;m<q.length;m++)l.push(q[m][g]);m=l.join(",");null==b[m]?b[m]={count:1,data:l,items:[h],itemPositions:[g]}:(b[m].count++,b[m].items.push(h),b[m].itemPositions.push(g))}return b};a.prototype._calculatePercentile=
function(a,b,c){if(0===a.length)return null;if(0>=b)return a[0];if(1<=b)return a[a.length-1];var d=(a.length-1)*b,g=Math.floor(d);b=g+1;var d=d%1,g=a[g],h=a[b];return b>=a.length||c||"string"===typeof g||"string"===typeof h?g:g*(1-d)+h*d};return a}();a.default=A})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(A,a,p,m){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(a,c,g){this._fieldDataCache=
new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=g;this.featureAdapter=c;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var b=c=0;b<a.length;b++){var l=a[b],p=m.getExpressionFromFieldName(l),v=this.fieldsIndex.get(p),p=v?null:m.getWhereClause(p,g),v=v?v.name:m.getAliasFromFieldName(l)||"FIELD_EXP_"+c++;this._fieldDataCache.set(l,{alias:v,clause:p})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);
return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,c,g){var b=g?g.name:c,l=null;this._fieldDataCache.has(b)?l=this._fieldDataCache.get(b).clause:g||(l=m.getWhereClause(c,this.fieldsIndex),this._fieldDataCache.set(b,{alias:b,clause:l}));return g?this.featureAdapter.getAttribute(a,b):l.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:m.getWhereClause(c,this.fieldsIndex)});
return this._fieldDataCache.get(c).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:m.getWhereClause(c,this.fieldsIndex)});return this._fieldDataCache.get(c).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},m=0;m<b.length;m++){var u=this._fieldDataCache.get(b[m]),
p=u.alias,u=u.clause;c[p]=u?u.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,p)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(p.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var m=0;m<b.length;m++){var u=this._fieldDataCache.get(b[m]).alias;c.push(a[u])}else for(u in a)c.push(a[u]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:
a};return a}();a.default=A})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(A,a){function p(a,c,g,m,u){if(null!=m&&null!=u&&m===u)return function(b){return m>=a.getAttribute(b,c)&&m<=a.getAttribute(b,g)};if(null!=m&&null!=u)return function(b){var l=a.getAttribute(b,c);b=a.getAttribute(b,g);return!(l>u||b<m)};if(null!=m)return function(b){return!(a.getAttribute(b,g)<m)};if(null!=u)return function(b){return!(a.getAttribute(b,c)>u)}}function m(a,c,g,m){if(null!=
g&&null!=m&&g===m)return function(b){return a.getAttribute(b,c)===g};if(null!=g&&null!=m)return function(b){return a.getAttribute(b,c)>=g&&a.getAttribute(b,c)<=m};if(null!=g)return function(b){return a.getAttribute(b,c)>=g};if(null!=m)return function(b){return a.getAttribute(b,c)<=m}}function c(){return function(){return!1}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var b=c.featureAdapter,l=a.startTimeField,m=a.endTimeField,p=Number.POSITIVE_INFINITY,
v=Number.NEGATIVE_INFINITY;if(l&&m)c.forEach(function(a){var c=b.getAttribute(a,l);a=b.getAttribute(a,m);null==c||isNaN(c)||(p=Math.min(p,c));null==a||isNaN(a)||(v=Math.max(v,a))});else{var z=l||m;c.forEach(function(a){a=b.getAttribute(a,z);null==a||isNaN(a)||(p=Math.min(p,a),v=Math.max(v,a))})}return{start:p,end:v}};a.getTimeOperator=function(a,l,g){if(!l||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var u=l.start;l=l.end;return null===u&&null===l?null:void 0===u&&
void 0===l?c():b&&a?p(g,b,a,u,l):m(g,b||a,u,l)}})},"esri/layers/graphics/data/utils":function(){define("require exports tslib ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),function(A,a,p,m,c,b,l,g,q,u,C,v,
z,E,F){function G(a,b,c,d,g){void 0===d&&(d=a.hasZ);void 0===g&&(g=a.hasM);var k=a.hasZ&&d,h=a.hasM&&g;return c?(a=v.quantizeOptimizedGeometry(B,b,a.hasZ,a.hasM,"esriGeometryPoint",c,d,g),v.convertToPoint(a,k,h)):v.convertToPoint(b,k,h)}function D(b,d,k){return p.__awaiter(this,void 0,void 0,function(){var n,m,r,u,t,v;return p.__generator(this,function(p){switch(p.label){case 0:if(!b)return[2,null];n=b.where;b.where=n=n&&n.trim();if(!n||/^1 *= *1$/.test(n)||d&&d===n)b.where=null;return b.geometry?
[4,h(b)]:[2,b];case 1:return m=p.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(r=b.geometry.spatialReference,m=l.getGeometryExtent(m),m.spatialReference=r),b.geometry=m,[4,E.checkProjectionSupport(m.spatialReference,k)];case 2:return p.sent(),[4,q.normalizeCentralMeridian(g.fromJSON(m))];case 3:u=p.sent()[0];if(c.isNone(u))throw a.QUERY_ENGINE_EMPTY_RESULT;t=u.toJSON();return[4,E.project(t,t.spatialReference,k)];case 4:v=p.sent();if(!v)throw a.QUERY_ENGINE_EMPTY_RESULT;
v.spatialReference=k;b.geometry=v;return[2,b]}})})}function h(a){return p.__awaiter(this,void 0,void 0,function(){var c,g,k,h,l,n,m,r,q;return p.__generator(this,function(p){switch(p.label){case 0:c=a.geometry;g=a.distance;k=a.units;if(null==g||"vertexAttributes"in c)return[2,c];h=c.spatialReference;l=k?d.fromJSON(k):b.getUnitString(h);n=h&&(u.isGeographic(h)||u.isWebMercator(h));if(!n)return[3,1];r=c;return[3,3];case 1:return[4,E.checkProjectionSupport(h,u.WGS84).then(function(){return E.project(c,
u.WGS84)})];case 2:r=p.sent(),p.label=3;case 3:return m=r,[4,F.getGeodesicBufferOperator()];case 4:return q=p.sent(),[2,q(m.spatialReference,m,g,l)]}})})}Object.defineProperty(a,"__esModule",{value:!0});var d=new m.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var n=new z.default,t=new z.default,
B=new z.default,k={esriGeometryPoint:v.convertToPoint,esriGeometryPolyline:v.convertToPolyline,esriGeometryPolygon:v.convertToPolygon,esriGeometryMultipoint:v.convertToMultipoint};a.transformCentroid=G;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=C.getCentroidOptimizedGeometry(new z.default,b.geometry,a.hasZ,a.hasM));return G(a,b.centroid,c)};a.getGeometry=function(a,b,c,d,g,h,l,m){void 0===l&&(l=b);void 0===
m&&(m=c);var r=b&&l,p=c&&m;d=d?"coords"in d?d:d.geometry:null;if(!d)return null;if(g)return b=v.generalizeOptimizedGeometry(t,d,b,c,a,g,l,m),h&&(b=v.quantizeOptimizedGeometry(B,b,r,p,a,h)),k[a](b,r,p);if(h)return b=v.quantizeOptimizedGeometry(B,d,b,c,a,h,l,m),k[a](b,r,p);v.removeZMValues(n,d,b,c,l,m);return k[a](n,r,p)};a.normalizeQuery=function(a,b,c){return p.__awaiter(this,void 0,void 0,function(){var d,g,k,h,l;return p.__generator(this,function(n){d=a.outFields;g=a.orderByFields;k=a.groupByFieldsForStatistics;
h=a.outStatistics;if(d)for(l=0;l<d.length;l++)d[l]=d[l].trim();if(g)for(l=0;l<g.length;l++)g[l]=g[l].trim();if(k)for(l=0;l<k.length;l++)k[l]=k[l].trim();if(h)for(l=0;l<h.length;l++)h[l].onStatisticField&&(h[l].onStatisticField=h[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,D(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(d){return[2,D(a,b,c)]})})};a.normalizeQueryLike=
D;a.cleanFromGeometryEngine=function(a){return a&&r in a?JSON.parse(JSON.stringify(a,S)):a};var r="_geVersion",S=function(a,b){return a!==r?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(A,a){function p(a,b,l,g,m,p){p=m?p?4:3:p?3:2;var c=l,q=l+p,u=0,E=0,A=l=0,G=0,D=0;for(--g;D<g;D++,c+=p,q+=p){var h=b[c],d=b[c+1],n=b[c+2],t=b[q],B=b[q+1],k=b[q+2],r=h*B-t*d,A=A+r,u=u+(h+t)*r,E=E+(d+B)*r;m&&(r=h*k-t*n,l+=(n+k)*r,G+=r);h<a[0]&&(a[0]=h);h>a[1]&&(a[1]=h);
d<a[2]&&(a[2]=d);d>a[3]&&(a[3]=d);m&&(n<a[4]&&(a[4]=n),n>a[5]&&(a[5]=n))}0<A&&(A*=-1);0<G&&(G*=-1);if(!A)return null;a=[u,E,.5*A];m&&(a[3]=l,a[4]=.5*G);return a}function m(a,b,l,g,m){m=g?m?4:3:m?3:2;for(var c=b,p=b+m,q=0,z=0,A=0,F=0,G=0,D=l-1;G<D;G++,c+=m,p+=m){var h=a[c],d=a[c+1],n=a[c+2],t=a[p],B=a[p+1],k=a[p+2],r;if(g){r=t-h;var S=B-d,T=k-n;r=Math.sqrt(r*r+S*S+T*T)}else r=t-h,S=B-d,r=Math.sqrt(r*r+S*S);r&&(q+=r,g?(h=[h+.5*(t-h),d+.5*(B-d),n+.5*(k-n)],z+=r*h[0],A+=r*h[1],F+=r*h[2]):(h=[h+.5*(t-
h),d+.5*(B-d)],z+=r*h[0],A+=r*h[1]))}return 0<q?g?[z/q,A/q,F/q]:[z/q,A/q]:0<l?g?[a[b],a[b+1],a[b+2]]:[a[b],a[b+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,b,l,g){if(!b||!b.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var c=a.coords,u=[],C=l?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:
[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],v=b.lengths,z=b.coords,A=l?g?4:3:g?3:2,F=0,G=0;G<v.length;G++){var D=v[G],h=p(C,z,F,D,l,g);h&&u.push(h);F+=D*A}u.sort(function(a,b){var c=a[2]-b[2];0===c&&l&&(c=a[4]-b[4]);return c});u.length&&(A=6*u[0][2],c[0]=u[0][0]/A,c[1]=u[0][1]/A,l&&(A=6*u[0][4],c[2]=0!==A?u[0][3]/A:0),c[0]<C[0]||c[0]>C[1]||c[1]<C[2]||c[1]>C[3]||l&&(c[2]<C[4]||c[2]>C[5]))&&(c.length=0);if(!c.length)if(b=b.lengths[0]?m(z,0,v[0],
l,g):null)c[0]=b[0],c[1]=b[1],l&&2<b.length&&(c[2]=b[2]);else return null;return a};a.lineCentroid=m})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils @dojo/framework/shim/Promise".split(" "),
function(A,a,p,m,c,b,l,g,q,u,C,v,z,E){function F(){return new Promise(function(a,b){A(["../../../geometry/geometryEngineJSON"],a,b)})}Object.defineProperty(a,"__esModule",{value:!0});var G={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},D={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},h={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},d={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=F;a.getGeodesicBufferOperator=function(){return F().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,d,h,k,m){if(g.isPolygon(d)&&"esriGeometryPoint"===h&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var n=C.convertFromPolygon(new v.default,d,!1,!1);return c.resolve(function(a){return u.polygonContainsPoint(n,!1,!1,a)})}if(g.isPolygon(d)&&"esriGeometryMultipoint"===h){var r=C.convertFromPolygon(new v.default,
d,!1,!1);if("esriSpatialRelContains"===a)return c.resolve(function(a){return u.polygonContainsMultipoint(r,!1,!1,a,k,m)})}if(g.isExtent(d)&&"esriGeometryPoint"===h&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return c.resolve(function(a){return b.extentContainsPoint(d,E.getGeometry(h,k,m,a))});if(g.isExtent(d)&&"esriGeometryMultipoint"===h&&"esriSpatialRelContains"===a)return c.resolve(function(a){return b.extentContainsMultipoint(d,E.getGeometry(h,k,m,a))});if(g.isExtent(d)&&"esriSpatialRelIntersects"===
a){var p=l.getExtentIntersector(h);return c.resolve(function(a){return p(d,E.getGeometry(h,k,m,a))})}return F().then(function(b){var c=b[G[a]].bind(null,d.spatialReference,d);return function(a){return c(E.getGeometry(h,k,m,a))}})};a.checkSpatialQuerySupport=function(a,b,c){return p.__awaiter(this,void 0,void 0,function(){var k,l;return p.__generator(this,function(n){k=a.spatialRel;l=a.geometry;if(!l)return[2];if(!0!==D[k])throw new m("feature-store:unsupported-query","Unsupported query spatial relationship",
{query:a});if(!q.isValid(l.spatialReference)||!q.isValid(c))return[2];if(!0!==h[g.getJsonType(l)])throw new m("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==d[b])throw new m("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,z.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(g.isExtent(a))return!0;if(g.isPolygon(a)){var b=0;for(a=a.rings;b<a.length;b++){var c=
a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(A,a){function p(a,c,b,l,g){if(!a)return!1;c=c?b?4:3:b?3:2;b=a.coords;var m=!1,p=0,C=0;for(a=a.lengths;C<a.length;C++){for(var v=a[C],z=p,A=p,F=p+v*c;A<F;A+=c){z=A+c;z===F&&(z=p);var G=b[A],D=b[A+1],h=b[z],z=b[z+1];(D<g&&z>=g||z<g&&D>=g)&&G+(g-D)/(z-D)*(h-
G)<l&&(m=!m)}p+=v*c}return m}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,c,b,l){return p(a,c,b,l.coords[0],l.coords[1])};a.polygonContainsMultipoint=function(a,c,b,l,g,q){g=g?q?4:3:q?3:2;q=l.coords;l=l.lengths;if(!l)return!1;for(var m=0,A=0;m<l.length;m++,A+=g)if(!p(a,c,b,q[A],q[A+1]))return!1;return!0};a.polygonContainsCoords=p})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],function(A,a,p){Object.defineProperty(a,
"__esModule",{value:!0});A=function(){function a(){this._tasks=[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var b=this;return p.create(function(c,l){return b._tasks.push(new m(c,l,a))})};a.prototype.unshift=function(a){var b=this;return p.create(function(c,l){return b._tasks.unshift(new m(c,l,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;var a=this._tasks.shift();try{var c=
a.callback();c&&"then"in c&&"function"===typeof c.then?c.then(a.resolve,a.reject):a.resolve(c)}catch(g){a.reject(g)}return!0};a.prototype.cancelAll=function(){for(var a=p.createAbortError(),c=0,g=this._tasks;c<g.length;c++)g[c].reject(a);this._tasks.length=0};return a}();a.default=A;var m=function(){return function(a,b,l){this.resolve=a;this.reject=b;this.callback=l}}()})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature",
"../OptimizedGeometry"],function(A,a,p,m,c){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,c){return a.attributes[c]},cloneWithGeometry:function(a,c){return new m.default(c,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,l){a.centroid||(a.centroid=p.getCentroidOptimizedGeometry(new c.default,a.geometry,
l.hasZ,l.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports tslib ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(A,a,p,m,c,b){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?b.defaultPointSymbolJSON:
"esriGeometryPolyline"===a?b.defaultPolylineSymbolJSON:b.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(m("csp-restrictions"))return function(){var c;return p.__assign((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",g;for(g in a)c+="this."+g+" \x3d "+JSON.stringify(a[g])+";";var l=new Function(c);return function(){return new l}}catch(v){return function(){var c;return p.__assign((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});
return[{name:"New Feature",description:"",prototype:{attributes:c.clone(a)}}]}})},"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports tslib ../../../../geometry/support/spatialReferenceUtils ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),function(A,a,p,m,c){function b(a){return new q(a)}function l(){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(a){switch(a.label){case 0:return v?[2,v]:[4,new Promise(function(a,
b){A(["../../../../geometry/geometryEngineJSON"],a,b)})];case 1:return v=a.sent(),[2,v]}})})}Object.defineProperty(a,"__esModule",{value:!0});var g=function(){return function(){this.description=this.code=null}}(),q=function(){return function(a){this.error=new g;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=b;var u=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();a.createFeatureEditSuccessResult=
function(a){return new u(a)};var C=new Set;a.mixAttributes=function(a,g,l,m,p,h){void 0===p&&(p=!1);C.clear();for(var d in m){var n=a.get(d);if(n){var u=m[d],q;q=n;var k=u,r=k;"string"===typeof k&&c.isNumericField(q)?r=parseFloat(k):null!=k&&c.isStringField(q)&&"string"!==typeof k&&(r=String(k));q=c.sanitizeNullFieldValue(r);q!==u&&h&&h.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:n,originalValue:u,sanitizedValue:q}});C.add(n.name);
if(n&&(p||n.editable)){if(u=c.validateFieldValue(n,q))return b(c.validationErrorToString(u,n,q));l[n.name]=q}}}for(a=0;a<g.length;a++)if(l=g[a],!C.has(l.name))return b('missing required field "'+l.name+'"');return null};var v;a.simplify=function(a,b){if(!a||!m.isValid(b))return a;if("rings"in a||"paths"in a){if(!v)throw new TypeError("geometry engine not loaded");return v.simplify(b,a)}return a};a.loadGeometryEngine=l;a.loadGeometryEngineForSimplify=function(a,b){return p.__awaiter(this,void 0,void 0,
function(){return p.__generator(this,function(c){switch(c.label){case 0:return!m.isValid(a)||"esriGeometryPolygon"!==b&&"esriGeometryPolyline"!==b?[3,2]:[4,l()];case 1:c.sent(),c.label=2;case 2:return[2]}})})}})},"*noref":1}});
define("require exports tslib ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ./sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(A,a,p,m,c,b,l,g,q,u,C,v,z,E,F,G){function D(a){return b.isPoint(a)?null!=a.z:!!a.hasZ}
function h(a){return b.isPoint(a)?null!=a.m:!!a.hasM}Object.defineProperty(a,"__esModule",{value:!0});var d=l.WGS84,n={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:l.WGS84},t={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,
supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};A=function(){function a(){this._nextObjectId=this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null};
a.prototype.load=function(a){return p.__awaiter(this,void 0,void 0,function(){var b,c,g,k,h,l,x,z,A,B,D,P,wa,Ma,aa,ja,I,ba,qa,ca,ha,W,V,da,ia,Na;return p.__generator(this,function(r){switch(r.label){case 0:b=[];c=a.features;g=this._inferLayerProperties(c,a.fields);k=a.fields||[];h=null!=a.hasM?a.hasM:g.hasM;l=null!=a.hasZ?a.hasZ:g.hasZ;z=(x=!a.spatialReference&&!g.spatialReference)?d:a.spatialReference||g.spatialReference;A=x?n:null;B=a.geometryType||g.geometryType;D=a.objectIdField||g.objectIdField;
P=a.timeInfo;x&&b.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"});if(!B)throw new m("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!D)throw new m("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");g.objectIdField&&D!==g.objectIdField&&(b.push({name:"feature-layer:duplicated-oid-field",message:'Provided objectIdField "'+
D+'" doesn\'t match the field name "'+g.objectIdField+'", found in the provided fields'}),D=g.objectIdField);D&&!g.objectIdField&&(wa=null,(Ma=k.some(function(a){return a.name===D?(wa=a,!0):!1}))?(wa.type="esriFieldTypeOID",wa.editable=!1,wa.nullable=!1):k.unshift({alias:D,name:D,type:"esriFieldTypeOID",editable:!1,nullable:!1}));aa=0;for(ja=k;aa<ja.length;aa++){I=ja[aa];null==I.name&&(I.name=I.alias);null==I.alias&&(I.alias=I.name);if(!I.name)throw new m("feature-layer:invalid-field-name","field name is missing",
{field:I});I.name===D&&(I.type="esriFieldTypeOID");if(-1===F.kebabDict.jsonValues.indexOf(I.type))throw new m("feature-layer:invalid-field-type",'invalid type for field "'+I.name+'"',{field:I});}ba={};this._requiredFields=[];qa=0;for(ca=k;qa<ca.length;qa++)I=ca[qa],"esriFieldTypeOID"!==I.type&&"esriFieldTypeGlobalID"!==I.type&&(I.editable=null==I.editable?!0:!!I.editable,I.nullable=null==I.nullable?!0:!!I.nullable,ha=G.getFieldDefaultValue(I),I.nullable||void 0!==ha?ba[I.name]=ha:this._requiredFields.push(I));
this._fieldsIndex=new E(k);this._createDefaultAttributes=v.createDefaultAttributesFunction(ba,D);P&&(P.startTimeField&&((W=this._fieldsIndex.get(P.startTimeField))?(P.startTimeField=W.name,W.type="esriFieldTypeDate"):P.startTimeField=null),P.endTimeField&&((V=this._fieldsIndex.get(P.endTimeField))?(P.endTimeField=V.name,V.type="esriFieldTypeDate"):P.endTimeField=null),P.trackIdField&&((da=this._fieldsIndex.get(P.trackIdField))?P.trackIdField=da.name:(P.trackIdField=null,b.push({name:"feature-layer:invalid-timeInfo-trackIdField",
message:"trackIdField is missing",details:{timeInfo:P}}))),P.startTimeField||P.endTimeField||(b.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:P}}),P=null));ia={warnings:b,featureErrors:[],layerDefinition:p.__assign(p.__assign({},t),{drawingInfo:v.createDrawingInfo(B),templates:v.createDefaultTemplate(ba),extent:A,geometryType:B,objectIdField:D,fields:k,hasZ:!!l,hasM:!!h,timeInfo:P}),assignedObjectIds:{}};this._queryEngine=
new C.default({fields:k,geometryType:B,hasM:h,hasZ:l,objectIdField:D,spatialReference:z,featureStore:new q.default({geometryType:B,hasM:h,hasZ:l}),timeInfo:P});if(!c||!c.length)return this._nextObjectId=1,[2,ia];Na=c.reduce(function(a,b){b=b.attributes&&b.attributes[D];return null==b||isNaN(b)||!isFinite(b)?a:Math.max(a,b)},0);this._nextObjectId=1+Na;return[4,u.checkProjectionSupport(c,z)];case 1:return r.sent(),[2,this._loadInitialFeatures(ia,c)]}})})};a.prototype.applyEdits=function(a){return p.__awaiter(this,
void 0,void 0,function(){var b,d,g;return p.__generator(this,function(k){switch(k.label){case 0:return b=this._queryEngine,d=b.spatialReference,g=b.geometryType,[4,c.all([z.loadGeometryEngineForSimplify(d,g),u.checkProjectionSupport(a.adds,d),u.checkProjectionSupport(a.updates,d)])];case 1:return k.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,b){void 0===b&&(b={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQuery(a,
b.signal)]})})};a.prototype.queryFeatureCount=function(a,b){void 0===b&&(b={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};a.prototype.queryObjectIds=function(a,b){void 0===b&&(b={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};a.prototype.queryExtent=function(a,b){void 0===b&&(b={});return p.__awaiter(this,
void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};a.prototype._inferLayerProperties=function(a,c){for(var d=void 0,g=void 0,k=null,l=null,m=null,n=0;n<a.length;n++){var p=a[n].geometry;if(p&&(k||(k=b.getJsonType(p)),l||(l=p.spatialReference),null==d&&(d=D(p)),null==g&&(g=h(p)),k&&l&&null!=d&&null!=g))break}if(c&&c.length){var r=null;c.some(function(a){var b="esriFieldTypeOID"===a.type,c=!a.type&&a.name&&"objectid"===a.name.toLowerCase();
r=a;return b||c})&&(m=r.name)}return{geometryType:k,spatialReference:l,objectIdField:m,hasM:g,hasZ:d}};a.prototype._loadInitialFeatures=function(a,c){for(var d=this._queryEngine,h=d.geometryType,k=d.hasM,l=d.hasZ,m=d.objectIdField,n=d.spatialReference,d=d.featureStore,p=[],r=0;r<c.length;r++){var q=c[r];null!=q.uid&&(a.assignedObjectIds[q.uid]=-1);if(q.geometry&&h!==b.getJsonType(q.geometry))a.featureErrors.push(z.createFeatureEditErrorResult("Incorrect geometry type."));else{var t=this._createDefaultAttributes(),
v=z.mixAttributes(this._fieldsIndex,this._requiredFields,t,q.attributes,!0,a.warnings);v?a.featureErrors.push(v):(this._assignObjectId(t,q.attributes,!0),q.attributes=t,null!=q.uid&&(a.assignedObjectIds[q.uid]=q.attributes[m]),q.geometry&&(q.geometry=u.project(q.geometry,q.geometry.spatialReference,n)),p.push(q))}}d.addMany(g.convertFromFeatures([],p,h,l,k,m));a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(c=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=
[c.start,c.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(d,b);c&&c.length&&this._applyUpdateEdits(d,c);if(a&&a.length){for(b=0;b<a.length;b++)d.deleteResults.push(z.createFeatureEditSuccessResult(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:d}};a.prototype._applyAddEdits=function(a,
c){for(var d=a.addResults,h=this._queryEngine,k=h.geometryType,l=h.hasM,m=h.hasZ,n=h.objectIdField,p=h.spatialReference,h=h.featureStore,q=[],r=0;r<c.length;r++){var t=c[r];if(t.geometry&&k!==b.getJsonType(t.geometry))d.push(z.createFeatureEditErrorResult("Incorrect geometry type."));else{var v=this._createDefaultAttributes(),A=z.mixAttributes(this._fieldsIndex,this._requiredFields,v,t.attributes);A?d.push(A):(this._assignObjectId(v,t.attributes),t.attributes=v,null!=t.uid&&(a.uidToObjectId[t.uid]=
t.attributes[n]),t.geometry&&(t.geometry=u.project(z.simplify(t.geometry,p),t.geometry.spatialReference,p)),q.push(t),d.push(z.createFeatureEditSuccessResult(t.attributes[n])))}}h.addMany(g.convertFromFeatures([],q,k,m,l,n))};a.prototype._applyUpdateEdits=function(a,c){a=a.updateResults;for(var d=this._queryEngine,h=d.geometryType,k=d.hasM,l=d.hasZ,m=d.objectIdField,n=d.spatialReference,d=d.featureStore,p=0;p<c.length;p++){var q=c[p],r=q.attributes,t=q.geometry,q=r&&r[m];if(null==q)a.push(z.createFeatureEditErrorResult("Identifier field "+
m+" missing"));else if(d.has(q)){var v=g.convertToFeature(d.getFeature(q),h,l,k);if(t){if(h!==b.getJsonType(t)){a.push(z.createFeatureEditErrorResult("Incorrect geometry type."));continue}v.geometry=u.project(z.simplify(t,n),t.spatialReference,n)}if(r&&(r=z.mixAttributes(this._fieldsIndex,this._requiredFields,v.attributes,r))){a.push(r);continue}d.add(g.convertFromFeature(v,h,l,k,m));a.push(z.createFeatureEditSuccessResult(q))}else a.push(z.createFeatureEditErrorResult("Feature with object id "+q+
" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var d=this._queryEngine.objectIdField;c?b&&isFinite(b[d])?a[d]=b[d]:a[d]=this._nextObjectId++:a[d]=this._nextObjectId++};return a}();a.default=A});