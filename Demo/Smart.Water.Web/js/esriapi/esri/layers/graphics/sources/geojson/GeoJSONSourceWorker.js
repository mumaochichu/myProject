// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/data/FeatureStore":function(){define("require exports tslib ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),function(z,a,p,n,h,b,m,g,t,r,A,u,B,G){Object.defineProperty(a,"__esModule",{value:!0});
var D=b.getLogger("esri.layers.graphics.data.FeatureStore");z=function(){function a(a){this.geometryInfo=a;this._boundsStore=new u.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new h;this.featureAdapter=G.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var l=t.create(t.NEGATIVE_INFINITY);this._featuresById.forEach(function(e){if(e=a._boundsStore.get(e.objectId))l[0]=Math.min(e[0],
l[0]),l[1]=Math.min(e[1],l[1]),l[2]=Math.max(e[2],l[2]),l[3]=Math.max(e[3],l[3])});return l},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(l){l.geometry&&l.geometry.coords&&(a+=l.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=function(a){this._add(a);this._emitChanged()};a.prototype.addMany=
function(a){for(var l=0;l<a.length;l++)this._add(a[l]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var l=0;l<a.length;l++){var e=this._featuresById.get(a[l]);e&&this._remove(e)}this._emitChanged()};a.prototype.forEachBounds=
function(a,l,e){for(var k=0;k<a.length;k++){var c=this._boundsStore.get(a[k].objectId);c&&l(g.fromRect(e,c))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(l){return a(l)})};a.prototype.forEachInBounds=function(a,l){var e=this;this._boundsStore.forEachInBounds(a,function(a){l(e._featuresById.get(a))})};a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();
this._markedIds.clear()};a.prototype.sweep=function(){var a=this,l=!1;this._featuresById.forEach(function(e,k){a._markedIds.has(k)||(l=!0,a._remove(e))});this._markedIds.clear();l&&this._emitChanged()};a.prototype.executeTileQuery=function(a,l,e){return p.__awaiter(this,void 0,void 0,function(){var k,c,q,b,h,g,m,G,D,J,C,F,R,n;return p.__generator(this,function(w){k=e.returnGeometry;c=e.returnCentroid;q=e.returnOutline;b=e.pixelBuffer;h=new Set;g=[];m=b*a.resolution;G=t.pad(a.bounds,m,t.create());
B.createTileFeatures(g,h,this.geometryInfo,this,G,k,c,q,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||c)if(D=r.getInfo(l))J=D.valid,C=J[0],F=J[1],G[0]<C&&(R=t.fromValues(F-m,G[1],F,G[3]),B.createTileFeatures(g,h,this.geometryInfo,this,R,k,c,q,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[F,a.bounds[3]]})),G[2]>F&&(n=t.fromValues(C,G[1],C+m,G[3]),B.createTileFeatures(g,h,this.geometryInfo,
this,n,k,c,q,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[C-F+a.bounds[0],a.bounds[3]]}));g.sort(function(a,e){return a.localId-e.localId});return[2,{features:g,objectIds:h}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var l=a.objectId;if(null==l)D.error(new n("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var e=this._featuresById.get(l),k;this._markedIds.add(l);if(e)a.localId=
e.localId,k=this._boundsStore.get(l),this._boundsStore.delete(l);else if(m.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(k=A.getBoundsOptimizedGeometry(k||t.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(l,k)):this._boundsStore.set(l,null);this._featuresById.set(l,a)}}};a.prototype._remove=function(a){if(m.isSome(this.onFeatureRemove))this.onFeatureRemove(a);this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);
this._featuresById.delete(a.objectId);return a};return a}();a.default=z})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(z,a,p,n){Object.defineProperty(a,"__esModule",{value:!0});var h={minX:0,minY:0,maxX:0,maxY:0};z=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=n(9,p("csp-restrictions")?
function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),h=0;a._idByBounds.forEach(function(a,g){b[h++]=g});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();
this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,b){this._loadIndex();var g=0,m=this._index;h.minX=a[0];h.minY=a[1];h.maxX=a[2];h.maxY=a[3];for(a=m.search(h);g<a.length;g++)b(this._idByBounds.get(a[g]))};a.prototype.get=function(a){return this._boundsById.get(a)};a.prototype.has=function(a){return this._boundsById.has(a)};
a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var h=this._boundsById.get(a);h&&(this._index.remove(h),this._idByBounds.delete(h))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||(this._boundsToLoad.push(b),5E4<this._boundsToLoad.length&&this._loadIndex()))};return a}();a.BoundsStore=z})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(z){function a(b,h){if(!(this instanceof a))return new a(b,h);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));h&&("function"===typeof h?this.toBBox=h:this._initFormat(h));this.clear()}function p(a,b){n(a,0,a.children.length,b,a)}function n(a,b,g,m,l){l||(l=u(null));l.minX=Infinity;l.minY=Infinity;l.maxX=-Infinity;l.maxY=-Infinity;for(var e;b<g;b++)e=a.children[b],h(l,a.leaf?m(e):e);return l}function h(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function b(a,b){return a.minX-b.minX}function m(a,b){return a.minY-b.minY}function g(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function t(a){return a.maxX-a.minX+(a.maxY-a.minY)}function r(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function A(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function u(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function B(a,b,h,g,l){for(var e=[b,h],k;e.length;)h=e.pop(),b=e.pop(),h-b<=g||(k=b+Math.ceil((h-b)/g/2)*g,z(a,k,b,h,l),e.push(b,k,k,h))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,h=[],g=this.toBBox;if(!A(a,b))return h;for(var l=[],e,k,c,q;b;){e=0;for(k=b.children.length;e<k;e++)c=b.children[e],q=b.leaf?g(c):c,A(a,q)&&(b.leaf?h.push(c):r(a,q)?this._all(c,h):l.push(c));b=l.pop()}return h},collides:function(a){var b=
this.data,h=this.toBBox;if(!A(a,b))return!1;for(var g=[],l,e,k,c;b;){l=0;for(e=b.children.length;l<e;l++)if(k=b.children[l],c=b.leaf?h(k):k,A(a,c)){if(b.leaf||r(a,c))return!0;g.push(k)}b=g.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,h=a.length;b<h;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=u([]);return this},remove:function(a,b){if(!a)return this;for(var h=this.data,g=this.toBBox(a),l=[],e=[],k,c,q,w;h||l.length;){h||(h=l.pop(),c=l[l.length-1],k=e.pop(),w=!0);if(h.leaf){a:{q=a;var x=h.children,m=b;if(m){for(var t=0;t<x.length;t++)if(m(q,x[t])){q=t;break a}q=-1}else q=x.indexOf(q)}if(-1!==q){h.children.splice(q,
1);l.push(h);this._condense(l);break}}w||h.leaf||!r(h,g)?c?(k++,h=c.children[k],w=!1):h=null:(l.push(h),e.push(k),k=0,c=h,h=h.children[0])}return this},toBBox:function(a){return a},compareMinX:b,compareMinY:m,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var h=[];a;)a.leaf?b.push.apply(b,a.children):h.push.apply(h,a.children),a=h.pop();return b},_build:function(a,b,h,g){var l=h-b+1,e=this._maxEntries,k;if(l<=e)return k=u(a.slice(b,h+1)),p(k,
this.toBBox),k;g||(g=Math.ceil(Math.log(l)/Math.log(e)),e=Math.ceil(l/Math.pow(e,g-1)));k=u([]);k.leaf=!1;k.height=g;var l=Math.ceil(l/e),e=l*Math.ceil(Math.sqrt(e)),c,q,w;for(B(a,b,h,e,this.compareMinX);b<=h;b+=e)for(q=Math.min(b+e-1,h),B(a,b,q,l,this.compareMinY),c=b;c<=q;c+=l)w=Math.min(c+l-1,q),k.children.push(this._build(a,c,w,g-1));p(k,this.toBBox);return k},_chooseSubtree:function(a,b,h,m){for(var l,e,k,c,q,w,x,t;;){m.push(b);if(b.leaf||m.length-1===h)break;x=t=Infinity;l=0;for(e=b.children.length;l<
e;l++)k=b.children[l],q=g(k),w=(Math.max(k.maxX,a.maxX)-Math.min(k.minX,a.minX))*(Math.max(k.maxY,a.maxY)-Math.min(k.minY,a.minY))-q,w<t?(t=w,x=q<x?q:x,c=k):w===t&&q<x&&(x=q,c=k);b=c||b.children[0]}return b},_insert:function(a,b,g){var m=this.toBBox;g=g?a:m(a);var m=[],l=this._chooseSubtree(g,this.data,b,m);l.children.push(a);for(h(l,g);0<=b;)if(m[b].children.length>this._maxEntries)this._split(m,b),b--;else break;this._adjustParentBBoxes(g,m,b)},_split:function(a,b){var h=a[b],g=h.children.length,
l=this._minEntries;this._chooseSplitAxis(h,l,g);g=this._chooseSplitIndex(h,l,g);g=u(h.children.splice(g,h.children.length-g));g.height=h.height;g.leaf=h.leaf;p(h,this.toBBox);p(g,this.toBBox);b?a[b-1].children.push(g):this._splitRoot(h,g)},_splitRoot:function(a,b){this.data=u([a,b]);this.data.height=a.height+1;this.data.leaf=!1;p(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,h){var m,l,e,k,c,q,w;c=q=Infinity;for(m=b;m<=h-b;m++)l=n(a,0,m,this.toBBox),e=n(a,m,h,this.toBBox),k=Math.max(0,Math.min(l.maxX,
e.maxX)-Math.max(l.minX,e.minX))*Math.max(0,Math.min(l.maxY,e.maxY)-Math.max(l.minY,e.minY)),l=g(l)+g(e),k<c?(c=k,w=m,q=l<q?l:q):k===c&&l<q&&(q=l,w=m);return w},_chooseSplitAxis:function(a,h,g){var t=a.leaf?this.compareMinX:b,l=a.leaf?this.compareMinY:m,e=this._allDistMargin(a,h,g,t);h=this._allDistMargin(a,h,g,l);e<h&&a.children.sort(t)},_allDistMargin:function(a,b,g,m){a.children.sort(m);m=this.toBBox;var l=n(a,0,b,m),e=n(a,g-b,g,m),k=t(l)+t(e),c,q;for(c=b;c<g-b;c++)q=a.children[c],h(l,a.leaf?m(q):
q),k+=t(l);for(c=g-b-1;c>=b;c--)q=a.children[c],h(e,a.leaf?m(q):q),k+=t(e);return k},_adjustParentBBoxes:function(a,b,g){for(;0<=g;g--)h(b[g],a)},_condense:function(a){for(var b=a.length-1,h;0<=b;b--)0===a[b].children.length?0<b?(h=a[b-1].children,h.splice(h.indexOf(a[b]),1)):this.clear():p(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function z(n,h,b,m,g){for(;m>b;){if(600<m-b){var t=m-b+1,r=h-b+1,A=Math.log(t),u=.5*Math.exp(2*A/3),A=.5*Math.sqrt(A*u*(t-u)/t)*(0>r-t/2?-1:1);z(n,h,Math.max(b,Math.floor(h-r*u/t+A)),Math.min(m,Math.floor(h+(t-r)*u/t+A)),g)}t=n[h];r=b;u=m;a(n,b,h);for(0<g(n[m],t)&&a(n,b,m);r<u;){a(n,r,u);r++;for(u--;0>g(n[r],t);)r++;for(;0<g(n[u],t);)u--}0===g(n[b],t)?
a(n,b,u):(u++,a(n,u,m));u<=h&&(b=u+1);h<=u&&(m=u-1)}}function a(a,h,b){var m=a[h];a[h]=a[b];a[b]=m}function p(a,h){return a<h?-1:a>h?1:0}return function(a,h,b,m,g){z(a,h,b||0,m||a.length-1,g||p)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),function(z,a,p,n,h,b,m){function g(a,b,h,g,m,t){a.lengths.length&&(a.lengths.length=0);a.coords.length&&
(a.coords.length=0);if(!b||!b.coords.length)return null;var l=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=n.quantizeX(t,l[0]),a.coords[1]=n.quantizeY(t,l[1]),a.coords.length=h,a;for(var e,k,c,q,w=0,x,r=0,S=0;S<b.length;S++){var A=b[S];if(!(A<g))if(x=r,c=e=n.quantizeX(t,l[w]),q=k=n.quantizeY(t,l[w+1]),a.coords[x]=c,a.coords[x+1]=q,w+=h,1===A)a.lengths.push(1),r=x+2;else{c=n.quantizeX(t,l[w]);q=n.quantizeY(t,l[w+1]);var u=c-e,J=q-k,C=J/u;x+=2;a.coords[x]=u;a.coords[x+1]=J;e=c;k=q;for(var w=
w+h,F=2;F<A;F++){c=n.quantizeX(t,l[w]);q=n.quantizeY(t,l[w+1]);if(c!==e||q!==k){e=c-e;k=q-k;var R=k/e,C=C===R||!isFinite(C)&&!isFinite(R),ka=(0<=J&&0<=k||0>=J&&0>=k)&&(0<=u&&0<=e||0>=u&&0>=e);C&&(m||ka)?(u+=e,J+=k):(u=e,J=k,x+=2);a.coords[x]=u;a.coords[x+1]=J;C=R;e=c;k=q}w+=h}c=(x+2-r)/2;c>=g&&(a.lengths.push(c),r=x+2)}}a.coords.length>r&&(a.coords.length=r);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});var t=new h.default,r={esriGeometryPoint:n.convertToPoint,esriGeometryPolyline:n.convertToPolyline,
esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};a.executeTileQueryForIds=function(a,b,h){b=p.pad(b.bounds,h.pixelBuffer*b.resolution,p.create());var g=[];a.featureStore.forEachInBounds(b,function(b){return g.push(a.featureAdapter.getObjectId(b))});return g};a.createTileFeatures=function(a,h,n,p,H,z,l,e,k){var c=r[n.geometryType],q=A[n.geometryType],w="esriGeometryPolygon"===n.geometryType&&!e,x=n.hasZ?n.hasM?4:3:n.hasM?3:2;l&&!z?p.forEachInBounds(H,function(e){if(!h.has(e.objectId)){var c=
m.getCentroid(n,e,k),g=e.attributes;c&&(h.add(e.objectId),a.push(new b.Feature(g,e.localId,null,c)))}}):z&&!l?p.forEachInBounds(H,function(e){if(!h.has(e.objectId)){var l=e.attributes,m=c(g(t,e.geometry,x,q,w,k),!1,!1);m&&(h.add(e.objectId),a.push(new b.Feature(l,e.localId,m,null)))}}):p.forEachInBounds(H,function(e){if(!h.has(e.objectId)){var l=m.getCentroid(n,e,k),r=e.attributes,A=c(g(t,e.geometry,x,q,w,k),!1,!1);A&&l&&(h.add(e.objectId),a.push(new b.Feature(r,e.localId,A,l)))}})};var A={esriGeometryPoint:0,
esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=g})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports tslib ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(z,a,p,n,h,b,m,g,t,r,A,u,B,G,D,H,E,l,e,k,c,q,w,x){function Y(a){return a.every(function(a){return"exceedslimit"!==a.statisticType})}Object.defineProperty(a,"__esModule",{value:!0});z=function(){return function(a,e,b,h,C){void 0===e&&(e=null);this.attributes=a;this.geometry=b;this.centroid=h;this.filterFlags=C;this.groupId=-1;this.localId=e}}();a.Feature=z;var S=new Set,ta=new m.MemCacheStorage(2E6),aa=0;z=function(){function a(a){var e=this;this.capabilities={query:l.queryCapabilities};this.geometryType=
a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return e.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new m.MemCache(aa++ +"$$",ta));this.fieldsIndex=new w(a.fields);a.scheduler&&a.task&&(this._frameQueue=new x.default,this._frameTask=
a.scheduler.registerTask(a.task,function(a){return e._update(a)},function(){return 0<e._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:q.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=c.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});
a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,C,c,k=this;return p.__generator(this,function(l){switch(l.label){case 0:b=h.clone(a),l.label=1;case 1:return l.trys.push([1,8,,9]),[4,this._schedule(function(){return q.normalizeQuery(b,k.definitionExpression,k.spatialReference)})];case 2:return b=l.sent(),
[4,this._reschedule(function(){return k._checkQuerySupport(b)})];case 3:return b=l.sent(),[4,this._reschedule(function(){return k._executeGeometryQuery(b)})];case 4:return C=l.sent(),[4,this._reschedule(function(){return C.executeObjectIdsQuery(b)})];case 5:return C=l.sent(),[4,this._reschedule(function(){return C.executeTimeQuery(b)})];case 6:return C=l.sent(),[4,this._reschedule(function(){return C.executeAttributesQuery(b)})];case 7:return C=l.sent(),[3,9];case 8:c=l.sent();if(c!==q.QUERY_ENGINE_EMPTY_RESULT)throw c;
C=new e.default([],null,this);return[3,9];case 9:return[2,C.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,e,C,c=this;return p.__generator(this,function(k){switch(k.label){case 0:b=h.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,k.label=1;case 1:return k.trys.push([1,8,,9]),[4,this._schedule(function(){return q.normalizeQuery(b,c.definitionExpression,c.spatialReference)})];case 2:return b=
k.sent(),[4,this._reschedule(function(){return c._checkQuerySupport(b)})];case 3:return b=k.sent(),[4,this._reschedule(function(){return c._executeGeometryQuery(b)})];case 4:return e=k.sent(),[4,this._reschedule(function(){return e.executeObjectIdsQuery(b)})];case 5:return e=k.sent(),[4,this._reschedule(function(){return e.executeTimeQuery(b)})];case 6:return e=k.sent(),[4,this._reschedule(function(){return e.executeAttributesQuery(b)})];case 7:return e=k.sent(),[2,e.size];case 8:C=k.sent();if(C!==
q.QUERY_ENGINE_EMPTY_RESULT)throw C;return[2,0];case 9:return[2]}})})};a.prototype.executeQueryForExtent=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,e,c,k,l,g,w,x,m=this;return p.__generator(this,function(F){switch(F.label){case 0:b=h.clone(a),c=b.outSR,F.label=1;case 1:return F.trys.push([1,8,,9]),[4,this._schedule(function(){return q.normalizeQuery(b,m.definitionExpression,m.spatialReference)})];case 2:return b=F.sent(),[4,this._reschedule(function(){return m._checkQuerySupport(b)})];
case 3:return b=F.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return m._executeGeometryQuery(b)})];case 4:return e=F.sent(),[4,this._reschedule(function(){return e.executeObjectIdsQuery(b)})];case 5:return e=F.sent(),[4,this._reschedule(function(){return e.executeTimeQuery(b)})];case 6:return e=F.sent(),[4,this._reschedule(function(){return e.executeAttributesQuery(b)})];case 7:e=F.sent();k=e.size;if(!k)return[2,{count:k,extent:null}];A.set(C,A.NEGATIVE_INFINITY);
this.featureStore.forEachBounds(e.items,function(a){return A.expand(C,a)},J);l={xmin:C[0],ymin:C[1],xmax:C[3],ymax:C[4],spatialReference:q.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(C[2])&&isFinite(C[5])&&(l.zmin=C[2],l.zmax=C[5]);g=E.project(l,e.spatialReference,c);g.spatialReference=q.cleanFromGeometryEngine(c||this.spatialReference);0===g.xmax-g.xmin&&(w=r.getMetersPerUnitForSR(g.spatialReference),g.xmin-=w,g.xmax+=w);0===g.ymax-g.ymin&&(w=r.getMetersPerUnitForSR(g.spatialReference),
g.ymin-=w,g.ymax+=w);this.hasZ&&null!=g.zmin&&null!=g.zmax&&0===g.zmax-g.zmin&&(w=r.getMetersPerUnitForSR(g.spatialReference),g.zmin-=w,g.zmax+=w);return[2,{count:k,extent:g}];case 8:x=F.sent();if(x===q.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw x;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(e){return[2,this.executeQueryForIdSet(a,b).then(function(a){return t.valuesOfSet(a)})]})})};
a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,e,C,c,k,g=this;return p.__generator(this,function(l){switch(l.label){case 0:b=h.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,l.label=1;case 1:return l.trys.push([1,9,,10]),[4,this._schedule(function(){return q.normalizeQuery(b,g.definitionExpression,g.spatialReference)})];case 2:return b=l.sent(),[4,this._reschedule(function(){return g._checkQuerySupport(b)})];
case 3:return b=l.sent(),[4,this._reschedule(function(){return g._executeGeometryQuery(b)})];case 4:return e=l.sent(),[4,this._reschedule(function(){return e.executeObjectIdsQuery(b)})];case 5:return e=l.sent(),[4,this._reschedule(function(){return e.executeTimeQuery(b)})];case 6:return e=l.sent(),[4,this._reschedule(function(){return e.executeAttributesQuery(b)})];case 7:return e=l.sent(),C=e.items,c=new Set,[4,this._reschedule(function(){for(var a=0,b=C;a<b.length;a++)c.add(e.featureAdapter.getObjectId(b[a]))})];
case 8:return l.sent(),[2,c];case 9:k=l.sent();if(k===q.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw k;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){void 0===a&&(a={});return p.__awaiter(this,void 0,void 0,function(){var b,C,c,k=this;return p.__generator(this,function(g){switch(g.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new n("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});
b=h.clone(a);g.label=1;case 1:return g.trys.push([1,9,,10]),[4,this._schedule(function(){return q.normalizeQuery(b,k.definitionExpression,k.spatialReference)})];case 2:return b=g.sent(),[4,this._reschedule(function(){return k._checkQuerySupport(b)})];case 3:return b=g.sent(),[4,this._reschedule(function(){return k._executeGeometryQuery(b)})];case 4:return C=g.sent(),[4,this._reschedule(function(){return C.executeObjectIdsQuery(b)})];case 5:return C=g.sent(),[4,this._reschedule(function(){return C.executeTimeQuery(b)})];
case 6:return C=g.sent(),[4,this._reschedule(function(){return C.executeAttributesQuery(b)})];case 7:return C=g.sent(),[4,this._reschedule(function(){return C.filterLatest()})];case 8:return C=g.sent(),[3,10];case 9:c=g.sent();if(c!==q.QUERY_ENGINE_EMPTY_RESULT)throw c;C=new e.default([],null,this);return[3,10];case 10:return[2,C.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(b){return this._frameQueue?
[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=
new e.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return p.__awaiter(this,void 0,void 0,function(){var C,c,h,g,l,q,w,x,m,F,t,R,J,r,S,n,A,Y,u,ta,B=this;return p.__generator(this,function(ka){switch(ka.label){case 0:C=a.geometry;c=a.outSR;h=a.spatialRel;g=D.isValid(c)&&!D.equals(this.spatialReference,c);if(l=this._geometryQueryCache?g?JSON.stringify({geometry:C,spatialRelationship:h,outSpatialReference:c}):JSON.stringify({geometry:C,spatialRelationship:h}):
null)if(q=this._geometryQueryCache.get(l),!b.isUndefined(q))return[2,q];w=function(b){return p.__awaiter(B,void 0,void 0,function(){var e;return p.__generator(this,function(C){switch(C.label){case 0:return g&&(a.returnGeometry||a.returnCentroid)?[4,b.project(c)]:[3,2];case 1:return e=C.sent(),l&&this._geometryQueryCache.put(l,e,e.size||1),[2,e];case 2:return l&&this._geometryQueryCache.put(l,b,b.size||1),[2,b]}})})};if(!C)return[2,w(this._getAll())];x=this.featureAdapter;if("esriSpatialRelDisjoint"!==
h)return[3,3];m=this._searchFeatures(this._getQueryBBoxes(C));if(!m.length)return[2,w(this._getAll())];R=new Set;J=0;for(r=m;J<r.length;J++)S=r[J],R.add(x.getObjectId(S));return[4,this._reschedule(function(){var a=0;F=Array(R.size);B.featureStore.forEach(function(b){return F[a++]=b});t=R})];case 1:return ka.sent(),[4,this._reschedule(function(){return p.__awaiter(B,void 0,void 0,function(){var a,b,c;return p.__generator(this,function(g){switch(g.label){case 0:return[4,k.getSpatialQueryOperator(h,
C,this.geometryType,this.hasZ,this.hasM)];case 1:return a=g.sent(),b=function(b){return!t.has(x.getObjectId(b))||a(x.getGeometry(b))},c=e.default.bind,[4,this._runSpatialFilter(F,b)];case 2:return[2,new (c.apply(e.default,[void 0,g.sent(),C,this]))]}})})})];case 2:return n=ka.sent(),[2,w(n)];case 3:return A=this._searchFeatures(this._getQueryBBoxes(C)),A.length?(Y=this._canExecuteSoloPass(C,a))?[2,w(new e.default(A,C,this))]:[4,k.getSpatialQueryOperator(h,C,this.geometryType,this.hasZ,this.hasM)]:
(n=new e.default([],C,this),l&&this._geometryQueryCache.put(l,n,n.size||1),[2,n]);case 4:return u=ka.sent(),[4,this._runSpatialFilter(A,function(a){return u(x.getGeometry(a))})];case 5:return ta=ka.sent(),[2,w(new e.default(ta,C,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return p.__awaiter(this,void 0,void 0,function(){var e,C,c,h=this;return p.__generator(this,function(k){if(!b)return[2,a];if(!this._budget)return[2,a.filter(function(a){return b(a)})];e=0;C=[];c=function(){return p.__awaiter(h,
void 0,void 0,function(){var h;return p.__generator(this,function(k){switch(k.label){case 0:if(!(e<a.length))return[3,3];h=a[e];b(h)&&C.push(h);return this._budget.done?[4,this._reschedule(function(){return c()})]:[3,2];case 1:k.sent(),k.label=2;case 2:return++e,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return c()}).then(function(){return C})]})})};a.prototype._canExecuteSoloPass=function(a,b){var e=this.geometryType;b=b.spatialRel;return k.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===
b||"esriGeometryPoint"===e&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(k.canQueryWithRBush(a)){if(G.isExtent(a))return[u.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(G.isPolygon(a))return a.rings.map(function(a){return u.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[B.getBoundsXY(u.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=
0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){S.add(a)});var e=Array(S.size),C=0;S.forEach(function(a){return e[C++]=a});S.clear();return e};a.prototype._checkQuerySupport=function(a){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new n("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,g.all([this._checkAttributesQuerySupport(a),
this._checkStatisticsQuerySupport(a),k.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),E.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,e=a.orderByFields,C=a.returnDistinctValues,c=a.outStatistics,h=c?c.map(function(a){return a.outStatisticFieldName&&a.outStatisticFieldName.toLowerCase()}):[];e&&0<e.length&&(e=e.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?
b.split(" asc")[0]:-1<b.indexOf(" desc")?b.split(" desc")[0]:a}).filter(function(a){return-1===h.indexOf(a)}),H.validateFields(this.fieldsIndex,e,"orderByFields contains missing fields"));if(b&&0<b.length)H.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(C)throw new n("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});H.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return p.__awaiter(this,
void 0,void 0,function(){var b,e,C,c,h,k,g,l,q,w,x,m,F;return p.__generator(this,function(t){b=a.outStatistics;e=a.groupByFieldsForStatistics;C=a.having;c=e&&e.length;h=b&&b.length;if(C){if(!c||!h)throw new n("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});H.validateHaving(this.fieldsIndex,C,b)}if(h){if(!Y(b))return[2];k=b.map(function(a){return a.onStatisticField});H.validateFields(this.fieldsIndex,k,"onStatisticFields contains missing fields");
c&&H.validateFields(this.fieldsIndex,e,"groupByFieldsForStatistics contains missing fields");g=0;for(l=b;g<l.length;g++)if(q=l[g],w=q.onStatisticField,x=q.statisticType,(m="percentile_disc"===x||"percentile_cont"===x)&&"statisticParameters"in q){if(F=q.statisticParameters,!F)throw new n("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:q,query:a});}else if("count"!==x&&w&&H.hasInvalidFieldType(w,this.fieldsIndex))throw new n("feature-store:unsupported-query",
"outStatistics contains non-numeric fields",{definition:q,query:a});}return[2]})})};return a}();a.default=z;var J=A.create(),C=A.create()})},"esri/layers/graphics/data/attributeSupport":function(){define(["require","exports","../../../core/Error","../../../core/SetUtils","../../../core/sql/WhereClauseCache"],function(z,a,p,n,h){function b(a,b){return a?t.get(a,b):null}function m(a,h,t,r){void 0===r&&(r=!0);for(var n=[],A=0;A<h.length;A++){var u=h[A];if("*"!==u&&!a.has(u))if(r){var l=g(u);try{var e=
b(l,a);if(!e)throw new p("feature-store:unsupported-query","invalid SQL expression",{where:l});if(!e.isStandardized)throw new p("feature-store:unsupported-query","expression is not standard",{clause:e});m(a,e.fieldNames,"expression contains missing fields")}catch(k){if((l=k&&k.details)&&(l.clause||l.where))throw k;l&&l.missingFields?n.push.apply(n,l.missingFields):n.push(u)}}else n.push(u)}if(n.length)throw new p("feature-store:unsupported-query",t,{missingFields:n});}function g(a){return a.split(" as ")[0]}
Object.defineProperty(a,"__esModule",{value:!0});var t=new h.WhereClauseCache(50,500),r=n.SetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;var h=t.get(b,a);if(!h)throw new p("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!h.isStandardized)throw new p("feature-store:unsupported-query","where clause is not standard",
{where:b});m(a,h.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,h){if(!b)return!0;var g=t.get(b,a);if(!g)throw new p("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!g.isAggregate)throw new p("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:b});m(a,g.fieldNames,"having contains missing fields");if(!g.getExpressions().every(function(b){var g=b.aggregateType;b=b.field;var m=a.has(b)&&
a.get(b).name;return h.some(function(b){var e=b.onStatisticField;b=b.statisticType;return(a.has(e)&&a.get(e).name)===m&&b.toLowerCase().trim()===g})}))throw new p("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=b;a.validateFields=m;a.getExpressionFromFieldName=g;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!r.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require",
"exports","../ItemCache","./WhereClause"],function(z,a,p,n){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,h){this._cache=new p(a);this._invalidCache=new p(h)}a.prototype.get=function(a,h){var b=h.uid+":"+a,m=this._cache.get(b);if(m)return m;if(void 0!==this._invalidCache.get(b))return null;try{var r=n.WhereClause.create(a,h);this._cache.put(b,r);return r}catch(A){return this._invalidCache.put(b,null),null}};return a}();a.WhereClauseCache=z})},"esri/core/ItemCache":function(){define(["require",
"exports","./MemCache"],function(z,a,p){return function(){function a(a,b){this._storage=new p.MemCacheStorage;this._storage.maxSize=a;b&&this._storage.registerRemoveFunc("",b)}a.prototype.put=function(a,b){this._storage.put(a,b,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(z,a,p,n,h,b,m){function g(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function t(a,b,e,c,h,k,l,q,w){void 0===e&&(e="0");void 0===c&&(c="0");void 0===h&&(h="0");void 0===k&&(k="0");void 0===l&&(l="");void 0===q&&(q="0");void 0===w&&(w="0");return"+"===l||"-"===l?(a=g(parseInt(a,10),4)+"-"+g(parseInt(b,10),2)+"-"+g(parseInt(e,10),2),b="",10>parseFloat(k)&&(b="0"),c=g(parseInt(c,10),2)+":"+g(parseInt(h,10),2)+":"+(b+parseFloat(k).toString()),l=""+l+g(parseInt(q,10),2)+":"+
g(parseInt(w,10),2),new Date(a+"T"+c+l)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(e,10),parseInt(c,10),parseInt(h,10),parseFloat(k))}function r(a){var b=x.exec(a);if(null!==b){a=b[1];var e=b[2],c=b[3],h=b[4],k=b[5],g=b[6];return t(a,e,c,h,k,g)}b=Y.exec(a);if(null!==b){a=b[1];var e=b[2],c=b[3],h=b[4],k=b[5],g=b[6],l=b[7],q=b[8],b=b[9];return t(a,e,c,h,k,g,l,q,b)}b=S.exec(a);if(null!==b)return a=b[1],e=b[2],c=b[3],h=b[4],k=b[5],l=b[6],q=b[7],b=b[8],t(a,e,c,h,k,"0",l,q,b);b=ta.exec(a);if(null!==
b)return a=b[1],e=b[2],c=b[3],h=b[4],k=b[5],t(a,e,c,h,k);b=w.exec(a);if(null!==b)return a=b[1],e=b[2],c=b[3],t(a,e,c);throw Error("SQL Invalid Timestamp");}function A(a){a=w.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],e=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(e,10))}function u(a){return Array.isArray(a)?a:[a]}function B(a){return null!==a?!0!==a:null}function G(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function D(a,b){return null!=
a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function H(a,b){if(null==a)return null;for(var e=!1,c=0;c<b.length;c++){var h=b[c];if(null==h)e=null;else if(a===h){e=!0;break}}return e}function E(a,b,e){if(null==a)return null;for(var c="",h=0,k=0;k<b.length;k++){var g=b.charAt(k);switch(h){case 0:g===e?h=1:c=0<="-[]/{}()*+?.\\^$|".indexOf(g)?c+("\\"+g):"%"===g?c+".*":"_"===g?c+".":c+g;break;case 1:c=0<="-[]/{}()*+?.\\^$|".indexOf(g)?c+("\\"+g):c+g,h=0}}return(new RegExp("^"+c+"$")).test(a)}function l(a){return a instanceof
Date?a.valueOf():a}function e(a,b,e){if(null==b||null==e)return null;b=l(b);e=l(e);switch(a){case "\x3c\x3e":return b!==e;case "\x3d":return b===e;case "\x3e":return b>e;case "\x3c":return b<e;case "\x3e\x3d":return b>=e;case "\x3c\x3d":return b<=e}}function k(a){for(var b=[],e={},c=0;c<a.length;c++){var h=a[c],k=h.toLowerCase();void 0===e[k]&&(b.push(h),e[k]=1)}return b}function c(a,e,c){if(e instanceof b.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(e.valueInMilliseconds()+
c.getTime());case "-":return e.valueInMilliseconds()-c.getTime();case "*":return e.valueInMilliseconds()*c.getTime();case "/":return e.valueInMilliseconds()/c.getTime()}else if(c instanceof b.SqlInterval)switch(a){case "+":return b.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()+c.valueInMilliseconds());case "-":return b.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()-c.valueInMilliseconds());case "*":return e.valueInMilliseconds()*c.valueInMilliseconds();case "/":return e.valueInMilliseconds()/
c.valueInMilliseconds()}else e=e.valueInMilliseconds();else if(c instanceof b.SqlInterval)if(e instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+e.getTime());case "-":return new Date(e.getTime()-c.valueInMilliseconds());case "*":return e.getTime()*c.valueInMilliseconds();case "/":return e.getTime()/c.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(e instanceof Date&&"number"===typeof c)switch(c*=864E5,e=e.getTime(),a){case "+":return new Date(e+c);case "-":return new Date(e-
c);case "*":return new Date(e*c);case "/":return new Date(e/c)}else if(c instanceof Date&&"number"===typeof e)switch(e*=864E5,c=c.getTime(),a){case "+":return new Date(e+c);case "-":return new Date(e-c);case "*":return new Date(e*c);case "/":return new Date(e/c)}switch(a){case "+":return e+c;case "-":return e-c;case "*":return e*c;case "/":return e/c}}function q(a,b,e,c){a=c.getAttribute(a,b);return null!=a&&1===e[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var w=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,
x=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,Y=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,S=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,ta=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,aa=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,e,c){return q(a,b,e,c)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,e){return E(a,
b,e)};a.ensureArray=function(a){return u(a)};a.applyIn=function(a,b){return H(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=function(a,e,c){return b.SqlInterval.createFromValueAndQualifer(a,e,c)};a.convertInterval=function(a){return a instanceof b.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return e(a,b,c)};a.calculate=function(a,b,e){return c(a,b,e)};a.makeComparable=function(a){return l(a)};
a.evaluateFunction=function(a,e){return b.evaluateFunction(a,e)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return B(a)};a.ternaryAnd=function(a,b){return G(a,b)};a.ternaryOr=function(a,b){return D(a,b)};return a}();z=function(){function g(a,b){this.fieldsIndex=b;this.datefields={};this.parameters=
{};this.parseTree=m.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var e=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;this.isStandardized=b;this.isAggregate=e}g.create=function(a,b){return new g(a,b)};Object.defineProperty(g.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});g.prototype.testSet=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);for(var c={},h=function(a){c[a]=b.map(function(b){return e.getAttribute(b,
a)})},k=0,g=this.fieldNames;k<g.length;k++)h(g[k]);return!!this.evaluateNode(this.parseTree,{attributes:c},a.defaultAttributeAdapter)};g.prototype.calculateValue=function(e,c){void 0===c&&(c=a.defaultAttributeAdapter);e=this.evaluateNode(this.parseTree,e,c);return e instanceof b.SqlInterval?e.valueInMilliseconds()/864E5:e};g.prototype.calculateValueCompiled=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,
e,this.datefields);if(p("csp-restrictions"))return this.calculateValue(b,e);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,e,this.datefields)};g.prototype.testFeature=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,e)};g.prototype.testFeatureCompiled=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,e,this.datefields);
if(p("csp-restrictions"))return this.testFeature(b,e);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,e,this.datefields)};g.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return k(a)};g.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var e=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var c=
e+"-"+b;a.has(c)||a.set(c,{aggregateType:e,field:b})}}});return n.valuesOfMap(a)};g.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return k(a)};g.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(aa)};g.prototype.extractExpressionInfo=function(a){var e=
this,c=[],g=!0,l=!0;this.visitAll(this.parseTree,function(k){switch(k.type){case "column_ref":var q=a.get(k.column),w=q&&q.name;!q||"date"!==q.type&&"esriFieldTypeDate"!==q.type||(e.datefields[q.name]=1);void 0!==w?(c.push(w),k.column=w):c.push(k.column);break;case "function":q=k.name,k=k.args.value.length,g&&(g=b.isStandardized(q,k)),l&&(l=h.isAggregate(q,k))}});return{referencedFieldNames:k(c),isStandardized:g,isAggregate:l}};g.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,
b);this.visitAll(a.value,b);break;case "case_expression":for(var e=0,c=a.clauses;e<c.length;e++){var k=c[e];this.visitAll(k,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":e=0;for(a=a.value;e<a.length;e++)k=a[e],this.visitAll(k,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};g.prototype.evaluateNodeToJavaScript=
function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var e="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",c=0;c<a.clauses.length;c++)b+=" ("+e+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";
else for(b="( ",c=0;c<a.clauses.length;c++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";e=0;for(a=a.value;e<a.length;e++)c=a[e],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(c);return b+"]";case "unary_expr":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+
JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+A(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+
r(a.value).getTime().toString()+"))";case "current_time":return"date"===a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};g.prototype.evaluateNode=function(a,k,g){switch(a.type){case "interval":return k=this.evaluateNode(a.value,
k,g),b.SqlInterval.createFromValueAndQualifer(k,a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var w=l(this.evaluateNode(a.operand,k,g)),x=0;x<a.clauses.length;x++){if(w===l(this.evaluateNode(a.clauses[x].operand,k,g)))return this.evaluateNode(a.clauses[x].value,k,g)}else for(x=0;x<a.clauses.length;x++)if(!0===this.evaluateNode(a.clauses[x].operand,k,g))return this.evaluateNode(a.clauses[x].value,k,g);return null!==a.else?this.evaluateNode(a.else,k,g):null;case "param":return this.parameters[a.value.toLowerCase()];
case "expr_list":w=[];x=0;for(a=a.value;x<a.length;x++)w.push(this.evaluateNode(a[x],k,g));return w;case "unary_expr":return B(this.evaluateNode(a.expr,k,g));case "binary_expr":switch(a.operator){case "AND":return G(this.evaluateNode(a.left,k,g),this.evaluateNode(a.right,k,g));case "OR":return D(this.evaluateNode(a.left,k,g),this.evaluateNode(a.right,k,g));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,k,g);case "ISNOT":if("null"!==
a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,k,g);case "IN":return w=u(this.evaluateNode(a.right,k,g)),H(this.evaluateNode(a.left,k,g),w);case "NOT IN":return w=u(this.evaluateNode(a.right,k,g)),B(H(this.evaluateNode(a.left,k,g),w));case "BETWEEN":return w=this.evaluateNode(a.left,k,g),a=this.evaluateNode(a.right,k,g),null==w||null==a[0]||null==a[1]?null:w>=l(a[0])&&w<=l(a[1]);case "NOTBETWEEN":return w=this.evaluateNode(a.left,k,g),a=this.evaluateNode(a.right,
k,g),null==w||null==a[0]||null==a[1]?null:w<l(a[0])||w>l(a[1]);case "LIKE":return E(this.evaluateNode(a.left,k,g),this.evaluateNode(a.right,k,g),a.escape);case "NOT LIKE":return B(E(this.evaluateNode(a.left,k,g),this.evaluateNode(a.right,k,g),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return e(a.operator,this.evaluateNode(a.left,k,g),this.evaluateNode(a.right,k,g));case "-":case "+":case "*":case "/":return c(a.operator,this.evaluateNode(a.left,
k,g),this.evaluateNode(a.right,k,g))}case "null":case "bool":case "string":case "number":return a.value;case "date":return A(a.value);case "timestamp":return r(a.value);case "current_time":return k=new Date,"date"===a.mode&&k.setHours(0,0,0,0),k;case "column_ref":return q(k,a.column,this.datefields,g);case "function":return k=this.evaluateNode(a.args,k,g),this.isAggregate?h.aggregateFunction(a.name,k):b.evaluateFunction(a.name,k)}throw Error("Unsupported sql syntax "+a.type);};return g}();a.WhereClause=
z;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(z,a){function p(a){for(var b=0,g=0;g<a.length;g++)b+=a[g];return b/a.length}function n(a){for(var b=p(a),g=a.length,h=0,r=0;r<a.length;r++)h+=Math.pow(a[r]-b,2);return 1<g?h/(g-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,m){var b=h[a.toLowerCase()];if(null==
b)throw Error("Function Not Recognised");if(m.length<b.minParams||m.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(m)};a.isAggregate=function(a,m){a=h[a.toLowerCase()];return null!=a&&m>=a.minParams&&m<=a.maxParams};var h={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:p(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,g=0;g<a.length;g++)b+=a[g];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(n(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:n(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require",
"exports","../string"],function(z,a,p){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var h=new a;h.second=b/1E3;return h};a.createFromValueAndQualifer=function(b,h,g){var m=null,r=new a;r.op="-"===g?"-":"+";if("interval-period"===
h.type){a.fixDefaults(h);if("year"===h.period||"month"===h.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))r[h.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(h.start);a.fixDefaults(h.end);if("year"===h.start.period||"month"===h.start.period)throw Error("Year-Month Intervals not supported");if("year"===h.end.period||"month"===h.end.period)throw Error("Year-Month Intervals not supported");switch(h.start.period){case "day":switch(h.end.period){case "hour":m=
/^[0-9]{1,} [0-9]{1,}$/;if(m.test(b))r[h.start.period]=parseFloat(b.split(" ")[0]),r[h.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":m=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(m.test(b))r[h.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),r.hour=parseFloat(b[0]),r.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":m=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(m.test(b))r[h.start.period]=
parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),r.hour=parseFloat(b[0]),r.minute=parseFloat(b[1]),r.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(h.end.period){case "minute":m=/^[0-9]{1,}:[0-9]{1,}$/;if(m.test(b))r.hour=parseFloat(b.split(":")[0]),r.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":m=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(m.test(b))b=
b.split(":"),r.hour=parseFloat(b[0]),r.minute=parseFloat(b[1]),r.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(h.end.period){case "second":m=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(m.test(b))b=b.split(":"),r.minute=parseFloat(b[0]),r.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return r};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=z;a.evaluateFunction=function(a,b){var h=n[a.toLowerCase()];if(null==h)throw Error("Function Not Recognised");if(b.length<h.minParams||b.length>h.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return h.evaluate(b)};a.isStandardized=function(a,b){a=n[a.toLowerCase()];return null!=a&&b>=a.minParams&&
b<=a.maxParams};var n={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],h=a[1];return null==b||null==h?null:b.toString().substring(h-1)}if(3===a.length)return b=a[0],h=a[1],a=a[2],null==b||null==h||null==a?null:0>=a?"":b.toString().substring(h-1,h+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,h=b?a[1]:" ",b=b?a[2]:a[1];if(null==h||null==b)return null;h="("+p.escapeRegExpString(h)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
h+"*|"+h+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+h+"*","g"),"");case "TRAILING":return b.replace(new RegExp(h+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",h=0;h<
a.length;h++){if(null==a[h])return null;b+=a[h].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(z,a,p){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(){}a.parse=function(a){return p.parse(a)};
return a}();a.WhereGrammar=z})},"esri/core/sql/sql92grammar":function(){(function(z,a){"function"===typeof define&&define.amd?define([],a):"object"===typeof module&&module.exports&&(module.exports=a())})(this,function(){function z(a,p,n,h){this.message=a;this.expected=p;this.found=n;this.location=h;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,z)}(function(a,p){function n(){this.constructor=a}n.prototype=p.prototype;a.prototype=new n})(z,Error);
z.buildMessage=function(a,p){function n(a){return a.charCodeAt(0).toString(16).toUpperCase()}function h(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+n(a)})}function b(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,
"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+n(a)})}var m={literal:function(a){return'"'+h(a.text)+'"'},"class":function(a){var g="",h;for(h=0;h<a.parts.length;h++)g+=a.parts[h]instanceof Array?b(a.parts[h][0])+"-"+b(a.parts[h][1]):b(a.parts[h]);return"["+(a.inverted?"^":"")+g+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};
return"Expected "+function(a){var b=Array(a.length),g;for(g=0;g<a.length;g++){var h=g,n;n=a[g];n=m[n.type](n);b[h]=n}b.sort();if(0<b.length){for(a=g=1;g<b.length;g++)b[g-1]!==b[g]&&(b[a]=b[g],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(p?'"'+h(p)+'"':"end of input")+" found."};return{SyntaxError:z,parse:function(a,p){function n(a,d){return{type:"literal",text:a,ignoreCase:d}}function h(a,
d,b){return{type:"class",parts:a,inverted:d,ignoreCase:b}}function b(d){var b=Aa[d],f;if(!b){for(f=d-1;!Aa[f];)f--;b=Aa[f];for(b={line:b.line,column:b.column};f<d;)10===a.charCodeAt(f)?(b.line++,b.column=1):b.column++,f++;Aa[d]=b}return b}function m(a,d){var f=b(a),e=b(d);return{start:{offset:a,line:f.line,column:f.column},end:{offset:d,line:e.line,column:e.column}}}function g(a){f<ea||(f>ea&&(ea=f,Oa=[]),Oa.push(a))}function t(){var a,b,e;a=f;b=y();b!==d?(b=A(),b!==d?(e=y(),e!==d?a=b:(f=a,a=d)):
(f=a,a=d)):(f=a,a=d);return a}function r(){var a,b,e,c,k,g,l,h;a=f;b=A();if(b!==d){e=[];c=f;k=y();k!==d?(g=Ga(),g!==d?(l=y(),l!==d?(h=A(),h!==d?c=k=[k,g,l,h]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,k=y(),k!==d?(g=Ga(),g!==d?(l=y(),l!==d?(h=A(),h!==d?c=k=[k,g,l,h]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);if(e!==d){a={type:"expr_list"};b=[b];for(c=0;c<e.length;c++)b.push(e[c][3]);a.value=b}else f=a,a=d}else f=a,a=d;return a}function A(){var a,b,e,c,k,g,l,h;a=f;b=u();if(b!==
d){e=[];c=f;k=y();k!==d?(g=ca(),g!==d?(l=y(),l!==d?(h=u(),h!==d?c=k=[k,g,l,h]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,k=y(),k!==d?(g=ca(),g!==d?(l=y(),l!==d?(h=u(),h!==d?c=k=[k,g,l,h]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);e!==d?a=b=Ba(b,e):(f=a,a=d)}else f=a,a=d;return a}function u(){var a,b,e,c,k,g,l,h;a=f;b=B();if(b!==d){e=[];c=f;k=y();k!==d?(g=V(),g!==d?(l=y(),l!==d?(h=B(),h!==d?c=k=[k,g,l,h]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,
k=y(),k!==d?(g=V(),g!==d?(l=y(),l!==d?(h=B(),h!==d?c=k=[k,g,l,h]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);e!==d?a=b=Ba(b,e):(f=a,a=d)}else f=a,a=d;return a}function B(){var b,e,c,k,l;b=f;e=U();e===d&&(e=f,33===a.charCodeAt(f)?(c=ad,f++):(c=d,0===v&&g(bd)),c!==d?(k=f,v++,61===a.charCodeAt(f)?(l=Ya,f++):(l=d,0===v&&g(Za)),v--,l===d?k=void 0:(f=k,k=d),k!==d?e=c=[c,k]:(f=e,e=d)):(f=e,e=d));e!==d?(c=y(),c!==d?(k=B(),k!==d?b=e={type:"unary_expr",operator:"NOT",expr:k}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d);
if(b===d)if(b=f,e=E(),e!==d)if(c=y(),c!==d){var h,q,w;c=[];k=f;l=y();l!==d?(h=G(),h!==d?(q=y(),q!==d?(w=E(),w!==d?k=l=[l,h,q,w]:(f=k,k=d)):(f=k,k=d)):(f=k,k=d)):(f=k,k=d);if(k!==d)for(;k!==d;)c.push(k),k=f,l=y(),l!==d?(h=G(),h!==d?(q=y(),q!==d?(w=E(),w!==d?k=l=[l,h,q,w]:(f=k,k=d)):(f=k,k=d)):(f=k,k=d)):(f=k,k=d);else c=d;c!==d&&(c={type:"arithmetic",tail:c});c===d&&(c=f,k=H(),k!==d?(l=y(),l!==d?(l=fa(),l!==d?(l=y(),l!==d?(l=r(),l!==d?(h=y(),h!==d?(h=ga(),h!==d?c=k={op:k,right:l}:(f=c,c=d)):(f=c,c=
d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,k=H(),k!==d?(l=y(),l!==d?(l=fa(),l!==d?(l=y(),l!==d?(l=ga(),l!==d?c=k={op:k,right:{type:"expr_list",value:[]}}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,k=H(),k!==d?(l=y(),l!==d?(l=S(),l!==d?c=k={op:k,right:l}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d))),c===d&&(c=f,l=U(),l!==d?(k=y(),k!==d?(k=da(),k!==d?(h=y(),h!==d?(h=E(),h!==d?(q=y(),q!==d?(q=V(),q!==d?(l=y(),l!==d?(l=E(),l!==d?c=l={op:"NOT"+k,right:{type:"expr_list",
value:[h,l]}}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,l=da(),l!==d?(k=y(),k!==d?(k=E(),k!==d?(h=y(),h!==d?(h=V(),h!==d?(q=y(),q!==d?(q=E(),q!==d?c=l={op:l,right:{type:"expr_list",value:[k,q]}}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)),c===d&&(c=f,k=ba(),k!==d?(l=y(),l!==d?(l=U(),l!==d?(l=y(),l!==d?(l=E(),l!==d?c=k={op:k+"NOT",right:l}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&
(c=f,k=ba(),k!==d?(l=y(),l!==d?(l=E(),l!==d?c=k={op:k,right:l}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)),c===d&&(c=f,k=D(),k!==d?(l=y(),l!==d?(l=R(),l!==d?(h=y(),h!==d?(h=f,a.substr(f,6).toLowerCase()===cd?(q=a.substr(f,6),f+=6):(q=d,0===v&&g(dd)),q!==d?(q=f,v++,w=x(),v--,w===d?q=void 0:(f=q,q=d),q!==d?h="ESCAPE":(f=h,h=d)):(f=h,h=d),h!==d?(h=y(),h!==d?(h=ka(),h!==d?c=k={op:k,right:l,escape:h.value}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,k=D(),k!==d?(l=y(),
l!==d?(l=R(),l!==d?c=k={op:k,right:l,escape:""}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d))))));c===d&&(c=null);c!==d?(b=e,e=c,""==e||void 0==e||null==e?e=b:(c=null,e=c="arithmetic"==e.type?Ba(b,e.tail):$a(e.op,b,e.right,e.escape)),b=e):(f=b,b=d)}else f=b,b=d;else f=b,b=d;return b}function G(){var b;a.substr(f,2)===ab?(b=ab,f+=2):(b=d,0===v&&g(ed));b===d&&(62===a.charCodeAt(f)?(b=fd,f++):(b=d,0===v&&g(gd)),b===d&&(a.substr(f,2)===bb?(b=bb,f+=2):(b=d,0===v&&g(hd)),b===d&&(a.substr(f,2)===cb?(b=cb,f+=2):(b=d,
0===v&&g(id)),b===d&&(60===a.charCodeAt(f)?(b=jd,f++):(b=d,0===v&&g(kd)),b===d&&(61===a.charCodeAt(f)?(b=Ya,f++):(b=d,0===v&&g(Za)),b===d&&(a.substr(f,2)===db?(b=db,f+=2):(b=d,0===v&&g(ld))))))));return b}function D(){var a,b,c,e;a=a=f;b=U();b!==d?(c=y(),c!==d?(e=ja(),e!==d?a=b=[b,c,e]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=ja());return a}function H(){var a,b,c,e;a=a=f;b=U();b!==d?(c=y(),c!==d?(e=va(),e!==d?a=b=[b,c,e]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+
a[2]);a===d&&(a=va());return a}function E(){var a,b,c,k,g,h,q,w;a=f;b=e();if(b!==d){c=[];k=f;g=y();g!==d?(h=l(),h!==d?(q=y(),q!==d?(w=e(),w!==d?k=g=[g,h,q,w]:(f=k,k=d)):(f=k,k=d)):(f=k,k=d)):(f=k,k=d);for(;k!==d;)c.push(k),k=f,g=y(),g!==d?(h=l(),h!==d?(q=y(),q!==d?(w=e(),w!==d?k=g=[g,h,q,w]:(f=k,k=d)):(f=k,k=d)):(f=k,k=d)):(f=k,k=d);c!==d?a=b=Ba(b,c):(f=a,a=d)}else f=a,a=d;return a}function l(){var b;43===a.charCodeAt(f)?(b=ac,f++):(b=d,0===v&&g(bc));b===d&&(45===a.charCodeAt(f)?(b=cc,f++):(b=d,0===
v&&g(dc)));return b}function e(){var a,b,e,g,l,h,q,w;a=f;b=c();if(b!==d){e=[];g=f;l=y();l!==d?(h=k(),h!==d?(q=y(),q!==d?(w=c(),w!==d?g=l=[l,h,q,w]:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d);for(;g!==d;)e.push(g),g=f,l=y(),l!==d?(h=k(),h!==d?(q=y(),q!==d?(w=c(),w!==d?g=l=[l,h,q,w]:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d);e!==d?a=b=Ba(b,e):(f=a,a=d)}else f=a,a=d;return a}function k(){var b;42===a.charCodeAt(f)?(b=md,f++):(b=d,0===v&&g(nd));b===d&&(47===a.charCodeAt(f)?(b=od,f++):(b=d,0===v&&g(pd)));
return b}function c(){var b,c,e,k,l,h,m;m=ka();if(m===d){var t,n,p,C;t=f;var u,B,J,G;u=f;B=ia();B!==d?(J=Z(),J!==d?(G=la(),G!==d?u=B=parseFloat(B+J+G):(f=u,u=d)):(f=u,u=d)):(f=u,u=d);u===d&&(u=f,B=ia(),B!==d?(J=Z(),J!==d?u=B=parseFloat(B+J):(f=u,u=d)):(f=u,u=d),u===d&&(u=f,B=ia(),B!==d?(J=la(),J!==d?u=B=parseFloat(B+J):(f=u,u=d)):(f=u,u=d),u===d&&(u=f,B=ia(),B!==d&&(B=parseFloat(B)),u=B)));n=u;n!==d?(p=f,v++,C=w(),v--,C===d?p=void 0:(f=p,p=d),p!==d?t=n={type:"number",value:n}:(f=t,t=d)):(f=t,t=d);
m=t;if(m===d){var F,D;F=f;var z,H,E,T;z=f;a.substr(f,4).toLowerCase()===qd?(H=a.substr(f,4),f+=4):(H=d,0===v&&g(rd));H!==d?(E=f,v++,T=x(),v--,T===d?E=void 0:(f=E,E=d),E!==d?z=H=[H,E]:(f=z,z=d)):(f=z,z=d);D=z;D!==d&&(D={type:"bool",value:!0});F=D;if(F===d){F=f;var da,V,U,ja;da=f;a.substr(f,5).toLowerCase()===sd?(V=a.substr(f,5),f+=5):(V=d,0===v&&g(td));V!==d?(U=f,v++,ja=x(),v--,ja===d?U=void 0:(f=U,U=d),U!==d?da=V=[V,U]:(f=da,da=d)):(f=da,da=d);D=da;D!==d&&(D={type:"bool",value:!1});F=D}m=F;if(m===
d){var ea,W,ca,ba,Ba;W=f;a.substr(f,4).toLowerCase()===ud?(ca=a.substr(f,4),f+=4):(ca=d,0===v&&g(vd));ca!==d?(ba=f,v++,Ba=x(),v--,Ba===d?ba=void 0:(f=ba,ba=d),ba!==d?W=ca=[ca,ba]:(f=W,W=d)):(f=W,W=d);ea=W;ea!==d&&(ea={type:"null",value:null});m=ea;if(m===d){var wa,Aa,Ga,Ea;wa=f;var Ha,ya,eb,Oa;Ha=f;a.substr(f,4).toLowerCase()===wd?(ya=a.substr(f,4),f+=4):(ya=d,0===v&&g(xd));ya!==d?(eb=f,v++,Oa=x(),v--,Oa===d?eb=void 0:(f=eb,eb=d),eb!==d?Ha=ya="DATE":(f=Ha,Ha=d)):(f=Ha,Ha=d);Aa=Ha;Aa!==d?(Ga=y(),Ga!==
d?(Ea=R(),Ea!==d?wa=Aa={type:"date",value:Ea.value}:(f=wa,wa=d)):(f=wa,wa=d)):(f=wa,wa=d);m=wa;if(m===d){var xa,ec,Ya,fc;xa=f;var Ia,Eb,fb,Za;Ia=f;a.substr(f,9).toLowerCase()===yd?(Eb=a.substr(f,9),f+=9):(Eb=d,0===v&&g(zd));Eb!==d?(fb=f,v++,Za=x(),v--,Za===d?fb=void 0:(f=fb,fb=d),fb!==d?Ia=Eb="TIMESTAMP":(f=Ia,Ia=d)):(f=Ia,Ia=d);ec=Ia;ec!==d?(Ya=y(),Ya!==d?(fc=R(),fc!==d?xa=ec={type:"timestamp",value:fc.value}:(f=xa,xa=d)):(f=xa,xa=d)):(f=xa,xa=d);m=xa;if(m===d){var M,Pa,Fb,ra,Gb,Qa,$a,gc;M=f;Pa=
vc();Pa!==d?(Fb=y(),Fb!==d?(45===a.charCodeAt(f)?(ra=cc,f++):(ra=d,0===v&&g(dc)),ra===d&&(43===a.charCodeAt(f)?(ra=ac,f++):(ra=d,0===v&&g(bc))),ra!==d?(Gb=y(),Gb!==d?(Qa=R(),Qa!==d?($a=y(),$a!==d?(gc=aa(),gc!==d?M=Pa={type:"interval",value:Qa,qualifier:gc,op:ra}:(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d);M===d&&(M=f,Pa=vc(),Pa!==d?(Fb=y(),Fb!==d?(ra=R(),ra!==d?(Gb=y(),Gb!==d?(Qa=aa(),Qa!==d?M=Pa={type:"interval",value:ra,qualifier:Qa,op:""}:(f=M,M=d)):(f=M,M=d)):(f=
M,M=d)):(f=M,M=d)):(f=M,M=d));m=M}}}}}}b=m;if(b===d){var P,hc,ab,bb,cb,ic,db,pb,qb,jc,rb,sb;P=f;var Ja,Hb,gb,tb;Ja=f;a.substr(f,7).toLowerCase()===Ad?(Hb=a.substr(f,7),f+=7):(Hb=d,0===v&&g(Bd));Hb!==d?(gb=f,v++,tb=x(),v--,tb===d?gb=void 0:(f=gb,gb=d),gb!==d?Ja=Hb="EXTRACT":(f=Ja,Ja=d)):(f=Ja,Ja=d);hc=Ja;if(hc!==d)if(ab=y(),ab!==d)if(bb=fa(),bb!==d)if(cb=y(),cb!==d){var ma;ma=wc();ma===d&&(ma=xc(),ma===d&&(ma=yc(),ma===d&&(ma=zc(),ma===d&&(ma=Ac(),ma===d&&(ma=Fa())))));ic=ma;ic!==d?(db=y(),db!==d?
(pb=$b(),pb!==d?(qb=y(),qb!==d?(jc=A(),jc!==d?(rb=y(),rb!==d?(sb=ga(),sb!==d?P=hc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:ic},jc]}}:(f=P,P=d)):(f=P,P=d)):(f=P,P=d)):(f=P,P=d)):(f=P,P=d)):(f=P,P=d)):(f=P,P=d)}else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;b=P;if(b===d){var O,kc,ub,vb,wb,Ib,xb,yb,zb,Jb,Ab,ha,Ra,lc,mc,nc;O=f;var Ka,Kb,hb,Bb;Ka=f;a.substr(f,9).toLowerCase()===Cd?(Kb=a.substr(f,9),f+=9):(Kb=d,0===v&&g(Dd));Kb!==d?(hb=f,v++,Bb=x(),v--,Bb===
d?hb=void 0:(f=hb,hb=d),hb!==d?Ka=Kb="SUBSTRING":(f=Ka,Ka=d)):(f=Ka,Ka=d);kc=Ka;if(kc!==d)if(ub=y(),ub!==d)if(vb=fa(),vb!==d)if(wb=y(),wb!==d)if(Ib=A(),Ib!==d)if(xb=y(),xb!==d)if(yb=$b(),yb!==d)if(zb=y(),zb!==d)if(Jb=A(),Jb!==d)if(Ab=y(),Ab!==d){ha=f;var La,Lb,ib,Bc;La=f;a.substr(f,3).toLowerCase()===Ed?(Lb=a.substr(f,3),f+=3):(Lb=d,0===v&&g(Fd));Lb!==d?(ib=f,v++,Bc=x(),v--,Bc===d?ib=void 0:(f=ib,ib=d),ib!==d?La=Lb="FOR":(f=La,La=d)):(f=La,La=d);Ra=La;Ra!==d?(lc=y(),lc!==d?(mc=A(),mc!==d?(nc=y(),
nc!==d?ha=Ra=[Ra,lc,mc,nc]:(f=ha,ha=d)):(f=ha,ha=d)):(f=ha,ha=d)):(f=ha,ha=d);ha===d&&(ha=null);ha!==d?(Ra=ga(),Ra!==d?O=kc={type:"function",name:"substring",args:{type:"expr_list",value:ha?[Ib,Jb,ha[2]]:[Ib,Jb]}}:(f=O,O=d)):(f=O,O=d)}else f=O,O=d;else f=O,O=d;else f=O,O=d;else f=O,O=d;else f=O,O=d;else f=O,O=d;else f=O,O=d;else f=O,O=d;else f=O,O=d;else f=O,O=d;b=O;if(b===d){var I,Sa,Mb,Nb,Ob,na,Pb,Ta,Qb,Rb,Cc,oc,Dc,Ec;I=f;Sa=uc();Sa!==d?(Mb=y(),Mb!==d?(Nb=fa(),Nb!==d?(Ob=y(),Ob!==d?(na=ta(),na===
d&&(na=null),na!==d?(Pb=y(),Pb!==d?(Ta=A(),Ta!==d?(Qb=y(),Qb!==d?(Rb=$b(),Rb!==d?(Cc=y(),Cc!==d?(oc=A(),oc!==d?(Dc=y(),Dc!==d?(Ec=ga(),Ec!==d?I=Sa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==na?"BOTH":na},Ta,oc]}}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d);I===d&&(I=f,Sa=uc(),Sa!==d?(Mb=y(),Mb!==d?(Nb=fa(),Nb!==d?(Ob=y(),Ob!==d?(na=ta(),na===d&&(na=null),na!==
d?(Pb=y(),Pb!==d?(Ta=A(),Ta!==d?(Qb=y(),Qb!==d?(Rb=ga(),Rb!==d?I=Sa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==na?"BOTH":na},Ta]}}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d));b=I;if(b===d){var Q,pc,Fc,Gc,Hc,qc,Ic,Jc,Kc,rc,Lc,Mc;Q=f;var Ma,Sb,jb,Nc;Ma=f;a.substr(f,8).toLowerCase()===Gd?(Sb=a.substr(f,8),f+=8):(Sb=d,0===v&&g(Hd));Sb!==d?(jb=f,v++,Nc=x(),v--,Nc===d?jb=void 0:(f=jb,jb=d),jb!==d?Ma=Sb="POSITION":
(f=Ma,Ma=d)):(f=Ma,Ma=d);pc=Ma;pc!==d?(Fc=y(),Fc!==d?(Gc=fa(),Gc!==d?(Hc=y(),Hc!==d?(qc=A(),qc!==d?(Ic=y(),Ic!==d?(Jc=va(),Jc!==d?(Kc=y(),Kc!==d?(rc=A(),rc!==d?(Lc=y(),Lc!==d?(Mc=ga(),Mc!==d?Q=pc={type:"function",name:"position",args:{type:"expr_list",value:[qc,rc]}}:(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d);b=Q;if(b===d){var X,Tb,Oc,Pc,Qc,Ua,Rc,Sc;X=f;var oa,kb,lb,sa;oa=f;oa=kb=q();if(oa===d)if(oa=f,96===a.charCodeAt(f)?
(kb=Tc,f++):(kb=d,0===v&&g(Uc)),kb!==d){lb=[];Vc.test(a.charAt(f))?(sa=a.charAt(f),f++):(sa=d,0===v&&g(Wc));if(sa!==d)for(;sa!==d;)lb.push(sa),Vc.test(a.charAt(f))?(sa=a.charAt(f),f++):(sa=d,0===v&&g(Wc));else lb=d;lb!==d?(96===a.charCodeAt(f)?(sa=Tc,f++):(sa=d,0===v&&g(Uc)),sa!==d?oa=kb=lb.join(""):(f=oa,oa=d)):(f=oa,oa=d)}else f=oa,oa=d;Tb=oa;Tb!==d?(Oc=y(),Oc!==d?(Pc=fa(),Pc!==d?(Qc=y(),Qc!==d?(Ua=r(),Ua===d&&(Ua=null),Ua!==d?(Rc=y(),Rc!==d?(Sc=ga(),Sc!==d?X=Tb={type:"function",name:Tb,args:Ua?
Ua:{type:"expr_list",value:[]}}:(f=X,X=d)):(f=X,X=d)):(f=X,X=d)):(f=X,X=d)):(f=X,X=d)):(f=X,X=d)):(f=X,X=d);b=X;if(b===d){var Ub,K,Va,Vb,Wa,Wb,Ca,pa,mb,Xc,Yc;K=f;Va=Cb();if(Va!==d)if(Vb=y(),Vb!==d)if(Wa=A(),Wa!==d)if(Wb=y(),Wb!==d){Ca=[];for(pa=za();pa!==d;)Ca.push(pa),pa=za();Ca!==d?(pa=y(),pa!==d?(mb=Db(),mb!==d?K=Va={type:"case_expression",format:"simple",operand:Wa,clauses:Ca,else:null}:(f=K,K=d)):(f=K,K=d)):(f=K,K=d)}else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;if(K===d)if(K=f,Va=Cb(),
Va!==d)if(Vb=y(),Vb!==d)if(Wa=A(),Wa!==d)if(Wb=y(),Wb!==d){Ca=[];for(pa=za();pa!==d;)Ca.push(pa),pa=za();Ca!==d?(pa=y(),pa!==d?(mb=L(),mb!==d?(Xc=y(),Xc!==d?(Yc=Db(),Yc!==d?K=Va={type:"case_expression",format:"simple",operand:Wa,clauses:Ca,else:mb.value}:(f=K,K=d)):(f=K,K=d)):(f=K,K=d)):(f=K,K=d)):(f=K,K=d)}else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;Ub=K;if(Ub===d){var N,Xa,Xb,Da,qa,nb,Zc,$c;N=f;Xa=Cb();if(Xa!==d)if(Xb=y(),Xb!==d){Da=[];for(qa=ua();qa!==d;)Da.push(qa),qa=ua();Da!==d?(qa=
y(),qa!==d?(nb=Db(),nb!==d?N=Xa={type:"case_expression",format:"searched",clauses:Da,else:null}:(f=N,N=d)):(f=N,N=d)):(f=N,N=d)}else f=N,N=d;else f=N,N=d;if(N===d)if(N=f,Xa=Cb(),Xa!==d)if(Xb=y(),Xb!==d){Da=[];for(qa=ua();qa!==d;)Da.push(qa),qa=ua();Da!==d?(qa=y(),qa!==d?(nb=L(),nb!==d?(Zc=y(),Zc!==d?($c=Db(),$c!==d?N=Xa={type:"case_expression",format:"searched",clauses:Da,else:nb.value}:(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)}else f=N,N=d;else f=N,N=d;Ub=N}b=Ub;if(b===d){var ob,Na,sc,
Yb,Zb;Na=f;sc=w();if(sc!==d){Yb=[];for(Zb=Y();Zb!==d;)Yb.push(Zb),Zb=Y();Yb!==d?Na=sc+=Yb.join(""):(f=Na,Na=d)}else f=Na,Na=d;ob=Na;if(ob!==d){var tc=ob;ob=/^CURRENT_DATE$/i.test(tc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(tc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:tc}}b=ob;b===d&&(b=S(),b===d&&(b=f,c=fa(),c!==d?(e=y(),e!==d?(k=A(),k!==d?(l=y(),l!==d?(h=ga(),h!==d?(k.paren=!0,b=c=k):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)))}}}}}}}return b}
function q(){var a,b,c,e;a=f;b=w();if(b!==d){c=[];for(e=x();e!==d;)c.push(e),e=x();c!==d?a=b+=c.join(""):(f=a,a=d)}else f=a,a=d;return a}function w(){var b;Id.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&g(Jd));return b}function x(){var b;Kd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&g(Ld));return b}function Y(){var b;Md.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&g(Nd));return b}function S(){var b,c,e;b=f;64===a.charCodeAt(f)?(c=Od,f++):(c=d,0===v&&g(Pd));c!==d?(e=q(),e!==d?b=c=
[c,e]:(f=b,b=d)):(f=b,b=d);b!==d&&(b={type:"param",value:b[1]});return b}function ta(){var b,c,e;b=f;a.substr(f,7).toLowerCase()===Qd?(c=a.substr(f,7),f+=7):(c=d,0===v&&g(Rd));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="LEADING":(f=b,b=d)):(f=b,b=d);b===d&&(b=f,a.substr(f,8).toLowerCase()===Sd?(c=a.substr(f,8),f+=8):(c=d,0===v&&g(Td)),c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="TRAILING":(f=b,b=d)):(f=b,b=d),b===d&&(b=f,a.substr(f,4).toLowerCase()===Ud?(c=a.substr(f,
4),f+=4):(c=d,0===v&&g(Vd)),c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="BOTH":(f=b,b=d)):(f=b,b=d)));return b}function aa(){var b,c,e;b=f;var k,l;c=f;e=J();e!==d?(k=y(),k!==d?(k=fa(),k!==d?(k=y(),k!==d?(k=F(),k!==d?(l=y(),l!==d?(l=ga(),l!==d?c=e={type:"interval-period",period:e.value,precision:k,secondary:null}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);c===d&&(c=f,e=J(),e!==d&&(e=pb(e)),c=e);if(c!==d)if(e=y(),e!==d)if(e=f,a.substr(f,2).toLowerCase()===
Wd?(k=a.substr(f,2),f+=2):(k=d,0===v&&g(Xd)),k!==d?(k=f,v++,l=x(),v--,l===d?k=void 0:(f=k,k=d),k!==d?e="TO":(f=e,e=d)):(f=e,e=d),e!==d)if(e=y(),e!==d){var h;e=f;k=J();k!==d&&(k={type:"interval-period",period:k.value,precision:null,secondary:null});e=k;e===d&&(e=f,k=Fa(),k!==d?(k=y(),k!==d?(k=fa(),k!==d?(k=y(),k!==d?(k=F(),k!==d?(l=y(),l!==d?(l=Ga(),l!==d?(l=y(),l!==d?(l=C(),l!==d?(h=y(),h!==d?(h=ga(),h!==d?e=k=qb(k,l):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=
e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,k=Fa(),k!==d?(k=y(),k!==d?(k=fa(),k!==d?(k=y(),k!==d?(k=F(),k!==d?(l=y(),l!==d?(l=ga(),l!==d?e=k={type:"interval-period",period:"second",precision:k,secondary:null}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,k=Fa(),k!==d&&(k={type:"interval-period",period:"second",precision:null,secondary:null}),e=k)));e!==d?b=c={type:"interval-qualifier",start:c,end:e}:(f=b,b=d)}else f=b,b=d;else f=b,b=d;else f=b,b=d;
else f=b,b=d;b===d&&(b=f,e=J(),e!==d?(c=y(),c!==d?(c=fa(),c!==d?(c=y(),c!==d?(c=C(),c!==d?(k=y(),k!==d?(k=ga(),k!==d?b=e={type:"interval-period",period:e.value,precision:c,secondary:null}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,e=J(),e!==d&&(e=pb(e)),b=e,b===d&&(b=f,e=Fa(),e!==d?(c=y(),c!==d?(c=fa(),c!==d?(c=y(),c!==d?(c=F(),c!==d?(k=y(),k!==d?(k=Ga(),k!==d?(e=y(),e!==d?(e=C(),e!==d?(k=y(),k!==d?(k=ga(),k!==d?b=e=qb(c,e):(f=b,b=d)):(f=b,b=d)):(f=b,b=
d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,e=Fa(),e!==d?(c=y(),c!==d?(c=fa(),c!==d?(c=y(),c!==d?(c=C(),c!==d?(k=y(),k!==d?(k=ga(),k!==d?b=e={type:"interval-period",period:"second",precision:c,secondary:null}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,e=Fa(),e!==d&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),b=e)))));return b}function J(){var a;a=f;a=yc();a!==d&&(a=
{type:"string",value:"day"});a===d&&(a=f,a=zc(),a!==d&&(a={type:"string",value:"hour"}),a===d&&(a=f,a=Ac(),a!==d&&(a={type:"string",value:"minute"}),a===d&&(a=f,a=xc(),a!==d&&(a={type:"string",value:"month"}),a===d&&(a=f,a=wc(),a!==d&&(a={type:"string",value:"year"})))));return a}function C(){var a;a=T();a!==d&&(a=parseFloat(a));return a}function F(){var a;a=T();a!==d&&(a=parseFloat(a));return a}function R(){var a;a=ka();a===d&&(a=S());return a}function ka(){var b,c,e;b=f;39===a.charCodeAt(f)?(c=
rb,f++):(c=d,0===v&&g(sb));c===d&&(a.substr(f,2)===tb?(c=tb,f+=2):(c=d,0===v&&g(Yd)));if(c!==d){c=[];e=f;a.substr(f,2)===Ea?(e=Ea,f+=2):(e=d,0===v&&g(ub));e!==d&&(e="'");e===d&&(vb.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===v&&g(wb)));for(;e!==d;)c.push(e),e=f,a.substr(f,2)===Ea?(e=Ea,f+=2):(e=d,0===v&&g(ub)),e!==d&&(e="'"),e===d&&(vb.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===v&&g(wb)));c!==d?(39===a.charCodeAt(f)?(e=rb,f++):(e=d,0===v&&g(sb)),e!==d?b=c={type:"string",value:c.join("")}:(f=
b,b=d)):(f=b,b=d)}else f=b,b=d;return b}function ua(){var a,b,c;a=f;b=xb();b!==d?(b=y(),b!==d?(b=A(),b!==d?(c=y(),c!==d?(c=yb(),c!==d?(c=y(),c!==d?(c=A(),c!==d?a=b={type:"when_clause",operand:b,value:c}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function za(){var a,b,c;a=f;b=xb();b!==d?(b=y(),b!==d?(b=A(),b!==d?(c=y(),c!==d?(c=yb(),c!==d?(c=y(),c!==d?(c=A(),c!==d?a=b={type:"when_clause",operand:b,value:c}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=
d)):(f=a,a=d)):(f=a,a=d);return a}function L(){var b,c;b=f;var e,k;c=f;a.substr(f,4).toLowerCase()===Zd?(e=a.substr(f,4),f+=4):(e=d,0===v&&g($d));e!==d?(e=f,v++,k=x(),v--,k===d?e=void 0:(f=e,e=d),e!==d?c="ELSE":(f=c,c=d)):(f=c,c=d);c!==d?(c=y(),c!==d?(c=A(),c!==d?b={type:"else_clause",value:c}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d);return b}function ia(){var b,c,e;b=T();b===d&&(b=f,45===a.charCodeAt(f)?(c=cc,f++):(c=d,0===v&&g(dc)),c===d&&(43===a.charCodeAt(f)?(c=ac,f++):(c=d,0===v&&g(bc))),c!==d?(e=T(),
e!==d?b=c=c[0]+e:(f=b,b=d)):(f=b,b=d));return b}function Z(){var b,c;b=f;46===a.charCodeAt(f)?(c=ae,f++):(c=d,0===v&&g(be));c!==d?(c=T(),c===d&&(c=null),c!==d?b="."+(null!=c?c:""):(f=b,b=d)):(f=b,b=d);return b}function la(){var b,c,e;c=b=f;ce.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===v&&g(de));e!==d?(ee.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===v&&g(fe)),e===d&&(e=null),e!==d?c="e"+(null===e?"":e):(f=c,c=d)):(f=c,c=d);c!==d?(e=T(),e!==d?b=c+e:(f=b,b=d)):(f=b,b=d);return b}function T(){var a,
b;a=[];b=W();if(b!==d)for(;b!==d;)a.push(b),b=W();else a=d;a!==d&&(a=a.join(""));return a}function W(){var b;ge.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&g(he));return b}function va(){var b,c,e;b=f;a.substr(f,2).toLowerCase()===ie?(c=a.substr(f,2),f+=2):(c=d,0===v&&g(je));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="IN":(f=b,b=d)):(f=b,b=d);return b}function ba(){var b,c,e;b=f;a.substr(f,2).toLowerCase()===ke?(c=a.substr(f,2),f+=2):(c=d,0===v&&g(le));c!==d?(c=f,v++,e=x(),v--,
e===d?c=void 0:(f=c,c=d),c!==d?b="IS":(f=b,b=d)):(f=b,b=d);return b}function ja(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===me?(c=a.substr(f,4),f+=4):(c=d,0===v&&g(ne));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="LIKE":(f=b,b=d)):(f=b,b=d);return b}function U(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===oe?(c=a.substr(f,3),f+=3):(c=d,0===v&&g(pe));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="NOT":(f=b,b=d)):(f=b,b=d);return b}function V(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===
qe?(c=a.substr(f,3),f+=3):(c=d,0===v&&g(re));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="AND":(f=b,b=d)):(f=b,b=d);return b}function ca(){var b,c,e;b=f;a.substr(f,2).toLowerCase()===se?(c=a.substr(f,2),f+=2):(c=d,0===v&&g(te));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="OR":(f=b,b=d)):(f=b,b=d);return b}function da(){var b,c,e;b=f;a.substr(f,7).toLowerCase()===ue?(c=a.substr(f,7),f+=7):(c=d,0===v&&g(ve));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="BETWEEN":
(f=b,b=d)):(f=b,b=d);return b}function $b(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===we?(c=a.substr(f,4),f+=4):(c=d,0===v&&g(xe));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="FROM":(f=b,b=d)):(f=b,b=d);return b}function uc(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===ye?(c=a.substr(f,4),f+=4):(c=d,0===v&&g(ze));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="TRIM":(f=b,b=d)):(f=b,b=d);return b}function vc(){var b,c,e;b=f;a.substr(f,8).toLowerCase()===Ae?(c=a.substr(f,
8),f+=8):(c=d,0===v&&g(Be));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="INTERVAL":(f=b,b=d)):(f=b,b=d);return b}function wc(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Ce?(c=a.substr(f,4),f+=4):(c=d,0===v&&g(De));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="YEAR":(f=b,b=d)):(f=b,b=d);return b}function xc(){var b,c,e;b=f;a.substr(f,5).toLowerCase()===Ee?(c=a.substr(f,5),f+=5):(c=d,0===v&&g(Fe));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="MONTH":(f=b,b=
d)):(f=b,b=d);return b}function yc(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===Ge?(c=a.substr(f,3),f+=3):(c=d,0===v&&g(He));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="DAY":(f=b,b=d)):(f=b,b=d);return b}function zc(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Ie?(c=a.substr(f,4),f+=4):(c=d,0===v&&g(Je));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="HOUR":(f=b,b=d)):(f=b,b=d);return b}function Ac(){var b,c,e;b=f;a.substr(f,6).toLowerCase()===Ke?(c=a.substr(f,6),f+=6):
(c=d,0===v&&g(Le));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="MINUTE":(f=b,b=d)):(f=b,b=d);return b}function Fa(){var b,c,e;b=f;a.substr(f,6).toLowerCase()===Me?(c=a.substr(f,6),f+=6):(c=d,0===v&&g(Ne));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="SECOND":(f=b,b=d)):(f=b,b=d);return b}function Cb(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Oe?(c=a.substr(f,4),f+=4):(c=d,0===v&&g(Pe));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="CASE":(f=b,b=d)):(f=b,b=
d);return b}function Db(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===Qe?(c=a.substr(f,3),f+=3):(c=d,0===v&&g(Re));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="END":(f=b,b=d)):(f=b,b=d);return b}function xb(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Se?(c=a.substr(f,4),f+=4):(c=d,0===v&&g(Te));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="WHEN":(f=b,b=d)):(f=b,b=d);return b}function yb(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Ue?(c=a.substr(f,4),f+=4):(c=d,0===v&&
g(Ve));c!==d?(c=f,v++,e=x(),v--,e===d?c=void 0:(f=c,c=d),c!==d?b="THEN":(f=b,b=d)):(f=b,b=d);return b}function Ga(){var b;44===a.charCodeAt(f)?(b=We,f++):(b=d,0===v&&g(Xe));return b}function fa(){var b;40===a.charCodeAt(f)?(b=Ye,f++):(b=d,0===v&&g(Ze));return b}function ga(){var b;41===a.charCodeAt(f)?(b=$e,f++):(b=d,0===v&&g(af));return b}function y(){var a,b;a=[];for(b=zb();b!==d;)a.push(b),b=zb();return a}function zb(){var b;bf.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&g(cf));return b}
function $a(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function Ba(a,b){for(var c=0;c<b.length;c++)a=$a(b[c][1],a,b[c][3]);return a}p=void 0!==p?p:{};var d={},Ab={start:t},Bb=t,ad="!",bd=n("!",!1),Ya="\x3d",Za=n("\x3d",!1),ab="\x3e\x3d",ed=n("\x3e\x3d",!1),fd="\x3e",gd=n("\x3e",!1),bb="\x3c\x3d",hd=n("\x3c\x3d",!1),cb="\x3c\x3e",id=n("\x3c\x3e",!1),jd="\x3c",kd=n("\x3c",!1),db="!\x3d",ld=n("!\x3d",!1),ac="+",bc=n("+",!1),cc="-",dc=n("-",!1),md="*",
nd=n("*",!1),od="/",pd=n("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=h([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=h([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=h([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=n("@",!1),pb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},qb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},rb="'",sb=n("'",
!1),tb="N'",Yd=n("N'",!1),Ea="''",ub=n("''",!1),vb=/^[^']/,wb=h(["'"],!0,!1),ae=".",be=n(".",!1),ge=/^[0-9]/,he=h([["0","9"]],!1,!1),ce=/^[eE]/,de=h(["e","E"],!1,!1),ee=/^[+\-]/,fe=h(["+","-"],!1,!1),ud="null",vd=n("NULL",!0),qd="true",rd=n("TRUE",!0),sd="false",td=n("FALSE",!0),ie="in",je=n("IN",!0),ke="is",le=n("IS",!0),me="like",ne=n("LIKE",!0),cd="escape",dd=n("ESCAPE",!0),oe="not",pe=n("NOT",!0),qe="and",re=n("AND",!0),se="or",te=n("OR",!0),ue="between",ve=n("BETWEEN",!0),we="from",xe=n("FROM",
!0),Ed="for",Fd=n("FOR",!0),Cd="substring",Dd=n("SUBSTRING",!0),Ad="extract",Bd=n("EXTRACT",!0),ye="trim",ze=n("TRIM",!0),Gd="position",Hd=n("POSITION",!0),yd="timestamp",zd=n("TIMESTAMP",!0),wd="date",xd=n("DATE",!0),Qd="leading",Rd=n("LEADING",!0),Sd="trailing",Td=n("TRAILING",!0),Ud="both",Vd=n("BOTH",!0),Wd="to",Xd=n("TO",!0),Ae="interval",Be=n("INTERVAL",!0),Ce="year",De=n("YEAR",!0),Ee="month",Fe=n("MONTH",!0),Ge="day",He=n("DAY",!0),Ie="hour",Je=n("HOUR",!0),Ke="minute",Le=n("MINUTE",!0),Me=
"second",Ne=n("SECOND",!0),Oe="case",Pe=n("CASE",!0),Qe="end",Re=n("END",!0),Se="when",Te=n("WHEN",!0),Ue="then",Ve=n("THEN",!0),Zd="else",$d=n("ELSE",!0),We=",",Xe=n(",",!1),Ye="(",Ze=n("(",!1),$e=")",af=n(")",!1),bf=/^[ \t\n\r]/,cf=h([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=n("`",!1),Vc=/^[^`]/,Wc=h(["`"],!0,!1),f=0,Aa=[{line:1,column:1}],ea=0,Oa=[],v=0,ya;if("startRule"in p){if(!(p.startRule in Ab))throw Error("Can't start parsing from rule \""+p.startRule+'".');Bb=Ab[p.startRule]}ya=Bb();if(ya!==
d&&f===a.length)return ya;ya!==d&&f<a.length&&g({type:"end"});throw function(a,b,c){return new z(z.buildMessage(a,b),a,b,c)}(Oa,ea<a.length?a.charAt(ea):null,ea<a.length?m(ea,ea+1):m(ea,ea));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(z,a,p,n,h,b,m,g,t){function r(a,b){var e;if(!b)return null;if("x"in b){var c={x:0,y:0};a=a(b.x,b.y,G);c.x=a[0];c.y=a[1];null!=b.z&&(c.z=b.z);null!=b.m&&(c.m=b.m);return c}if("xmin"in b)return c={xmin:0,ymin:0,xmax:0,ymax:0},e=a(b.xmin,b.ymin,G),c.xmin=e[0],c.ymin=e[1],a=a(b.xmax,b.ymax,G),c.xmax=a[0],c.ymax=a[1],b.hasZ&&(c.zmin=b.zmin,c.zmax=b.zmax,c.hasZ=!0),b.hasM&&(c.mmin=b.mmin,c.mmax=b.mmax,c.hasM=!0),c;if("rings"in b)return{rings:A(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:A(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:u(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function A(a,b){for(var e=[],c=0;c<a.length;c++)e.push(u(a[c],b));return e}function u(a,b){for(var e=[],c=0;c<a.length;c++){var g=a[c],l=b(g[0],g[1],[0,0]);e.push(l);2<g.length&&l.push(g[2]);3<g.length&&l.push(g[3])}return e}function B(a,b){return!g.isValid(a)||!g.isValid(b)||g.equals(a,b)||t.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var G=[0,0];a.doesBrowserSupportProjection=
function(a,e){return B(a,e)?b.isSupported():!0};a.checkProjectionSupport=function(a,e){return p.__awaiter(this,void 0,void 0,function(){var k,c,g;return p.__generator(this,function(l){if(!e)return[2];if(Array.isArray(a)){k=0;for(c=a;k<c.length;k++)if(g=c[k],B(g.geometry&&g.geometry.spatialReference,e)){if(b.isSupported())return[2,b.load()];throw new n("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:e});}return[2]}if(!B(a,e))return[2];if(b.isSupported())return[2,
b.load()];throw new n("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:e});})})};var D=r.bind(null,t.lngLatToXY),H=r.bind(null,t.xyToLngLat);a.project=function(a,e,k){if(!a)return a;k||(k=e,e=a.spatialReference);return g.isValid(e)&&g.isValid(k)&&!g.equals(e,k)?t.canProject(e,k)?g.isWebMercator(k)?D(a):H(a):b.projectMany(m.jsonAdapter,[a],e,k,null)[0]:a};var E=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}
a.prototype.push=function(a,b,c){return p.__awaiter(this,void 0,void 0,function(){var e,k=this;return p.__generator(this,function(l){a&&a.length&&b&&c&&!g.equals(b,c)||h.resolve(a);e={geometries:a,inSpatialReference:b,outSpatialReference:c,resolve:null};this._jobs.push(e);return[2,h.create(function(a){e.resolve=a;null===k._timer&&(k._timer=setTimeout(k._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var k=a.geometries,c=a.inSpatialReference,l=
a.outSpatialReference,a=a.resolve;t.canProject(c,l)?g.isWebMercator(l)?a(k.map(D)):a(k.map(H)):a(b.projectMany(m.jsonAdapter,k,c,l,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,k){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,E.push(a,b,k)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),
function(z,a,p,n,h){function b(a,b,t,n,r){void 0===r&&(r=null);if(null===r){var u=h.cacheKey(t,n);void 0!==A[u]?r=A[u]:(r=m(t,n,null),null===r&&(r=new h),A[u]=r)}return g._project(a,b,t,n,r)}function m(a,b,m){void 0===m&&(m=null);a=g._getTransformation(t,a,b,m,null===m||void 0===m?void 0:m.spatialReference);return null!==a?h.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var g=null,t=null;a.isLoaded=function(){return!!g&&n.isLoaded()};a.isSupported=function(){return n.isSupported()};
var r=null;a.load=function(){return r?r:r=p.all([n.load(),new Promise(function(a,b){z(["./geometryEngineBase"],a,b)}),new Promise(function(a,b){z(["./geometryAdapters/hydrated"],a,b)})]).then(function(a){var b=a[1];t=a[2].hydratedAdapter;g=b;g._enableProjection(n)})};a.project=function(a,g,h){void 0===h&&(h=null);return a instanceof Array?0===a.length?[]:b(t,a,a[0].spatialReference,g,h):b(t,[a],a.spatialReference,g,h)[0]};var A={};a.projectMany=b;a.getTransformation=m;a.getTransformations=function(a,
b,m){void 0===m&&(m=null);a=g._getTransformationBySuitability(t,a,b,m,null===m||void 0===m?void 0:m.spatialReference);if(null!==a){b=[];for(m=0;m<a.length;m++)b.push(h.fromGE(a[m]));return b}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(z,a,p,n,h,b){function m(b){function e(a,b,c){a[b]=c(a[b])}a._pe=b;B.init();G.init();D.init();H.init();E.init();a.PeGCSExtent=function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}p.__extends(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var k=0,c=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];k<c.length;k++)b=c[k],e(b.prototype,"getName",function(a){return function(){return a.call(this,Array(B.PE_NAME_MAX))}});k=0;for(c=[a._pe.PeGeogtran,a._pe.PeProjcs];k<c.length;k++)b=c[k],e(b.prototype,"getParameters",
function(b){return function(){for(var c=Array(B.PE_PARM_MAX),e=b.call(this),k=0;k<c.length;k++){var g=a._pe.getValue(e,"*");c[k]=g?a._pe.wrapPointer(g,a._pe.PeParameter):null;e+=Int32Array.BYTES_PER_ELEMENT}return c}});e(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var c=[],e=a.call(this);A(c,b,e);return c}});e(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var e=
null,k=b.call(this);if(!a._pe.compare(k,a._pe.NULL)){var e=[k],g=this.getSteps();if(1<g)for(var k=a._pe.getPointer(k),l=1;l<g;l++)e.push(a._pe.wrapPointer(k+c*l,a._pe.PeGTlistExtendedGTs))}return e}});var g=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var e=null,k=b.call(this);if(!a._pe.compare(k,a._pe.NULL)){var e=[k],l=k.getNump();if(1<l)for(var k=a._pe.getPointer(k),h=1;h<l;h++)e.push(a._pe.wrapPointer(k+g*
h,a._pe.PeHorizon))}c.set(b,e);return e}};e(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);e(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=B.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),e=a._pe.ensureInt8(Array(B.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,e))}}function g(b){if(b){var e=a._pe.getClass(b);e&&(e=a._pe.getCache(e))&&(b=a._pe.getPointer(b))&&delete e[b]}}function t(b,
e){var k=[];e=Array(e);for(var c=0;c<b;c++)k.push(a._pe.ensureInt8(e));return k}function r(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function A(b,e,k,c){void 0===c&&(c=!1);if(c)for(c=0;c<2*e;c++)b[c]=a._pe.getValue(k+c*Float64Array.BYTES_PER_ELEMENT,"double");else{var g=0===b.length;for(c=0;c<e;c++)g&&(b[c]=Array(2)),b[c][0]=a._pe.getValue(k,"double"),b[c][1]=a._pe.getValue(k+Float64Array.BYTES_PER_ELEMENT,"double"),k+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});var u;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!h("esri-wasm")};a.load=function(){return u?u:u=b.create(function(a,b){(new Promise(function(a,b){z(["./support/pe-wasm"],a,b)})).then(function(e){e({locateFile:function(a){return n.getAssetUrl("esri/geometry/support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){m(b);a()})})})};(function(b){function e(b,c,e){a._pe.ensureCache.prepare();var k=r(e),g=e===
k,k=a._pe.ensureFloat64(k);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,k))&&A(e,c,k,g);return b}function k(a,b,e){return c(a,b,e,0)}function c(b,c,e,k){a._pe.ensureCache.prepare();var g=r(e),h=e===g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),c,g,k))&&A(e,c,g,h);return b}b.geogToProj=e;b.projGeog=function(a,b,c,g){switch(g){case B.PE_TRANSFORM_P_TO_G:return k(a,b,c);case B.PE_TRANSFORM_G_TO_P:return e(a,b,c)}return 0};b.projToGeog=k;b.projToGeogCenter=c})(a.PeCSTransformations||
(a.PeCSTransformations={}));var B;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=
a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=
a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;
b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(B=a.PeDefs||(a.PeDefs={}));(function(b){function e(b,e){var g=null,h=c[b];h||(h={},c[b]=h);h.hasOwnProperty(String(e))?g=h[e]:(b=a._pe.PeFactory.prototype.factoryByType(b,e),a._pe.compare(b,a._pe.NULL)||(g=b,h[e]=g));return g=k(g)}function k(b){if(b){var c=b.getType();switch(c){case B.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case B.PE_TYPE_PROJCS:b=a._pe.castObject(b,
a._pe.PeProjcs);break;case B.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&B.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var c={},g={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return e(B.PE_TYPE_COORDSYS,a)};b.factoryByType=e;b.fromString=function(b,c){var e=null,h=g[b];h||(h={},g[b]=h);h.hasOwnProperty(c)?e=h[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,h[c]=e));return e=
k(e)};b.geogcs=function(a){return e(B.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return e(B.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return e(B.PE_TYPE_PROJCS,a)};b.unit=function(a){return e(B.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var G;(function(b){var e;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;e=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=
function(b,c,g,h,l,m){var k=null,q=new a._pe.PeInteger(m);try{var w=a._pe.PeGTlistExtended.prototype.getGTlist(b,c,g,h,l,q);if(m=q.val)if(k=[w],1<m){var x=a._pe.getPointer(w);for(b=1;b<m;b++)k.push(a._pe.wrapPointer(x+e*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(q)}return k}})(G=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var e=0;e<b.length;e++){var c=b[e];g(c);c.getEntries().forEach(function(a){g(a);a=a.getGeogtran();g(a);a.getParameters().forEach(g);
[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){g(a);var b=a.getDatum();g(b);g(b.getSpheroid());g(a.getPrimem());g(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,k,c,g,h){a._pe.ensureCache.prepare();var e=r(c),l=c===e,e=a._pe.ensureFloat64(e),q=0;g&&(q=a._pe.ensureFloat64(g));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),k,e,q,h))&&A(c,k,e,l);return b}})(a.PeGTTransformations||
(a.PeGTTransformations={}));(function(b){function e(b,e,k,g,h,l){a._pe.ensureCache.prepare();var c,q;switch(b){case "dd":c=a._pe._pe_geog_to_dd;q=B.PE_DD_MAX;break;case "ddm":c=a._pe._pe_geog_to_ddm;q=B.PE_DDM_MAX;break;case "dms":c=a._pe._pe_geog_to_dms,q=B.PE_DMS_MAX}b=0;e&&(b=a._pe.getPointer(e));e=r(g);e=a._pe.ensureFloat64(e);q=t(k,q);g=a._pe.ensureInt32(q);if(h=c(b,k,e,h,g))for(c=0;c<k;c++)l[c]=a._pe.UTF8ToString(q[c]);return h}function k(b,e,k,g,h){a._pe.ensureCache.prepare();var c;switch(b){case "dd":c=
a._pe._pe_dd_to_geog;break;case "ddm":c=a._pe._pe_ddm_to_geog;break;case "dms":c=a._pe._pe_dms_to_geog}b=0;e&&(b=a._pe.getPointer(e));e=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(e);e=a._pe.ensureFloat64(Array(2*k));(c=c(b,k,g,e))&&A(h,k,e);return c}b.geog_to_dms=function(a,b,k,g,h){return e("dms",a,b,k,g,h)};b.dms_to_geog=function(a,b,e,g){return k("dms",a,b,e,g)};b.geog_to_ddm=function(a,b,k,g,h){return e("ddm",a,b,k,g,h)};b.ddm_to_geog=function(a,b,e,g){return k("ddm",
a,b,e,g)};b.geog_to_dd=function(a,b,k,g,h){return e("dd",a,b,k,g,h)};b.dd_to_geog=function(a,b,e,g){return k("dd",a,b,e,g)}})(a.PeNotationDms||(a.PeNotationDms={}));var D;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=
a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,k,c,g,h,l,m){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=r(c);c=a._pe.ensureFloat64(b);b=t(k,B.PE_MGRS_MAX);var q=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_mgrs_extended(e,k,c,g,h,l,q))for(h=0;h<k;h++)m[h]=a._pe.UTF8ToString(b[h]);return g};b.mgrs_to_geog_extended=function(b,k,c,g,h){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});
c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*k));(g=a._pe._pe_mgrs_to_geog_extended(e,k,c,g,b))&&A(h,k,b);return g}})(D=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,k,c,g,h,l,m){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=r(c);c=a._pe.ensureFloat64(b);b=t(k,B.PE_MGRS_MAX);var q=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_usng(e,k,c,g,h,l,q))for(h=0;h<k;h++)m[h]=a._pe.UTF8ToString(b[h]);return g};b.usng_to_geog=function(b,k,c,g){a._pe.ensureCache.prepare();
var e=0;b&&(e=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*k));(e=a._pe._pe_usng_to_geog(e,k,c,b))&&A(g,k,b);return e}})(a.PeNotationUsng||(a.PeNotationUsng={}));var H;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
k,c,g,h){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=r(c);c=a._pe.ensureFloat64(b);b=t(k,B.PE_UTM_MAX);var l=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_utm(e,k,c,g,l))for(e=0;e<k;e++)h[e]=a._pe.UTF8ToString(b[e]);return g};b.utm_to_geog=function(b,k,c,g,h){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*k));(g=a._pe._pe_utm_to_geog(e,k,c,g,b))&&A(h,k,b);return g}})(H=
a.PeNotationUtm||(a.PeNotationUtm={}));var E;(function(b){var e=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(k,c){void 0===c&&(c=b.PE_PCSINFO_OPTION_DOMAIN);var g,h;e.has(k)&&(h=e.get(k),h[c]&&(g=h[c]));g||(g=a._pe.PePCSInfo.prototype.generate(k,
c),h||(h=[],e.set(k,h)),h[c]=g);return g}})(E=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=m})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(z,a,p){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<
a.length;b++){var h=a[b];h instanceof p?this.steps.push(h):this.steps.push(new p({wkid:h.wkid,wkt:h.wkt,isInverse:h.isInverse}))}}}a.cacheKey=function(a,b){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==b.wkid&&null!==b.wkid?b.wkid.toString():"-1",void 0!==b.wkt&&null!==b.wkt?b.wkt.toString():""].join()};a.fromGE=function(h){var b=new a,m="",g=0;for(h=h.steps;g<h.length;g++){var t=p.fromGE(h[g]);b.steps.push(t);m+=t.uid.toString()+
","}b._cached_projection={};b._gtlistentry=null;b._chain=m;return b};a.prototype.getInverse=function(){var h=new a;h.steps=[];for(var b=this.steps.length-1;0<=b;b--)h.steps.push(this.steps[b].getInverse());return h};a.prototype.getGTListEntry=function(){for(var a="",b=0,m=this.steps;b<m.length;b++)a+=m[b].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(h,b,m){this._cached_projection[a.cacheKey(h,
b)]=m};a.prototype.getCachedGeTransformation=function(h,b){for(var m="",g=0,t=this.steps;g<t.length;g++)m+=t[g].uid.toString()+",";m!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=m);h=this._cached_projection[a.cacheKey(h,b)];return void 0===h?null:h};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(z,a){var p=0;return function(){function a(a){void 0===a&&(a=null);this.uid=p++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(h){var b=new a;b._wkt=h.wkt;b._wkid=h.wkid;b._isInverse=h.isInverse;return b};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=p++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=p++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=p++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var h=new a;h._wkt=this.wkt;h._wkid=this._wkid;h._isInverse=!this.isInverse;return h};return a}()})},"esri/geometry/geometryAdapters/json":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});a.jsonAdapter=
{convertToGEGeometry:function(a,b){return null==b?null:a.convertJSONToGeometry(b)},exportPoint:function(a,b,h){h=new p(a.getPointX(b),a.getPointY(b),h);var g=a.hasZ(b),m=a.hasM(b);g&&(h.z=a.getPointZ(b));m&&(h.m=a.getPointM(b));return h},exportPolygon:function(a,b,h){return new n(a.exportPaths(b),h,a.hasZ(b),a.hasM(b))},exportPolyline:function(a,b,m){return new h(a.exportPaths(b),m,a.hasZ(b),a.hasM(b))},exportMultipoint:function(a,h,m){return new b(a.exportPoints(h),m,a.hasZ(h),a.hasM(h))},exportExtent:function(a,
b,h){var g=a.hasZ(b),t=a.hasM(b);h=new m(a.getXMin(b),a.getYMin(b),a.getXMax(b),a.getYMax(b),h);g&&(g=a.getZExtent(b),h.zmin=g.vmin,h.zmax=g.vmax);t&&(a=a.getMExtent(b),h.mmin=a.vmin,h.mmax=a.vmax);return h}};var p=function(){return function(a,b,h){this.x=a;this.y=b;this.spatialReference=h;this.m=this.z=void 0}}(),n=function(){return function(a,b,h,m){this.rings=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);m&&(this.hasM=m)}}(),h=function(){return function(a,b,h,m){this.paths=
a;this.spatialReference=b;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);m&&(this.hasM=m)}}(),b=function(){return function(a,b,h,m){this.points=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);m&&(this.hasM=m)}}(),m=function(){return function(a,b,h,m,n){this.xmin=a;this.ymin=b;this.xmax=h;this.ymax=m;this.spatialReference=n;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(z,
a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,
supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports tslib ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(z,a,p,n,h,b,m,g,t,r,A,u,B,G,D){function H(a){return a.substr(24,12)+a.substr(19,4)+a.substr(16,2)+a.substr(14,2)+a.substr(11,2)+a.substr(9,2)+a.substr(6,2)+a.substr(4,2)+a.substr(2,2)+a.substr(0,2)}function E(a,b,k,c){if(k&&"esriFieldTypeDate"===k.type){var e=(new Date(a)).getTime(),g=(new Date(b)).getTime();if(!isNaN(e)&&!isNaN(g))return c?g-e:e-g}return"number"===typeof a&&"number"===typeof b?c?b-a:a-b:"string"===typeof a&&"string"===typeof b?(e=a.toUpperCase(),g=b.toUpperCase(),!k||"esriFieldTypeGUID"!==
k.type&&"esriFieldTypeGlobalID"!==k.type?c=(c?e>g:e<g)?-1:(c?e<g:e>g)?1:0:(a=H(e),g=H(g),c=(c?a>g:a<g)?-1:(c?a<g:a>g)?1:0),c):c?1:-1}Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=
c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(t.isValid(a.outSR)&&!t.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=
D.cleanFromGeometryEngine(p.__assign({spatialReference:a.outSR},B.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):b.queryGeometry=D.cleanFromGeometryEngine(p.__assign({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(e){var k=u.getWhereClause(e.where,this.fieldsIndex);if(!k)return b.resolve(this);if(k.isStandardized){for(var c=0,g=[],h=0,l=this.items;h<l.length;h++){var m=l[h];k.testFeature(m,this.featureAdapter)&&(g[c++]=
m)}k=new a(g,this.queryGeometry,this);k.definitionExpression=e.where;return b.resolve(k)}return b.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=function(e){if(!e.objectIds||!e.objectIds.length)return b.resolve(this);var k=m.SetFromValues(e.objectIds),c=this.featureAdapter.getObjectId;return b.resolve(new a(this.items.filter(function(a){return k.has(c(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(e){e=G.getTimeOperator(this.timeInfo,
e.timeExtent,this.featureAdapter);if(!h.isSome(e))return b.resolve(this);e=this.items.filter(e);return b.resolve(new a(e,this.queryGeometry,this))};a.prototype.filterLatest=function(){for(var e=this.timeInfo,k=e.trackIdField,c=e.startTimeField,e=e.endTimeField||c,c=new Map,g=this.featureAdapter.getAttribute,h=0,l=this.items;h<l.length;h++){var m=l[h],t=g(m,k),r=g(m,e),p=c.get(t);(!p||r>g(p,e))&&c.set(t,m)}k=n.valuesOfMap(c);return b.resolve(new a(k,this.queryGeometry,this))};a.prototype.project=function(b){return p.__awaiter(this,
void 0,void 0,function(){var e,c,g,h=this;return p.__generator(this,function(k){switch(k.label){case 0:if(!b||t.equals(this.spatialReference,b))return[2,this];e=this.featureAdapter;return[4,B.projectMany(this.items.map(function(a){return D.getGeometry(h.geometryType,h.hasZ,h.hasM,e.getGeometry(a))}),this.spatialReference,b)];case 1:return c=k.sent(),g=c.map(function(a,b){return e.cloneWithGeometry(h.items[b],r.convertFromGeometry(a,h.hasZ,h.hasM))}),[2,new a(g,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:b,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._sortFeatures=function(a,b,c){if(1<a.length&&b&&b.length){var e=function(b){b=b.split(" ");var e=b[0],g=k.fieldsIndex.get(e),h=b[1]&&"desc"===b[1].toLowerCase();a.sort(function(a,b){a=c(a,e,g);b=c(b,e,g);return E(a,b,g,h)})},k=this,g=0;for(b=b.reverse();g<b.length;g++)e(b[g])}};a.prototype._createFeatureQueryResponse=
function(a){var b=this,c=this.items,e=this.geometryType,h=this.hasM,l=this.hasZ,m=this.objectIdField,n=this.spatialReference,t=a.outFields,r=a.outSR,u=a.quantizationParameters,C=a.resultRecordCount,A=a.resultOffset,B=a.returnZ,G=a.returnM,z=!1;null!=C&&null!=A&&(C=A+C,z=c.length>C,c=c.slice(A,Math.min(c.length,C)));t=t&&(-1<t.indexOf("*")?p.__spreadArrays(this.fieldsIndex.fields):t.map(function(a){return b.fieldsIndex.get(a)}));return{exceededTransferLimit:z,features:this._createFeatures(a,c),fields:t,
geometryType:e,hasM:h&&G,hasZ:l&&B,objectIdFieldName:m,spatialReference:D.cleanFromGeometryEngine(r?r:n),transform:u&&g.toQuantizationTransform(u)||null}};a.prototype._createFeatures=function(a,b){var c=new A.default(a,this.featureAdapter,this.fieldsIndex),e=a.orderByFields,k=a.quantizationParameters,h=a.returnGeometry,l=a.returnCentroid,m=a.maxAllowableOffset,n=a.returnZ;a=a.returnM;var t=this.hasZ&&(void 0===n?!1:n),r=this.hasM&&(void 0===a?!1:a),n=[];a=0;if(h||l)if(k=g.toQuantizationTransform(k),
h&&!l)for(l=0;l<b.length;l++)h=b[l],n[a++]={attributes:c.getAttributes(h),geometry:D.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(h),m,k,t,r)};else if(!h&&l)for(m=0;m<b.length;m++)h=b[m],n[a++]={attributes:c.getAttributes(h),centroid:D.transformCentroid(this,this.featureAdapter.getCentroid(h,this),k)};else for(l=0;l<b.length;l++)h=b[l],n[a++]={attributes:c.getAttributes(h),centroid:D.transformCentroid(this,this.featureAdapter.getCentroid(h,this),k),geometry:D.getGeometry(this.geometryType,
this.hasZ,this.hasM,this.featureAdapter.getGeometry(h),m,k,t,r)};else for(m=0;m<b.length;m++)h=b[m],(t=c.getAttributes(h))&&(n[a++]={attributes:t});this._sortFeatures(n,e,function(a,b,e){return c.getFieldValue(a,b,e)});return n};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,g=0;for(a=a.outStatistics;g<a.length;g++){var h=a[g];if("exceedslimit"===h.statisticType){c=null!=h.maxPointCount?h.maxPointCount:
Number.POSITIVE_INFINITY;e=null!=h.maxRecordCount?h.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=h.maxVertexCount?h.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>e)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter,b=this.items.reduce(function(a,b){b=l.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",
sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=this,c={attributes:{}},e=[],g=new Map,h=new Map,l=new Map,m=new Map,t=new A.default(a,this.featureAdapter,this.fieldsIndex),r=a.outStatistics,p=a.groupByFieldsForStatistics,u=a.having;a=a.orderByFields;for(var B=p&&p.length,G=!!B,D=G&&p[0],z=G&&!this.fieldsIndex.get(D),H=0;H<r.length;H++){var E=r[H],ia=E.outStatisticFieldName,Z=E.statisticType,
la=E,T="exceedslimit"!==Z?E.onStatisticField:void 0,W="percentile_disc"===Z||"percentile_cont"===Z,va=G&&1===B&&(T===D||z)&&"count"===Z;if(G){if(!l.has(T)){for(var E=[],Z=0,ba=p;Z<ba.length;Z++){var ja=this._getAttributeValues(t,ba[Z],g);E.push(ja)}l.set(T,this._calculateUniqueValues(E))}var U=l.get(T),E=function(a){var c=U[a];a=c.count;var e=c.data,k=c.items,h=c.itemPositions,c=e.join(",");if(!u||t.validateItems(k,u)){var l=m.get(c)||{attributes:{}},k=null;if(va)k=a;else{var q=V._getAttributeValues(t,
T,g);a=h.map(function(a){return q[a]});k=W&&"statisticParameters"in la?V._getPercentileValue(la,a):V._getStatisticValue(la,a)}l.attributes[ia]=k;p.forEach(function(a,c){return l.attributes[b.fieldsIndex.get(a)?a:"EXPR_"+(c+1)]=e[c]});m.set(c,l)}},V=this,ca;for(ca in U)E(ca)}else ja=this._getAttributeValues(t,T,g),c.attributes[ia]=W&&"statisticParameters"in la?this._getPercentileValue(la,ja):this._getStatisticValue(la,ja,h);e.push({name:ia,alias:ia,type:"esriFieldTypeDouble"})}c=G?n.valuesOfMap(m):
[c];this._sortFeatures(c,a,function(a,b){return a.attributes[b]});return{fields:e,features:c}};a.prototype._getStatisticValue=function(a,b,c){var e=a.onStatisticField;a=a.statisticType;b=c&&c.has(e)?c.get(e):this._calculateStatistics(b);c&&c.set(e,b);return b["var"===a?"variance":a]};a.prototype._getPercentileValue=function(a,b){var c=a.statisticParameters,e=a.statisticType,k=c.value,g="desc"===c.orderBy,h=this.fieldsIndex.get(a.onStatisticField);a=p.__spreadArrays(b).sort(function(a,b){return E(a,
b,h,g)});return this._calculatePercentile(a,k,"percentile_disc"===e)};a.prototype._getAttributeValues=function(a,b,c){if(c.has(b))return c.get(b);var e=this.fieldsIndex.get(b),k=this.items.map(function(c){return a.getFieldValue(c,b,e)});c.set(b,k);return k};a.prototype._calculateStatistics=function(a){for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,e=null,g=null,h=null,l=null,m=[],n=0,t=0;t<a.length;t++){var r=a[t];"string"===typeof r?n++:null==r||isNaN(r)||(e+=r,b=Math.min(b,r),c=Math.max(c,
r),m.push(r),n++)}if(n){g=e/n;for(h=a=0;h<m.length;h++)r=m[h],a+=Math.pow(r-g,2);l=1<n?a/(n-1):0;h=Math.sqrt(l)}else c=b=null;return{avg:g,count:n,max:c,min:b,stddev:h,sum:e,variance:l}};a.prototype._calculateUniqueValues=function(a){for(var b={},c=this.items,e=c.length,g=0;g<e;g++){for(var h=c[g],l=[],m=0,n=a;m<n.length;m++)l.push(n[m][g]);m=l.join(",");null==b[m]?b[m]={count:1,data:l,items:[h],itemPositions:[g]}:(b[m].count++,b[m].items.push(h),b[m].itemPositions.push(g))}return b};a.prototype._calculatePercentile=
function(a,b,c){if(0===a.length)return null;if(0>=b)return a[0];if(1<=b)return a[a.length-1];var e=(a.length-1)*b,k=Math.floor(e);b=k+1;var e=e%1,k=a[k],g=a[b];return b>=a.length||c||"string"===typeof k||"string"===typeof g?k:k*(1-e)+g*e};return a}();a.default=z})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(z,a,p,n){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,h,g){this._fieldDataCache=
new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=g;this.featureAdapter=h;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var b=h=0;b<a.length;b++){var m=a[b],p=n.getExpressionFromFieldName(m),u=this.fieldsIndex.get(p),p=u?null:n.getWhereClause(p,g),u=u?u.name:n.getAliasFromFieldName(m)||"FIELD_EXP_"+h++;this._fieldDataCache.set(m,{alias:u,clause:p})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);
return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,h,g){var b=g?g.name:h,m=null;this._fieldDataCache.has(b)?m=this._fieldDataCache.get(b).clause:g||(m=n.getWhereClause(h,this.fieldsIndex),this._fieldDataCache.set(b,{alias:b,clause:m}));return g?this.featureAdapter.getAttribute(a,b):m.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,h){this._fieldDataCache.has(h)||this._fieldDataCache.set(h,{alias:h,clause:n.getWhereClause(h,this.fieldsIndex)});
return this._fieldDataCache.get(h).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,h){this._fieldDataCache.has(h)||this._fieldDataCache.set(h,{alias:h,clause:n.getWhereClause(h,this.fieldsIndex)});return this._fieldDataCache.get(h).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var g={},h=0;h<b.length;h++){var n=this._fieldDataCache.get(b[h]),
p=n.alias,n=n.clause;g[p]=n?n.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,p)}return g};a.prototype._processAttributesForDistinctValues=function(a){if(p.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,g=[];if(b)for(var h=0;h<b.length;h++){var n=this._fieldDataCache.get(b[h]).alias;g.push(a[n])}else for(n in a)g.push(a[n]);b=(b||["*"]).join(",")+"\x3d"+g.join(",");g=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++g);return 1<g?null:
a};return a}();a.default=z})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(z,a){function p(a,h,g,n,p){if(null!=n&&null!=p&&n===p)return function(b){return n>=a.getAttribute(b,h)&&n<=a.getAttribute(b,g)};if(null!=n&&null!=p)return function(b){var m=a.getAttribute(b,h);b=a.getAttribute(b,g);return!(m>p||b<n)};if(null!=n)return function(b){return!(a.getAttribute(b,g)<n)};if(null!=p)return function(b){return!(a.getAttribute(b,h)>p)}}function n(a,h,g,n){if(null!=
g&&null!=n&&g===n)return function(b){return a.getAttribute(b,h)===g};if(null!=g&&null!=n)return function(b){return a.getAttribute(b,h)>=g&&a.getAttribute(b,h)<=n};if(null!=g)return function(b){return a.getAttribute(b,h)>=g};if(null!=n)return function(b){return a.getAttribute(b,h)<=n}}function h(){return function(){return!1}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,h){if(!a)return null;var b=h.featureAdapter,m=a.startTimeField,n=a.endTimeField,p=Number.POSITIVE_INFINITY,
u=Number.NEGATIVE_INFINITY;if(m&&n)h.forEach(function(a){var h=b.getAttribute(a,m);a=b.getAttribute(a,n);null==h||isNaN(h)||(p=Math.min(p,h));null==a||isNaN(a)||(u=Math.max(u,a))});else{var B=m||n;h.forEach(function(a){a=b.getAttribute(a,B);null==a||isNaN(a)||(p=Math.min(p,a),u=Math.max(u,a))})}return{start:p,end:u}};a.getTimeOperator=function(a,m,g){if(!m||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var r=m.start;m=m.end;return null===r&&null===m?null:void 0===r&&
void 0===m?h():b&&a?p(g,b,a,r,m):n(g,b||a,r,m)}})},"esri/layers/graphics/data/utils":function(){define("require exports tslib ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),function(z,a,p,n,h,b,m,g,t,r,A,u,
B,G,D){function H(a,b,c,e,k){void 0===e&&(e=a.hasZ);void 0===k&&(k=a.hasM);var h=a.hasZ&&e,g=a.hasM&&k;return c?(a=u.quantizeOptimizedGeometry(q,b,a.hasZ,a.hasM,"esriGeometryPoint",c,e,k),u.convertToPoint(a,h,g)):u.convertToPoint(b,h,g)}function E(b,c,e){return p.__awaiter(this,void 0,void 0,function(){var k,q,n,w,x,r;return p.__generator(this,function(p){switch(p.label){case 0:if(!b)return[2,null];k=b.where;b.where=k=k&&k.trim();if(!k||/^1 *= *1$/.test(k)||c&&c===k)b.where=null;return b.geometry?
[4,l(b)]:[2,b];case 1:return q=p.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(n=b.geometry.spatialReference,q=m.getGeometryExtent(q),q.spatialReference=n),b.geometry=q,[4,G.checkProjectionSupport(q.spatialReference,e)];case 2:return p.sent(),[4,t.normalizeCentralMeridian(g.fromJSON(q))];case 3:w=p.sent()[0];if(h.isNone(w))throw a.QUERY_ENGINE_EMPTY_RESULT;x=w.toJSON();return[4,G.project(x,x.spatialReference,e)];case 4:r=p.sent();if(!r)throw a.QUERY_ENGINE_EMPTY_RESULT;
r.spatialReference=e;b.geometry=r;return[2,b]}})})}function l(a){return p.__awaiter(this,void 0,void 0,function(){var c,k,h,g,l,m,q,n,w;return p.__generator(this,function(p){switch(p.label){case 0:c=a.geometry;k=a.distance;h=a.units;if(null==k||"vertexAttributes"in c)return[2,c];g=c.spatialReference;l=h?e.fromJSON(h):b.getUnitString(g);m=g&&(r.isGeographic(g)||r.isWebMercator(g));if(!m)return[3,1];n=c;return[3,3];case 1:return[4,G.checkProjectionSupport(g,r.WGS84).then(function(){return G.project(c,
r.WGS84)})];case 2:n=p.sent(),p.label=3;case 3:return q=n,[4,D.getGeodesicBufferOperator()];case 4:return w=p.sent(),[2,w(q.spatialReference,q,k,l)]}})})}Object.defineProperty(a,"__esModule",{value:!0});var e=new n.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var k=new B.default,c=new B.default,
q=new B.default,w={esriGeometryPoint:u.convertToPoint,esriGeometryPolyline:u.convertToPolyline,esriGeometryPolygon:u.convertToPolygon,esriGeometryMultipoint:u.convertToMultipoint};a.transformCentroid=H;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=A.getCentroidOptimizedGeometry(new B.default,b.geometry,a.hasZ,a.hasM));return H(a,b.centroid,c)};a.getGeometry=function(a,b,e,h,g,l,m,n){void 0===m&&(m=b);void 0===
n&&(n=e);var p=b&&m,x=e&&n;h=h?"coords"in h?h:h.geometry:null;if(!h)return null;if(g)return b=u.generalizeOptimizedGeometry(c,h,b,e,a,g,m,n),l&&(b=u.quantizeOptimizedGeometry(q,b,p,x,a,l)),w[a](b,p,x);if(l)return b=u.quantizeOptimizedGeometry(q,h,b,e,a,l,m,n),w[a](b,p,x);u.removeZMValues(k,h,b,e,m,n);return w[a](k,p,x)};a.normalizeQuery=function(a,b,c){return p.__awaiter(this,void 0,void 0,function(){var e,k,h,g,l;return p.__generator(this,function(m){e=a.outFields;k=a.orderByFields;h=a.groupByFieldsForStatistics;
g=a.outStatistics;if(e)for(l=0;l<e.length;l++)e[l]=e[l].trim();if(k)for(l=0;l<k.length;l++)k[l]=k[l].trim();if(h)for(l=0;l<h.length;l++)h[l]=h[l].trim();if(g)for(l=0;l<g.length;l++)g[l].onStatisticField&&(g[l].onStatisticField=g[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,E(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(e){return[2,E(a,b,c)]})})};a.normalizeQueryLike=
E;a.cleanFromGeometryEngine=function(a){return a&&x in a?JSON.parse(JSON.stringify(a,Y)):a};var x="_geVersion",Y=function(a,b){return a!==x?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(z,a){function p(a,b,m,g,n,p){p=n?p?4:3:p?3:2;var h=m,t=m+p,r=0,G=0,D=m=0,z=0,E=0;for(--g;E<g;E++,h+=p,t+=p){var l=b[h],e=b[h+1],k=b[h+2],c=b[t],q=b[t+1],w=b[t+2],x=l*q-c*e,D=D+x,r=r+(l+c)*x,G=G+(e+q)*x;n&&(x=l*w-c*k,m+=(k+w)*x,z+=x);l<a[0]&&(a[0]=l);l>a[1]&&(a[1]=l);
e<a[2]&&(a[2]=e);e>a[3]&&(a[3]=e);n&&(k<a[4]&&(a[4]=k),k>a[5]&&(a[5]=k))}0<D&&(D*=-1);0<z&&(z*=-1);if(!D)return null;a=[r,G,.5*D];n&&(a[3]=m,a[4]=.5*z);return a}function n(a,b,m,g,n){n=g?n?4:3:n?3:2;for(var h=b,p=b+n,t=0,B=0,z=0,D=0,H=0,E=m-1;H<E;H++,h+=n,p+=n){var l=a[h],e=a[h+1],k=a[h+2],c=a[p],q=a[p+1],w=a[p+2],x;if(g){x=c-l;var Y=q-e,S=w-k;x=Math.sqrt(x*x+Y*Y+S*S)}else x=c-l,Y=q-e,x=Math.sqrt(x*x+Y*Y);x&&(t+=x,g?(l=[l+.5*(c-l),e+.5*(q-e),k+.5*(w-k)],B+=x*l[0],z+=x*l[1],D+=x*l[2]):(l=[l+.5*(c-
l),e+.5*(q-e)],B+=x*l[0],z+=x*l[1]))}return 0<t?g?[B/t,z/t,D/t]:[B/t,z/t]:0<m?g?[a[b],a[b+1],a[b+2]]:[a[b],a[b+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,b,m,g){if(!b||!b.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var h=a.coords,r=[],A=m?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:
[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],u=b.lengths,B=b.coords,z=m?g?4:3:g?3:2,D=0,H=0;H<u.length;H++){var E=u[H],l=p(A,B,D,E,m,g);l&&r.push(l);D+=E*z}r.sort(function(a,b){var c=a[2]-b[2];0===c&&m&&(c=a[4]-b[4]);return c});r.length&&(z=6*r[0][2],h[0]=r[0][0]/z,h[1]=r[0][1]/z,m&&(z=6*r[0][4],h[2]=0!==z?r[0][3]/z:0),h[0]<A[0]||h[0]>A[1]||h[1]<A[2]||h[1]>A[3]||m&&(h[2]<A[4]||h[2]>A[5]))&&(h.length=0);if(!h.length)if(b=b.lengths[0]?n(B,0,u[0],
m,g):null)h[0]=b[0],h[1]=b[1],m&&2<b.length&&(h[2]=b[2]);else return null;return a};a.lineCentroid=n})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils @dojo/framework/shim/Promise".split(" "),
function(z,a,p,n,h,b,m,g,t,r,A,u,B,G){function D(){return new Promise(function(a,b){z(["../../../geometry/geometryEngineJSON"],a,b)})}Object.defineProperty(a,"__esModule",{value:!0});var H={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},E={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},l={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},e={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=D;a.getGeodesicBufferOperator=function(){return D().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,c,e,l,n){if(g.isPolygon(c)&&"esriGeometryPoint"===e&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var k=A.convertFromPolygon(new u.default,c,!1,!1);return h.resolve(function(a){return r.polygonContainsPoint(k,!1,!1,a)})}if(g.isPolygon(c)&&"esriGeometryMultipoint"===e){var q=A.convertFromPolygon(new u.default,
c,!1,!1);if("esriSpatialRelContains"===a)return h.resolve(function(a){return r.polygonContainsMultipoint(q,!1,!1,a,l,n)})}if(g.isExtent(c)&&"esriGeometryPoint"===e&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return h.resolve(function(a){return b.extentContainsPoint(c,G.getGeometry(e,l,n,a))});if(g.isExtent(c)&&"esriGeometryMultipoint"===e&&"esriSpatialRelContains"===a)return h.resolve(function(a){return b.extentContainsMultipoint(c,G.getGeometry(e,l,n,a))});if(g.isExtent(c)&&"esriSpatialRelIntersects"===
a){var p=m.getExtentIntersector(e);return h.resolve(function(a){return p(c,G.getGeometry(e,l,n,a))})}return D().then(function(b){var k=b[H[a]].bind(null,c.spatialReference,c);return function(a){return k(G.getGeometry(e,l,n,a))}})};a.checkSpatialQuerySupport=function(a,b,h){return p.__awaiter(this,void 0,void 0,function(){var c,k;return p.__generator(this,function(m){c=a.spatialRel;k=a.geometry;if(!k)return[2];if(!0!==E[c])throw new n("feature-store:unsupported-query","Unsupported query spatial relationship",
{query:a});if(!t.isValid(k.spatialReference)||!t.isValid(h))return[2];if(!0!==l[g.getJsonType(k)])throw new n("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==e[b])throw new n("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,B.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(g.isExtent(a))return!0;if(g.isPolygon(a)){var b=0;for(a=a.rings;b<a.length;b++){var e=
a[b];if(5!==e.length||e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(z,a){function p(a,h,b,m,g){if(!a)return!1;h=h?b?4:3:b?3:2;b=a.coords;var n=!1,p=0,A=0;for(a=a.lengths;A<a.length;A++){for(var u=a[A],B=p,z=p,D=p+u*h;z<D;z+=h){B=z+h;B===D&&(B=p);var H=b[z],E=b[z+1],l=b[B],B=b[B+1];(E<g&&B>=g||B<g&&E>=g)&&H+(g-E)/(B-E)*(l-
H)<m&&(n=!n)}p+=u*h}return n}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,h,b,m){return p(a,h,b,m.coords[0],m.coords[1])};a.polygonContainsMultipoint=function(a,h,b,m,g,t){g=g?t?4:3:t?3:2;t=m.coords;m=m.lengths;if(!m)return!1;for(var n=0,A=0;n<m.length;n++,A+=g)if(!p(a,h,b,t[A],t[A+1]))return!1;return!0};a.polygonContainsCoords=p})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],function(z,a,p){Object.defineProperty(a,
"__esModule",{value:!0});z=function(){function a(){this._tasks=[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var b=this;return p.create(function(g,h){return b._tasks.push(new n(g,h,a))})};a.prototype.unshift=function(a){var b=this;return p.create(function(g,h){return b._tasks.unshift(new n(g,h,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;var a=this._tasks.shift();try{var h=
a.callback();h&&"then"in h&&"function"===typeof h.then?h.then(a.resolve,a.reject):a.resolve(h)}catch(g){a.reject(g)}return!0};a.prototype.cancelAll=function(){for(var a=p.createAbortError(),h=0,g=this._tasks;h<g.length;h++)g[h].reject(a);this._tasks.length=0};return a}();a.default=z;var n=function(){return function(a,b,m){this.resolve=a;this.reject=b;this.callback=m}}()})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature",
"../OptimizedGeometry"],function(z,a,p,n,h){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,h){return a.attributes[h]},cloneWithGeometry:function(a,h){return new n.default(h,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,m){a.centroid||(a.centroid=p.getCentroidOptimizedGeometry(new h.default,a.geometry,
m.hasZ,m.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports tslib ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),function(z,a,p,n,h,b){function m(a){var b=[];a.forEach(function(a){return b.push(a)});return b}function g(a){var b,c,e,h;return p.__generator(this,function(k){switch(k.label){case 0:b=a.type;switch(b){case "Feature":return[3,1];case "FeatureCollection":return[3,
3]}return[3,7];case 1:return[4,a];case 2:return k.sent(),[3,7];case 3:c=0,e=a.features,k.label=4;case 4:return c<e.length?(h=e[c])?[4,h]:[3,6]:[3,7];case 5:k.sent(),k.label=6;case 6:return c++,[3,4];case 7:return[2]}})}function t(a){var b,c,e,h,g,l,m,n,t,r;return p.__generator(this,function(k){switch(k.label){case 0:if(!a)return[2,null];b=a.type;switch(b){case "Point":return[3,1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,
5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,a.coordinates];case 2:return k.sent(),[3,17];case 3:return[5,p.__values(a.coordinates)];case 4:return k.sent(),[3,17];case 5:c=0,e=a.coordinates,k.label=6;case 6:if(!(c<e.length))return[3,9];h=e[c];return[5,p.__values(h)];case 7:k.sent(),k.label=8;case 8:return c++,[3,6];case 9:return[3,17];case 10:g=0,l=a.coordinates,k.label=11;case 11:if(!(g<l.length))return[3,16];m=l[g];n=0;t=m;k.label=12;case 12:if(!(n<t.length))return[3,15];r=t[n];
return[5,p.__values(r)];case 13:k.sent(),k.label=14;case 14:return n++,[3,12];case 15:return g++,[3,11];case 16:return[3,17];case 17:return[2]}})}function r(a,k){var c,e,g,m,n,t,r,u,B,A;void 0===k&&(k={});return p.__generator(this,function(q){switch(q.label){case 0:c=k.geometryType,e=k.objectIdFieldName,q.label=1;case 1:g=a.next();m=g.value;if(n=g.done)return[2];t=m.geometry;r=m.properties;u=m.id;if(t&&l[t.type]!==c)return[3,1];B=r||{};e&&null!=u&&!B[e]&&(B[e]=u);A=new h.default(t?G(new b.default,
t,k):null,B);return[4,A];case 2:return q.sent(),[3,1];case 3:return[2]}})}function A(a){for(;;){var b=a.next();if(b.done)return!1;if(2<b.value.length)return!0}}function u(a){for(var b=0,c=0;c<a.length;c++)var e=a[c],h=a[(c+1)%a.length],b=b+(e[0]*h[1]-h[0]*e[1]);return 0>=b}function B(a){var b=a[0],c=a[a.length-1];b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]||a.push(b);return a}function G(a,b,c){switch(b.type){case "LineString":return D(a,b.coordinates,c),a;case "MultiLineString":var e=0;for(b=b.coordinates;e<
b.length;e++)D(a,b[e],c);return a;case "MultiPoint":return D(a,b.coordinates,c),a;case "MultiPolygon":e=0;for(b=b.coordinates;e<b.length;e++){var h=b[e],g=a,k=c,l=B(h[0]);u(l)?D(g,l,k):H(g,l,k);for(g=1;g<h.length;g++){var k=a,l=c,m=B(h[g]);u(m)?H(k,m,l):D(k,m,l)}}return a;case "Point":return E(a,b.coordinates,c),a;case "Polygon":e=b.coordinates;b=B(e[0]);u(b)?D(a,b,c):H(a,b,c);for(b=1;b<e.length;b++)h=a,g=c,k=B(e[b]),u(k)?H(h,k,g):D(h,k,g);return a}}function D(a,b,c){for(var e=0;e<b.length;e++)E(a,
b[e],c);a.lengths.push(b.length)}function H(a,b,c){for(var e=b.length-1;0<=e;e--)E(a,b[e],c);a.lengths.push(b.length)}function E(a,b,c){var e=b[2];a.coords.push(b[0],b[1]);c.hasZ&&a.coords.push(e||0)}Object.defineProperty(a,"__esModule",{value:!0});var l={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};a.validateGeoJSON=function(a){if(!a)throw new n("geojson-layer:empty",
"GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new n("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});if(a=a.crs){var b="string"===typeof a?a:"name"===a.type?a.properties.name:null,c=/.*(CRS84H?|4326)$/i;if(!b||!c.test(b))throw new n("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:a});}};a.inferLayerProperties=function(a,b){void 0===b&&(b={});var c=g(a),e=[],h=new Set,k=new Set,n=!1,p=Number.NEGATIVE_INFINITY,
r=null,u=!1,B=void 0;a=b.geometryType;var C=void 0===a?null:a,z=!1;for(a=function(){var a=c.next(),b=a.value;if(a.done){var g=r&&1===r.length&&r[0]||null;if(g)for(b=0;b<e.length;b++)a=e[b],a.name===g&&(a.type="esriFieldTypeOID");return{value:{fields:e,geometryType:C,hasZ:n,maxObjectId:Math.max(0,p),objectIdFieldName:g,objectIdFieldType:B,unknownFields:m(k)}}}var a=b.geometry,q=b.properties,w=b.id;if(a&&(C||(C=l[a.type]),l[a.type]!==C))return"continue";n||(b=t(a),n=A(b));!u&&(u=null!=w)&&(B=typeof w,
"number"===B&&(r=Object.keys(q).filter(function(a){return q[a]===w})));u&&"number"===B&&null!=w&&(p=Math.max(p,w),1<r.length?r=r.filter(function(a){return q[a]===w}):1===r.length&&(r=q[r[0]]===w?r:[]));if(!z&&q){b=!0;for(g in q)if(!h.has(g))if(a=q[g],null==a)b=!1,k.add(g);else{a:switch(typeof a){case "string":a="esriFieldTypeString";break a;case "number":a="esriFieldTypeDouble";break a;default:a="unknown"}"unknown"===a?k.add(g):(k.delete(g),h.add(g),e.push({name:g,alias:g,type:a}))}z=b}};;)if(b=a(),
"object"===typeof b)return b.value};a.createOptimizedFeatures=function(a,b){a:for(a=r(g(a),b),b=[];;){var c=a.next(),e=c.value;if(c.done)break a;b.push(e)}return b}})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports tslib ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(z,a,p,n,h,b){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===
a||"esriGeometryMultipoint"===a?b.defaultPointSymbolJSON:"esriGeometryPolyline"===a?b.defaultPolylineSymbolJSON:b.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(n("csp-restrictions"))return function(){var g;return p.__assign((g={},g[b]=null,g),a)};try{var h="this."+b+" \x3d null;",g;for(g in a)h+="this."+g+" \x3d "+JSON.stringify(a[g])+";";var m=new Function(h);return function(){return new m}}catch(u){return function(){var g;return p.__assign((g={},g[b]=null,g),a)}}};
a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:h.clone(a)}}]}})},"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports tslib ../../../../geometry/support/spatialReferenceUtils ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),function(z,a,p,n,h){function b(a){return new t(a)}function m(){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(a){switch(a.label){case 0:return u?
[2,u]:[4,new Promise(function(a,b){z(["../../../../geometry/geometryEngineJSON"],a,b)})];case 1:return u=a.sent(),[2,u]}})})}Object.defineProperty(a,"__esModule",{value:!0});var g=function(){return function(){this.description=this.code=null}}(),t=function(){return function(a){this.error=new g;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=b;var r=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=
this.uniqueId=a}}();a.createFeatureEditSuccessResult=function(a){return new r(a)};var A=new Set;a.mixAttributes=function(a,g,m,n,p,l){void 0===p&&(p=!1);A.clear();for(var e in n){var k=a.get(e);if(k){var c=n[e],q;q=k;var w=c,t=w;"string"===typeof w&&h.isNumericField(q)?t=parseFloat(w):null!=w&&h.isStringField(q)&&"string"!==typeof w&&(t=String(w));q=h.sanitizeNullFieldValue(t);q!==c&&l&&l.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:k,
originalValue:c,sanitizedValue:q}});A.add(k.name);if(k&&(p||k.editable)){if(c=h.validateFieldValue(k,q))return b(h.validationErrorToString(c,k,q));m[k.name]=q}}}for(a=0;a<g.length;a++)if(m=g[a],!A.has(m.name))return b('missing required field "'+m.name+'"');return null};var u;a.simplify=function(a,b){if(!a||!n.isValid(b))return a;if("rings"in a||"paths"in a){if(!u)throw new TypeError("geometry engine not loaded");return u.simplify(b,a)}return a};a.loadGeometryEngine=m;a.loadGeometryEngineForSimplify=
function(a,b){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(g){switch(g.label){case 0:return!n.isValid(a)||"esriGeometryPolygon"!==b&&"esriGeometryPolyline"!==b?[3,2]:[4,m()];case 1:g.sent(),g.label=2;case 2:return[2]}})})}})},"*noref":1}});
define("require exports tslib ../../../../request ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../support/sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(z,a,p,n,h,b,m,g,t,r,A,u,B,G,D,H,E,l){Object.defineProperty(a,
"__esModule",{value:!0});var e={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,
supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};z=function(){function a(){this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a){return p.__awaiter(this,void 0,void 0,function(){var b,c,k,m,z,D,aa,J,C,F,R,ka,ua,za,L,ia,Z,la,T,W,va,ba,ja,U,V,ca,da;return p.__generator(this,
function(q){switch(q.label){case 0:return b=[],[4,this._checkProjection(a.spatialReference)];case 1:return q.sent(),c=null,a.url?[4,n(a.url,{responseType:"json"})]:[3,4];case 2:return k=q.sent(),c=k.data,[4,B.validateGeoJSON(c)];case 3:q.sent(),q.label=4;case 4:m=B.inferLayerProperties(c,{geometryType:a.geometryType});z=a.fields||m.fields||[];D=null!=a.hasZ?a.hasZ:m.hasZ;aa=m.geometryType;J=a.objectIdField||("number"===m.objectIdFieldType?m.objectIdFieldName:"OBJECTID")||"OBJECTID";C=a.spatialReference||
g.WGS84;F=a.timeInfo;if(!aa)throw new h("geojson-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");"string"===m.objectIdFieldType&&b.push({name:"geojson-layer:unsupported-id-type",message:"Feature ids are of type string and can't be honored."});z===m.fields&&0<m.unknownFields.length&&b.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:m.unknownFields}});
J&&(R=null,(ka=z.some(function(a){return a.name===J?(R=a,!0):!1}))?(R.type="esriFieldTypeOID",R.editable=!1,R.nullable=!1):z.unshift({alias:J,name:J,type:"esriFieldTypeOID",editable:!1,nullable:!1}));ua=0;for(za=z;ua<za.length;ua++){L=za[ua];null==L.name&&(L.name=L.alias);null==L.alias&&(L.alias=L.name);if(!L.name)throw new h("geojson-layer:invalid-field-name","field name is missing",{field:L});L.name===J&&(L.type="esriFieldTypeOID");if(-1===E.kebabDict.jsonValues.indexOf(L.type))throw new h("geojson-layer:invalid-field-type",
'invalid type for field "'+L.name+'"',{field:L});}ia={};this._requiredFields=[];Z=0;for(la=z;Z<la.length;Z++)L=la[Z],"esriFieldTypeOID"!==L.type&&"esriFieldTypeGlobalID"!==L.type&&(L.editable=null==L.editable?!0:!!L.editable,L.nullable=null==L.nullable?!0:!!L.nullable,T=l.getFieldDefaultValue(L),L.nullable||void 0!==T?ia[L.name]=T:this._requiredFields.push(L));this._fieldsIndex=new H(z);F&&(F.startTimeField&&((W=this._fieldsIndex.get(F.startTimeField))?(F.startTimeField=W.name,W.type="esriFieldTypeDate"):
F.startTimeField=null),F.endTimeField&&((va=this._fieldsIndex.get(F.endTimeField))?(F.endTimeField=va.name,va.type="esriFieldTypeDate"):F.endTimeField=null),F.trackIdField&&((ba=this._fieldsIndex.get(F.trackIdField))?F.trackIdField=ba.name:(F.trackIdField=null,b.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:F}}))),F.startTimeField||F.endTimeField||(b.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",
details:{timeInfo:F}}),F=null));ja={warnings:b,featureErrors:[],layerDefinition:p.__assign(p.__assign({},e),{drawingInfo:G.createDrawingInfo(aa),templates:G.createDefaultTemplate(ia),extent:null,geometryType:aa,objectIdField:J,fields:z,hasZ:!!D,timeInfo:F})};this._queryEngine=new u.default({fields:z,geometryType:aa,hasM:!1,hasZ:D,objectIdField:J,spatialReference:C,timeInfo:F,featureStore:new r.default({geometryType:aa,hasM:!1,hasZ:D})});this._createDefaultAttributes=G.createDefaultAttributesFunction(ia,
J);this._nextObjectId=m.maxObjectId+1;U=B.createOptimizedFeatures(c,{geometryType:aa,hasZ:D,objectIdFieldName:"number"===m.objectIdFieldType?J:null});if(!g.equals(C,g.WGS84))for(V=0,ca=U;V<ca.length;V++)da=ca[V],da.geometry&&(da.geometry=t.convertFromGeometry(A.project(t.convertToGeometry(da.geometry,aa,D,!1),g.WGS84,C)));this._loadInitialFeatures(ja,U);return[2,ja]}})})};a.prototype.applyEdits=function(a){return p.__awaiter(this,void 0,void 0,function(){var c,e,g;return p.__generator(this,function(h){switch(h.label){case 0:return c=
this._queryEngine,e=c.spatialReference,g=c.geometryType,[4,b.all([D.loadGeometryEngineForSimplify(e,g),A.checkProjectionSupport(a.adds,e),A.checkProjectionSupport(a.updates,e)])];case 1:return h.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQuery(a,b.signal)]})})};a.prototype.queryFeatureCount=function(a,b){void 0===
a&&(a={});void 0===b&&(b={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};a.prototype.queryObjectIds=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};a.prototype.queryExtent=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return p.__awaiter(this,
void 0,void 0,function(){return p.__generator(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine,e=c.featureStore,c=c.objectIdField,g=[],h=0;h<b.length;h++){var k=b[h],l=this._createDefaultAttributes(),m=D.mixAttributes(this._fieldsIndex,this._requiredFields,l,k.attributes,!0,a.warnings);m?a.featureErrors.push(m):(this._assignObjectId(l,k.attributes,!0),k.attributes=l,k.objectId=l[c],g.push(k))}e.addMany(g);
a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var e={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(e,b);c&&c.length&&this._applyUpdateEdits(e,c);if(a&&a.length){for(b=0;b<a.length;b++)e.deleteResults.push(D.createFeatureEditSuccessResult(a[b]));
this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:e}};a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,e=this._queryEngine,g=e.geometryType,h=e.hasM,k=e.hasZ,l=e.objectIdField,n=e.spatialReference,e=e.featureStore,p=[],q=0;q<b.length;q++){var r=b[q];if(r.geometry&&g!==m.getJsonType(r.geometry))c.push(D.createFeatureEditErrorResult("Incorrect geometry type."));else{var u=this._createDefaultAttributes(),
z=D.mixAttributes(this._fieldsIndex,this._requiredFields,u,r.attributes);z?c.push(z):(this._assignObjectId(u,r.attributes),r.attributes=u,null!=r.uid&&(a.uidToObjectId[r.uid]=r.attributes[l]),r.geometry&&(r.geometry=A.project(D.simplify(r.geometry,n),r.geometry.spatialReference,n)),p.push(r),c.push(D.createFeatureEditSuccessResult(r.attributes[l])))}}e.addMany(t.convertFromFeatures([],p,g,k,h,l))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,e=c.geometryType,
g=c.hasM,h=c.hasZ,k=c.objectIdField,l=c.spatialReference,c=c.featureStore,n=0;n<b.length;n++){var p=b[n],q=p.attributes,r=p.geometry,p=q&&q[k];if(null==p)a.push(D.createFeatureEditErrorResult("Identifier field "+k+" missing"));else if(c.has(p)){var u=t.convertToFeature(c.getFeature(p),e,h,g);if(r){if(e!==m.getJsonType(r)){a.push(D.createFeatureEditErrorResult("Incorrect geometry type."));continue}u.geometry=A.project(D.simplify(r,l),r.spatialReference,l)}if(q&&(q=D.mixAttributes(this._fieldsIndex,
this._requiredFields,u.attributes,q))){a.push(q);continue}c.add(t.convertFromFeature(u,e,h,g,k));a.push(D.createFeatureEditSuccessResult(p))}else a.push(D.createFeatureEditErrorResult("Feature with object id "+p+" missing"))}};a.prototype._assignObjectId=function(a,b,e){void 0===e&&(e=!1);var c=this._queryEngine.objectIdField;e?isFinite(b[c])?a[c]=b[c]:a[c]=this._nextObjectId++:a[c]=this._nextObjectId++};a.prototype._checkProjection=function(a){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,
function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,A.checkProjectionSupport(g.WGS84,a)];case 1:return b.sent(),[3,3];case 2:throw b.sent(),new h("geojson-layer","Projection not supported");case 3:return[2]}})})};return a}();a.default=z});