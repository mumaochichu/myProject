// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(d,k,l,m){Object.defineProperty(k,"__esModule",{value:!0});d=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(a,c,b){return new n(a,c,b)};b.instance=null;return b}();k.EffectDonut=d;var n=function(){function b(a,c,b){this._inputGeometries=a;this._curveHelper=new m.CurveHelper;this._width=(void 0!==c.width?c.width:2)*b;switch(c.method){default:this._method=
"Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";break;case "Square":this._method="Square"}this._option=c.option;this._offsetFlattenError=m.PIXEL_TOLERANCE*b;this._option}b.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(l.isExtent(a)&&0<this._width){if(0>Math.min(a.xmax-a.xmin,a.ymax-a.ymin)-2*this._width)return a;var b=[];b.push([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]);
b.push([[a.xmin+this._width,a.ymin+this._width],[a.xmax-this._width,a.ymin+this._width],[a.xmax-this._width,a.ymax-this._width],[a.xmin+this._width,a.ymax-this._width],[a.xmin+this._width,a.ymin+this._width]]);return{rings:b}}if(l.isPolygon(a)&&0<this._width){for(var d=[],b=[],f=0,a=a.rings;f<a.length;f++){var e=a[f],g=this._curveHelper.calculatePathLength(e);0<g&&d.push(e);var h=this._curveHelper.offset(e,this._width,this._method,4,this._offsetFlattenError);h&&(0>g&&h.reverse(),b.push(h));0>g&&d.push(e)}if(b.length)return{rings:b}}a=
this._inputGeometries.next()}return null};return b}()});